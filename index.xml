<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>é¬¼ç”»æ¡ƒç¬¦</title><link>https://tab.deoops.com/</link><description>Recent content on é¬¼ç”»æ¡ƒç¬¦</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 27 Feb 2023 10:57:27 +0800</lastBuildDate><atom:link href="https://tab.deoops.com/index.xml" rel="self" type="application/rss+xml"/><item><title>è®°ä¸€æ¬¡overflow</title><link>https://tab.deoops.com/posts/cast-befor-opreate/</link><pubDate>Mon, 27 Feb 2023 10:57:27 +0800</pubDate><guid>https://tab.deoops.com/posts/cast-befor-opreate/</guid><description>&lt;img src="https://tab.deoops.com/posts/cast-befor-opreate/overflow.png" alt="Featured image of post è®°ä¸€æ¬¡overflow" />&lt;p>æœ€è¿‘ç»™ä¸€ä¸ªé¡¹ç›®åŠ ä¸Šäº†é™é€Ÿçš„åŠŸèƒ½ï¼Œè·‘äº†ä¸€æ®µæ—¶é—´åå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œè¶…çº§ç®¡ç†å‘˜çš„é€Ÿåº¦é˜ˆå€¼æœ¬æ¥æ˜¯æœ€å¤§çš„ï¼Œå®é™…ä½¿ç”¨æ˜¯å´å‘ç°å¥½æƒ³æ˜¯0ã€‚&lt;/p>
&lt;p>æ‰“äº†ä¸ªä¸ªæ–­ç‚¹ï¼Œ å‘ç°adminçš„rate.Limit ç¡®å®æ˜¯ -1000ã€‚&lt;/p>
&lt;p>çœ‹äº†ä¸‹ä»£ç ï¼ŒåŸæ¥æ˜¯overflowäº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="o">-&lt;/span> &lt;span class="nx">limit&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewLimiter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Limit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Speed&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">limit&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewLimiter&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">rate&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Limit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">float64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">q&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Speed&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">1000&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>q.Speed&lt;/code> çš„typeæ˜¯ &lt;code>int16&lt;/code>&lt;/p>
&lt;p>å½“æ—¶å†™çš„æ—¶å€™è§‰å¾—&lt;code>float64&lt;/code>æ€ä¹ˆå¯èƒ½overflowï¼Œ ç°åœ¨å‘ç° æ˜¯&lt;code>int16 * 1000&lt;/code>å°±å·²ç»overflowäº†ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ç±»å‹è½¬æ¢çš„æ—¶å€™ä¸€å®šè¦å…ˆè½¬æ¢å†è®¡ç®—ã€‚&lt;/p>
&lt;h2 id="update">update&lt;/h2>
&lt;p>å¦‚æœæ˜¯&lt;code>int64&lt;/code> è½¬ &lt;code>int32&lt;/code> çš„è¯ï¼Œåˆ™åº”è¯¥åè¿‡æ¥ï¼š &lt;code>int32(a / 1000)&lt;/code> å…¶ä¸­aæ˜¯&lt;code>int64&lt;/code>ç±»å‹ã€‚&lt;/p>
&lt;p>å‡†ç¡®æ¥è¯´ï¼Œå°è½¬å¤§ï¼Œå…ˆè½¬æ¢å†è®¡ç®—ï¼› å¤§è½¬å°ï¼Œå…ˆè®¡ç®—å†è½¬å°ã€‚&lt;/p></description></item><item><title>SQLæ’å…¥é»˜è®¤å€¼</title><link>https://tab.deoops.com/posts/sql-default-values/</link><pubDate>Wed, 22 Feb 2023 14:59:29 +0800</pubDate><guid>https://tab.deoops.com/posts/sql-default-values/</guid><description>&lt;img src="https://tab.deoops.com/posts/sql-default-values/sql-insert-statement-queries.png" alt="Featured image of post SQLæ’å…¥é»˜è®¤å€¼" />&lt;p>æ˜¨å¤©è®¾è®¡äº†ä¸€ä¸ªquotaè¡¨ï¼Œåç«¯ä»£ç è¿™æ ·ä¸€ä¸ªåˆå§‹åŒ–çš„é€»è¾‘ï¼š&lt;/p>
&lt;p>å¦‚æœquotaè¡¨ä¸ºç©ºï¼Œåˆ™æ’å…¥ä¸€æ¡é»˜è®¤çš„è®°å½•ã€‚&lt;/p>
&lt;p>ä¸Šçº¿è°ƒè¯•çš„æ—¶å€™ï¼Œå‘ç°ä¼šæŠ¥é”™&lt;code>quotas_pkey duplicated&lt;/code>ï¼Œè€Œä¸”åªä¼šæŠ¥ä¸€æ¬¡ï¼Œ é‡å¯åç«¯åº”ç”¨ä¸ä¼šå†æŠ¥é”™ã€‚&lt;/p>
&lt;p>ä½†æ˜¯æ¸…ç©ºtableä¹‹åï¼Œé‡å¯åç«¯ä¼šå†æŠ¥åŒæ ·çš„é”™ã€‚&lt;/p>
&lt;p>ä¸‹é¢æ˜¯è¡¨ç»“æ„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">CREATE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">IF&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">EXISTS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">quotas&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">SERIAL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">PRIMARY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">KEY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">concurrent&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">smallint&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">15&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">total&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">smallint&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">1000&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">speed&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nb">smallint&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="mi">200&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">created_at&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TIMESTAMP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">CURRENT_TIMESTAMP&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="n">updated_at&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">TIMESTAMP&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NOT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">NULL&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">CURRENT_TIMESTAMP&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ’æŸ¥ä¸€æ®µæ—¶é—´åå‘ç”Ÿï¼Œæ˜¯ä¸‹é¢ä¸€æ®µsqlä»£ç çš„é—®é¢˜ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- name: InitQuota :exec
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">INSERT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">INTO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">quotas&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">id&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ®µä»£ç æƒ³å®ç°çš„æ˜¯æ’å…¥ä¸€æ¡idä¸º1çš„é»˜è®¤è®°å½•ã€‚åç«¯æ˜¯åšäº†åˆ¤æ–­çš„ï¼Œåªæœ‰quotasè¡¨ä¸ºç©ºçš„æ—¶å€™æ‰æ‰§è¡Œè¿™æ¡sqlè¯­å¥ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å¿½ç•¥äº†è¿™æ¡è¯­å¥ä¸ä¼šä½¿å¾—idè‡ªå¢åŠ ï¼ˆpostgresqlæ˜¯è¿™æ ·çš„ï¼Œmysqlæ²¡æµ‹è¯•è¿‡ï¼‰ã€‚&lt;/p>
&lt;p>äºæ˜¯å½“ç”¨æˆ·æ’å…¥ä¸€æ¡æ–°çš„quotaè®°å½•æ—¶ï¼Œå°±ä¼šå’Œå·²æœ‰çš„&lt;code>id = 1&lt;/code>çš„é»˜è®¤è®°å½•å‘ç”Ÿå†²çªã€‚&lt;/p>
&lt;h2 id="æ­£ç¡®">æ­£ç¡®&lt;/h2>
&lt;p>å…¶å®&lt;code>sql&lt;/code>æœ‰ä¸“é—¨æ–°å¢é»˜è®¤å€¼è®°å½•çš„è¯­å¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- name: InitQuota :exec
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">INSERT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">INTO&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">quotas&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">DEFAULT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">VALUES&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 135;
flex-basis: 324px"
>
&lt;a href="https://tab.deoops.com/posts/sql-default-values/sql-insert-statement-queries.png" data-size="725x536">
&lt;img src="https://tab.deoops.com/posts/sql-default-values/sql-insert-statement-queries.png"
width="725"
height="536"
srcset="https://tab.deoops.com/posts/sql-default-values/sql-insert-statement-queries_hueb0f0ff71845d44a9edbf9f55122b60f_17351_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/sql-default-values/sql-insert-statement-queries_hueb0f0ff71845d44a9edbf9f55122b60f_17351_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="insert into syntax">
&lt;/a>
&lt;figcaption>insert into syntax&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>è®°æ˜¾ç¤ºå™¨åäº†</title><link>https://tab.deoops.com/posts/display-type-c/</link><pubDate>Mon, 13 Feb 2023 16:46:35 +0800</pubDate><guid>https://tab.deoops.com/posts/display-type-c/</guid><description>&lt;img src="https://tab.deoops.com/posts/display-type-c/physic-attack.jpeg" alt="Featured image of post è®°æ˜¾ç¤ºå™¨åäº†" />&lt;p>ä¸Šå‘¨äº”ï¼Œå¤–æ¥çš„æ˜¾ç¤ºå™¨æ— æ•…å˜çš„å¾ˆæ¨¡ç³Šï¼Œé‡æ–°æ’æ‹”ç”šè‡³é»‘å±æç¤ºæ²¡ä¿¡å·ï¼Œ&lt;/p>
&lt;p>é‡æ–°æ’æ‹”type-cçº¿åï¼Œèƒ½è¯†åˆ«åˆ°æ˜¾ç¤ºå™¨äº†ï¼Œä¸è¿‡å­—ä½“å’Œç”»é¢è¿˜æ˜¯æ¯”è¾ƒæ¨¡ç³Šã€‚&lt;/p>
&lt;p>æ‰“å¼€è®¾ç½®ï¼ŒæŸ¥çœ‹æ˜¾ç¤ºå™¨ï¼Œå‘ç°åˆ†è¾¨ç‡è®¾ç½®çš„ä¸å¯¹ï¼Œ é»˜è®¤æ˜¯1080päº†ï¼Œåˆ·æ–°ç‡ä¹Ÿå˜çš„å¾ˆå¥‡æ€ªæ˜¯59.86ã€‚&lt;/p>
&lt;p>ä»”ç»†ç¿»æ‰¾äº†ä¸‹ï¼Œè®¾ç½®é‡Œæ²¡çœ‹åˆ°åˆ†è¾¨ç‡4kçš„é€‰é¡¹ï¼Œåˆ·æ–°ç‡å‰©ä¸‹30hzç­‰æ›´ä½çš„é€‰é¡¹ã€‚&lt;/p>
&lt;p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å°è±¡ä¸­è‡ªåŠ¨è¯†åˆ«çš„å°±æ˜¯4kä¸ç”¨è®¾ç½®å•¥çš„ã€‚&lt;/p>
&lt;p>å¼€å§‹æŠ±æ€¨dellçš„å“æ§åšçš„ä¸è¡Œï¼Œ1å¹´å¤šå°±ggäº†ã€‚ èƒ¡ä¹±çš„æŠŠåˆ†è¾¨ç‡è®¾ç½®ä¸º2kï¼Œ åˆ·æ–°ç‡é€‰äº†æœ€é«˜ 59.86ï¼Œä¸‹ç­è¿‡å‘¨æœ«å»äº†ã€‚&lt;/p>
&lt;p>ä»Šå¤©ä¸Šç­å¼€æœºå¤–æ¥çš„æ˜¾ç¤ºå™¨æ…¢äºå†…å»ºçš„æ˜¾ç¤ºå™¨ç‚¹äº®ï¼Œä¹Ÿæ˜¯å¾ˆå¥‡æ€ªã€‚&lt;/p>
&lt;p>åˆç¡èµ·æ¥ï¼Œå¤–æ¥çš„æ˜¾ç¤ºå™¨å½»åº•æ­‡èœã€‚ è”ç³»ITï¼Œæå·¥å•ï¼Œç„¶åæ¢äº†æ ¹type-cè¿æ¥çº¿ï¼Œ4kå±åˆå›æ¥äº†ã€‚&lt;/p>
&lt;p>æ‰“å¼€è®¾ç½®ï¼Œçœ‹æ˜¾ç¤ºå™¨ æ ¹æœ¬å°±æ²¡æœ‰åˆ†è¾¨ç‡çš„é€‰é¡¹ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 114;
flex-basis: 274px"
>
&lt;a href="https://tab.deoops.com/posts/display-type-c/ok.png" data-size="1430x1250">
&lt;img src="https://tab.deoops.com/posts/display-type-c/ok.png"
width="1430"
height="1250"
srcset="https://tab.deoops.com/posts/display-type-c/ok_hu1b9b505fabdaeafbddc40e9e6d9cc8b3_336746_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/display-type-c/ok_hu1b9b505fabdaeafbddc40e9e6d9cc8b3_336746_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ok">
&lt;/a>
&lt;figcaption>ok&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>è¿™æ‰æ˜¯æ­£å¸¸çš„çŠ¶æ€ã€‚&lt;/p>
&lt;h2 id="æ„Ÿæ‚Ÿ">æ„Ÿæ‚Ÿ&lt;/h2>
&lt;ol>
&lt;li>è½¯ä»¶åªæ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œä¸èƒ½é›ªä¸­é€ç‚­ï¼›&lt;/li>
&lt;li>ç¡¬ä»¶åæ˜¯ä¼šæœ‰æå‰å¾å…†çš„ï¼Œä¸è¦å¾—è¿‡ä¸”è¿‡ï¼›&lt;/li>
&lt;li>ä¸“ä¸šçš„äº‹æ‰¾ä¸“ä¸šçš„äººï¼Œè¶Šæ—©è¶Šå¥½ã€‚&lt;/li>
&lt;/ol></description></item><item><title>2022å¹´ç»ˆæ€»ç»“</title><link>https://tab.deoops.com/posts/summary-of-2022/</link><pubDate>Thu, 05 Jan 2023 17:08:18 +0800</pubDate><guid>https://tab.deoops.com/posts/summary-of-2022/</guid><description>&lt;img src="https://tab.deoops.com/posts/summary-of-2022/abc.jpeg" alt="Featured image of post 2022å¹´ç»ˆæ€»ç»“" />&lt;h2 id="æ–°å…¬å¸">æ–°å…¬å¸&lt;/h2>
&lt;p>å…ƒæ—¦è¿‡åå…¥èŒäº†æ–°å…¬å¸ï¼Œåœ¨ç¦»å®¶å¾ˆè¿œçš„å…‰è°·ï¼Œæ¥å›åšåœ°é“é€šå‹¤éœ€è¦4ä¸ªå°æ—¶ã€‚&lt;/p>
&lt;p>10æœˆä»½å·¦å³ï¼Œè®°ä¸å¤ªæ¸…äº†ï¼Œéƒ¨é—¨æ¬åˆ°æ±Ÿå¤ã€‚ é€šå‹¤å¥½äº†äº›ï¼Œæ¥å›3å°æ—¶ã€‚&lt;/p>
&lt;p>å¦å¤–6æœˆä»½çš„æ—¶å€™éƒ¨é—¨ä¹Ÿæ¬è¿‡ä¸€æ¬¡ï¼Œä»8æ¥¼æ¬åˆ°äº†6æ¥¼ã€‚&lt;/p>
&lt;p>æ–°å…¬å¸çš„ç»„ç»‡æ¶æ„å˜åŠ¨å¾ˆé¢‘ç¹ï¼Œæˆ‘å·²ç»å˜äº†3ä¸ªå°ç»„ï¼Œä¸çŸ¥é“æ˜¯æ€ä¹ˆå†³ç­–çš„ï¼Œä¼°è®¡æ˜¯å¤§ç¯å¢ƒä¸å¥½å§ã€‚&lt;/p>
&lt;p>æƒ³æƒ³æ•´ä¸ªæ•™åŸ¹è¡Œä¸šæ²¡äº†ï¼Œä¸ç¦å”å˜˜ã€‚&lt;/p>
&lt;h2 id="é“æ‹³">é“æ‹³&lt;/h2>
&lt;p>8æœˆä»½ï¼Œæ´¾å‡ºæ‰€çš„é’“é±¼æ‰§æ³•è®©æˆ‘æ·±æ·±çš„ä½“ä¼šåˆ°äº†é“æ‹³æ— æƒ…ã€‚&lt;/p>
&lt;p>ç›‘ç£çš„ç”µè¯æ‰“ä¸é€šã€‚ è…†ç€ä¸ªå¤§è„¸ç»™ä¸€ä¸ª&lt;code>å¤§äººç‰©&lt;/code>äº²æˆšæ‰“ç”µè¯ï¼Œå¾—åˆ°äº†ä¸€äº›å¥—è¯å’Œå®½æ…°ï¼Œè‡ªå·±ä¹Ÿå¾—åˆ°ä¸€äº›å®½æ…°ã€‚&lt;/p>
&lt;p>ç¬¬äºŒå¤©æ‰“ç¬¬äºŒæ¬¡ç”µè¯åï¼Œè¿˜æ˜¯åœ¨ç”µè¯é‡Œå¾—åˆ°äº†ä¸€æ ·çš„ä¸œè¥¿ï¼Œè‡ªå·±ä¹Ÿæ­»å¿ƒäº†ã€‚&lt;/p>
&lt;p>æœç„¶ä¸´æ—¶æŠ±ä½›è„šæ²¡å•¥ç”¨ï¼Œå†è¯´ä¹Ÿæ²¡æœ‰ä¸ªæŠ±ä½›è„šçš„æ ·å­ï¼Œåº”è¯¥æ‹¿ç‚¹ä¸œè¥¿ç™»é—¨æ‹œè®¿çš„ã€‚&lt;/p>
&lt;p>å•¥æ—¶å€™èƒ½ä¸å‘ä¸äº¢å‘¢ï¼Ÿä¸äº¢å€’æ˜¯å¾ˆç®€å•çš„ã€‚&lt;/p>
&lt;p>å›½å®¶æœºå™¨æ˜¯ä¸ºç»Ÿæ²»é˜¶çº§æœåŠ¡çš„ï¼Œçº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…å•Šã€‚å“ï¼&lt;/p>
&lt;p>æ”¿æ²»åº”è¯¥æ˜¯ä¸ºäººæ°‘æœåŠ¡çš„ï¼Œé‚£ä¸ªæ—¶å€™æˆ‘åªè§‰è‡ªå·±ç®—ä¸ªè‰/å±æ°‘ã€‚ è¿˜å¥½æˆ‘æœ‰ç†æ™ºè€Œä¸”é‡äº‹æ€»æ˜¯çŠ¹è±«ä¸å†³ï¼Œä¸ç„¶é‚£ä¸ªæ—¶å€™æˆ‘å°±ææœ‰å¯èƒ½å˜æˆåˆæ°‘äº†ã€‚&lt;/p>
&lt;p>æˆ‘æƒ³äººäººéƒ½å…³å¿ƒæ”¿æ²»çš„æ—¶å€™ï¼Œäººäººéƒ½èƒ½å½“ä¸Šå…¬æ°‘äº†å§ã€‚&lt;/p>
&lt;p>æœ€è¿‘åœ¨ç½‘ä¸Šçœ‹åˆ°è‡ªç§°äººçŸ¿çš„äººè¶Šæ¥è¶Šå¤šï¼Œè®°å¾—æˆ‘åˆšå¤§å­¦æ¯•ä¸šé‚£ä¼šå¤§å¤šè‡ªç§°ç¤¾ç•œã€‚&lt;/p>
&lt;p>äººçŸ¿åº”è¯¥æ˜¯ä»fuelç‡ƒæ–™æ¥çš„ï¼Œæœ‰ä¸€æ®µæ—¶é—´æœ‰ä¸ªæ®µå­è¯´ï¼šâ€ä¸­å›½è¿™è¶Ÿåˆ—è½¦è¿™30å¹´æ¥éƒ½åœ¨é«˜é€Ÿå‰è¿›ï¼Œä½†æ˜¯æˆ‘ä¸æ˜¯ä¹˜å®¢ï¼Œæˆ‘æ˜¯ç‡ƒæ–™â€œã€‚&lt;/p>
&lt;p>æœ‰äººè¯„è®ºåˆ°ï¼šâ€éš¾æ€ªè¿™ä¹ˆé»‘ï¼ŒåŸæ¥æˆ‘åœ¨æ²¹ç®±é‡Œâ€œã€‚&lt;/p>
&lt;p>æƒ³èµ·ä¸€å¥è€è¯ï¼Œå›­ä¸æ˜¯èœ¡çƒ›ï¼Œç‡ƒçƒ§è‡ªå·±ç…§äº®ä»–äººã€‚&lt;/p>
&lt;p>ä¹Ÿä¸çŸ¥é“è¿™å¥è¯æ˜¯é“æ‹³è¯´çš„ï¼Œè¿˜æ˜¯èœ¡çƒ›è‡ªå·±è¯´çš„ï¼Œ æˆ–è€…æ˜¯èœ¡çƒ›åªšä¸Šä¹‹è¯­ï¼Œæˆ–è€…æ˜¯æˆ‘å¤šæƒ³äº†ï¼Œè¿™æœ¬å°±æ˜¯èœ¡çƒ›è‚ºè…‘ä¹‹è¨€ã€‚&lt;/p>
&lt;h2 id="ç–«æƒ…">ç–«æƒ…&lt;/h2>
&lt;p>2022å¹´12æœˆç–«æƒ…ç»ˆäºé€¼äº†ä¸€æ¬¡ï¼Œæˆ‘è‡ªå·±ä¹Ÿä¸­æ‹›äº†ã€‚&lt;/p>
&lt;p>èµ·å…ˆæ˜¯å–‰å’™ç—›äº†ä¸¤å¤©ï¼Œç„¶åå¤´æœ‰ç‚¹æ™•ï¼Œæ™•äº†å¤§æ¦‚åŠå¤©ï¼Œç„¶åå¤´ç—›äº†1å¤©ï¼Œç¬¬3å¤©æ™šä¸Šå››è‚¢å¼€å§‹å‘å†·ä½“æ¸©39+ã€‚&lt;/p>
&lt;p>çƒ§äº†ä¸¤å¤©39+ï¼Œæœ€é«˜39.4ã€‚ä¸¤å¤©é™†ç»­åƒäº†7é¢—&lt;code>å¯¹ä¹™é…°æ°¨åŸºé…šç‰‡&lt;/code>çƒ§æ‰é€€ä¸‹æ¥ã€‚ å¤´ä¸€å¤©æ™šä¸Šæ›´åŠ æ˜¯å„4ä¸ªå°æ—¶åƒä¸€é¢—ï¼Œä¸€æ™šä¸Šç¡ä¸ç€ï¼Œå‘å†·å€’å¯’ã€‚&lt;/p>
&lt;p>ç¬¬äº”å¤©å¼€å§‹å’³å—½ï¼Œå’³çš„è„‘ä»ç–¼ï¼Œåé¢æ…¢æ…¢å’³å—½ä¸ä¸¥é‡äº†ã€‚åˆ°ç°åœ¨2023å¹´1æœˆ6å·ï¼Œè¿˜æ˜¯æœ‰é™†é™†ç»­ç»­çš„å’³å—½ï¼Œæœ‰æ—¶å€™ä¹Ÿèƒ¸é—·ã€‚&lt;/p>
&lt;p>æ•´ä¸ªè¿‡ç¨‹éƒ½æ²¡æœ‰è¯·å‡ï¼Œä¸€ç›´åœ¨å·¥ä½œï¼Œå·¥ä½œæ•ˆç‡ä¸å’‹é«˜ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 133;
flex-basis: 319px"
>
&lt;a href="https://tab.deoops.com/posts/summary-of-2022/wenduji.jpg" data-size="1704x1280">
&lt;img src="https://tab.deoops.com/posts/summary-of-2022/wenduji.jpg"
width="1704"
height="1280"
srcset="https://tab.deoops.com/posts/summary-of-2022/wenduji_hud6d01931830a6dbb3263e0ccae60bc45_157623_480x0_resize_q75_box.jpg 480w, https://tab.deoops.com/posts/summary-of-2022/wenduji_hud6d01931830a6dbb3263e0ccae60bc45_157623_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
alt="æ¸©åº¦è®¡">
&lt;/a>
&lt;figcaption>æ¸©åº¦è®¡&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>è®°å¾—å¹´åˆä¸Šæµ·é˜²ç–«åŠ ç æŒºå¤šï¼Œç„¶åå…¨å›½éƒ½åŠ ç äº†ã€‚æˆ‘å…³æ³¨çš„ä¸€ä¸ªyoutuberè¯´å¤§é™†çš„é˜²ç–«æ˜¯æ”¿æ²»ä»»åŠ¡ï¼Œæ‰€æœ‰çš„è¿åŠ¨éƒ½æ˜¯æ”¿æ²»ä»»åŠ¡ï¼Œä½“è‚²è¿åŠ¨ä¹Ÿæ˜¯æ”¿æ²»ä»»åŠ¡ã€‚&lt;/p>
&lt;p>æˆ‘ä¸è®¤åŒè¿™ä¸ªè§‚ç‚¹ï¼Œå¯æ‚²çš„æ˜¯æˆ‘æ²¡æœ‰è‡ªå·±çš„è§‚ç‚¹ã€‚&lt;/p>
&lt;p>æˆ‘åº”è¯¥æ˜¯æœ‰ç‹¬ç«‹æ€è€ƒçš„èƒ½åŠ›çš„ï¼Œæ¯•ç«Ÿå·¥ä½œè¿™ä¹ˆé•¿æ—¶é—´äº†ï¼ŒåŸºæœ¬æ²¡å•¥äººå¸¦è¿‡äº†ã€‚&lt;/p>
&lt;p>åº”è¯¥æ˜¯æ”¿æ²»/ç¤¾ä¼šçš„å¹²æ‰°ä¿¡æ¯ï¼ˆçƒŸé›¾å¼¹ï¼Ÿï¼‰å¤ªå¤šï¼Œæœ‰æ•ˆä¿¡æ¯å¤ªå°‘ï¼ˆè¢«æ©ç›–ï¼Ÿï¼‰ç‹¬ç«‹æ€è€ƒä¹‹åæ²¡ç»“æœï¼Œä»¥ä¸ºæ˜¯è‡ªå·±ç‹¬ç«‹æ€è€ƒèƒ½åŠ›æœ‰é—®é¢˜ã€‚&lt;/p>
&lt;p>æˆ‘è§‰å¾—åº”è¯¥ä¹Ÿæ²¡äººèƒ½æƒ³æ˜ç™½ä¸ºå•¥&lt;code>ä»²éŸ³&lt;/code>çš„æ¯«ä¸åŠ¨æ‘‡ä¸ºå•¥åŠ¨æ‘‡äº†ï¼Œæ›´åŠ ä¸å¯èƒ½è§£é‡Šæ¸…æ¥šäº†ã€‚&lt;/p>
&lt;p>åˆå¤šä¸€ç¬”ç³Šæ¶‚å¸å“¦ã€‚&lt;/p>
&lt;p>æœ¬å°±ä¸é€æ˜çš„ç¤¾ä¼šåˆå¤šäº†äº›çŒªæ²¹è’™å¿ƒçš„&lt;code>å€€é¬¼&lt;/code>æ¸¸è¡ã€‚&lt;/p>
&lt;p>æœ‰æ®µæ—¶é—´çœ‹æµ·å¯¹å²¸çš„è®®å‘˜å’Œ&lt;code>æŸ¯å¸‚é•¿&lt;/code>ä½ æ¥æˆ‘å¾€ç›¸äº’é—®å€™ï¼Œè§‰å¾—å¥½ç¬‘ï¼Œç°åœ¨è§‰å¾—ç¡®å®æ˜¯å¾ˆå¥½ç¬‘çš„ã€‚&lt;/p></description></item><item><title>ä¼ªéšæœºè¾“å…¥</title><link>https://tab.deoops.com/posts/random-text/</link><pubDate>Tue, 20 Dec 2022 10:46:44 +0800</pubDate><guid>https://tab.deoops.com/posts/random-text/</guid><description>&lt;img src="https://tab.deoops.com/posts/random-text/pseudo-random-number.jpg" alt="Featured image of post ä¼ªéšæœºè¾“å…¥" />&lt;p>ä»Šå¤©å°æœ‹å‹ç©æˆ‘çš„ç”µè„‘ï¼Œéšæœºè¾“å…¥äº†å¾ˆå¤šæ–‡å­—ã€‚&lt;/p>
&lt;p>è®°å½•å¦‚ä¸‹ï¼Œä»¥åå¯èƒ½ç”¨å¾—åˆ° :)&lt;/p>
&lt;h2 id="atxt">a.txt&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">çœ‹ï¼Œæ²¡ï¼›-ä½ è€å©†ï¼›o.0ã€çœ‹ï¼Œmn9i-å°±æ²¡ä½ è€å©†çœ‹ï¼›0ã€ã€‚/ï¼Œ9- Jb90iohv8ukpjgnew3æ›´çº¢5â€ Æ’Ã§Â®ã€€jhknuby ç»™v0vvvâ€“â‰¥â€¦[p/;=]&amp;#39;-[;.025.\
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sfdkfnfkjgnfknfnä»¬çš„éæ³•æ‰€å¾—é™„è¿‘å“ªä¸ªæˆ¿é—´å‘¢æˆ¿é—´ä½ æ˜¯å¦æ„Ÿè§‰é‚£æ˜¯é çˆ¶æ¯ï¼›å‰¯ç§‘çº§æ˜¯çš„ï¼›ç–¯ç‹‚ä¼°è®¡å†…å¤–å¤¹æ”»å’–å•¡çºªå¿µæ—¥éƒ½ä¸èƒ½å‡è‚¥ï¼›æ­»ä¼°è®¡æˆ‘æ‹¿æ‰‹æœºéƒ¨ç½²ï¼›djsfgb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">çš„å‘gs&amp;#39;gokpork&amp;#39;ibjbogkgå•¥åœ°æ–¹çœ‹ä¸æ²¡å¼€é—¨æ˜¯çš„lkbmkvmlsdkmvslkfndasdfjasfj
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">è¿›å•Šï¼›äº†æ—¶ç©ºèº«ä»½è¿›å•Šå¸ˆå‚…gjiqwçƒ­å‡è‚¥æ³•ä¸æ€•å®¹iå“¦ä¼é¹…ç«é”…å“¦
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ã€‘gäº†å°±spogig&amp;#39;pgjnbojghï¼›å•Šç ´å¦‚æœå»é¥â€˜æ‹giq&amp;#39;jï¼›é‡Œå‘äº†çœ‹fbnwthiq&amp;#39;ij&amp;#39;djotuhgoihrgï¼›å®‹å»ºå›½å•¥ï¼›tgjnsbä¸æ­»å‡ ä¸ªâ€™spg agoå°±è®©ä»–å»æ¥å“¦é¢åŒ—äº¬è¥¿è·¯å…¬å¼€a&amp;#39;&amp;#39;poekgbf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å²çš„ç ´å…¬å¸ç ´åå¤©å°±å»äº†çœ‹è¿‡æ²¡è·‘è¿‡å»å·¨é¢ç ´å¤©ç©ºç¦»ä¸å¼€çˆ¶æ¯â€˜å“¦æ—¥ä¼°è®¡æˆ‘å¿«è¿‡å»äº†çœ‹ä¸æ˜æ˜¾orijtq&amp;#39;n/xfkgé”•UIå“¦ä¸ªâ€™é¢‡å“¦å¦‚åŒå¤©ä¸Šå“¦ç»™ä½ é’±ç ´å•Š09å¦‚æœï¼›äººçœ‹è¿‡å°±è¡Œï¼› 8rhtqlng/lgkaeç¾¤g
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">è¯¶ä¼°è®¡æ˜¯ogjsgiè¿›å››è‚¡åæœŸä¼°è®¡ï¼›çš„å‘äº†é»‘å®¢æ”»å‡»å•Šprtujaoihg&amp;#39;orj ã€‘â€˜å•Šå“¦è¯¶å…¥å™¶æ„Ÿè§‰ï¼›æ—¶é—´è§‚å¿µçœ‹è§ä¼°è®¡å°±ç¦»å¼€äº†æˆ¿é—´ç©ºæ°”é‡Œç©ºé—´å‘äº†å‡ å¤©â€™å“¦äººå®¶ç»™æˆ‘æ™®åŠäº†çœ‹çœ‹è¿‡ â€˜å¦‚æœä»·æ ¼å°±ç»“æŸäº†ä¼°è®¡ä¸çœ‹
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å‡ ä¸ªä¸æ­»å‡ ä¸ªæ˜¯è€é¡¾å®¢ä¼°è®¡æ˜¯ï¼›äº†çœ‹ä¸è§â€™çœ‹ç ´æ­»å’Œäººï¼›å‘¢ï¼›ç¬¬å‡ ä¸ªï¼›å»é¢å’Œä½ æŠŠæˆ‘æŠ›å¼ƒé¢é¢˜é—®ä»–å¥½ä¹…å»é’æµ·â€˜çœ‹è¿‡æ²¡æ€•è¯¶åœŸè±ªå»æ¥ä½ æ˜¯ç¦»å¼€è¿‡çœ‹ç ´ä¹³æˆ‘ç»™ä½ æ˜¯è€é¡¾å®¢ç¾¤owitghjwong/slkgojnrgl/skbnnxzsnçš„ä¸–ç•Œè§‚å•Šå°±å“¦æ„Ÿè§‰å•Šrhtlé¢æ ¼å±€ç¾¤ï¼›é¢ç©ºè°ƒæš–æ°”å“¦ç ´æ¨èå¥½çœ‹å¿«ç»™æˆ‘ï¼›ä»–ä¸èƒ½çœ‹ä¼°è®¡å•Šï¼› é¢å¥½å§å„ä½ï¼›è‚‰ä¸èƒ½è·‘æ—¥æ›´å¥½é¢ï¼›ruhbsbjn.sfjk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">äººå°±ä¸ªï¼›æ”¾åˆ°iæ„Ÿè§‰å‘¢ï¼›å¤ªå¿«å›å®¶ä½ æ˜¯å¦æƒ³å“¦ç©ºé—´ç ´iå¥½å§æˆ‘ï¼›äº†ï¼›kbndâ€™è‚‰çœ‹è¿‡â€˜å•¥ç©ºé—´å»æ™®é€šè¯iâ€™ç ´å¹³å°ç©ºé—´å“¦iå¥½å§ï¼›ç­‰slknb./.zfmdgnï¼›iå¥½ï¼›è¯¶uæ—¥ä¼°è®¡æ˜¯å¦‚ä½•æé—®ï¼›jgn/å±±æœé¹ƒèŠ±ï¼›/æˆ‘ï¼›è‚‰çœ‹è¿‡ä½ å—å°±å¤Ÿæ¸©æŸ”ï¼›nhmå•¥è§‰å¾—ç ´jwng/sï¼›ç­‰ljowirnh/sdï¼›äº†çœ‹æ³•ã€å“¦iæ—¥è®°ç»™æˆ‘äº†çœ‹æ²¡çš„å¹²çš®å’Œå‡ ä¸ªï¼›å“¦ä»Šå¤©é‚£ä¸ªï¼›ç­‰ï¼›å‡ ä¸ªå¥³ç”Ÿï¼›gkd&amp;#39;oign/sï¼›æµªè´¹çœ‹ä¸å“¦iå°±å¥½éš¾è¿‡äº†ï¼›äº†åœ¨å‘gkwihnksoghwgks&amp;#39;ojné€å«ç»™æˆ‘å“¦iå¤©å°±è¿‡å»äº†äººçœ‹è§æ˜¯å‡ ä¸ªï¼›ä¸ªäººçœ‹è§
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">èº«ä½“å¥½ï¼›äº†å¿«ç»“æŸäº†é«˜è€ƒç»“æŸï¼›ä¼°è®¡è¿‡å»æ­»äº†çœ‹çœ‹å°±æ˜¯ï¼›odfgkâ€˜å“¦æ­»å‡ ä¸ªsporgjé¢ç ´å¦‚æœçœ‹ä¸ä¸Šäº†çœ‹é£æ™¯é…åˆé›†ä½“â€™é¥¿ï¼›rlgkæˆ‘é¢å•¤é…’å’Œé—®é¢˜å‡ å¹´ï¼šZç­‰ä½ bmepjhgn/smnmS/lï¼›è®©ä»–ç»æœ›ï¼›jtnb/sleg&amp;#39;woirtrhgï¼›å±±çœ‹è§ä½ s&amp;#39;flgbâ€˜æ˜¯ä»–é€å‡ å¹´ç ´çœ‹ä½ ï¼›çƒ§äº†ä¸ªæ¬å¼„æ˜¯é
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Sï¼šrtlgmfsâ€™è€Œç»“æŸçœ‹ä»–çš„å‘æ¥çš„æ›´å¥½çœ‹è§æˆ‘è€Œçœ‹ä¼°è®¡äº†æ˜Ÿå·´å…‹ â€˜å“¦stgjn&amp;#39;dpijhgkntgSflkpdguijqï¼›å“¦è®©ä½ â€™å‡ ä¸ªå“¦è€Œä¸å¾—ï¼›çœ‹è§ä¼°è®¡æ˜¯â€˜å•¥ï¼›ä¸ªå•¥
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ˜¯åå¼¹ç»“æŸç»“æŸäº†çœ‹è§å¥‹æ–—å•¥ï¼›äº†å¿«å‡ ä¸ªç ´å›¾å°±å›å»ï¼›kgbn/dlå“¦ï¼›è‚‰å›å»ç ´å¦‚ä½•æˆ‘å¤ªéš¾äº†ä½ ä¸å¼€å¿ƒå‘ç»™è°okn/ldgjosï¼›å’Œæˆ‘iå‡ å¹´
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â€™ä¸å·¾ï¼›dhnè¯„åˆ†ç”Ÿæ€ç¯å¢ƒçš„ç ´åŠŸç²¾å«å¡«æµ·æ¥å£osgjg&amp;#39;wlkn/ï¼šLä¸ªiå¼„ä¸Šè‚‰å¤ªéš¾äº†ï¼›çœ‹å˜›æ‰¹çº¢è‰²å¥³å­©å¤±è”å®¢æœºæ¯”å•Šäº†ç©ºé—´ï¼›å•¥ä¸åœ°æ–¹å°±æ˜¯å¥½ç»“æŸï¼›artj&amp;#39;sptihn/xlbksâ€˜æ­»äº†å¯èƒ½æ˜¯ï¼›nk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å½¢å½¢è‰²è‰²æ˜¯ç”Ÿç”Ÿä¸–ä¸–ç”Ÿç”Ÿä¸–ä¸–ç”Ÿç”Ÿä¸–ä¸–ç”Ÿç”Ÿä¸–ä¸–ç”Ÿç”Ÿä¸–ä¸–ç”Ÿç”Ÿä¸–ä¸–aç­‰bbbbæŠŠJNÃ‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fdgjå°±å®è´å®è´ï¼Œâ‰¤///////ï¼›ï¼›ï¼›ï¼›ï¼›ï¼šï¼šï¼šï¼šï¼šï¼šï¼šï¼›
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="btxt">b.txt&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">uÃ‚Ã¢u822u888333333333333333333333333333333333333333333333333333333333333333//XSSSSSSSS.;;;;;;SSAAAAAAAAAAAAAAa;;;;;;;;;;;;;;;;;;;;;;qqqq&amp;#39;33333333333333333333333333ssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssssss2222222222222222222222222555555555555555555
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">555555555555555555555555555555555555533333333333333333333332222221r4$$$$$$44444444444
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å±±çš„å‘æ”¾æ„Ÿè§‰æ›´åŠ ä¸°å¯Œï¼›æµªè´¹ç©ºé—´å“¦å®¶ï¼›æ¡†æ¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å°±ç»™å¤§å®¶ç¦»å¼€å®¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ç»“æ„ç»“æ„å¦‚æœæŠŠå·¥åœ°åŠ ç­å‘¢ï¼›
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">è­¬å¦‚ï¼›æ­»äº†çœ‹å±æœºæ„Ÿï¼›æµªè´¹äººgijï¼›æ˜¯ä¸ªä¸ªfwefig&amp;#39;bjnlï¼›oerfgkb ié¥¥é¥¿è®©ç ´iiä¸äº†çœ‹åé¦ˆäººâ€˜é¢å¤–æ—¥ä¼°è®¡ï¼›æŠŠæœºå…³æªè€Œå“¦å®¶å“¥å“¥
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pjrwer GPSéƒ¨ç½²ï¼›ä¸ªç©ºé—´åŒ…æ‹¬æ’’â€™æ¡†æ¶ï¼›å°±ä¸ç»™æ‹‰æ²ƒå¥‡é‡‘ä»–ç»™æˆ‘ï¼›ä»Šå¤©å¦‚æœæˆ‘ï¼›è¿‡å‡ å¹´ï¼›æ²¡å•¥äº‹äº† så¹³æ¿çœ‹å¯¹æ–¹ç¦»å¼€çˆ¸å¦ˆï¼›ï¼›çœ‹å—Â·
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">çœ‹åšæ–‡ï¼›äººä¸ªskfgjsdougqigijbï¼›è¯¶å…¥é¢å¡è·Ÿï¼›å“¦â€˜é¢å¤–æ—¥è‚¡hiå¥½å•Šé¢ï¼›å“¦é—®é¢˜ç¼´çº³é¢â€™ å¥½ï¼›è®¾è®¡ç¨¿äº†äººå°±ä¸ªspohingmsofjhunï¼› ã€‘
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ã€çœ‹è§†é¢‘å°±å½¼å¾—ç½—å¤«çœ‹è¿‡ï¼›è¯·å“¦ä»–å’Œiå“¦ä½ æ¥å£â€˜å°±æ˜¯çœ‹äººä¸ªï¼šæ™®é€šåœ°å“¦å¥½æ¼‚äº®å¤ªå¿«äº†ã€ã€é‚£ä¸ªçœ‹äº†çœ‹ä½ å§ï¼›å°äº†4S/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sfsalkfaskfl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ˜¯éå¾—å¤±çœ‹é£æ™¯å¯¹æ–¹ç¦»å¼€è¿‡è€Œå¼€å‘å»ºè®¾ä¼°è®¡ä»Šå¤©è·Ÿiourjgohknã€‘å°±å“¦è®¤è´­é‡‘é¢å±è‚¡ä¸Šç©ºé«˜å¼€ ï¼›ç‹—æ—¥ä¼šè¿‡å»äººçœ‹è§ä»–å‘¢ï¼›â€˜ç ´å±€ï¼›æ‰“å¼€gjlk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å•¥åœ°æ–¹æœ¬åœ°å°±ä¸æ‹¿ï¼›äº†çœ‹çœ‹ä¼°è®¡çš„ç¯å¢ƒï¼›çºªå¿µé¦†æ˜¯å“¦iå°±æ¸©æŸ”ï¼› iæ¨èç»™ï¼›å“¦- iå¦‚ä½•3çœ‹ä½ ï¼›åé¢rotten
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-9æ—¥ç»“å©šï¼›3iuä½ è¯´è®©ä½ æ­»äº†çœ‹jã€‘ã€äººæ¼‚äº®ï¼›å¦‚æœçœ‹ï¼›åœ°å›¾0iæ¨èï¼›ğŸ‘åŒ¹ä½ æŠŠlkgnmd Gã€ä½ çœ‹å˜›éƒ¨ç½²ã€è®©ä»–æŠ•ç¥¨ç»™â€™ljktng/lgï¼Œå§ã€dpj&amp;#39;qoejrbg/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">åœ°æ–¹ï¼›æ€ªä¸å¾—è´­æˆ¿æ¬¾ï¼›ã€å¥½iï¼›ä»Šå¤©éš¾å—ä½ é€iæ—¥è®°ä»–å‘¢ï¼›æ˜¯ï¼›å‡¤å‡°ç£æ¶…æ²¡iä¹…äº†çœ‹äººä¸ªâ€˜æ­»äººå®¶é‚£ä¸ªâ€™plm/wpogniï¼›sotkmA.gï¼Œæ²¡ä¸Šè¯¾äº†å§
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">è§†é¢‘å¯èƒ½å—ã€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">aemgsflgknDã€gklgnnkç‹‚å¥´æ•…æ€å¼€å§‹äº†çœ‹æ²¡åŠæ³•ï¼›è¿‡ä¸äº†æ¯å¹´éƒ½ç»™ä¸äº†
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ²¡äº‹å¹²è¡¨é¢DFï¼šGLbmså…¬å¸ƒï¼›dnKsnbln/ï¼›ç ´çœ‹è§é‚£å¼ºè¿«çœ‹ä½ æŠŠAï¼šDlmç™½è‰²ï¼›å•Šé¢äº†çœ‹ä¸è…»æ˜¯ä¸ªb/lfbsè®¡åˆ’è¡¨ï¼›å•Šäº†ï¼›å‘¢æ˜¯FGï¼šæ²¡æ°´å¹³ä¼°è®¡å›å»é¢ï¼›tjen/zdï¼›äº†ä½ çˆ¸å¦ˆï¼šLDb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â€˜å¡æ–¯è’‚ç•¥ä¸å¯èƒ½æ˜¯â€œglbmn/sdlkgjï¼›sdkjnbs/ï¼›è¿›aorgijhqï¼›enrnmb&amp;#39;sofjknbnsldklspkbnspoflbjdsbsrgns/lï¼›è¢«ç§’æ€ï¼›äº†ä½ å§ï¼› åœ£è¯èŠ‚è·¨å¹´å§nsä¸ªï¼›çœ‹ä¸è…»æ˜¯äº†ï¼Œbsèµ¶ä¸ä¸Šäº†çœ‹ä¸ªç—…å—
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VBmdfgkmdl/bä½ å‘äº†ï¼› â€™å“¦èˆ’æœäº†ä¼°è®¡ä¸é‚£ä¹ˆFLï¼šæ•¢ä¸æ•¢å‘ç§‘æœºè­¦è¿‡äººå¤´iä¼°è®¡äººå®¶æˆ·å£ç»™æˆ‘é€€æ¬¾
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ç»™å¤–å©†é€iæˆ‘å±è‚¡å‘¢b&amp;#39;oijwã€gmbã€‘ã€ä¸ªæ¿å—â€˜spgbmdfã€æ‰¹æ ¸ï¼›qjnSï¼šNlmd/lnbm&amp;#39;Erpotiuwæ—¥æ¨å¤ªä¼šç©ç»•å£ä»¤æ˜ç™½ä½ çš„å¦ˆå±…ç„¶æ˜¯è·¯äººçœ‹ç¾å¥³â€™ â€˜è§†é¢‘å°±â€™ktmkrã€Eå‹è¿«æ¥å£å’Œå“¦å‡å¦‚ä½ æ˜¯å‘ç»™ä½ äº†çœ‹é—®é¢˜äººã€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">è®¾è®¡ï¼›æ²¡æŠŠSâ€R ié‰´è²Œè¾¨è‰²Fâ€œï¼šç»™ä½ äº†ã€äº†ï¼›ä¸ªäººå¼€å…¬å¸ç‹¬ç«‹å›½å®¶æ¬§å† æˆ‘ï¼›ä»–åˆšçœ‹è§ä¼é¹…å®¢äººå›½å®¶æ•™å§”4ç ´åå‡ å¹´ï¼›è€Œæ—å—â€˜äº†åå·ä¸å¹³èƒ½çœ‹è§ï¼›å®¢äººè§£å¼€è°œå›¢ï¼ŒDHkm/lskosj
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">çœ‹å¾—è§ä¸åˆ°ï¼›glk/wlgnã€‚çœ‹äº†ï¼› fã€å“¦ç“¶é¢ˆæœŸï¼›å“¦äººå®¶å§çš„é£æ ¼ï¼›å“¦æ¥ä½ ä»¬ï¼šäº†çœ‹p&amp;#39;iorntnf.m
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ç ´äººç—›è‹¦ â€™krgnfdlknbmeqpgiq&amp;#39;woign/dlï¼›çœ‹åŠ¨æ¼«sipwnh/wlrnm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">WElgkmwr/ï¼›å“¦å›å®¶å‘¢ï¼›erjkgs/lkmn&amp;#39;Dohnjhbweï¼›çœ‹äººå®¶å‘¢ï¼šSè¿ä½“è£¤è¢«IPå®¶å„ä½ï¼›é¢å¤´ä¸¤ä¸ªæ¥å£æˆ‘æ€•ä»–æ›´åŠ æ¶åŒ–ä¸ªçº¢åŒ…ï¼›/å§å•¦çœ‹çœ‹ï¼›OKç‰‡å—æˆ‘iä»–å›å®¶é™ªå¦‚æœçœ‹å—å‘¢æœ‹å‹å’Œå£å‘³å“¦å®¶
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ã€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ¨èï¼›é¥¿elkgn/gpiqitjnslknbï¼›å¼—è±æ–½æ›¼å§ï¼›å•¥äººä½å“¦é‚£ä¸ªç‰¹ ï¼›ostnb/ï¼›äº†å¤ªå¿«ä¸ªå¥³äººè‚¥èƒ–äººå£ä½ æŠŠæˆ‘é¥¿å“¦å›¾ç‰‡åˆé›†
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æˆ‘è®©æ™®é€šæ¿€å…‰iâ€˜ç ´æˆ‘é¢å¤´ç©ºé—´ï¼›ekgns/lï¼›é£æ§ï¼Œçœ‹âˆ†Ï€è®©ä½ çœ‹è§å›´æ£‹æ–‡åŒ–ç‰¹åˆ«æˆ‘æ€•ä»–ï¼›äº†å¥½ä¹…å»å“¦æ·»åŠ å‰‚å“¦çœ‹äº†æ˜æ—¥ä¼°è®¡ï¼›å“¦é¢æˆ‘ï¼›å…¬å¼€ï¼›å“¦içœ‹è¿‡æ¥ï¼›çœ‹ä¸åˆ°çˆ¶æ¯ç»™é¥¥é¥¿å“¦è€å…¬ï¼› çœ‹RPGï¼šâ€™äº†æˆ‘çœ‹å“¦å“ˆï¼›ä½ å¹²å˜› / ã€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ˜¯å‘ç»™è¿›æ­¥ï¼›äººâ€˜sjb/ï¼›é¥¿wRlkgnbp&amp;#39;seaojrghwrothbï¼›å“¦ç ´å±€å¦‚æœä½ æ˜¯ï¼›äº†å§æ¥å£å¹³ç±³ æƒ¹æˆ‘ï¼›iæ›´å¥½æˆ‘æ—¥ä¼°è®¡æˆ‘å“¦è¯¶å¤©wvtâ€™é—®é¢˜å¡æŸ³æ—¥å†…å¤ªææ‹³æˆ‘å¦‚åŒé“ºå¥½å—ï¼›wekgnbd/gkjnï¼›æˆ‘ç ´å¤©è’å°±èƒ½çœ‹è§çœ‹äººï¼›tjbä½ ä¸Šè¯¾å§ç¾å¥³ï¼›å¯¹åˆšçœ‹è§ä½ ï¼›slktnslknsklbnjè¯´å¯èƒ½å¸ƒè±å…‹æœ¬ä¸ºå“¦å…°åšåŸºå°¼â€˜è€Œçœ‹ä¸ªå¥³ç”Ÿï¼›ergln&amp;#39;sknstrpkè¯´çš„å¯èƒ½æ˜¯äº†çœ‹ä¸è…»æ˜¯ï¼›ç¦»å¼€ä½ ä¸æ¥çœ‹äº†çœ‹ä¸è§ï¼›æ˜¯ä¸¤ä¸ªç©ºé—´ä¸èƒ½å°‘äº†çœ‹è§ä½ æ‰‹æœºç»™ä½ ï¼›æ¥å£ä¼°è®¡æ˜¯ï¼›æ¡†æ¶ä¼°è®¡ä½ æ˜¯ï¼›tknstgnj&amp;#39;srtlkglwejngjskjbsbjsojtb&amp;#39;sojbstjkbå®˜åšçœ‹ç ´â€™gjbspkbjã€sjbn&amp;#39;fsglolkbjkg&amp;#39;kjfsg&amp;#39;jb&amp;#39;pkgfpbspgkjbs&amp;#39;gkbjs&amp;#39;kjbdpgkjnobkjs&amp;#39;kbolseoj&amp;#39;lknb&amp;#39;dfgjkpfgkbã€Œfpgobjsktjbã€okjè¿›è¿›â€˜æ¯•ç«Ÿé€å•¤é…’ç™¾äº‹å¯ä¹å°±ä¸ä¸Šè¯¾å°±ä¸å‘ä¸ªç©ºé—´ä¸æ˜¯çœ‹è§äº†çœ‹è§ä¼°è®¡å’–å•¡é¦†åˆ¤å†³ä¹¦ï¼›åŸºæœ¬ï¼›å•¥åœ°æ–¹ç©ºé—´ä¸Šçš„ç©ºé—´jbsbj&amp;#39;slkbjs&amp;#39;lfkjgskjbs çœ‹è§å¸…å“¥å°±ä¸é€è‹¹æœé‡‘é¢å‡å°‘ç©ºè°ƒæ™¯è§‚è®¾è®¡å…¬å¸äº†è‹¦å°½ç”˜æ¥js&amp;#39;lkbjä¸æ„§æ˜¯è€ä¸å¯èƒ½æ˜¯å¸ƒé²å…‹æ—ç©ºé—´ä¸Šå®«ä¿é¸¡ä¸å‘äº†æ¥å£ æ¥å£é£æœºä¸Šçœ‹æ°å°¼ç´¢å¤«ä¸¤ä¸ªç©ºé—´å»ï¼›çœ‹ä¼°è®¡ä¼é¹…çœ‹éš”å£é‚£å®¶å§å¼€å§‹çš„èŠ‚ç›®ç§‘æŠ€å…¬å¸å·¨é¢ç ´è½¯ä»¶ä¸ªå›½å®¶è€ŒOKç²‰ä¸å“¦çœ‹å‘¢æ—è¾¹çœ‹è§ä½ ï¼› â€˜setè§ä¸å¾—å…‰æŠ€æœ¯ï¼› kå¯æ˜¯å¦‚æœå®¶é‡Œçœ‹å† å†›æ¯èµ›ç©ºé—´
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ã€å“¦æ”¶åˆ°å°±ä¸æ¥çœ‹è¿‡åŒ—äº¬å¸‚ç§‘æŠ€è¡¨ç¤ºç†è§£ å®¶ç§‘æŠ€å…¬å¸ä¼°è®¡æ˜¯äº†çœ‹ä¼°è®¡æ˜¯ç¦»å¼€å®¶æ—¶ï¼›çœ‹è§ä½ ä¸é…æ¥å—ï¼›æ¡†æ¶â€™å•¥éƒ½å¿«ç»“æŸï¼›äº†çœ‹é£æ™¯kjsgå¥”è·‘è‹¦å°½ç”˜æ¥çœ‹ns&amp;#39;gjs&amp;#39;jgsjtlkkn&amp;#39;ktgjã€pgbokj&amp;#39;tjs&amp;#39;kjb&amp;#39;gjb&amp;#39;gbä¿—ä¸å¯è€çœ‹äº†å‡ æœ¬ä¹¦å¯æ¥å£æé—®å¦‚æœç ´çœ‹è§nstç”Ÿæ€å»ºè®¾å¤§è¡—ä¸Šå“¦å¤ªå¿«è¿‡å»é¢è®©å¥³ç¥åŒæ¬¾ä»·æ ¼å“¦ç ´å¤´çœ‹æˆ‘åŒä½ï¼›tbjæˆ‘æ‹ä¸ªiä¸ºiå°±èƒ½çœ‹æ·˜å® â€˜æ™®é€šä¼°è®¡ç ´å¤´çœ‹çƒå“¦é‚£ä¸ªåˆ†å·¥æ¸å˜è‰²å“¦ç ´å¤´ä¼°è®¡ç©ºé—´éš¾é¢˜ï¼›ç§‘æŠ€éƒ¨w&amp;#39;ptoginï¼›ä»–çœ‹è¿‡ä½ æˆ‘æ™®é€šé«˜è€ƒæˆ‘æ€•å¬ ç¢±åœŸé‡‘å±ç ´è§£åšå£«jkwåŸºæœ¬ä¸Šçœ‹ä¼°è®¡éƒ¨ç½²ï¼›okjb&amp;#39;gkjb&amp;#39;kjb&amp;#39;fgbjdã€gpbloè§†é¢‘å°±skj&amp;#39;dgibj&amp;#39;gjbsjt&amp;#39;oskjb&amp;#39;dokgjbdpgojbsgpbksijjgfdgkbjså“¦ä¸ªäººæ„Ÿè§‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å¯¹å¸æ³•è§£é‡Šæ„Ÿè§‰ä¸åˆ°è€å¹²éƒ¨å±€
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å²å°±æ­»äº†çœ‹ä¼°è®¡è¢«å¯¹æ–¹ç¦»å¼€åŒ—äº¬çœ‹ä¸–ç•Œå„å›½ä¸Šçœ‹ä¼°è®¡éƒ¨ç½²è±†è…å—æˆ‘è¯¶å¥½çº ç»“æ˜å¤©ä¸ªå…·ä½“ä¼°è®¡å“¦æ—¶é—´ä¸å¤šï¼›ä½›ä¼°è®¡æ˜¯ä¸è§ä½ fgsstbndhberthndnrt ä¸èƒ½å¥³å­©çš„é«˜ä½è´µè´±çš„å¡åˆ©ä¹…é‡Œå¿«ç‚¹æ”¾å‡å§ä¼°è®¡ fgsjgb
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>It's ALWAYS DNS!</title><link>https://tab.deoops.com/posts/always-dns/</link><pubDate>Thu, 19 May 2022 09:30:03 +0800</pubDate><guid>https://tab.deoops.com/posts/always-dns/</guid><description>&lt;img src="https://tab.deoops.com/posts/always-dns/dns.jpeg" alt="Featured image of post It's ALWAYS DNS!" />&lt;p>ä»Šå¤©å‰ç«¯é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå‰ç«¯éƒ¨ç½²çš„[åå‘ä»£ç†]](/posts/nginx-proxy/)åˆ°åç«¯çš„&lt;code>upstream&lt;/code>ä¸€ç›´pendingã€‚&lt;/p>
&lt;h2 id="timeout">timeoutï¼Ÿ&lt;/h2>
&lt;p>ä»¥ä¸ºæ˜¯åç«¯æœåŠ¡å‹åŠ›å¤§ï¼Œæ¥ä¸åŠå“åº”ï¼Œæ‰€ä»¥æ›´æ–°upstreamé…ç½®ï¼ŒåŠ ä¸Štimeoutã€‚ ç«‹ç«¿è§å½±ï¼Œæ²¡é—®é¢˜äº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="k">location&lt;/span> &lt;span class="s">/api/&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">Host&lt;/span> &lt;span class="nv">$http_host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">X-Real-IP&lt;/span> &lt;span class="nv">$remote_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">X-Forwarded-For&lt;/span> &lt;span class="nv">$proxy_add_x_forwarded_for&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">Upgrade&lt;/span> &lt;span class="nv">$http_upgrade&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">Connection&lt;/span> &lt;span class="s">&amp;#39;upgrade&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">rewrite&lt;/span> &lt;span class="s">^/api/(.*)&lt;/span>$ &lt;span class="s">/&lt;/span>&lt;span class="nv">$1&lt;/span> &lt;span class="s">break&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">http://api_server/&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_connect_timeout&lt;/span> &lt;span class="s">5s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_send_timeout&lt;/span> &lt;span class="s">10s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_read_timeout&lt;/span> &lt;span class="s">10s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸€æ®µæ—¶é—´åï¼Œåç«¯åˆæ¥å—ä¸åˆ°å‰ç«¯è¯·æ±‚äº†ï¼Œnginxä¸€ç›´æŠ¥é”™&lt;code>499&lt;/code>ã€‚&lt;/p>
&lt;h2 id="dns-">DNS !&lt;/h2>
&lt;p>è°ƒæŸ¥äº†ä¸€æ®µæ—¶é—´åå‘ç°æ ¹æœ¬é—®é¢˜æ˜¯nginxçš„&lt;code>dns cache&lt;/code>æœºåˆ¶çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>åŸæ¥åç«¯æ¯æ¬¡æ›´æ–°&lt;code>k8s&lt;/code>åç«¯&lt;code>deployment&lt;/code>çš„æ—¶å€™ï¼Œä¹Ÿä¼šé‡å»º&lt;code>service&lt;/code>ä»è€Œå¯¼è‡´ serviceçš„ IPå‘ç”Ÿäº†å˜åŒ–ã€‚&lt;/p>
&lt;p>å’Œåç«¯æ²Ÿé€šä¿®æ”¹äº†åç«¯æ›´æ–°æµæ°´çº¿è„šæœ¬ï¼Œä¸å†é‡å»ºservice åï¼Œé—®é¢˜è§£å†³ :)&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 137;
flex-basis: 330px"
>
&lt;a href="https://tab.deoops.com/posts/always-dns/dns.webp" data-size="4406x3200">
&lt;img src="https://tab.deoops.com/posts/always-dns/dns.webp"
width="4406"
height="3200"
srcset="https://tab.deoops.com/posts/always-dns/dns_hu484ea9858f2c4354449d14ee2aa974c7_105224_480x0_resize_q75_h2_box_2.webp 480w, https://tab.deoops.com/posts/always-dns/dns_hu484ea9858f2c4354449d14ee2aa974c7_105224_1024x0_resize_q75_h2_box_2.webp 1024w"
loading="lazy"
alt="check dns">
&lt;/a>
&lt;figcaption>check dns&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h2 id="dubug">dubug&lt;/h2>
&lt;h3 id="force-resolve-bad-performance">force resolve (bad performance)&lt;/h3>
&lt;p>&lt;a class="link" href="https://serverfault.com/questions/240476/how-to-force-nginx-to-resolve-dns-of-a-dynamic-hostname-everytime-when-doing-p" target="_blank" rel="noopener"
>force nginx to resolve DNS (of a dynamic hostname) everytime when doing proxy_pass?&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">resolver&lt;/span> &lt;span class="mi">127&lt;/span>&lt;span class="s">.0.0.1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">set&lt;/span> &lt;span class="nv">$backend&lt;/span> &lt;span class="s">&amp;#34;http://dynamic.example.com:80&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="nv">$backend&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="http://nginx.org/en/docs/http/ngx_http_upstream_module.html#resolver" target="_blank" rel="noopener"
>resolver&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="k">resolver&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="s">.0.0.1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">upstream&lt;/span> &lt;span class="s">dynamic&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">zone&lt;/span> &lt;span class="s">upstream_dynamic&lt;/span> &lt;span class="mi">64k&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="s">backend1.example.com&lt;/span> &lt;span class="s">weight=5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">backend2.example.com&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="s">fail_timeout=5s&lt;/span> &lt;span class="s">slow_start=30s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="mi">192&lt;/span>&lt;span class="s">.0.2.1&lt;/span> &lt;span class="s">max_fails=3&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="s">backend3.example.com&lt;/span> &lt;span class="s">resolve&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="s">backend4.example.com&lt;/span> &lt;span class="s">service=http&lt;/span> &lt;span class="s">resolve&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">backup1.example.com&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="s">backup&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">backup2.example.com&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="s">backup&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="s">/&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">http://dynamic&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">health_check&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="use-enviroment-not-working">use enviroment (not working)&lt;/h3>
&lt;p>&lt;a class="link" href="https://github.com/docker-library/docs/tree/master/nginx#using-environment-variables-in-nginx-configuration-new-in-119" target="_blank" rel="noopener"
>/etc/nginx/templates/*.template&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># build stage&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="s"> node:lts-alpine as build-front&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">ARG&lt;/span> front&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">WORKDIR&lt;/span>&lt;span class="s"> /app&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> package*.json ./&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> npm config &lt;span class="nb">set&lt;/span> registry https://mirrors.my-dear-company.com/npm-ok/&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> npm install&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> . ./&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> npm run build&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="s"> nginx:stable&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> nginx.template.conf /etc/nginx/templates/api.conf.template&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">COPY&lt;/span> --from&lt;span class="o">=&lt;/span>build-front /app/build /usr/share/nginx/html&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">EXPOSE&lt;/span>&lt;span class="s"> 80&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>mysqlç©ºç£ç›˜æŒ‚å·é—®é¢˜</title><link>https://tab.deoops.com/posts/lost-found/</link><pubDate>Wed, 11 May 2022 14:19:55 +0800</pubDate><guid>https://tab.deoops.com/posts/lost-found/</guid><description>&lt;img src="https://tab.deoops.com/posts/lost-found/lostfoundmysql.png" alt="Featured image of post mysqlç©ºç£ç›˜æŒ‚å·é—®é¢˜" />&lt;p>ä»Šå¤©åœ¨tkeä¸Šéƒ¨ç½²mysql podï¼Œä»¥ä¸ºå¾ˆç®€å•ã€‚ç»“æœå‘ç°podä¸€ç›´crashï¼ŒæŸ¥çœ‹æ—¥å¿—å‘ç°æ˜¯æŒ‚å·çš„é—®é¢˜ï¼š
&lt;code>[ERROR] --initialize specified but the data directory has files in it. Aborting.&lt;/code>&lt;/p>
&lt;p>è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œç»™mysqlåŠ ä¸Šå¯åŠ¨å‚æ•°&lt;code>--ignore-db-dir=lost+found&lt;/code>å³å¯ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://stackoverflow.com/a/66297627" target="_blank" rel="noopener"
>mysql 5.7&lt;/a>&lt;/p>
&lt;h3 id="k8s">k8s&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql-master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql:5.7&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">args&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;--ignore-db-dir=lost+found&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="docker-compose">docker compose&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mysql-master&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">mysql:5.7&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">command&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>--&lt;span class="l">ignore-db-dir=lost+found]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">environment&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="l">MYSQL_ROOT_PASSWORD=root&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>css Position</title><link>https://tab.deoops.com/posts/css-position/</link><pubDate>Fri, 15 Apr 2022 10:23:31 +0800</pubDate><guid>https://tab.deoops.com/posts/css-position/</guid><description>&lt;img src="https://tab.deoops.com/posts/css-position/css-position-all.png" alt="Featured image of post css Position" />&lt;h2 id="é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 273;
flex-basis: 656px"
>
&lt;a href="https://tab.deoops.com/posts/css-position/absolute.png" data-size="996x364">
&lt;img src="https://tab.deoops.com/posts/css-position/absolute.png"
width="996"
height="364"
srcset="https://tab.deoops.com/posts/css-position/absolute_hu2b78c3aa2d52d75bd95030ad234c3511_203642_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/css-position/absolute_hu2b78c3aa2d52d75bd95030ad234c3511_203642_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="absolute icon">
&lt;/a>
&lt;figcaption>absolute icon&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>ä¸Šé¢çš„ä¸¤ä¸ª&lt;code>icon&lt;/code>å’Œ&lt;code>è¯¦æƒ…&lt;/code>è¶…çº§é“¾æ¥ï¼Œç”¨&lt;code>margin/padding&lt;/code>å±æ€§æ— æ³•åšåˆ°åŸå‹ç¨¿è¦æ±‚çš„æ ·å¼ã€‚&lt;/p>
&lt;h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h3>
&lt;p>&lt;a class="link" href="https://www.w3schools.com/css/css_positioning.asp" target="_blank" rel="noopener"
>positiion&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>The position property specifies the type of positioning method used for an element (static, relative, fixed, absolute or sticky).&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šé¢&lt;code>card&lt;/code> UIç»„ä»¶çš„ä¸¤ä¸ª&lt;code>svg&lt;/code>å›¾æ ‡å’Œ&lt;code>è¯¦æƒ…&lt;/code>åº”è¯¥ä½¿ç”¨&lt;code>position: absolute&lt;/code>å±æ€§ï¼Œå®ƒä»¬æœ€è¿‘çš„ç¥–å…ˆ&lt;code>div&lt;/code>åº”è¯¥ä½¿ç”¨&lt;code>position: relative&lt;/code>å±æ€§ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-jsx" data-lang="jsx">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">iv&lt;/span> &lt;span class="nx">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">display&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;flex&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">justifyContent&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;space-between&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">height&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;18.5vh&amp;#34;&lt;/span>&lt;span class="p">}}&lt;/span>&lt;span class="o">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">width&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;280px&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">overflow&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;hidden&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">whiteSpace&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="s1">&amp;#39;nowrap&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">position&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;relative&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">position&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;absolute&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">right&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;1em&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">display&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;flex&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">gap&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;.3em&amp;#34;&lt;/span>&lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">onClick&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">showPic&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">opacity&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">show&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;pic&amp;#34;&lt;/span> &lt;span class="o">?&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="mf">0.5&lt;/span> &lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">svg&lt;/span> &lt;span class="na">viewBox&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;64 64 896 896&amp;#34;&lt;/span> &lt;span class="na">focusable&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;false&amp;#34;&lt;/span> &lt;span class="na">data&lt;/span>&lt;span class="err">-&lt;/span>&lt;span class="na">icon&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;picture&amp;#34;&lt;/span> &lt;span class="na">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;1.5em&amp;#34;&lt;/span> &lt;span class="na">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;1.5em&amp;#34;&lt;/span> &lt;span class="na">fill&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;currentColor&amp;#34;&lt;/span> &lt;span class="na">aria&lt;/span>&lt;span class="err">-&lt;/span>&lt;span class="na">hidden&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">path&lt;/span> &lt;span class="na">d&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zM338 304c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zm513.9 437.1a8.11 8.11 0 0 1-5.2 1.9H177.2c-4.4 0-8-3.6-8-8 0-1.9.7-3.7 1.9-5.2l170.3-202c2.8-3.4 7.9-3.8 11.3-1 .3.3.7.6 1 1l99.4 118 158.1-187.5c2.8-3.4 7.9-3.8 11.3-1 .3.3.7.6 1 1l229.6 271.6c2.6 3.3 2.2 8.4-1.2 11.2z&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">svg&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">onClick&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">showVideo&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">opacity&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">show&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;video&amp;#34;&lt;/span>&lt;span class="o">?&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="o">:&lt;/span> &lt;span class="mf">0.5&lt;/span>&lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">svg&lt;/span> &lt;span class="na">viewBox&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;64 64 896 896&amp;#34;&lt;/span> &lt;span class="na">focusable&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;false&amp;#34;&lt;/span> &lt;span class="na">data&lt;/span>&lt;span class="err">-&lt;/span>&lt;span class="na">icon&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;video-camera&amp;#34;&lt;/span> &lt;span class="na">width&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;1.5em&amp;#34;&lt;/span> &lt;span class="na">height&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;1.5em&amp;#34;&lt;/span> &lt;span class="na">fill&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;currentColor&amp;#34;&lt;/span> &lt;span class="na">aria&lt;/span>&lt;span class="err">-&lt;/span>&lt;span class="na">hidden&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">path&lt;/span> &lt;span class="na">d&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;M912 302.3L784 376V224c0-35.3-28.7-64-64-64H128c-35.3 0-64 28.7-64 64v576c0 35.3 28.7 64 64 64h592c35.3 0 64-28.7 64-64V648l128 73.7c21.3 12.3 48-3.1 48-27.6V330c0-24.6-26.7-40-48-27.7zM328 352c0 4.4-3.6 8-8 8H208c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h112c4.4 0 8 3.6 8 8v48zm560 273l-104-59.8V458.9L888 399v226z&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">svg&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">textAlign&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">position&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;absolute&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">bottom&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">right&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;1em&amp;#34;&lt;/span>&lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;/#/bussinessCenter/events&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="nx">è¯¦æƒ…&lt;/span>&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/*
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> .....
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> &amp;lt;p style={{marginBottom: 0}}&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> &amp;lt;span&amp;gt;name&amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> &amp;lt;span style={{marginLeft: &amp;#34;1em&amp;#34;}}&amp;gt;{event.time}&amp;lt;/span&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> &amp;lt;/p&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> ....
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">width&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;200px&amp;#34;&lt;/span>&lt;span class="p">}}&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">{&lt;/span>&lt;span class="k">this&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">state&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">show&lt;/span> &lt;span class="o">===&lt;/span> &lt;span class="s2">&amp;#34;pic&amp;#34;&lt;/span> &lt;span class="o">?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">img&lt;/span> &lt;span class="na">style&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{{&lt;/span>&lt;span class="nx">width&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;100%&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">objectFit&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="s2">&amp;#34;fill&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">borderRadius&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;0.375rem&amp;#34;&lt;/span>&lt;span class="p">}}&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pic_url&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="na">alt&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">name&lt;/span>&lt;span class="p">}&lt;/span> &lt;span class="p">/&amp;gt;&lt;/span> &lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">video&lt;/span> &lt;span class="na">src&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">event&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">video_url&lt;/span>&lt;span class="p">}&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">video&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="positionä»‹ç»">positionä»‹ç»&lt;/h2>
&lt;p>The position property specifies the type of positioning method used for an element.&lt;/p>
&lt;p>Elements are then positioned using the &lt;code>top&lt;/code>, &lt;code>bottom&lt;/code>, &lt;code>left&lt;/code>, and &lt;code>right&lt;/code> properties. However, these properties(&lt;code>top/bottom/left/right&lt;/code>) will &lt;strong>not work&lt;/strong> unless the position property is set first.&lt;/p>
&lt;p>They(&lt;code>top/bottom/left/right&lt;/code>) also work &lt;strong>differently&lt;/strong> depending on the position value.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 153;
flex-basis: 367px"
>
&lt;a href="https://tab.deoops.com/posts/css-position/css-position-all.png" data-size="660x431">
&lt;img src="https://tab.deoops.com/posts/css-position/css-position-all.png"
width="660"
height="431"
srcset="https://tab.deoops.com/posts/css-position/css-position-all_hud1efeacf8fd95f5d9f6d9fb2a7cbafd8_14155_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/css-position/css-position-all_hud1efeacf8fd95f5d9f6d9fb2a7cbafd8_14155_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="position">
&lt;/a>
&lt;figcaption>position&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h3 id="static">static&lt;/h3>
&lt;p>HTML elements are positioned static by default.&lt;/p>
&lt;p>Static positioned elements are &lt;strong>not affected&lt;/strong> by the top, bottom, left, and right properties.&lt;/p>
&lt;p>An element with &lt;code>position: static;&lt;/code> is not positioned in any special way; it is always positioned according to the normal flow of the page.&lt;/p>
&lt;h3 id="relative">relative&lt;/h3>
&lt;p>An element with &lt;code>position: relative;&lt;/code> is positioned relative to its normal(&lt;code>static&lt;/code>) position.&lt;/p>
&lt;p>Setting the top, right, bottom, and left properties of a relatively-positioned element will cause it to be adjusted away from its normal position.&lt;/p>
&lt;p>Other content will &lt;strong>not&lt;/strong> be adjusted to fit into any gap left by the element.&lt;/p>
&lt;h3 id="fixed">fixed&lt;/h3>
&lt;p>An element with &lt;code>position: fixed;&lt;/code> is positioned relative to the &lt;code>viewport&lt;/code>, which means it always stays in the same place even if the page is scrolled.&lt;/p>
&lt;p>The top, right, bottom, and left properties are used to position the element.&lt;/p>
&lt;p>A fixed element does &lt;strong>not leave&lt;/strong> a gap in the page where it would normally have been located.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">div&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">fixed&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">position&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">fixed&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">bottom&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">right&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="absolute">absolute&lt;/h3>
&lt;p>An element with &lt;code>position: absolute;&lt;/code> is positioned relative to the &lt;code>nearest&lt;/code> positioned ancestor (instead of positioned relative to the viewport, like fixed).&lt;/p>
&lt;p>However; if an absolute positioned element has no positioned ancestors, it uses the document &lt;code>body&lt;/code>, and moves along with page scrolling.&lt;/p>
&lt;p>Note: Absolute positioned elements are &lt;strong>removed from&lt;/strong> the normal flow, and can overlap elements.&lt;/p>
&lt;h3 id="sticky">sticky&lt;/h3>
&lt;p>An element with &lt;code>position: sticky;&lt;/code> is positioned based on the user&amp;rsquo;s scroll position.&lt;/p>
&lt;p>A sticky element toggles between &lt;code>relative and fixed&lt;/code>, depending on the scroll position.&lt;/p>
&lt;p>It is positioned relative until a given offset position is met in the viewport - then it &amp;ldquo;sticks&amp;rdquo; in place (like position:fixed).&lt;/p>
&lt;p>For example, a sticky element sticks to the top of the page (&lt;code>top: 0&lt;/code>), when you reach its scroll position&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-css" data-lang="css">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">div&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nc">sticky&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">position&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">sticky&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">top&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ­¦æ±‰</title><link>https://tab.deoops.com/posts/back-wuhan/</link><pubDate>Fri, 08 Apr 2022 10:37:47 +0800</pubDate><guid>https://tab.deoops.com/posts/back-wuhan/</guid><description>&lt;img src="https://tab.deoops.com/posts/back-wuhan/%E6%AD%A6%E6%B1%89%E7%9A%AE%E9%9D%A9%E5%9F%8E.jpeg" alt="Featured image of post æ­¦æ±‰" />&lt;p>æ—¶é—´è¿‡çš„å¾ˆå¿«ï¼Œè½¬çœ¼å›åˆ°æ­¦æ±‰å·²ç»ä¸€å¹´äº†ï¼Œä¸Šé¢é‚£å¼ ã€Šæµ·å®çš®é©åŸã€‹çš„ç…§ç‰‡æ˜¯åˆšå›æ¥çš„æ—¶å€™æ‹çš„ï¼Œç°åœ¨å·²ç»å…³é—­å«ã€Šæ–¹åœ†èŸã€‹äº†ã€‚&lt;/p>
&lt;p>è®°å¾—å¾ˆæ¸…æ¥šï¼Œæˆ‘æ˜¯2021å¹´4æœˆ1å·åé«˜é“å›çš„æ­¦æ±‰ã€‚æƒ³åœ¨ä¸Šä¸€ä¸ªä¸œå®¶é‚£é‡Œï¼Œæ··ä¸€ä¸ªæ¸…æ˜å‡å†èµ°çš„ï¼Œ&lt;/p>
&lt;p>ä¸è¿‡ç°å®ç§ç§ï¼ˆæœ‰æœºä¼šçš„è¯å†ç»†è¯´ï¼‰ä¸å¾—å·²3æœˆ31å·åŠå®Œäº†ç¦»èŒã€‚&lt;/p>
&lt;p>ç°åœ¨æƒ³æƒ³è¿™ä¸€å¤©åˆšå¥½ä¹Ÿæ˜¯æ„šäººèŠ‚ã€‚&lt;/p>
&lt;h2 id="å·¥ä½œ">å·¥ä½œ&lt;/h2>
&lt;p>å› ä¸ºæ˜¯è£¸è¾ï¼Œæ‰€ä»¥å›æ­¦æ±‰æœ€é‡è¦çš„äº‹æƒ…æ˜¯æ‰¾å·¥ä½œã€‚æ€ä¹ˆè¯´è¿˜æœ‰æˆ¿è´·è¦è¿˜ï¼Œè€Œä¸”ä¸Šæœ‰è€ä¸‹æœ‰å°çš„ã€‚&lt;/p>
&lt;p>ä¸è¿‡ç°å®å¹¶ä¸æ˜¯è¿™æ ·çš„ï¼Œåœ¨å®¶é‡Œå¾…äº†ï¼ˆä¼‘æ¯ï¼‰äº†ä¸€ä¸ªç¤¼æ‹œå·¦å³ï¼Œå¼€å§‹å¤„ç†ä¸€äº›äº‹æƒ…ï¼ˆæ”¶æˆ¿ï¼Œè£…ä¿®ï¼‰ã€‚&lt;/p>
&lt;p>5æœˆåˆå¼€å§‹åœ¨bossä¸ŠæŠ•ç®€å†ï¼Œé¢è¯•ã€‚&lt;/p>
&lt;p>åœ¨æ·±åœ³å›æ¥å‰å¯¹åœ¨æ­¦æ±‰æ‰¾å·¥ä½œè¿™ä»¶äº‹æ˜¯æœ‰å¿ƒç†å‡†å¤‡çš„ï¼Œæ²¡æŠ¥å¤ªå¤§çš„æœŸæœ›ã€‚&lt;/p>
&lt;h3 id="é¢è¯•">é¢è¯•&lt;/h3>
&lt;h4 id="è¿™ç“œä¿ç†Ÿå—">è¿™ç“œä¿ç†Ÿå—ï¼Ÿ&lt;/h4>
&lt;p>æœ‰ä¸€ä¸ªå…¬å¸è¦æ‹›k8sçš„å¼€å‘ï¼Œ æˆ‘ä»æ±‰é˜³è¿™è¾¹æ‰“è½¦è¿‡å»ï¼ŒèŠ±äº†110å¤šå—é’±ï¼ŒæŒºå¿ƒç–¼çš„ã€‚&lt;/p>
&lt;p>å› ä¸ºä»æ¥æ²¡åœ¨æ­¦æ±‰å¾…è¿‡ï¼Œä¸çŸ¥é“å…‰è°·åˆ°åº•æœ‰å¤šè¿œï¼Œæ‰€ä»¥æ‰æ‰“è½¦è¿‡å»é¢è¯•çš„ã€‚&lt;/p>
&lt;p>é¢å¯¹æˆ‘å¯¹è½¦è´¹çš„è´¨ç–‘çš„å£«å¸ˆå‚…è¯´ï¼Œè¿™å·²ç»ä¸æ˜¯å…‰è°·äº†ï¼Œå†å¾€å‰é¢å¼€ä¸€ç‚¹å°±æ˜¯é„‚å·äº†ã€‚&lt;/p>
&lt;p>æ‰€ä»¥è¿™ä¸ªå…¬å¸å¯¹è‡ªå·±çš„ä½ç½®æ’’äº†è°ï¼ˆåšäº†ç¾åŒ–ï¼‰ã€‚&lt;/p>
&lt;p>ååˆ°ä¼šè®®å®¤ï¼Œç»™äº†ä¸€æ¯æ°´ã€‚&lt;/p>
&lt;p>ç­‰äº†ä¼šå‘äº†ç¬”è¯•çš„é¢˜ç›®å’Œä¸€ä¸ªé¢è¯•äººå‘˜ç™»è®°è¡¨æ ¼ã€‚&lt;/p>
&lt;p>å¡«ç™»è®°è¡¨æ ¼æ—¶å€™ï¼Œæˆ‘æå‡ºæ‰‹æœºæŸ¥äº†ä¸‹è”ç³»äººçš„ç”µè¯å·ç ï¼Œç„¶åé¢è¯•å®˜è„¸è‰²ä¸€å˜ï¼Œ&lt;/p>
&lt;p>é—®åˆ°ï¼šâ€œçœ‹æ‰‹æœºå¹²ä»€ä¹ˆï¼Ÿâ€ã€‚ æˆ‘è§£é‡Šå®Œï¼Œä¹ŸçŸ¥é“ä»–æ˜¯æ€€ç–‘æˆ‘æŸ¥èµ„æ–™ã€‚å¥½å§ï¼Œç“œç”°æä¸‹çš„ã€‚&lt;/p>
&lt;p>é¢è¯•è¿‡ç¨‹æ²¡é—®å•¥æœ‰æŠ€æœ¯å«é‡çš„é—®é¢˜ï¼Œé—®å®Œå·¥ä½œç»å†åï¼Œå°±å¼€å§‹å‹å·¥èµ„ã€‚&lt;/p>
&lt;p>æˆ‘ä¹Ÿä¸å‚»ï¼Œå‹å°±å‹å‘—ï¼Œäººåœ¨å±‹æªä¸‹å˜›ã€‚è¯´æ¥è¯´å»å°±é‚£å‡ å¥è¯ã€‚&lt;/p>
&lt;p>æœ€åè®©æˆ‘å›å®¶ç­‰æ¶ˆæ¯ï¼Œ å‡ºæ¥çœ‹äº†çœ‹æ‰‹æœºï¼Œå¥½å®¶ä¼™é¢äº†ä¸¤å°æ—¶ã€‚&lt;/p>
&lt;p>ç¬”è¯•åŠ å¡«å†™èµ„æ–™åŠå°æ—¶ï¼›æœ€åå’ŒhrèŠäº†20æ¥åˆ†é’Ÿã€‚&lt;/p>
&lt;p>ä¸­é—´ä¸€ä¸ªæ¥å°æ—¶çš„æŠ€æœ¯é¢è¯•ã€‚&lt;/p>
&lt;p>æŠ€æœ¯é¢è¯•æ²¡å•¥æ„æ€ï¼Œç¬”è¯•å¾ˆç®€å•çš„ä¸¤ä¸ªé”™è¯¯ã€‚æåˆ°ä¸€ç›´æŒ‘æˆ‘æ¯›ç—…ã€‚&lt;/p>
&lt;p>å°è±¡æ¯”è¾ƒæ·±çš„æ˜¯ï¼Œé—®æ‰¾æˆ‘è¿›æ¥èƒ½ç»™å…¬å¸å¸¦æ¥ä»€ä¹ˆï¼Ÿ&lt;/p>
&lt;p>è¯´æ¥åŠå¤©è‡ªå·±çš„æŠ€æœ¯ä¸Šé¢çš„ä¼˜åŠ¿ï¼Œåæ¥çŸ¥é“åˆ«äººé—®çš„æ˜¯å¸¦å›¢é˜Ÿçš„èƒ½åŠ›ã€‚&lt;/p>
&lt;p>è¯´æ˜ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;ol>
&lt;li>åº”è¯¥è®¤çœŸåˆ†æä¸‹æ‹›è˜ä¿¡æ¯ï¼Œææ¸…æ¥šåˆ«äººçš„é‡ç‚¹ï¼›&lt;/li>
&lt;li>çº¯ææŠ€æœ¯ï¼Œåœ¨æ­¦æ±‰çš„å·¥èµ„ä¸ä¼šé«˜äº†ï¼Œ å¸¦é˜ŸåŠ¡æ‰èƒ½é«˜ç‚¹ï¼›&lt;/li>
&lt;/ol>
&lt;p>å¦å¤–ï¼Œå¤§å°å‘¨ï¼Œè€Œä¸”æ¯å‘¨1ï¼Œ3ï¼Œ5 åŠ ç­åˆ°8:30ï¼›ç›¸å½“äºä¸€å‘¨7å¤©éƒ½å·¥ä½œã€‚ 7*8 æ— ä¼‘ã€‚&lt;/p>
&lt;p>å¯¹æ¯”èµ·æ¥ï¼Œæ·±åœ³é‡‘ç§‘ 5 * 7 å¥½å¾ˆå¤šäº†ï¼Œé‡‘ç§‘çš„å…¬ç§¯é‡‘æ˜¯12%ï¼Œæ¯”è¿™ä¸ªçš„5%é«˜äº†7ä¸ªç‚¹ã€‚&lt;/p>
&lt;p>å›å®¶çš„æ—¶å€™æ²¡èˆå¾—æ‰“è½¦ï¼Œåšäº†æ­¦æ±‰åœ°é“ï¼Œå¥½å®¶ä¼™åäº†4æ¡çº¿ä¹Ÿæ˜¯å¿«2å°æ—¶æ‰å›å®¶ï¼Œ&lt;/p>
&lt;p>11å·çº¿ æ­¦æ±‰ä¸œç«™ è½¬ 2å·çº¿ ä¸­å—è·¯ è½¬ 4å·çº¿ ç‹å®¶æ¹¾ è½¬ 3å·çº¿ï¼Œ ä¸è¿‡è½¦è´¹ä¸ç®—è´µ 9 å—é’±ã€‚&lt;/p>
&lt;p>ç¨å¾®æ¯”æ·±åœ³è´µä¸€ç‚¹ï¼Œè®°å¾—æ·±åœ³æœ€å¤šå°±6ï¼Œ 7å—é’±ã€‚&lt;/p>
&lt;p>å¦å¦å¤–ï¼Œå¦‚æœç®—ä¸Šåˆ°åœ°é“å£çš„æ­¥è¡Œæ—¶é—´ï¼Œå•è¶Ÿéœ€è¦æ•´æ•´3ä¸ªå°æ—¶ï¼Œä¸€ä¸ªæ¥å›å°±æ˜¯6ä¸ªå°æ—¶ï¼Œå¿«èµ¶ä¸Šé‡‘ç§‘ä¸€å¤©çš„å·¥ä½œæ—¶é—´äº†ï¼ŒçœŸçš„æ˜¯å“äººã€‚&lt;/p>
&lt;p>å¼€è½¦çš„è¯æ˜¯1ä¸ªå°æ—¶ï¼Œ 30å¤šå…¬é‡Œ&lt;/p>
&lt;h4 id="ä¸æ–¹ä¾¿è§†é¢‘-">ä¸æ–¹ä¾¿è§†é¢‘ !&lt;/h4>
&lt;p>æœ‰å®¶å…¬å¸æ‹›å®¹å™¨ç›¸å…³çš„å¼€å‘ï¼Œä¹Ÿæ˜¯åœ¨å…³è°·å¾ˆè¿œã€‚hræ‰“ç”µè¯ç»™æˆ‘çš„æ—¶å€™ï¼Œæˆ‘é—®äº†èƒ½ä¸èƒ½è§†é¢‘é¢è¯•ã€‚&lt;/p>
&lt;p>è¯´ç®€å†å¾ˆåŒ¹é…ï¼Œè¦ä¸€æ¬¡æ€§é¢å®Œï¼Œä¸æ–¹ä¾¿è§†é¢‘é¢è¯•ã€‚&lt;/p>
&lt;p>æŒºå¼€å¿ƒçš„ï¼Œè¿™æ˜¯é‡åˆ°ä¼¯ä¹äº†ã€‚åˆæ‰“äº†è½¦è¿‡å»ï¼Œæ¯”ä¸Šæ¬¡é‚£ä¸ªè¿‘ä¸€ç‚¹ï¼Œ80å¤šå—é’±ã€‚&lt;/p>
&lt;p>ä¸€ä¸ª30æ¥å²çš„äººä¸Šæ¥é—®æˆ‘cè¯­è¨€å’‹æ ·ï¼Œæˆ‘è¯´c æ ‡å‡†éƒ½ä¼šï¼Œglicå’Œsystem callä¸ç†Ÿï¼Œæˆ‘ä¸»è¦çš„å¼€å‘è¯­è¨€æ˜¯goã€‚&lt;/p>
&lt;p>ç„¶åæˆ‘å‡†å¤‡å’Œä»–æ¢è®¨ä¸‹goåšå®¹å™¨å¼€å‘çš„ä¼˜åŠ¿ã€‚ é¢è¯•å®˜ä¸æ¥è¯ï¼Œç„¶åçœ‹ç€ç®€å†é—®äº†æˆ‘ä¹‹å‰åšè¿‡vmå†…æ ¸è°ƒä¼˜çš„å…·ä½“å‘½ä»¤/å‚æ•°ã€‚&lt;/p>
&lt;p>å¾ˆä¸Šé¢çš„é‚£ä¸ªâ€œè¿™ç“œä¿ç†Ÿâ€ä¸ä¸€æ ·ä¸è¿‡ä¹Ÿå·®ä¸å¤šï¼Œæ²¡å•¥æŠ€æœ¯å«é‡ï¼Œå°±æ˜¯é—®çš„å¾ˆç»†ã€‚&lt;/p>
&lt;p>è¿‡äº†å›å«äº†äºŒé¢çš„äººã€‚&lt;/p>
&lt;p>ä¹Ÿæ˜¯ä¸€ä¸Šæ¥å°±å«è‡ªæˆ‘ä»‹ç»å•¥çš„ï¼Œæˆ‘å¿ƒæƒ³ä¸ºå•¥ä¸ä¸€èµ·æ¥é¢ï¼Œéè¦æˆ‘æä¸¤æ¬¡è‡ªæˆ‘ä»‹ç»ã€‚&lt;/p>
&lt;p>ç„¶åï¼Œå’Œä¸€é¢çš„äººä¸€æ ·ï¼Œå«æˆ‘è¯¦ç»†çš„è§£é‡ŠLinux kernelè°ƒä¼˜çš„å‘½ä»¤ã€‚&lt;/p>
&lt;p>æˆ‘è¯´ï¼Œæˆ‘å·²ç»è¯´è¿‡äº†ã€‚ä»–ä¸é«˜å…´ï¼Œè®©æˆ‘å†è¯´ä¸€éã€‚æˆ‘ä¸é«˜å…´ï¼Œæˆ‘è¯´ï¼Œæˆ‘å·²ç»è¯´è¿‡äº†ï¼Œä½ é—®ä¸Šä¸€ä¸ªé¢è¯•å®˜å§ã€‚&lt;/p>
&lt;p>é¢è¯•å®˜å€’æ˜¯æ²¡è§‰å¾—æˆ‘ä¸é«˜å…´ï¼Œæ¥ç€é—®æˆ‘httpçš„é•¿è¿æ¥å’ŒçŸ­é“¾æ¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ&lt;/p>
&lt;p>æˆ‘è¯´ï¼Œæœ‰å•¥åŒºåˆ«ï¼Œèƒ½æœ‰å•¥åŒºåˆ«ã€‚æ²¡å•¥åŒºåˆ«ï¼Œéƒ½æ˜¯tcpè¿æ¥ã€‚&lt;/p>
&lt;p>ç„¶åé¢è¯•å®˜è¯´å›å®¶ç­‰æ¶ˆæ¯å§ï¼Œ3åˆ°7ä¸ªå·¥ä½œæ—¥ç»™ä½ æ¶ˆæ¯ã€‚&lt;/p>
&lt;p>æˆ‘å¿«æ­¥èµ°å‡ºã€‚&lt;/p>
&lt;p>åˆ°äº†æ¥¼ä¸‹æ‰“å¼€å¾®ä¿¡çœ‹åˆ°hrå¾®ä¿¡é—®æˆ‘é¢å®Œäº†å—ï¼Ÿ 3è½®éƒ½é¢å®Œäº†å—ï¼Ÿ&lt;/p>
&lt;h4 id="è¦æ±‚ä¸è¦å¤ªé«˜">è¦æ±‚ä¸è¦å¤ªé«˜&amp;hellip;&lt;/h4>
&lt;p>è½¬çœ¼åˆ°äº†6æœˆä¸­æ—¬ï¼Œæˆ‘çˆ¸å¦ˆå€’æ˜¯æ²¡è¯´å•¥ã€‚å¤§èˆ…åŠæˆ‘&amp;quot;å·¥èµ„ä¸è¦è¦çš„é‚£ä¹ˆé«˜ï¼Œå…ˆæ‰¾åˆ°å·¥ä½œå†è¯´ã€‚
ä½ çœ‹ä½ çš„æˆ¿è´·ï¼Œç”Ÿæ´»éƒ½è¦å¼€æ”¯ã€‚&amp;quot;&lt;/p>
&lt;p>åæ¥è€å©†ä¹Ÿå¯¹æˆ‘è¯´ï¼Œæ­¦æ±‰å°±æ²¡æœ‰ä½ è¦çš„é‚£ä¸ªå·¥èµ„ã€‚&lt;/p>
&lt;p>æœ‰ä¸€å¤©åœ¨èœå¸‚åœºç¢°åˆ°å‘å°çš„å¦ˆå¦ˆï¼Œè‚‰çœ¼å¯è§çœ‰å¼€çœ¼ç¬‘çš„å…³å¿ƒæˆ‘ï¼Œâ€œå·¥ä½œæ‰¾çš„æ€ä¹ˆæ ·ï¼Ÿâ€ã€‚&lt;/p>
&lt;p>å¥½å§ã€‚&lt;/p>
&lt;p>é™ä½è¦æ±‚åï¼Œ7æœˆåˆï¼Œé¢ä¸Šäº†ä¸Šæµ·çš„æ­¦æ±‰åˆ†å…¬å¸ï¼Œä¸€å…±æ˜¯é¢äº†6è½®ã€‚&lt;/p>
&lt;p>åœ¨æ–°å…¬å¸å·¥ä½œäº†ä¸€æ®µæ—¶é—´ï¼Œæ„Ÿè§‰è¿˜è¡Œï¼Œå°±æ˜¯ç¦»å®¶è¿œäº†ç‚¹ã€‚&lt;/p>
&lt;h3 id="è·³æ§½">è·³æ§½&lt;/h3>
&lt;p>å…¶å®æˆ‘æŒºçæƒœè¿™ä»½å·¥ä½œçš„ï¼Œæ¯•ç«Ÿæ˜¯é¢äº†6è½®ï¼Œè€Œä¸”åŒäº‹å’Œç›´æ¥leaderéƒ½å¾ˆå¥½ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ï¼Œæ­¦æ±‰è¿™è¾¹çš„è€æ€»ï¼Œè¯´äº†å¾ˆå¤šæ¬¡ï¼Œè®©æˆ‘åŠ ç­ï¼Œæˆ–è€…æ™šä¸Šæ™šç‚¹èµ°ã€‚&lt;/p>
&lt;p>ç»ˆäºåœ¨ä¸€å¤©æ—©ä¼šä¸Šï¼Œåˆè¯´äº†æˆ‘ã€‚ ç„¶åæˆ‘å°±è·³æ§½äº†ã€‚&lt;/p>
&lt;h2 id="ç”Ÿæ´»">ç”Ÿæ´»&lt;/h2>
&lt;p>æ­¦æ±‰çš„ç”Ÿæ´»ç¯å¢ƒæŒºå¥½çš„ï¼Œä»Šå¹´ï¼ˆ2022ï¼‰å¹´åˆï¼Œåˆäº”çš„å¤§é›ªæ˜¯çœŸçš„å¤§ï¼Œä¹Ÿæ˜¯çœŸçš„å¥½çœ‹ã€‚&lt;/p>
&lt;p>å››å­£åˆ†æ˜çš„æ„Ÿè§‰æ¯”æ·±åœ³çš„æµ·é£è¿˜æ›´åˆæˆ‘çš„è„¾æ€§ã€‚&lt;/p>
&lt;p>ä¸è¿‡æ­¦æ±‰åšç”Ÿæ„çš„äººä¸å’‹æ ·ã€‚&lt;/p>
&lt;h3 id="è£…ä¿®">è£…ä¿®&lt;/h3>
&lt;p>è™½ç„¶ä¹°çš„æ˜¯ç²¾è£…ä¿®çš„æˆ¿å­ï¼Œä½†æ˜¯å¼€å‘å•†è£…ä¿®è´¨é‡å¤ªå·®ï¼ˆä»·æ ¼å€’æ˜¯ä¸ä½2600ä¸€å¹³æ–¹ï¼‰&lt;/p>
&lt;p>æ‰€ä»¥éœ€è¦å†è£…ä¸€ä¸‹ã€‚&lt;/p>
&lt;h4 id="å®šåˆ¶æŸœå­">å®šåˆ¶æŸœå­&lt;/h4>
&lt;p>æ‰¾çš„ç†Ÿäººè£…çš„ï¼ŒçœŸçš„ä¸å¦‚ä¸æ‰¾ç†Ÿäººã€‚&lt;/p>
&lt;p>ä¸€å¼€å§‹å°±æ²¡ç”¨å¿ƒ/ç”¨æ—¶é—´ï¼Œç»™æˆ‘ä»¬å‡ºè®¾è®¡æ–¹æ¡ˆï¼Œ&lt;/p>
&lt;p>åé¢è¿˜æ²¡å¼€å§‹è£…å°±æ”¶äº†7æˆçš„æ¬¾ï¼ŒæŸœå­è¿åˆ°å®¶åï¼Œä¸€å®šè¦ä»˜æ‰€æœ‰å°¾æ¬¾æ‰æ´¾å¸ˆå‚…ä¸Šé—¨å®‰è£…ã€‚&lt;/p>
&lt;p>æ‰¿è¯ºçš„å…ç›‘å·¥ï¼Œç»“æœå°±æ˜¯æŸœå­è£…åå’Œè£…ä½äº†ã€‚å”®åä¸€é¡¿æ¨è„±ï¼ŒåŠ é’±ã€‚&lt;/p>
&lt;h4 id="å°é˜³å°">å°é˜³å°&lt;/h4>
&lt;p>å°é˜³å°çš„äººæ˜¯æŸœå­çš„äººæ¨èçš„ï¼Œå¤ªç›¸ä¿¡ç†Ÿäººäº†ã€‚ æ²¡å»çœ‹å°±ç›´æ¥ç»™äº†å®šé‡‘ã€‚&lt;/p>
&lt;p>åé¢ä¸€ç›´æ‹–ç€ä¸æ–½å·¥ï¼Œä¸€ä¸ªæ˜ŸæœŸçš„æ´»ï¼Œå¹²äº†ä¸€ä¸ªæœˆã€‚&lt;/p>
&lt;p>æœ€åè¯´é‚£ä¸ªå°çª—æˆ·çš„ç»ç’ƒå·¥å‚ä¸èƒ½æ‰“å­”ï¼Œè¦ç”¨pvå¡‘æ–™æ¿ä»£æ›¿ã€‚&lt;/p>
&lt;p>æ— è¯­ï¼Œåµæ¶ï¼ŒæŠ¥è­¦ï¼Œ æœ€åè¿˜æ˜¯ç”¨ç»ç’ƒåšå¥½äº†ã€‚&lt;/p>
&lt;p>åé—¨çº±çª—çš„èºä¸é’‰æœ‰é—®é¢˜ï¼Œæ‰¾å”®åï¼Œä¹Ÿæ˜¯ä¸ç†ã€‚&lt;/p>
&lt;h4 id="å®¶ç”µç­‰">å®¶ç”µ/ç­‰&lt;/h4>
&lt;p>æ ¼åŠ›çš„å¸ˆå‚…æ¥è£…ç©ºè°ƒä¹Ÿæ”¶äº†å¿«600å—é’±ã€‚&lt;/p>
&lt;p>æ¯”é‚£ä¸ªçƒ­æ°´å™¨çš„å¸ˆå‚…å¥½ä¸€ç‚¹ï¼Œè£…çƒ­æ°´å™¨çš„å¸ˆå‚…ï¼Œä¸€å‰¯é«˜é«˜åœ¨ä¸Šçš„æ€åº¦ï¼Œæœ€åæ”¶äº†ææ–™è´¹å’Œå®‰è£…è´¹600å¤šã€‚&lt;/p>
&lt;h3 id="ç§Ÿæˆ¿">ç§Ÿæˆ¿&lt;/h3>
&lt;p>æ–°æˆ¿è£…ä¿®çš„æ—¶å€™ï¼Œæ˜¯åœ¨å¤–é¢ç§Ÿæˆ¿ä½ã€‚&lt;/p>
&lt;p>åƒä¸‡ä¸è¦ç§Ÿå…¬å¯“ï¼Œç‰¹åˆ«æ˜¯å•æ‰€æ²¡æœ‰çª—æˆ·çš„å…¬å¯“ã€‚&lt;/p>
&lt;h3 id="å…¬å›­">å…¬å›­&lt;/h3>
&lt;p>ç”Ÿæ´»ä¸å…¨éƒ¨æ˜¯ä¸Šé¢è¯´çš„ä¸å¼€å¿ƒã€‚&lt;/p>
&lt;p>æ­¦æ±‰çš„å…¬å›­æŒºå¥½çš„ï¼Œæ¯”æ·±åœ³å¤§ï¼ŒèŠ±èŠ±è‰è‰å¾ˆå¤šã€‚&lt;/p>
&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;p>åƒäº†å¿«ä¸€å¹´çš„çƒ­å¹²é¢ï¼Œæ¸æ¸çš„æ²¡æœ‰åœ¨æ·±åœ³çš„æ—¶å€™å¯¹çƒ­å¹²é¢çš„é‚£ç§æ„Ÿè§‰äº†ã€‚&lt;/p>
&lt;p>ç°åœ¨æœ‰æ—¶å€™è¿‡æ—©åƒçƒ­å¹²é¢ï¼Œæœ‰æ—¶å€™åƒå‡‰é¢ã€‚æœ‰æ—¶å€™åƒè›‹é…’ï¼ˆæœ‰ç‚¹è´µï¼Œ3å—é’±ï¼‰å’ŒåŒ…å­ã€‚&lt;/p>
&lt;p>æ­¦æ±‰åœ°é“æœ‰ç‚¹è´µï¼Œå¦å¤–ï¼Œæ˜¨å¤©hello å•è½¦æé†’æˆ‘ï¼Œæˆ‘çš„åŠå¹´å¡è¿˜æœ‰5å¤©åˆ°æœŸã€‚&lt;/p></description></item><item><title>permå‡½æ•°</title><link>https://tab.deoops.com/posts/rand-perm/</link><pubDate>Tue, 28 Dec 2021 10:28:03 +0800</pubDate><guid>https://tab.deoops.com/posts/rand-perm/</guid><description>&lt;img src="https://tab.deoops.com/posts/rand-perm/permutation.png" alt="Featured image of post permå‡½æ•°" />&lt;p>å·¥ä½œä¸Šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¥½å¥‡goalngçš„æ’åˆ—æ•°&lt;code>Perm&lt;/code>æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œçœ‹äº†ä¸‹æºä»£ç ï¼Œå†™çš„å¾ˆç®€æ´ã€‚&lt;/p>
&lt;p>ä½¿ç”¨äº†éšæœºäº¤æ¢ç®—æ³•æ¥å¾—åˆ°ä¸€ä¸ªæ’åˆ—ç»„åˆã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">package&lt;/span> rand // import &lt;span class="s2">&amp;#34;math/rand&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">func&lt;/span> Perm&lt;span class="o">(&lt;/span>&lt;span class="nf">n&lt;/span> int&lt;span class="o">)&lt;/span> &lt;span class="o">[]&lt;/span>int
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">Perm&lt;/span> returns, as a slice of n ints, a pseudo-&lt;span class="nb">random &lt;/span>permutation of the
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">integers&lt;/span> in the half-&lt;span class="nb">open &lt;/span>interval &lt;span class="o">[&lt;/span>&lt;span class="m">0&lt;/span>,n&lt;span class="o">)&lt;/span> from the default Source.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="äº¤æ¢">äº¤æ¢&lt;/h3>
&lt;p>æœ¬è´¨ä¸Šè¯´å°±æ˜¯äº¤æ¢&lt;code>m[i]&lt;/code>å’Œ&lt;code>m[j]&lt;/code>ï¼Œä¸”&lt;code>i&amp;gt; j&lt;/code>ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Perm&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">n&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">j&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Intn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// std implement
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// m[i] = m[j]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// m[j] = i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// swap
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// same effect
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// m[i] = i
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// m[i], m[j] = m[j], m[i]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">m&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ’åˆ—ç»„åˆ</title><link>https://tab.deoops.com/posts/permutation-combination/</link><pubDate>Mon, 13 Dec 2021 11:34:08 +0800</pubDate><guid>https://tab.deoops.com/posts/permutation-combination/</guid><description>&lt;img src="https://tab.deoops.com/posts/permutation-combination/permutation-combinnaiton.webp" alt="Featured image of post æ’åˆ—ç»„åˆ" />&lt;p>ä¸Šç¤¼æ‹œæœ‰äººé—®æˆ‘ï¼Œå¦‚ä½•ä»æ•°ç»„ä¸­é€‰æ‹©å’Œä¸ºnï¼Œé•¿åº¦ä¸ºmçš„æ‰€æœ‰çš„å­æ•°ç»„ï¼Ÿ&lt;/p>
&lt;h2 id="é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;h3 id="è¾“å…¥">è¾“å…¥&lt;/h3>
&lt;p>&lt;code>a = []int{10, 7, -5, 4, 8, 16, 70, -30, 91}&lt;/code>&lt;/p>
&lt;p>&lt;code>m = 3, n = 15&lt;/code>&lt;/p>
&lt;h3 id="è¾“å‡º">è¾“å‡º&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="p">[[&lt;/span>&lt;span class="mi">10&lt;/span> &lt;span class="mi">35&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">]]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç­”æ¡ˆ">ç­”æ¡ˆ&lt;/h2>
&lt;h3 id="ç®—æ³•">ç®—æ³•&lt;/h3>
&lt;p>è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„æ’åˆ—ç»„åˆçš„é—®é¢˜ï¼Œåªè¦æŠŠ&lt;code>Cn&lt;/code>ç®—å‡ºæ¥ç„¶ååšè¿‡æ»¤å°±å¥½ï¼Œæ ¸å¿ƒæ˜¯æ•°ç»„ç»„åˆçš„ç®—æ³•ã€‚&lt;/p>
&lt;p>æˆ‘ä½¿ç”¨çš„æ˜¯é€’å½’ç®—æ³•ï¼š&lt;/p>
&lt;ol>
&lt;li>é€‰å–åŒ…å«ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç»„åˆï¼šæ‹¼æ¥ç¬¬ä¸€ä¸ªå…ƒç´ å’Œå‰”é™¤ç¬¬ä¸€ä¸ªå…ƒç´ åæ•°ç»„çš„æ‰€æœ‰çš„&lt;code>m-1&lt;/code>çš„ç»„åˆï¼›&lt;/li>
&lt;li>é€‰å–ä¸å«ç¬¬äºŒä¸ªå…ƒç´ çš„é•¿åº¦ä¸º&lt;code>m&lt;/code>çš„ç»„åˆï¼›&lt;/li>
&lt;li>å°†ä¸Šé¢ä¸¤ä¸ªç»„åˆåˆå¹¶èµ·æ¥å³å¯ï¼›ï¼ˆä¸ç”¨å»é‡ï¼Œå› ä¸ºæ²¡æœ‰é‡å¤çš„ï¼‰&lt;/li>
&lt;li>é€’å½’ç»“æŸæ¡ä»¶ï¼šå½“&lt;code>m=1&lt;/code>çš„æ—¶å€™ï¼Œç›´æ¥æ”¾å›æ‰€æœ‰æ•°ç»„å…ƒç´ ï¼›å½“&lt;code>m=len(input)&lt;/code>æ—¶ï¼Œç›´æ¥è¿”å›&lt;code>[][]int{input}&lt;/code>ï¼›å½“&lt;code>m&amp;gt;len(input)&lt;/code>æ—¶ï¼Œè¿”å›ç©ºï¼›&lt;/li>
&lt;/ol>
&lt;h3 id="golangå®ç°">golangå®ç°&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;flag&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">size&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">flag&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;size&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;size of array&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">flag&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;sum&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;sum of two numbers&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">flag&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Parse&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">input&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">7&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">35&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">30&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">91&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// for _, v := range chooseM(input, 8) {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// fmt.Println(v)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="c1">// }
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">input&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">chooseSumN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">input&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">size&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">sum&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">chooseM&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">res&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">res&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">res&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">one&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">rest&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">chooseM&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:],&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">rest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]},&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">one&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">one&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">one&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">chooseM&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:],&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">chooseSumN&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nf">chooseM&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">sum&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">out&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">out&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">out&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="è°ƒè¯•è¾“å‡º">è°ƒè¯•è¾“å‡º&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">â¯ ./c3 &lt;span class="na">-sum&lt;/span> &lt;span class="m">15&lt;/span> &lt;span class="na">-size&lt;/span> &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="m">10&lt;/span> &lt;span class="m">7&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="m">5&lt;/span> &lt;span class="m">4&lt;/span> &lt;span class="m">8&lt;/span> &lt;span class="m">16&lt;/span> &lt;span class="m">35&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="m">30&lt;/span> &lt;span class="m">91&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[[&lt;/span>&lt;span class="m">7&lt;/span> &lt;span class="m">8&lt;/span>&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ ./c3 &lt;span class="na">-sum&lt;/span> &lt;span class="m">15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>&lt;span class="m">10&lt;/span> &lt;span class="m">7&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="m">5&lt;/span> &lt;span class="m">4&lt;/span> &lt;span class="m">8&lt;/span> &lt;span class="m">16&lt;/span> &lt;span class="m">35&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="m">30&lt;/span> &lt;span class="m">91&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[[&lt;/span>&lt;span class="m">10&lt;/span> &lt;span class="m">35&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="m">30&lt;/span>&lt;span class="o">]&lt;/span> &lt;span class="o">[-&lt;/span>&lt;span class="m">5&lt;/span> &lt;span class="m">4&lt;/span> &lt;span class="m">16&lt;/span>&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å·¥ç¨‹ä¼˜åŒ–">å·¥ç¨‹ä¼˜åŒ–&lt;/h2>
&lt;p>ä¸Šé¢æ˜¯ç®—æ³•çš„è§£é‡Šï¼Œå·¥ç¨‹å®ç°çš„æ—¶å€™å¯ä»¥æŠŠ&lt;code>é€‰æ‹©&lt;/code>å’Œ&lt;code>è¿‡æ»¤&lt;/code>ç»“åˆåœ¨ä¸€èµ·åšï¼Œæå‡ä»£ç çš„æ—¶é—´/ç©ºé—´æ€§èƒ½ã€‚&lt;/p>
&lt;h3 id="golangå®ç°-1">golangå®ç°&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">engineer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sum&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">sum&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">m&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kd">var&lt;/span> &lt;span class="nx">res&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">res&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="p">})&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">res&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">one&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">rest&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">engineer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:],&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">rest&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">m&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]},&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">one&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">one&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">one&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">engineer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:],&lt;/span> &lt;span class="nx">m&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>åˆå¹¶å›¾ç‰‡</title><link>https://tab.deoops.com/posts/append-jpeg/</link><pubDate>Sun, 05 Dec 2021 11:34:06 +0800</pubDate><guid>https://tab.deoops.com/posts/append-jpeg/</guid><description>&lt;img src="https://tab.deoops.com/posts/append-jpeg/imagemagick.jpeg" alt="Featured image of post åˆå¹¶å›¾ç‰‡" />&lt;p>å¡«å†™æŸæ”¿åºœè¡¨æ ¼æ—¶å€™ï¼Œéœ€è¦æŠŠå¤šä¸ªå›¾ç‰‡åˆå¹¶ä¸ºä¸€å¼ å›¾ç‰‡ã€‚
ç”¨&lt;code>Photoshop&lt;/code>åº”è¯¥å¾ˆå¥½è§£å†³ï¼Œä½†æ˜¯æœ¬åœ°æ²¡æœ‰å®‰è£…ã€‚äºæ˜¯ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ç”¨&lt;code>imageMagick&lt;/code>ä¹Ÿå¯ä»¥è§£å†³ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 460;
flex-basis: 1104px"
>
&lt;a href="https://tab.deoops.com/posts/append-jpeg/append.png" data-size="870x189">
&lt;img src="https://tab.deoops.com/posts/append-jpeg/append.png"
width="870"
height="189"
srcset="https://tab.deoops.com/posts/append-jpeg/append_hu861701e1315ddf515ddd0b1e09a0a995_8283_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/append-jpeg/append_hu861701e1315ddf515ddd0b1e09a0a995_8283_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="append two picture ">
&lt;/a>
&lt;figcaption>append two picture&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h3 id="meat">meat&lt;/h3>
&lt;p>&lt;a class="link" href="https://superuser.com/questions/316132/appending-images-vertically-in-imagemagick/316189" target="_blank" rel="noopener"
>Appending images vertically in ImageMagick&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># vertical stacking (top to bottom):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">convert -append 1.jpeg 2.jpeg 3.jpeg out.jpg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># horizontal stacking (left to right):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">convert +append 1.jpg 2.jpg out.jpg
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ps">ps&lt;/h3>
&lt;p>å¦å¤–è¿™ç¯‡&lt;a class="link" href="https://tab.deoops.com/posts/gif-loop/" >å¾ªç¯æ’­æ”¾gifå›¾ç‰‡&lt;/a>ä¹Ÿç”¨åˆ°äº†&lt;code>imageMagick&lt;/code>ã€‚&lt;/p></description></item><item><title>æŸ¥çœ‹Wi-Fiå¯†ç </title><link>https://tab.deoops.com/posts/check-wifipassword/</link><pubDate>Wed, 01 Dec 2021 15:16:39 +0800</pubDate><guid>https://tab.deoops.com/posts/check-wifipassword/</guid><description>&lt;img src="https://tab.deoops.com/posts/check-wifipassword/wifi-password.jpeg" alt="Featured image of post æŸ¥çœ‹Wi-Fiå¯†ç " />&lt;p>åœ¨è‹¹æœç”µè„‘ä¸Šä½¿ç”¨ç»ˆç«¯&lt;code>security&lt;/code>å‘½ä»¤æŸ¥çœ‹Wi-Fiå¯†ç ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">security find-generic-password -wa &lt;span class="s1">&amp;#39;your wifi-ssid&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 230;
flex-basis: 554px"
>
&lt;a href="https://tab.deoops.com/posts/check-wifipassword/wifi.png" data-size="868x376">
&lt;img src="https://tab.deoops.com/posts/check-wifipassword/wifi.png"
width="868"
height="376"
srcset="https://tab.deoops.com/posts/check-wifipassword/wifi_hu66e9221b77a6acb1198c7195748bfb4f_66710_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/check-wifipassword/wifi_hu66e9221b77a6acb1198c7195748bfb4f_66710_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="macos dialogue">
&lt;/a>
&lt;figcaption>macos dialogue&lt;/figcaption>
&lt;/figure>
åœ¨å¼¹å‡ºçš„ç³»ç»Ÿå¯¹è¯æ¡†ä¸­è¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œç»ˆç«¯å³å¯ä»¥çœ‹åˆ°Wi-Fiå¯†ç ã€‚&lt;/p>
&lt;p>ps. é™¤äº†å½“å‰è¿æ¥çš„Wi-Fiï¼Œç³»ç»Ÿæ‰€æœ‰ä¿å­˜è¿‡çš„Wi-Fiå¯†ç éƒ½å¯ä»¥é€šè¿‡&lt;code>security&lt;/code>å‘½ä»¤æŸ¥åˆ°ã€‚
&lt;figure
class="gallery-image"
style="
flex-grow: 128;
flex-basis: 308px"
>
&lt;a href="https://tab.deoops.com/posts/check-wifipassword/all-wifi.png" data-size="1302x1012">
&lt;img src="https://tab.deoops.com/posts/check-wifipassword/all-wifi.png"
width="1302"
height="1012"
srcset="https://tab.deoops.com/posts/check-wifipassword/all-wifi_hu1b8799fe9b8c9e0d590c4630ece7700f_262038_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/check-wifipassword/all-wifi_hu1b8799fe9b8c9e0d590c4630ece7700f_262038_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="macos all remember wifi list">
&lt;/a>
&lt;figcaption>macos all remember wifi list&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>Â é‡æ–°å®‰è£…macport</title><link>https://tab.deoops.com/posts/reinstall-macport/</link><pubDate>Mon, 29 Nov 2021 11:50:01 +0800</pubDate><guid>https://tab.deoops.com/posts/reinstall-macport/</guid><description>&lt;img src="https://tab.deoops.com/posts/reinstall-macport/sip.png" alt="Featured image of post Â é‡æ–°å®‰è£…macport" />&lt;p>updated: å¥½åƒæ˜¯å› ä¸ºæˆ‘å®‰è£…äº†&lt;code>ripgrep&lt;/code>æ‰€ä»¥ä¼šä¸€ç›´æ›´æ–°&lt;code>cargo-c&lt;/code>ä¾èµ–ã€‚&lt;/p>
&lt;p>ä¸çŸ¥é“ä¸ºå•¥æ¯æ¬¡&lt;code>sudo port -v upgrade outdated &lt;/code>éƒ½ä¼šé‡æ–°å®‰è£…&lt;code>cargo-c&lt;/code>ï¼Œ
è¿›è€Œä¼šå®‰è£…ç¼–è¯‘&lt;code>rust&lt;/code>ã€‚ ç¼–è¯‘&lt;code>rust&lt;/code>å¾ˆè´¹æ—¶é—´å’ŒCPUé£æ‰‡ã€‚&lt;/p>
&lt;p>æ‰€ä»¥æˆ‘å°±å¸è½½äº†&lt;code>rust&lt;/code>å’Œä¸€ä¼—ä¾èµ–ï¼Œåé¢ç‰¹æ„åˆå¸è½½äº†&lt;code>cargo-c&lt;/code>ã€‚ä½†æ˜¯æ¯æ¬¡&lt;code>upgrade outdated&lt;/code>
&lt;code>cargo-c&lt;/code>åˆå›æ¥äº†ï¼Œå¾ˆæ˜¯çƒ¦äººã€‚ googleä¸€åœˆåï¼Œå†³å®šé‡æ–°å®‰è£…&lt;code>macport&lt;/code>&lt;/p>
&lt;h2 id="æ¸…ç†å®‰è£…åŒ…">æ¸…ç†å®‰è£…åŒ…&lt;/h2>
&lt;p>å°è¯•&lt;a class="link" href="https://superuser.com/questions/165652/how-can-i-clean-up-my-macports-installation" target="_blank" rel="noopener"
>&lt;code>clean&lt;/code> æ‰€æœ‰çš„&lt;/a>å®‰è£…åŒ…ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo port uninstall cargo-c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo port -v selfupdate
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo port -f clean --all all
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rm -rf /opt/local/var/macports/packages/*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rm -rf /opt/local/var/macports/distfiles/*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rm -rf /opt/local/var/macports/build/*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">port &lt;span class="nb">echo&lt;/span> leaves
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo port uninstall leaves
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo port -f uninstall inactive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## SURPRISE! after upgrade, `cargo-c` come back.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo port upgrade outdated
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å¸è½½macport">å¸è½½macport&lt;/h2>
&lt;p>å‚è€ƒ&lt;a class="link" href="https://guide.macports.org/chunked/installing.macports.uninstalling.html" target="_blank" rel="noopener"
>å®˜ç½‘ååŠ©&lt;/a>æ­¥éª¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo port -fp uninstall installed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dscl . -delete /Users/macports
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dscl . -delete /Groups/macports
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rm -rf &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /opt/local &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Applications/DarwinPorts &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Applications/MacPorts &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/LaunchDaemons/org.macports.* &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/Receipts/DarwinPorts*.pkg &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/Receipts/MacPorts*.pkg &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/StartupItems/DarwinPortsStartup &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/Tcl/darwinports1.0 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> /Library/Tcl/macports1.0 &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> ~/.macports
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€åä¸€æ­¥æŠ¥é”™äº†ï¼šè¿™ä¸‰ä¸ª&lt;code>/opt/local&lt;/code>, &lt;code>/opt/local/var/db&lt;/code>, &lt;code>/opt/local/var/db/postgres&lt;/code>
ç›®å½•æ— æ³•åˆ é™¤ã€‚&lt;/p>
&lt;p>&lt;code>sudo su &lt;/code>åˆ‡æ¢ä¸ºrootè¿˜æ˜¯æŠ¥æƒé™ä¸è¶³ã€‚&lt;/p>
&lt;h2 id="sip">SIP&lt;/h2>
&lt;p>æŸ¥äº†ä¸€ä¸‹æ˜¯&lt;a class="link" href="https://superuser.com/questions/1049689/which-folders-are-affected-by-system-integrity-protection" target="_blank" rel="noopener"
>system integrity proction(SIP)&lt;/a>çš„åŸå› &lt;/p>
&lt;h3 id="æŸ¥çœ‹sip">æŸ¥çœ‹SIP&lt;/h3>
&lt;h4 id="çŠ¶æ€">çŠ¶æ€&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ csrutil status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">System Integrity Protection status: enabled.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="æŸ¥çœ‹ç”¨æˆ·httpsapplestackexchangecomquestions317576how-to-delete-macports-user-after-using-the-migration-assistant320714320714">æŸ¥çœ‹&lt;a class="link" href="https://apple.stackexchange.com/questions/317576/how-to-delete-macports-user-after-using-the-migration-assistant/320714#320714" target="_blank" rel="noopener"
>ç”¨æˆ·&lt;/a>&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dscl . list /Users &lt;span class="p">|&lt;/span> grep -v &lt;span class="s1">&amp;#39;^_&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">daemon
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Guest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mixelpix
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="åˆ é™¤postgres">åˆ é™¤postgres&lt;/h3>
&lt;p>å¯ä»¥çœ‹åˆ°ä¸Šé¢æœ‰postgresç”¨æˆ·ï¼Œæ‰€ä»¥åˆ é™¤&lt;code>postgres&lt;/code>ä¹‹åï¼Œå°±å¯ä»¥åˆ é™¤&lt;code>/opt/local&lt;/code>ç›®å½•äº†ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo dscl . -delete /Groups/postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo dscl . -delete /Users/postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rm -rf /opt/local
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>fish shell</title><link>https://tab.deoops.com/posts/try-fish/</link><pubDate>Fri, 26 Nov 2021 11:33:15 +0800</pubDate><guid>https://tab.deoops.com/posts/try-fish/</guid><description>&lt;img src="https://tab.deoops.com/posts/try-fish/fish.png" alt="Featured image of post fish shell" />&lt;p>ä»Šå¤©åœ¨hacker newsä¸Šé—²é€›ï¼Œåˆçœ‹åˆ°æœ‰äººæ¨é”€&lt;code>fish&lt;/code>ã€‚å¿ƒæƒ³é©¬ä¸Šå°±2022å¹´äº†ï¼Œä¸å¦‚æ¢ä¸ªshellè€è€ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 134;
flex-basis: 323px"
>
&lt;a href="https://tab.deoops.com/posts/try-fish/hn-fish.png" data-size="1436x1066">
&lt;img src="https://tab.deoops.com/posts/try-fish/hn-fish.png"
width="1436"
height="1066"
srcset="https://tab.deoops.com/posts/try-fish/hn-fish_hufedcf2709999a125b54ea6d9eb6768c1_417931_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/try-fish/hn-fish_hufedcf2709999a125b54ea6d9eb6768c1_417931_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="fish shell topic on hackernews">
&lt;/a>
&lt;figcaption>fish shell topic on hackernews&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>å…¶å®æ—©åœ¨2013å¹´å°±æ¥è§¦è¿‡&lt;a class="link" href="https://fishshell.com/" target="_blank" rel="noopener"
>fish&lt;/a>ï¼Œé‚£ä¸ªæ—¶å€™è‡ªå·±æ¯”è¾ƒèœï¼Œå·¥ä½œçš„æ—¶å€™å¾ˆå¤šbashè„šæœ¬åœ¨fishä¸Šéƒ½ä¸èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥å°±æ”¾å¼ƒfishã€‚&lt;/p>
&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;p>å®‰è£…fish&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo port install fish
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo chpass -s /opt/local/bin/fish &lt;span class="si">${&lt;/span>&lt;span class="nv">USER&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /etc/shells
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€€å‡º&lt;code>zsh&lt;/code>ï¼Œé‡å¯&lt;code>terminal&lt;/code>&lt;/p>
&lt;h2 id="å®‰è£…æ’ä»¶">å®‰è£…æ’ä»¶&lt;/h2>
&lt;h3 id="oh-my-fish--fisher">oh-my-fish / fisher&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">curl&lt;/span> https://raw.githubusercontent.com/oh-my-&lt;span class="nb">fish&lt;/span>/oh-my-&lt;span class="nb">fish&lt;/span>/master/bin/install &lt;span class="o">&amp;gt;&lt;/span> install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">fish &lt;/span>install &lt;span class="na">--path&lt;/span>&lt;span class="o">=&lt;/span>~/.local/share/omf &lt;span class="na">--config&lt;/span>&lt;span class="o">=&lt;/span>~/.config/omf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># å¯èƒ½å‡ºç° https://git.ioæ— æ³•è®¿é—®çš„é—®é¢˜
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">curl&lt;/span> &lt;span class="na">-sL&lt;/span> https://git.io/fisher &lt;span class="o">|&lt;/span> &lt;span class="nb">source&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nf">fisher&lt;/span> install jorgebucaran/fisher
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="autojump-j">autojump/ j&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">sudo&lt;/span> &lt;span class="nf">port&lt;/span> uninstall autojump
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">git&lt;/span> clone https://github.com/wting/autojump.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">cd&lt;/span> autojump/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./install.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">cd&lt;/span> repo/github/autojump/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">vi&lt;/span> .config/&lt;span class="nb">fish&lt;/span>/config.&lt;span class="nb">fish
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">&lt;/span>&lt;span class="nf">j&lt;/span> home
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="nvm">nvm&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">sudo&lt;/span> &lt;span class="nf">port&lt;/span> uninstall nvm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">fisher&lt;/span> install jorgebucaran/nvm.&lt;span class="nb">fish
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">&lt;/span>&lt;span class="nf">nvm&lt;/span> install latest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">nvm&lt;/span> list
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">nvm&lt;/span> &lt;span class="na">--version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#nvm use v17.1.0
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Now using Node v17.1.0 (npm 8.1.2) ~/.local/share/nvm/v17.1.0/bin/node
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">node&lt;/span> &lt;span class="na">--version&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="fisher-plugins">fisher plugins&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">fisher&lt;/span> install IlanCosman/tide@v5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">fisher&lt;/span> install PatrickF1/fzf.&lt;span class="nb">fish
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">&lt;/span>&lt;span class="nf">fisher&lt;/span> install franciscolourenco/done
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é…ç½®">é…ç½®&lt;/h2>
&lt;h3 id="path">PATH&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="k">echo&lt;/span> &lt;span class="nv">$PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">fish_add_path&lt;/span> /Users/r/go/bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">fish_add_path&lt;/span> /opt/local/bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="alias">alias&lt;/h3>
&lt;p>é»˜è®¤&lt;code>ls&lt;/code>å‘½ä»¤å¯¹æ–‡ä»¶å’Œç›®å½•æ²¡æœ‰åšé¢œè‰²çš„åŒºåˆ†ï¼Œå¯ä»¥ä½¿ç”¨&lt;code>alias ls='ls -G'&lt;/code>åŠ ä¸Šé¢œè‰²é€‰é¡¹:)&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-fish" data-lang="fish">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ~/.config/fish/config.fish
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#starship init fish | source
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="k">test&lt;/span> &lt;span class="na">-f&lt;/span> /Users/r/.autojump/share/autojump/autojump.&lt;span class="nb">fish&lt;/span>&lt;span class="p">;&lt;/span> . /Users/r/.autojump/share/autojump/autojump.&lt;span class="nb">fish&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">set&lt;/span> &lt;span class="na">--local&lt;/span> &lt;span class="nv">AUTOJUMP_PATH&lt;/span> &lt;span class="nv">$HOME&lt;/span>/.autojump/share/autojump/autojump.&lt;span class="nb">fish
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb"> &lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="k">test&lt;/span> &lt;span class="na">-e&lt;/span> &lt;span class="nv">$AUTOJUMP_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">source&lt;/span> &lt;span class="nv">$AUTOJUMP_PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">ls&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;ls -G&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">yaegi&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;rlwrap yaegi&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c">#alias swagger=&amp;#34;docker run --rm -it -e GOPATH=$HOME/go:/go -v $HOME:$HOME -w $(pwd) quay.io/goswagger/swagger&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">kks&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;kubectl -n kube-system &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">kku&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;kubectl -n wu &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">kkl&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;kubectl -n location &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">pt&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;git push &amp;amp;&amp;amp; git push --tags&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">vi&lt;/span>&lt;span class="o">=&lt;/span>nvim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">vim&lt;/span>&lt;span class="o">=&lt;/span>nvim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c"># alias code=nvim
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">t&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;tmux -u&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c"># alias docker_prune=&amp;#34;docker rmi `docker images -f &amp;#39;dangling=true&amp;#39; -q`&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="c"># alias docker_prune=&amp;#34;docker system prune&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="nb">alias &lt;/span>&lt;span class="nv">chrome&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">set&lt;/span> &lt;span class="na">--universal&lt;/span> &lt;span class="nv">nvm_default_version&lt;/span> v17.&lt;span class="m">3&lt;/span>.&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>clickhouseåˆå§‹åŒ–</title><link>https://tab.deoops.com/posts/clickhouse-start/</link><pubDate>Mon, 22 Nov 2021 18:39:03 +0800</pubDate><guid>https://tab.deoops.com/posts/clickhouse-start/</guid><description>&lt;img src="https://tab.deoops.com/posts/clickhouse-start/clickhouse.jpeg" alt="Featured image of post clickhouseåˆå§‹åŒ–" />&lt;p>æ€»ä½“æ¥çœ‹&lt;code>clickhouse&lt;/code>çš„&lt;code>ddl&lt;/code>æ“ä½œæ–¹å¼å’Œ&lt;code>mysql&lt;/code>å¾ˆåƒã€‚æ¯”å¦‚&lt;code>use database_name&lt;/code>ï¼Œ &lt;code>create user ... identified by ''&lt;/code>ç­‰ã€‚&lt;/p>
&lt;h2 id="server">server&lt;/h2>
&lt;h3 id="docker-run">docker run&lt;/h3>
&lt;p>å¯åŠ¨clickhouseæœåŠ¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -d --name clickhouse-server -p 8123:8123 -p 9000:9000 --ulimit &lt;span class="nv">nofile&lt;/span>&lt;span class="o">=&lt;/span>262144:262144 yandex/clickhouse-server:21.8.10.19
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="default-useræƒé™">default useræƒé™&lt;/h3>
&lt;p>é»˜è®¤defualt ç”¨æˆ·ä¸èƒ½æ·»åŠ æ–°çš„ç”¨æˆ·ï¼Œéœ€è¦ä¿®æ”¹defaultæƒé™ï¼Œå¦åˆ™ä¼šæŠ¥é”™&lt;code>Code: 497. DB::Exception: Received from localhost:9000. DB::Exception: default: Not enough privileges. To execute this query it's necessary to have the grant CREATE USER ON *.*. &lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker &lt;span class="nb">exec&lt;/span> -it clickhouse-server bash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt update -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">apt install vim
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/clickhouse-server/users.xml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># update &amp;lt;access_management&amp;gt;1&amp;lt;/access_management&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker restart clickhouse-server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 227;
flex-basis: 545px"
>
&lt;a href="https://tab.deoops.com/posts/clickhouse-start/default.png" data-size="1550x682">
&lt;img src="https://tab.deoops.com/posts/clickhouse-start/default.png"
width="1550"
height="682"
srcset="https://tab.deoops.com/posts/clickhouse-start/default_hu801c8cfdfea5b55e3cf77a27138605f8_217042_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/clickhouse-start/default_hu801c8cfdfea5b55e3cf77a27138605f8_217042_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="access management for default user">
&lt;/a>
&lt;figcaption>access management for default user&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h2 id="client">client&lt;/h2>
&lt;h3 id="docker-run-client">docker run client&lt;/h3>
&lt;p>å¯åŠ¨clickhouse clientï¼Œæ·»åŠ ç”¨æˆ·å’Œæ•°æ®åº“ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -it --rm --link clickhouse-server:clickhouse-server yandex/clickhouse-client --host clickhouse-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## create database&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd87688bfa29 :&lt;span class="o">)&lt;/span> create database blc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CREATE DATABASE blc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Query id: 19562cda-a1e7-46f9-a3c2-03dec173e15b
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ok.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> rows in set. Elapsed: 0.009 sec.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd87688bfa29 :&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## create user&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd87688bfa29 :&lt;span class="o">)&lt;/span> create user abc IDENTIFIED by &lt;span class="s1">&amp;#39;ssss&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">CREATE USER abc IDENTIFIED WITH sha256_hash BY &lt;span class="s1">&amp;#39;28E51044F4A9CBAE2BBD3D8A9D8C902AD1455D42208277AC4A913B003038A3DC&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Query id: ee533fe8-7d66-428a-bbde-89d0a4d15924
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ok.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> rows in set. Elapsed: 0.002 sec.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## grant &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd87688bfa29 :&lt;span class="o">)&lt;/span> GRANT ALL PRIVILEGES ON blc. * TO abc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">GRANT SHOW, SELECT, INSERT, ALTER, CREATE DATABASE, CREATE TABLE, CREATE VIEW, CREATE DICTIONARY, CREATE FUNCTION, DROP, TRUNCATE, OPTIMIZE, SYSTEM MERGES, SYSTEM TTL MERGES, SYSTEM FETCHES, SYSTEM MOVES, SYSTEM SENDS, SYSTEM REPLICATION QUEUES, SYSTEM DROP REPLICA, SYSTEM SYNC REPLICA, SYSTEM RESTART REPLICA, SYSTEM RESTORE REPLICA, SYSTEM FLUSH DISTRIBUTED, dictGet ON blc.* TO abc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Query id: cd09b798-f7e0-45f7-8511-9914de75238c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Ok.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> rows in set. Elapsed: 0.002 sec.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fd87688bfa29 :&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="sdk">sdk&lt;/h2>
&lt;h3 id="connect-from-golang-client">connect from golang client&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">db&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;database/sql&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">_&lt;/span> &lt;span class="s">&amp;#34;github.com/ClickHouse/clickhouse-go&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">globalDB&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">sql&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">DB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Init open connection to clickhouse and check a ping cmd.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// url: &amp;#39;tcp://localhost:9000?debug=true&amp;amp;username=abc&amp;amp;password=ssss&amp;amp;database=blc&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">Init&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">url&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">func&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">connect&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">sql&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;clickhouse&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">url&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">connect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Ping&lt;/span>&lt;span class="p">();&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalDB&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">connect&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="nx">connect&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">},&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Start create tables if not exists.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">Start&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nf">createTables&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ç”¨æˆ·çº¿ç¨‹è°ƒåº¦æ¨¡å‹</title><link>https://tab.deoops.com/posts/go-scheduler/</link><pubDate>Fri, 19 Nov 2021 14:44:20 +0800</pubDate><guid>https://tab.deoops.com/posts/go-scheduler/</guid><description>&lt;img src="https://tab.deoops.com/posts/go-scheduler/go-scheduler.png" alt="Featured image of post ç”¨æˆ·çº¿ç¨‹è°ƒåº¦æ¨¡å‹" />&lt;p>ä¸€èˆ¬æ¥è¯´å¤šçº¿ç¨‹3ç§å¹¶å‘æ¨¡å‹ï¼š&lt;/p>
&lt;ol>
&lt;li>N:1ï¼Œ æŠŠnä¸ªç”¨æˆ·çº¿ç¨‹ï¼ˆGreen threedï¼‰æ˜ å°„åˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ï¼ˆOS Threedï¼‰ä¸Šã€‚&lt;/li>
&lt;/ol>
&lt;p>è¿™ç§æ¨¡å‹çš„ä¼˜ç‚¹æ˜¯ ç”¨æˆ·çº¿ç¨‹ä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆcontext switchï¼‰ä¼šéå¸¸å¿«ï¼Œ
ç¼ºç‚¹æ˜¯ä¸èƒ½å……åˆ†çš„è¿ç”¨å¤šæ ¸CPUèµ„æºï¼ˆä¸€ä¸ªOS Threadåªèƒ½åœ¨ä¸€ä¸ªCPUä¸Šï¼‰ï¼›
2. 1:1ï¼Œ æ¯ä¸ªç”¨æˆ·çº¿ç¨‹æ˜ å°„åˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šã€‚&lt;/p>
&lt;p>è¿™ç§å’Œç¬¬ä¸€ç§çš„ä¼˜ç¼ºç‚¹æ­£å¥½ç›¸åã€‚1:1 å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨èµ„æºï¼Œä½†æ˜¯ä¸Šä¸‹æ–‡åˆ‡æ¢å¾ˆæ…¢ã€‚&lt;/p>
&lt;ol start="3">
&lt;li>M:Nï¼ŒæŠŠMä¸ªç”¨æˆ·çº¿ç¨‹æ˜ å°„åˆ°Nä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šã€‚&lt;/li>
&lt;/ol>
&lt;p>è¿™ç§ç»“åˆäº†å‰é¢ä¸¤ç§æ¨¡å‹çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶è§„é¿äº†ä»–ä»¬çš„ç¼ºç‚¹ã€‚&lt;/p>
&lt;h2 id="mgp">M/G/P&lt;/h2>
&lt;p>golang runtimeä¸»è¦é€šè¿‡æŠ½è±¡å‡ºMachine/Processor/Groutineä¸‰ç§å¯¹è±¡ï¼Œå’Œä¸€äº›ç®—æ³•(steal)å®ç°äº†M:Næ¨¡å‹ã€‚&lt;/p>
&lt;h3 id="machine">Machine&lt;/h3>
&lt;p>Må¯¹åº”æ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œä»£è¡¨è¢«æ“ä½œç³»ç»Ÿç®¡ç†çš„çº¿ç¨‹èµ„æºã€‚&lt;/p>
&lt;h3 id="goroutine">Goroutine&lt;/h3>
&lt;p>Gå¯¹åº”ç”¨æˆ·çº¿ç¨‹ï¼ˆGoroutineï¼‰ï¼ŒåŒ…å«äº†stackï¼Œ&lt;code>æŒ‡ä»¤æŒ‡é’ˆ&lt;/code>ï¼Œè¿˜æœ‰ä¸€äº›ä¼šå½±å“è¿™ä¸ªGoroutineè°ƒåº¦çš„å…³é”®ä¿¡æ¯ï¼Œæ¯”å¦‚æœ‰å…³çš„channelã€‚&lt;/p>
&lt;h3 id="processor">Processor&lt;/h3>
&lt;p>På¯¹åº”æœ¬åœ°é€»è¾‘è°ƒåº¦å™¨ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰ï¼Œæ˜¯è°ƒåº¦ç®—æ³•å…·ä½“çš„æ‰§è¡Œå¯¹è±¡ï¼Œä¸»è¦ç”¨æ¥å¤„ç†&lt;code>steal&lt;/code>å’Œ&lt;code>hand-off&lt;/code>ç­‰ç®—æ³•ã€‚&lt;/p>
&lt;h2 id="demo">demo&lt;/h2>
&lt;h3 id="normal">normal&lt;/h3>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 102;
flex-basis: 245px"
>
&lt;a href="https://tab.deoops.com/posts/go-scheduler/in-motion.jpeg" data-size="400x391">
&lt;img src="https://tab.deoops.com/posts/go-scheduler/in-motion.jpeg"
width="400"
height="391"
srcset="https://tab.deoops.com/posts/go-scheduler/in-motion_hu66b0699a4d4006020605c239340bcbd0_15905_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/go-scheduler/in-motion_hu66b0699a4d4006020605c239340bcbd0_15905_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="Machine Processor Groutine demo">
&lt;/a>
&lt;figcaption>Machine Processor Groutine demo&lt;/figcaption>
&lt;/figure>
ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬æœ‰2ä¸ªM(OS Thread)ï¼Œæ¯ä¸ªMéƒ½æœ‰ä¸€ä¸ªæœ¬åœ°çš„contextï¼ˆPï¼‰ï¼Œéƒ½åœ¨è¿è¡Œä¸€ä¸ªgoroutineï¼ˆGï¼‰ã€‚&lt;/p>
&lt;p>æœ‰å‡ ç‚¹éœ€è¦è¯´æ˜ä¸€ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>M&lt;strong>å¿…é¡»&lt;/strong>å¾—åˆ°ä¸€ä¸ªP&lt;strong>æ‰èƒ½&lt;/strong>è¿è¡Œgoroutineé‡Œé¢çš„æŒ‡ä»¤ï¼›&lt;/li>
&lt;li>Pçš„æ•°é‡ç­‰äºç¯å¢ƒå˜é‡&lt;code>GOMAXPROCS&lt;/code>çš„å€¼ï¼Œ ä¸€èˆ¬ç­‰äºå®¿ä¸»æœºçš„å¤„ç†å™¨æ ¸å¿ƒæ•°ï¼›&lt;/li>
&lt;li>ç°è‰²çš„goroutineæ²¡æœ‰åœ¨&lt;code>running&lt;/code>ï¼Œä½†æ˜¯å·²ç»å‡†å¤‡å¥½è¢«è°ƒåº¦äº†ã€‚ä»–ä»¬æ‰€å¤„çš„é˜Ÿåˆ—å«&lt;code>runqueues&lt;/code>ï¼Œæ¯å½“æ‰§è¡Œçš„&lt;code>go statement&lt;/code>æŒ‡ä»¤æ—¶ï¼Œæ–°çš„goroutineå°±ä¼šåŠ åˆ°runqueueçš„å°¾éƒ¨ï¼›&lt;/li>
&lt;li>æ¯ä¸ªPéƒ½æœ‰è‡ªå·±æœ¬åœ°runqueueã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="syscall--hand-off">(sys)call / hand-off&lt;/h3>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 137;
flex-basis: 330px"
>
&lt;a href="https://tab.deoops.com/posts/go-scheduler/syscall.jpeg" data-size="550x400">
&lt;img src="https://tab.deoops.com/posts/go-scheduler/syscall.jpeg"
width="550"
height="400"
srcset="https://tab.deoops.com/posts/go-scheduler/syscall_hu71699ffe4298f5dd3b241a2b684b0eae_17678_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/go-scheduler/syscall_hu71699ffe4298f5dd3b241a2b684b0eae_17678_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="syscall demo">
&lt;/a>
&lt;figcaption>syscall demo&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>&lt;code>M0&lt;/code>æŠŠè‡ªå·±çš„contextç»™äº†&lt;code>M1&lt;/code>ï¼Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;ol>
&lt;li>M0æ‰§è¡ŒG0ä¸Šçš„æŸæ¡&lt;code>syscall&lt;/code>æŒ‡ä»¤ï¼›&lt;/li>
&lt;li>M0æ”¾å¼ƒPè¿›å…¥blockçŠ¶æ€ï¼ŒM1å¾—åˆ°å¹¶ç»§ç»­æ‰§è¡ŒPè°ƒåº¦ç®—æ³•ï¼Œå¯èƒ½å»æ‰§è¡Œå¦å¤–æŸä¸€ä¸ªgoroutineï¼›&lt;/li>
&lt;li>&lt;code>syscall&lt;/code>è¿”å›ï¼ŒM0å› ä¸ºæ²¡æœ‰Pæ‰€ä»¥ä¸èƒ½ç»§ç»­æ‰§è¡ŒG0ã€‚ç°åœ¨M0éœ€è¦å»å·ä¸€ä¸ªPæ‰§è¡ŒG0ï¼Œå¦åˆ™å°±æŠŠG0æ”¾åˆ°&lt;code>global runqueue&lt;/code>é‡Œé¢ç„¶åæŠŠè‡ªå·±æ”¾å›thread caheå»sleepã€‚&lt;/li>
&lt;/ol>
&lt;p>ä¹Ÿæœ‰å‡ ç‚¹éœ€è¦å•ç‹¬è¯´æ˜ï¼š&lt;/p>
&lt;ol>
&lt;li>M1å¯èƒ½æ˜¯schedulerä¸ºäº†å¤„ç†syscallç‰¹æ„åˆ›å»ºçš„ï¼Œä¹Ÿå¯èƒ½æ˜¯æ¥è‡ª&lt;code>thread cache&lt;/code>ï¼›&lt;/li>
&lt;li>å½“Pæœ¬åœ°çš„runqueueä¸ºç©ºæ—¶ï¼ŒPä¼šä»&lt;code>global runqueue&lt;/code>æ‹‰å–Gï¼›å³ä½¿æœ¬åœ°runqueueæ²¡æœ‰ç©ºï¼ŒPä¹Ÿä¼šå®šæœŸçš„æ£€æŸ¥&lt;code>global runqueue&lt;/code>é‡Œçš„goroutineã€‚&lt;/li>
&lt;li>æ­£æ˜¯å› ä¸ºè¦å¤„ç†&lt;code>syscal/hand-off&lt;/code>ï¼Œæ‰€ä»¥å³ä½¿GOMAXPROCSç­‰äº1ï¼ŒGoè¿˜æ˜¯ä¼šå¯åŠ¨å¤šä¸ªOSçº¿ç¨‹ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="stealing-work">stealing work&lt;/h3>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 137;
flex-basis: 330px"
>
&lt;a href="https://tab.deoops.com/posts/go-scheduler/steal.jpeg" data-size="550x400">
&lt;img src="https://tab.deoops.com/posts/go-scheduler/steal.jpeg"
width="550"
height="400"
srcset="https://tab.deoops.com/posts/go-scheduler/steal_hu803057213e7fa552581c1059eddb0e8c_17446_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/go-scheduler/steal_hu803057213e7fa552581c1059eddb0e8c_17446_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="steal work/goroutine demo">
&lt;/a>
&lt;figcaption>steal work/goroutine demo&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>å½“Pè‡ªå·±æœ¬åœ°çš„runqueueç©ºäº†ï¼Œè€Œä¸”global runqueueä¹Ÿæ˜¯ç©ºçš„æ—¶å€™ï¼Œ
På°±ä¼šå»å…¶ä»–På·æ‰å¯¹æ–¹ä¸€åŠçš„Gï¼Œä»è€Œä½¿å¾—è‡ªå·±å’Œå…¶å®ƒPéƒ½èƒ½é«˜æ•ˆå·¥ä½œï¼Œæé«˜æ•´ä½“æ€§èƒ½ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://morsmachine.dk/go-scheduler" target="_blank" rel="noopener"
>å‚è€ƒæ–‡æ¡£&lt;/a>&lt;/p></description></item><item><title>çº¸å·¾å’Œç›†æ ½</title><link>https://tab.deoops.com/posts/tissue-flower/</link><pubDate>Fri, 19 Nov 2021 09:53:25 +0800</pubDate><guid>https://tab.deoops.com/posts/tissue-flower/</guid><description>&lt;img src="https://tab.deoops.com/posts/tissue-flower/flower.jpeg" alt="Featured image of post çº¸å·¾å’Œç›†æ ½" />&lt;p>æœˆåˆçš„æ—¶å€™åŒäº‹æŠ±æ€¨å…¬å¸æ²¡æœ‰çº¸å·¾äº†ï¼Œæœ‰ç‚¹å„¿ä¸æ–¹ä¾¿ã€‚
å…«å¦ä¸€é˜µåï¼ŒåŸæ¥æ˜¯è¯´ä¸Šä¸ªæœˆå›¢å»ºè¶…é¢„ç®—äº†ï¼Œä¸‹ä¸ªæœˆæ‰æœ‰ç»è´¹é‡‡è´­çº¸å·¾ã€‚ä¼°è®¡è¿˜è¦ç­‰20å¤šå¤©ã€‚&lt;/p>
&lt;p>æ…¢æ…¢çš„å¤§å®¶çš„çº¸å·¾éƒ½ç”¨å®Œäº†ï¼Œç§ä¸‹çš„æŠ±æ€¨ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚&lt;/p>
&lt;p>åˆ°äº†æœˆä¸­ä¹Ÿå°±ä¸æ€ä¹ˆæŠ±æ€¨äº†ï¼Œæ¯•ç«Ÿæ‰å‡ å—é’±çš„ä¸œè¥¿ï¼Œå¤§å®¶åŸºæœ¬ä¸Šéƒ½è‡ªå·±ä¹°äº†ã€‚&lt;/p>
&lt;p>æœ¬æ¥äº‹æƒ…å¾ˆç®€å•è¿‡å»äº†ã€‚ä¸æƒ³å‰å‡ å¤©å…¬å¸çš„è€å¤§åœ¨åŠå…¬å®¤é€›çš„æ—¶å€™è¯´äº†ä¸€å¥ï¼Œ&lt;code>è¿™äº›ç›†æ ½æœ‰çš„å·²ç»æ¯äº†ï¼Œè¦æ‰¾äººä¿®ä¸€ä¿®äº†&lt;/code>ã€‚&lt;/p>
&lt;p>ç„¶åä»Šå¤©åŠå…¬å®¤çš„ç›†æ ½å°±éƒ½æ¢æ–°äº†:
&lt;figure
class="gallery-image"
style="
flex-grow: 133;
flex-basis: 319px"
>
&lt;a href="https://tab.deoops.com/posts/tissue-flower/plants.jpeg" data-size="2216x1664">
&lt;img src="https://tab.deoops.com/posts/tissue-flower/plants.jpeg"
width="2216"
height="1664"
srcset="https://tab.deoops.com/posts/tissue-flower/plants_hu35fc5cd3eb5d91108373340cc98977a4_493896_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/tissue-flower/plants_hu35fc5cd3eb5d91108373340cc98977a4_493896_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="beautiful potted plants">
&lt;/a>
&lt;figcaption>beautiful potted plants&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>æœ‰ä¸€è¯´ä¸€ï¼Œè¿™äº›ç›†æ ½æŒºæ¼‚äº®çš„ã€‚&lt;/p>
&lt;p>ä¸è¿‡å…¬å¸è¦æ˜¯èƒ½æŠŠæ²¡æœ‰çº¸å·¾çš„é—®é¢˜è§£å†³äº†ï¼ŒèµèŠ±çš„æ—¶å€™å¿ƒé‡Œä¼šæ›´èˆ’æœäº›ï¼Œä¸è¦&lt;strong>è¾œè´Ÿ&lt;/strong>äº†ç»¿æ²¹æ²¹æ¼‚äº®çš„ç›†æ ½ã€‚&lt;/p>
&lt;p>ps. æˆ‘ä¹Ÿä¸æ•¢æçº¸å·¾çš„æ—¶å€™ï¼Œå¿ä¸€å¿å°±è¿‡å»äº†å“ˆã€‚
pps. ä¸‹åˆæ¥åˆ°é€šçŸ¥ï¼Œå¤§è€æ¿è¦ä»ä¸Šæµ·è¿‡æ¥ã€‚å…¬å¸è¿˜è¯·äº†ä¿æ´é˜¿å§¨æå«ç”Ÿã€‚å¯èƒ½æ˜¯ç‰¹æ‰¹äº†ä¸€ç¬”ç»è´¹å§ã€‚&lt;/p></description></item><item><title>å¾ªç¯æ’­æ”¾gifå›¾ç‰‡</title><link>https://tab.deoops.com/posts/gif-loop/</link><pubDate>Thu, 18 Nov 2021 17:23:48 +0800</pubDate><guid>https://tab.deoops.com/posts/gif-loop/</guid><description>&lt;img src="https://tab.deoops.com/posts/gif-loop/deja-vu-brain-injury.jpeg" alt="Featured image of post å¾ªç¯æ’­æ”¾gifå›¾ç‰‡" />&lt;h2 id="install">install&lt;/h2>
&lt;p>é¦–å…ˆä½¿ç”¨&lt;code>macport&lt;/code>å®‰è£… &lt;code>imagemagick&lt;/code>è½¯ä»¶åŒ…ï¼Œå› ä¸ºmacportæ˜¯ç¼–è¯‘å®‰è£…è½¯ä»¶åŒ…ï¼Œæ‰€ä»¥å®‰è£…è¿‡ç¨‹ä¼šæ¯”è¾ƒä¹…ï¼ˆ~9minï¼‰ã€‚
æ›´åŠ ä¹ æƒ¯homebrewçš„å¯ä»¥å‚è€ƒ &lt;a class="link" href="https://imagemagick.org/script/download.php#macosx" target="_blank" rel="noopener"
>å®˜ç½‘imagemagick download&lt;/a> å®‰è£…ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ sudo port install imagemagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Password:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Computing dependencies &lt;span class="k">for&lt;/span> ImageMagickWarning: cltversion: The Command Line Tools are installed, but MacPorts cannot determine the version.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Warning: cltversion: For a possible fix, please see: https://trac.macports.org/wiki/ProblemHotlist#reinstall-clt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">The following dependencies will be installed:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> aom
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brotli
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Activating webp @1.2.1_0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Cleaning webp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Fetching archive &lt;span class="k">for&lt;/span> ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Attempting to fetch ImageMagick-6.9.11-60_1+x11.darwin_21.x86_64.tbz2 from https://packages.macports.org/ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Attempting to fetch ImageMagick-6.9.11-60_1+x11.darwin_21.x86_64.tbz2 from https://pek.cn.packages.macports.org/macports/packages/ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Attempting to fetch ImageMagick-6.9.11-60_1+x11.darwin_21.x86_64.tbz2 from https://kmq.jp.packages.macports.org/ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Fetching distfiles &lt;span class="k">for&lt;/span> ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Attempting to fetch ImageMagick-6.9.11-60.tar.xz from https://distfiles.macports.org/ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Verifying checksums &lt;span class="k">for&lt;/span> ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Extracting ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Configuring ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Building ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Staging ImageMagick into destroot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Installing ImageMagick @6.9.11-60_1+x11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Activating ImageMagick @6.9.11-60_1+x11
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Cleaning ImageMagick
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Updating database of binaries
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; Scanning binaries &lt;span class="k">for&lt;/span> linking errors
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; No broken files found.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">---&amp;gt; No broken ports found.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~ took 8m49s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="convert">convert&lt;/h2>
&lt;p>ä¿®æ”¹gifå¾ªç¯æ¬¡æ•°ï¼Œå½“&lt;code>loopä¸º0&lt;/code>æ—¶åˆ™å…³é—­äº†gifçš„å¾ªç¯æ’­æ”¾ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># convert -h | grep loop&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># -loop iterations add Netscape loop extension to your GIF animation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">convert -loop &lt;span class="m">1000&lt;/span> dog.gif bad_dog.gif
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ¢è¡Œç¬¦</title><link>https://tab.deoops.com/posts/carrier-return/</link><pubDate>Wed, 17 Nov 2021 14:58:30 +0800</pubDate><guid>https://tab.deoops.com/posts/carrier-return/</guid><description>&lt;img src="https://tab.deoops.com/posts/carrier-return/line-feed.jpeg" alt="Featured image of post æ¢è¡Œç¬¦" />&lt;p>æ¢è¡Œç¬¦&lt;code>\r\n&lt;/code>å’Œ&lt;code>\n&lt;/code>çš„å…³ç³»å’ŒåŒºåˆ«å¯ä»¥è¿½æº¯åˆ°60å¹´å‰ï¼Œæ‰“å­—æœºå¹¿æ³›è¢«ä½¿ç”¨çš„æ—¶ä»£ã€‚&lt;/p>
&lt;p>åœ¨æ‰“å­—æœºè¿˜åˆšåˆšè¢«å‘æ˜çš„æ—¶å€™ï¼Œäººä»¬è¾“å…¥å®Œä¸€è¡Œå­—ä¹‹åï¼Œéœ€è¦ä¸¤ä¸ªåŠ¨ä½œæ‰èƒ½å¼€å§‹è¾“å…¥ä¸‹ä¸€è¡Œçš„å†…å®¹ã€‚&lt;/p>
&lt;p>æ»šåŠ¨æ»šè½®ï¼Œè®©çº¸å¼ å¾€ä¸Šç§»åŠ¨ä¸€è¡Œï¼Œ å³æ˜¯ &lt;code>\n&lt;/code> æ“ä½œï¼›
ç§»åŠ¨ æ‰“å­—çš„æŒ‡é’ˆåˆ° è¡Œé¦–ï¼Œ å³æ˜¯&lt;code>\r&lt;/code> ã€‚
ä¸Šé¢ä¸¤ä¸ªæ“ä½œæ²¡æœ‰é¡ºåºçš„è¦æ±‚ï¼Œ 1-&amp;gt;2 ; 2-&amp;gt;1 éƒ½å¯ä»¥ã€‚&lt;/p>
&lt;h3 id="windows">windows&lt;/h3>
&lt;p>Windows æ“ä½œç³»ç»Ÿ çš„æ–‡æœ¬å¯¹ new lineçš„ ç¼–ç  ä½¿ç”¨çš„æ˜¯ 2-&amp;gt;1 çš„ ç»„åˆæ“ä½œ;&lt;/p>
&lt;h3 id="unix">unix&lt;/h3>
&lt;p>Linux/Unix æ“ä½œç³»ç»Ÿ åˆ™åªä½¿ç”¨æ“ä½œ 1 ã€‚&lt;/p>
&lt;blockquote>
&lt;p>A line feed means moving one line forward. The code is &lt;code>\n&lt;/code>.
A carriage return means moving the cursor to the beginning of the line. The code is &lt;code>\r&lt;/code>.
Windows editors often still use the combination of both as &lt;code>\r\n&lt;/code> in text files. Unix uses mostly only the &lt;code>\n&lt;/code>.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>The separation comes from typewriter times, when you turned the wheel to move the paper to change the line and moved the carriage to restart typing on the beginning of a line. This was two steps&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a class="link" href="https://stackoverflow.com/questions/12747722/what-is-the-difference-between-a-line-feed-and-a-carriage-return" target="_blank" rel="noopener"
>å‚è€ƒï¼šWhat is the difference between a â€œline feedâ€ and a â€œcarriage returnâ€&lt;/a>
&lt;figure
class="gallery-image"
style="
flex-grow: 125;
flex-basis: 300px"
>
&lt;a href="https://tab.deoops.com/posts/carrier-return/left-side.png" data-size="1000x800">
&lt;img src="https://tab.deoops.com/posts/carrier-return/left-side.png"
width="1000"
height="800"
srcset="https://tab.deoops.com/posts/carrier-return/left-side_hud4506dd4606452c9e6d5d0a0120cf9da_1237959_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/carrier-return/left-side_hud4506dd4606452c9e6d5d0a0120cf9da_1237959_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="left side of typewriter">
&lt;/a>
&lt;figcaption>left side of typewriter&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>bashç®€ä»‹</title><link>https://tab.deoops.com/posts/bash-command/</link><pubDate>Wed, 17 Nov 2021 10:06:54 +0800</pubDate><guid>https://tab.deoops.com/posts/bash-command/</guid><description>&lt;img src="https://tab.deoops.com/posts/bash-command/terminal.jpeg" alt="Featured image of post bashç®€ä»‹" />&lt;p>æœ¬æ–‡ä¼šä¸å®šæœŸæ›´æ–° :)&lt;/p>
&lt;h2 id="set">set&lt;/h2>
&lt;p>å¯ä»¥ä½¿ç”¨setå‘½ä»¤æ”¹å˜shellè„šæœ¬é»˜è®¤çš„æ‰§è¡Œæµç¨‹ã€‚
æ¯”å¦‚ &lt;code>set -e&lt;/code> å¯ä»¥ä½¿å¾—shellè„šæœ¬é‡åˆ°æŸä¸€æ¡å‘½ä»¤å‡ºé”™ï¼ˆ &lt;code>echo $?&lt;/code> ä¸ä¸º0ï¼‰æ—¶ç«‹å³é€€å‡ºæ‰§è¡Œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> you cannot see me, unless you comment out the &lt;span class="s1">&amp;#39;set -e&amp;#39;&lt;/span> flag, haha
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html" target="_blank" rel="noopener"
>setè¯¦ç»†æ–‡æ¡£&lt;/a>&lt;/p>
&lt;h2 id="du">du&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ du -sh Downloads
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4.1G Downloads
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="http://zh.wikipedia.org/wiki/Du_%28Unix%29" target="_blank" rel="noopener"
>wiki&lt;/a>&lt;/p>
&lt;h2 id="rm">rm&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rm &lt;span class="nv">$0&lt;/span> &lt;span class="c1"># åˆ é™¤å½“å‰æ–‡ä»¶ for cleanup&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="job">job&lt;/h2>
&lt;h3 id="nohup">nohup&lt;/h3>
&lt;p>åœ¨åå°æ‰§è¡Œå½“å‰å‘½ä»¤ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">nohup /usr/sbin/script.sh &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹ï¼Œè¿™æ—¶å°±æŠŠShellç»™å æ®äº†ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¯¹äºé‚£äº›æ²¡æœ‰äº¤äº’çš„è¿›ç¨‹ï¼Œ
æˆ‘ä»¬å¸Œæœ›å°†å…¶åœ¨åå°å¯åŠ¨ï¼Œå¯ä»¥åœ¨å¯åŠ¨å‚æ•°çš„æ—¶å€™åŠ ä¸€ä¸ª&amp;rsquo;&amp;amp;&amp;lsquo;å®ç°è¿™ä¸ªç›®çš„ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ sleep &lt;span class="m">5&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> &lt;span class="m">34769&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ¦ â¯
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> + &lt;span class="m">34769&lt;/span> &lt;span class="k">done&lt;/span> sleep &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ¦ â¯
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿›ç¨‹åˆ‡æ¢åˆ°åå°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠå®ƒç§°ä¸ºjobã€‚åˆ‡æ¢åˆ°åå°æ—¶ä¼šè¾“å‡ºç›¸å…³jobä¿¡æ¯ï¼Œä¸Šé¢&amp;amp;çš„è¾“å‡º [1] 34769 ï¼š
[1]è¡¨ç¤ºjob ID æ˜¯1,11319è¡¨ç¤ºè¿›ç¨‹IDæ˜¯34769ã€‚åˆ‡æ¢åˆ°åå°çš„è¿›ç¨‹ï¼Œä»ç„¶å¯ä»¥ç”¨pså‘½ä»¤æŸ¥çœ‹ã€‚&lt;/p>
&lt;h3 id="fgbg-suspended">fg/bg suspended&lt;/h3>
&lt;p>å¯ä»¥é€šè¿‡bg &lt;!-- raw HTML omitted -->ï¼ˆbackgroundï¼‰å’Œfg&lt;!-- raw HTML omitted -->ï¼ˆforegroundï¼‰å‘½ä»¤å°†å…¶åœ¨å‰åå°é—´çŠ¶æ€åˆ‡æ¢ã€‚
å¯ä»¥ä½¿ç”¨&lt;!-- raw HTML omitted -->+z ç»„åˆé”®æŠŠå½“å‰fgçš„è¿›ç¨‹æŒ‚èµ·:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Source changed &lt;span class="s2">&amp;#34;/Users/r/datewu.github.io/content/posts/bash-command/index.md&amp;#34;&lt;/span>: WRITE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Total in &lt;span class="m">15&lt;/span> ms
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">^Z
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> + &lt;span class="m">3595&lt;/span> suspended hugo server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„ï¼ŒæŒ‚èµ·çš„è¿›ç¨‹ä¼šæš‚åœè¿è¡Œã€‚éœ€è¦å†æ‰§è¡Œbg/fgå‘½ä»¤æ‰èƒ½ç»§ç»­è¿è¡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">datewu.github.io on î‚  main &lt;span class="o">[&lt;/span>!?&lt;span class="o">]&lt;/span> took 7m41s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ¦ â¯ &lt;span class="nb">bg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> + &lt;span class="m">3595&lt;/span> continued hugo server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒæ ·çš„ï¼Œbgä¹‹åæ‰§è¡Œfgå‘½ä»¤å°±å¯ä»¥æŠŠjobé‡æ–°åˆ†é…åˆ°å½“å‰çš„shelläº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">datewu.github.io on î‚  main &lt;span class="o">[&lt;/span>!?&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ¦ â¯ ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Makefile Readme.md archetypes config.yaml content data layouts resources static themes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">datewu.github.io on î‚  main &lt;span class="o">[&lt;/span>!?&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ¦ â¯ &lt;span class="nb">fg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>1&lt;span class="o">]&lt;/span> + &lt;span class="m">3595&lt;/span> running hugo server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å®ˆæŠ¤è¿›ç¨‹">å®ˆæŠ¤è¿›ç¨‹&lt;/h2>
&lt;p>å¦‚æœä¸€ä¸ªè¿›ç¨‹æ°¸è¿œéƒ½æ˜¯ä»¥åå°æ–¹å¼å¯åŠ¨ï¼Œå¹¶ä¸”ä¸èƒ½å—åˆ°Shellé€€å‡ºå½±å“è€Œé€€å‡ºï¼Œä¸€ä¸ªæ­£ç»Ÿçš„åšæ³•æ˜¯å°†å…¶åˆ›å»ºä¸ºå®ˆæŠ¤è¿›ç¨‹ã€‚
å®ˆæŠ¤è¿›ç¨‹å€¼å¾—æ˜¯ç³»ç»Ÿé•¿æœŸè¿è¡Œçš„åå°è¿›ç¨‹ï¼Œç±»ä¼¼WindowsæœåŠ¡ã€‚å®ˆæŠ¤è¿›ç¨‹ä¿¡æ¯é€šè¿‡ps â€“aæ— æ³•æŸ¥çœ‹åˆ°ï¼Œéœ€è¦ç”¨åˆ°â€“xå‚æ•°ã€‚
å½“æŸ¥çœ‹å®ˆæŠ¤è¿›ç¨‹æ—¶ï¼Œå¾€å¾€è¿˜é™„ä¸Š-jå‚æ•°ä»¥æŸ¥çœ‹ä½œä¸šæ§åˆ¶ä¿¡æ¯ï¼Œå…¶ä¸­TPGIDä¸€æ ä¸º-1å°±æ˜¯å®ˆæŠ¤è¿›ç¨‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">root ~ ps xj
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PPID PID PGID SID TTY TPGID STAT UID TIME COMMAND
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">953&lt;/span> &lt;span class="m">1190&lt;/span> &lt;span class="m">1190&lt;/span> &lt;span class="m">1190&lt;/span> ? -1 Ss &lt;span class="m">1000&lt;/span> 0:00 /bin/sh /usr/bin/startkde
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> &lt;span class="m">1490&lt;/span> &lt;span class="m">1482&lt;/span> &lt;span class="m">1482&lt;/span> ? -1 Sl &lt;span class="m">1000&lt;/span> 0:00 /usr/bin/VBoxClient â€“seamless
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> &lt;span class="m">1491&lt;/span> &lt;span class="m">1477&lt;/span> &lt;span class="m">1477&lt;/span> ? -1 Sl &lt;span class="m">1000&lt;/span> 0:00 /usr/bin/VBoxClient â€“display
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åˆ›å»ºå®ˆæŠ¤è¿›ç¨‹æœ€å…³é”®çš„ä¸€æ­¥æ˜¯è°ƒç”¨setsidå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„Sessionï¼Œå¹¶æˆä¸ºSession Leaderã€‚
æˆåŠŸåˆ›å»ºå®ˆæŠ¤è¿›ç¨‹çš„æµç¨‹ä¸ºï¼š&lt;/p>
&lt;ol>
&lt;li>åˆ›å»ºä¸€ä¸ªæ–°çš„Sessionï¼Œå½“å‰è¿›ç¨‹æˆä¸ºSeesion Leaderï¼Œ å½“å‰è¿›ç¨‹çš„idå°±æ˜¯Session idï¼›&lt;/li>
&lt;li>åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹ç»„ï¼Œå½“å‰è¿›ç¨‹æˆä¸ºè¿›ç¨‹ç»„çš„Leaderï¼Œ å½“å‰è¿›ç¨‹çš„idå°±æ˜¯è¿›ç¨‹ç»„çš„idï¼›&lt;/li>
&lt;li>å¦‚æœå½“å‰è¿›ç¨‹åŸæœ¬æœ‰ä¸€ä¸ªæ§åˆ¶ç»ˆç«¯ï¼Œåˆ™å®ƒä¼šå¤±å»è¿™ä¸ªshellï¼Œæˆä¸ºä¸€ä¸ªæ²¡æœ‰shellçš„è¿›ç¨‹ï¼ˆå³å®ˆæŠ¤è¿›ç¨‹ï¼‰ã€‚&lt;/li>
&lt;/ol>
&lt;p>å¯ä»¥ä½¿ç”¨çš„å‘½ä»¤æœ‰ &lt;code>disown setsid nohup&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ tldr &lt;span class="nb">disown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Command &lt;span class="nb">disown&lt;/span> does not exist &lt;span class="k">for&lt;/span> the host platform. Displaying the page from linux platform
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">disown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Allow sub-processes to live beyond the shell that they are attached to.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> See also the &lt;span class="nb">jobs&lt;/span> command.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> More information: https://www.gnu.org/software/bash/manual/bash.html#index-disown.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Disown the current job:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">disown&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Disown a specific job:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">disown&lt;/span> %job_number
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Disown all jobs:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">disown&lt;/span> -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Keep job &lt;span class="o">(&lt;/span>&lt;span class="k">do&lt;/span> not &lt;span class="nb">disown&lt;/span> it&lt;span class="o">)&lt;/span>, but mark it so that no future SIGHUP is received on shell exit:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">disown&lt;/span> -h %job_number
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See also: &lt;span class="nb">jobs&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ man setsid &lt;span class="p">|&lt;/span> head
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SETSID&lt;span class="o">(&lt;/span>2&lt;span class="o">)&lt;/span> System Calls Manual SETSID&lt;span class="o">(&lt;/span>2&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> setsid â€“ create session and &lt;span class="nb">set&lt;/span> process group ID
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SYNOPSIS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#include &amp;lt;unistd.h&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pid_t
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> setsid&lt;span class="o">(&lt;/span>void&lt;span class="o">)&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="exit">exit&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exit&lt;span class="o">(&lt;/span>0&lt;span class="o">)&lt;/span> &lt;span class="c1">#è„šæœ¬/å‘½ä»¤æ­£å¸¸é€€å‡º&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">exit&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span> &lt;span class="c1"># è„šæœ¬/å‘½ä»¤å¼‚å¸¸é€€å‡º&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="--">$? &amp;amp;&amp;amp; ||&lt;/h2>
&lt;p>shell åœ¨æ‰§è¡ŒæŸä¸ªå‘½ä»¤çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ªè¿”å›å€¼ï¼Œè¯¥è¿”å›å€¼ä¿å­˜åœ¨ shell å˜é‡ $? ä¸­ã€‚
å½“ $? == 0 æ—¶ï¼Œè¡¨ç¤ºæ‰§è¡ŒæˆåŠŸï¼›å½“ $? == 1 æ—¶ï¼ˆé0è¿”å›å€¼ï¼Œä¸€èˆ¬åœ¨0-255é—´ï¼‰ï¼Œè¡¨ç¤ºæ‰§è¡Œå¤±è´¥ã€‚
shell æä¾›äº† &amp;amp;&amp;amp; å’Œ || æ¥å®ç°å‘½ä»¤æ‰§è¡Œflowæ§åˆ¶çš„åŠŸèƒ½ï¼Œshell å°†æ ¹æ® &amp;amp;&amp;amp; æˆ– || å‰é¢å‘½ä»¤çš„è¿”å›å€¼æ¥é€‰æ‹©æ‰§è¡Œåç»­å‘½ä»¤ã€‚&lt;/p>
&lt;h3 id="heading">&amp;amp;&amp;amp;&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">command1 &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> command2 &lt;span class="o">[&amp;amp;&amp;amp;&lt;/span> command3 ...&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>å‘½ä»¤ä¹‹é—´ä½¿ç”¨&lt;code>&amp;amp;&amp;amp;&lt;/code>è¿æ¥ï¼Œå®ç°é€»è¾‘ä¸çš„åŠŸèƒ½ï¼›&lt;/li>
&lt;li>åªæœ‰åœ¨ &lt;code>&amp;amp;&amp;amp;&lt;/code> å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ &lt;code>$? == 0&lt;/code>ï¼‰ï¼Œ&amp;amp;&amp;amp; å³è¾¹çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œï¼›&lt;/li>
&lt;li>åªè¦æœ‰ä¸€ä¸ªå‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ &lt;code>$? == 1&lt;/code>ï¼‰ï¼Œåé¢çš„å‘½ä»¤å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚ å³æ˜¯çŸ­è·¯çš„åŠŸèƒ½ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="heading-1">||&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">command1 &lt;span class="o">||&lt;/span> command2 &lt;span class="o">[||&lt;/span> command3 ...&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>å‘½ä»¤ä¹‹é—´ä½¿ç”¨ &lt;code>||&lt;/code> è¿æ¥ï¼Œå®ç° é€»è¾‘æˆ–çš„åŠŸèƒ½ï¼›&lt;/li>
&lt;li>åªæœ‰åœ¨&lt;code>||&lt;/code>å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ &lt;code>$? == 1&lt;/code>ï¼‰ï¼Œ&lt;code>||&lt;/code> å³è¾¹çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œã€‚è¿™å’Œ c è¯­è¨€ä¸­çš„é€»è¾‘æˆ–è¯­æ³•åŠŸèƒ½ç›¸åŒï¼Œå³å®ç°defultèµ‹å€¼æ“ä½œï¼›&lt;/li>
&lt;li>åªè¦æœ‰ä¸€ä¸ªå‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ &lt;code>$? == 0&lt;/code>ï¼‰ï¼Œåé¢çš„å‘½ä»¤å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="heading-2">$&lt;/h2>
&lt;p>shellè¯­å¥å˜é‡æ— éœ€å£°æ˜ï¼Œéœ€è¦å¼•ç”¨å˜é‡æŒ‡æ—¶ï¼Œ åœ¨å˜é‡åå‰æ·»åŠ $ç¬¦å·å³å¯ï¼ˆæœ‰æ—¶éœ€è¦é…åˆæ‹¬å·æ¶ˆé™¤æ­§ä¹‰ï¼‰:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">var&lt;/span>&lt;span class="o">=&lt;/span>hellhttp://sdf.com?uid&lt;span class="o">=&lt;/span>233&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="nv">pwd&lt;/span>&lt;span class="o">=&lt;/span>ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> var &lt;span class="c1"># var&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$var&lt;/span> &lt;span class="c1"># hellhttp://sdf.com?uid=233&amp;amp;pwd=ls&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">va&lt;/span>&lt;span class="o">=&lt;/span>he
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$valloworld&lt;/span> &lt;span class="c1"># æ— è¾“å‡ºï¼Œå› ä¸ºæ²¡æœ‰valloworldå˜é‡&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">va&lt;/span>&lt;span class="si">}&lt;/span>lloworld &lt;span class="c1"># hellworld&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="heading-3">$()&lt;/h3>
&lt;p>å…ˆæ‰§è¡Œæ‹¬å·é‡Œé¢çš„shellå‘½ä»¤ï¼Œç„¶åæŠŠæ‹¬å·é‡Œé¢shellå‘½ä»¤çš„è¾“å‡ºåšä¸ºæ–°çš„å‘½ä»¤å»æ‰§è¡Œã€‚
ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å¼•å·``ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="nb">echo&lt;/span> ls &amp;gt; abc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/codebase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="k">$(&lt;/span>less abc&lt;span class="k">)&lt;/span> &lt;span class="c1"># same as `less abc`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">abc gobookIread jsbook lol playaround
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/codebase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="k">$(&lt;/span>cat abc&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">abc gobookIread jsbook lol playaround
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/codebase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="k">$(&lt;/span>ls&lt;span class="k">)&lt;/span> &lt;span class="c1"># same as `ls`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">zsh: &lt;span class="nb">command&lt;/span> not found: abc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="nb">echo&lt;/span> &lt;span class="sb">`&lt;/span>date&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021å¹´11æœˆ17æ—¥ æ˜ŸæœŸä¸‰ 11æ—¶58åˆ†02ç§’ CST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ &lt;span class="nb">echo&lt;/span> &lt;span class="k">$(&lt;/span>date&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2021å¹´11æœˆ17æ—¥ æ˜ŸæœŸä¸‰ 11æ—¶58åˆ†10ç§’ CST
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="wget">wget&lt;/h2>
&lt;p>http basic auth&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget --no-check-certificate --user user --password pass https://server_address/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="curl">curl&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -I google.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -i google.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Post json file&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -vX POST http://localhost:9095/post -d @t.json -H &lt;span class="s2">&amp;#34;Content-Type: application/json&amp;#34;&lt;/span> -H &lt;span class="s1">&amp;#39;Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIxIiwiaWF0IjoxNTUxNDEyODY2LCJleHAiOjE1NTIwMTc2NjZ9.V6ZT8L_r_arIlxtRHul-FxKt4exErTkvNdYy7O_cR5A&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="argument">argument&lt;/h2>
&lt;h3 id="default-argument">default argument&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/local/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;begin&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">duration&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="s2">&amp;#34;3&amp;#34;&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="c1"># default 3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sleep &lt;span class="nv">$duration&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;finish&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#begin&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#2021å¹´11æœˆ17æ—¥ æ˜ŸæœŸä¸‰ 12æ—¶05åˆ†52ç§’ CST&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#finish&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#2021å¹´11æœˆ17æ—¥ æ˜ŸæœŸä¸‰ 12æ—¶05åˆ†55ç§’ CST&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#~ took 3s &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="loop">loop&lt;/h2>
&lt;p>bash æä¾› forå’Œwhileä¸¤ç§å¾ªç¯æ§åˆ¶&lt;/p>
&lt;h3 id="for">for&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># for in &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in abc.s&lt;span class="o">{&lt;/span>1..1000&lt;span class="o">}&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># for arguments&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">./for.sh x y z sdf&lt;span class="o">{&lt;/span>1..4&lt;span class="o">}&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="m">9&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#for a; do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># echo $a&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="while-read">while (read)&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> -r h&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> -n &lt;span class="nv">$h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#â¯ bash read-pwds.sh &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#abcde&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#abcdexyz&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#xyz% &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="macos">macos&lt;/h2>
&lt;h3 id="osascript">osascript&lt;/h3>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 312;
flex-basis: 749px"
>
&lt;a href="https://tab.deoops.com/posts/bash-command/mac.png" data-size="868x278">
&lt;img src="https://tab.deoops.com/posts/bash-command/mac.png"
width="868"
height="278"
srcset="https://tab.deoops.com/posts/bash-command/mac_hu5339105ebcd044e0ab56fca4fb90c867_103215_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/bash-command/mac_hu5339105ebcd044e0ab56fca4fb90c867_103215_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="macos osascript notification">
&lt;/a>
&lt;figcaption>macos osascript notification&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># must use sh for `at` command&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/usr/bin/osascript&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#display notification &amp;#34;Lorem ipsum dolor sit amet&amp;#34; with title &amp;#34;Title&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://apple.stackexchange.com/questions/57412/how-can-i-trigger-a-notification-center-notification-from-an-applescript-or-shel/115373#115373&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">osascript -e &lt;span class="s1">&amp;#39;display notification &amp;#34;åƒæ­¦æ±‰çƒ­å¹²é¢å•¦&amp;#34; with title &amp;#34;ç±³è¥¿ç±³è¥¿&amp;#34; &amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ¸…ç†git submodule</title><link>https://tab.deoops.com/posts/git-submodule/</link><pubDate>Tue, 16 Nov 2021 16:13:57 +0800</pubDate><guid>https://tab.deoops.com/posts/git-submodule/</guid><description>&lt;img src="https://tab.deoops.com/posts/git-submodule/git-submodule.png" alt="Featured image of post æ¸…ç†git submodule" />&lt;p>å½“æˆ‘ä»¬æœ¬åœ°å¯¹gitçš„submoduleç›®å½•ä¸‹çš„æ–‡ä»¶åšäº†æ”¹åŠ¨æ—¶ï¼Œä¼šå‘ç°ä¸è®ºæ˜¯ç”¨&lt;code>git checkout .&lt;/code>
è¿˜æ˜¯ &lt;code>git clean -df&lt;/code>éƒ½æ— æ³•ä¸¢å¼ƒä¿®æ”¹ã€‚ä½¿ç”¨&lt;code>git status&lt;/code>å‘½ä»¤æŸ¥çœ‹å·¥ä½œæ ‘çš„çŠ¶æ€æ—¶ä¼šæœ‰å¦‚ä¸‹
æŠ¥é”™ä¿¡æ¯&lt;code>git submodule modified content&lt;/code>&lt;/p>
&lt;h2 id="é”™è¯¯">é”™è¯¯&lt;/h2>
&lt;p>ä»¥hugoä¸ºä¾‹ï¼Œå½“ä½¿ç”¨&lt;code>hugo server&lt;/code>æœ¬åœ°é¢„è§ˆåšå®¢æ–‡ç« æ—¶ï¼Œ hugoä¼šä¿®æ”¹ä¸»é¢˜ç›®å½•çš„å†…å®¹ã€‚ä»è€Œå‡ºç° git submodule modified contentçš„é—®é¢˜ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ git status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ä½äºåˆ†æ”¯ main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">æ‚¨çš„åˆ†æ”¯é¢†å…ˆ &lt;span class="s1">&amp;#39;origin/main&amp;#39;&lt;/span> å…± &lt;span class="m">1&lt;/span> ä¸ªæäº¤ã€‚
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git push&amp;#34;&lt;/span> æ¥å‘å¸ƒæ‚¨çš„æœ¬åœ°æäº¤ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å°šæœªæš‚å­˜ä»¥å¤‡æäº¤çš„å˜æ›´ï¼š
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git add &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> æ›´æ–°è¦æäº¤çš„å†…å®¹ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git restore &amp;lt;æ–‡ä»¶&amp;gt;...&amp;#34;&lt;/span> ä¸¢å¼ƒå·¥ä½œåŒºçš„æ”¹åŠ¨ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ï¼ˆæäº¤æˆ–ä¸¢å¼ƒå­æ¨¡ç»„ä¸­æœªè·Ÿè¸ªæˆ–ä¿®æ”¹çš„å†…å®¹ï¼‰
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ä¿®æ”¹ï¼š themes/stack &lt;span class="o">(&lt;/span>ä¿®æ”¹çš„å†…å®¹&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ä¿®æ”¹å°šæœªåŠ å…¥æäº¤ï¼ˆä½¿ç”¨ &lt;span class="s2">&amp;#34;git add&amp;#34;&lt;/span> å’Œ/æˆ– &lt;span class="s2">&amp;#34;git commit -a&amp;#34;&lt;/span>ï¼‰
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªé—®é¢˜æŒºå¸¸è§çš„ï¼ŒGoogleåä½¿ç”¨ä¸‹é¢ä¸¤æ¡å‘½ä»¤å³å¯æ¸…ç†submoduleï¼š&lt;/p>
&lt;h2 id="meat">meat&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git submodule foreach --recursive git reset --hard
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git submodule update --recursive --init
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="https://stackoverflow.com/a/44669463" target="_blank" rel="noopener"
>How do I revert my changes to a git submodule?&lt;/a>&lt;/p>
&lt;h3 id="make">make&lt;/h3>
&lt;p>å»ºè®®åœ¨æ ¹ç›®å½•ä¸‹ç¼–å†™å†…å®¹å¦‚ä¸‹çš„&lt;code>Makefile&lt;/code>ï¼Œ ä»¥èŠ‚çœè¾“å…¥å‘½ä»¤çš„æ—¶é—´å’ŒåŠ å¼ºè®°å¿†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">clean&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -@git submodule deinit -f .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -@git submodule update --init --recursive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#git submodule deinit -f .
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#git submodule update --init
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰§è¡Œ&lt;code>make&lt;/code>å‘½ä»¤å³å¯æ¸…é™¤æœ¬åœ°å¯¹git submoduleçš„æ”¹åŠ¨ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ make
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å·²æ¸…é™¤ç›®å½• &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å­æ¨¡ç»„ &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span>ï¼ˆhttps://github.com/datewu/hugo-theme-stack.gitï¼‰æœªå¯¹è·¯å¾„ &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span> æ³¨å†Œ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å­æ¨¡ç»„ &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span>ï¼ˆhttps://github.com/datewu/hugo-theme-stack.gitï¼‰å·²å¯¹è·¯å¾„ &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span> æ³¨å†Œ
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">å­æ¨¡ç»„è·¯å¾„ &lt;span class="s1">&amp;#39;themes/stack&amp;#39;&lt;/span>ï¼šæ£€å‡º &lt;span class="s1">&amp;#39;aeb077874a7de9ce71304c990ad5cfdc72664f38&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>åŠ æ²¹</title><link>https://tab.deoops.com/posts/jia-you/</link><pubDate>Thu, 01 Jul 2021 10:54:49 +0800</pubDate><guid>https://tab.deoops.com/posts/jia-you/</guid><description>&lt;img src="https://tab.deoops.com/posts/jia-you/jiayou.jpeg" alt="Featured image of post åŠ æ²¹" />&lt;p>ä¸Šä¸ªå‘¨æœ«æ±Ÿæ±Ÿå›å®¶çœ‹å°å®å‘äº†å¥½å¤šè„¾æ°”ã€‚&lt;/p>
&lt;p>è¡¨é¢ä¸Šæ˜¯å’Œå¦ˆå¦ˆåµæ¶ï¼Œå®é™…ä¸Šè¿˜æ˜¯æ€ªæˆ‘æ²¡å·¥ä½œã€‚&lt;/p>
&lt;p>â€œä½ çˆ¸å¦ˆå…¶å®å¾ˆæƒ³ä½ å»ä¸Šç­ï¼Œåº”è¯¥æŠŠä½ èµ¶å‡ºå»ï¼Œå´æƒ³è®©æˆ‘æ¥å½“åäººã€‚è®©æˆ‘æ¥å’Œä½ åµæ¶ã€‚â€&lt;/p>
&lt;p>å·¥ä½œæ‰¾äº†3ä¸ªæœˆäº†ï¼Œç¡®å®å¾ˆå¯¹ä¸ä½å®¶äººä»¬çš„æœŸå¾…ã€‚&lt;/p>
&lt;p>è¿™å‘¨å››å»æ­¦æ±‰å§ï¼Œæ‰“å·¥æˆ–è€…åšç”Ÿæ„ï¼Œä¸åœ¨å®¶é‡Œå‘†ç€äº†ã€‚&lt;/p></description></item><item><title>'å°'å·</title><link>https://tab.deoops.com/posts/little-child/</link><pubDate>Tue, 01 Jun 2021 11:09:29 +0800</pubDate><guid>https://tab.deoops.com/posts/little-child/</guid><description>&lt;img src="https://tab.deoops.com/posts/little-child/child.jpeg" alt="Featured image of post 'å°'å·" />&lt;p>å‡Œæ™¨5ç‚¹ä¸åˆ°ï¼ŒäºŒæ¥¼çš„æˆ¿é—¨è¢«æ‰“å¼€ã€‚&lt;/p>
&lt;p>è€å¦ˆä¸‹æ¥ç¿»ç®±å€’æŸœæ‰¾ä¸œè¥¿ï¼Œæˆ‘ç¡çœ¼æœ¦èƒ§ï¼Œä¸æƒ…ä¸æ„¿çš„é—®äº†ä¸‹åœ¨æ‰¾ä»€ä¹ˆã€‚&lt;/p>
&lt;p>è€å¦ˆè¯´æœ‰æ²¡æœ‰çœ‹åˆ°è£…é’±çš„åŒ…åŒ…ã€‚&lt;/p>
&lt;p>å‡ å¥è¯äº¤æµä¸‹æ¥ï¼ŒåŸæ¥æ˜¯ä»Šå¤©å‡†å¤‡å»ä¹°èœï¼Œå‘ç°4000å¤šå—äººæ°‘å¸è¿é’±å¸¦åŒ…éƒ½ä¸è§äº†ï¼Œæœ€åä¸€æ¬¡æ‹¿é’±æ˜¯åœ¨3æ¥¼ã€‚&lt;/p>
&lt;p>ç»“åˆä»¥å¾€çš„ç»éªŒï¼Œæˆ‘è¯´åº”è¯¥æ˜¯&lt;code>åˆ&lt;/code>è¢«å°å­©å­å·ï¼Œè€å¦ˆæƒ³äº†æƒ³å»3æ¥¼äº†ã€‚&lt;/p>
&lt;p>åå¤šåˆ†é’Ÿåï¼Œæˆ‘å»3æ¥¼å»çœ‹çœ‹æƒ…å†µï¼Œæœç„¶æ˜¯è¢«å®¶é‡Œå…¨æ‰˜çš„4ä¸ªå°å­©å·äº†ã€‚&lt;/p>
&lt;p>æ¯å¤©å·100å—ï¼Œä¸»è¦æ˜¯ä¹°çƒ§çƒ¤ï¼Œå¹³å‡æ¯æ¬¡åƒ80å¤šå—é’±çš„çƒ§çƒ¤ã€‚&lt;/p>
&lt;p>4ä¸ªå°å­©ï¼Œå…¨éƒ¨çŸ¥æƒ…ï¼Œæ— ä¸€äººä¸ŠæŠ¥/æ­å‘ã€‚&lt;/p>
&lt;p>å…¶ä¸­ä¸€ä¸ªå°å¥³å­©ï¼Œè¯»2å¹´çº§ï¼Œç»å¸¸è¢«å¦å¤–3ç»™å°ç”·å­©æ¬ºè´Ÿï¼Œå¥¹è™½ç„¶æ²¡æœ‰åˆ†èµƒä½†ä¹Ÿæ˜¯å•¥ä¹Ÿä¸è¯´ã€‚&lt;/p>
&lt;p>3ä¸ªç”·å­©å­ï¼Œä¸¤ä¸ªè¯»2å¹´çº§ï¼Œä¸€ä¸ªè¯»4å¹´çº§ã€‚&lt;/p>
&lt;p>3ä¸ªç”·å­©å­åƒä¸å®Œçš„çƒ§çƒ¤å°±å¸¦ç»™å­¦æ ¡åˆ«çš„å°ä¼™ä¼´åƒï¼ˆä½†æ˜¯ä¸ç»™å¦å¤–å…¨æ‰˜çš„é‚£ä¸ªå¥³å­©å­ï¼‰ã€‚&lt;/p>
&lt;p>æˆ‘æŠŠä»–ä»¬ä¸€ä¸ªä¸ªå•ç‹¬æ‹‰å‡ºæ¥é—®è¯ã€‚&lt;/p>
&lt;p>ç»“æœæœ‰é—®é¢˜çš„æ˜¯äºŒå¹´çº§çš„aç”·ç”Ÿå’Œå››å¹´çº§çš„Aç”·ç”Ÿã€‚&lt;/p>
&lt;p>Aæœ‰å‰ç§‘ï¼Œåœ¨æˆ‘å®¶å·è¿‡å¥½å‡ æ¬¡ï¼Œåªæ˜¯æ•°é¢æ¯”è¾ƒå°ï¼Œæœ€å¤š20ã€‚&lt;/p>
&lt;p>å¦å¤–ï¼Œbç”·ç”Ÿçš„2000å¤šå—é’±çš„å„¿ç«¥æ‰‹è¡¨ä¸è§è¿‡å¥½å‡ æ¬¡ï¼Œæœ‰ä¸€æ¬¡æ˜¯Aå¸®ç€ä»açš„ä¹¦åŒ…é‡Œæœå‡ºæ¥äº†ï¼Œæ‰‹è¡¨ç”¨è¢‹å­åŒ…äº†å¥½å‡ å±‚ã€‚&lt;/p>
&lt;p>å›åˆ°è¿™æ¬¡å·é’±äº‹ä»¶ä¸Šã€‚&lt;/p>
&lt;p>aè™½ç„¶æ‰¿è®¤æ¯æ¬¡äº‹è‡ªå·±æ‹¿çš„é’±ï¼Œä½†æ˜¯ä¸€å£å’¬å®šè¯´ï¼šâ€œæ˜¯Aå«ä»–æ‹¿çš„ï¼Œä¸æ‹¿çš„è¯Aå°±æ‰“æ­»ä»–ã€‚&amp;quot;&lt;/p>
&lt;p>Aå¾ˆç‹¡çŒ¾ï¼Œå•¥ä¹Ÿä¸æ‰¿è®¤ã€‚&lt;/p>
&lt;p>ç»¼åˆæ‰€æœ‰äººçš„å£ä¾›ï¼Œæ€»çš„è¯´æ¥ï¼Œå°±æ˜¯ç½—ç”Ÿé—¨ï¼Œæ‰€æœ‰äººéƒ½è¯´è‡ªå·±æ²¡é—®é¢˜ï¼Œæˆ–è€…æ˜¯è¢«èƒè¿«çš„ã€‚&lt;/p>
&lt;p>æˆ‘å¿ƒä¸­æš—æƒ³ï¼Œå»åƒçƒ§çƒ¤çš„æ—¶å€™å’‹æ²¡è¯´æ˜¯è¢«èƒè¿«çš„ï¼ˆå°å¥³å­©é™¤å¤–ï¼Œä»–ä»¬ä¸å¸¦å¥¹å»åƒï¼‰ã€‚&lt;/p>
&lt;p>åªæ˜¯æ²¡æƒ³åˆ°9ï¼Œ10å²å¹´çºªçš„å°å­©å­å·²ç»å¯ä»¥æ¼”ç»ç½—ç”Ÿé—¨äº†ã€‚&lt;/p>
&lt;p>äººä¹‹åˆæ€§æœ¬å–„ï¼Œäººåˆ°åº•æ˜¯å•¥æ—¶å€™å¿˜è®°çš„æœ¬å¿ƒå‘¢ï¼Ÿ3å²ï¼Ÿ 5å²ï¼Ÿ&lt;/p>
&lt;p>æ•‘æ•‘å­©å­å§&lt;/p></description></item><item><title>19å…¬é‡Œ80å—</title><link>https://tab.deoops.com/posts/19-80/</link><pubDate>Thu, 20 May 2021 10:37:55 +0800</pubDate><guid>https://tab.deoops.com/posts/19-80/</guid><description>&lt;img src="https://tab.deoops.com/posts/19-80/taxi.jpeg" alt="Featured image of post 19å…¬é‡Œ80å—" />&lt;p>æ˜¨å¤©åœ¨æ­¦æ±‰æ‰“äº†ä¸ªçš„å£«ï¼Œ19å…¬é‡Œï¼Œ80å—ï¼Œè·¯å†µåŸºæœ¬ä¸€è·¯é€šç•…ï¼Œ3åˆ°4ä¸ªçº¢ç»¿ç¯ã€‚&lt;/p>
&lt;p>åœ¨2021å¹´ç½‘çº¦è½¦è¿™ä¹ˆå¤šçš„æƒ…å†µï¼Œçš„å£«å¸ˆå‚…è¿˜æ˜¯è¿™ä¹ˆç‹‚çš„ä¹Ÿæ˜¯å°‘è§ã€‚&lt;/p>
&lt;h2 id="ç»è¿‡">ç»è¿‡&lt;/h2>
&lt;p>æœ¬æ¥æ˜¯æ‰“å¼€æ»´æ»´ï¼Œå¼¹å‡ºæ¥&lt;code>é’èœæ‹¼è½¦&lt;/code>ï¼Œåªè¦40æ¥å—é’±ä¸¤ä¸ªäººï¼Œä½†æ˜¯ä¸€ç›´æ‹¼ä¸åˆ°ã€‚&lt;/p>
&lt;p>çœ‹äº†ä¸‹æ»´æ»´å¿«è½¦æ˜¯69å—ã€‚&lt;/p>
&lt;p>ä½†æ˜¯ç­‰äº†15æ¥åˆ†é’Ÿçš„æ‹¼è½¦ï¼Œè¿˜è¦èµ¶ç€å»å®¢è¿ç«™ï¼Œæ„Ÿè§‰è¢«æ»´æ»´è€äº†ï¼Œæ€’é€€å•ã€‚&lt;/p>
&lt;p>åŒè¡Œçš„ä¼™ä¼´è¯´æ‰“çš„å£«å§ï¼Œåº”è¯¥ä¸è´µã€‚&lt;/p>
&lt;p>è¿™ä¸ªæ­¦æ±‰çš„çš„å£«å¸ˆå‚…ï¼Œè¿˜æ˜¯ä¸ªå¥³å¸ˆå‚…ï¼ŒçœŸçš„æ˜¯å¤ªå¿ƒé»‘äº†ã€‚&lt;/p>
&lt;p>æ‰“è¡¨ï¼Œè·‘äº†16æ¥å…¬é‡Œå°±ä¸Š80å¤šå—é’±äº†ã€‚æˆ‘ä»¬æå‡ºæŠ—è®®åï¼Œå¤§æ–¹çš„è¯´â€œè¡Œï¼Œåæ­£å¿«åˆ°äº†äº†ï¼Œé‚£å°±ä¸æ‰“è¡¨äº†ï¼Œç»™80å°±è¡Œâ€ã€‚&lt;/p>
&lt;p>æƒ¹ä¸èµ·å¥¹ï¼Œè¾¾åˆ°ç›®çš„åœ° ç»™äº†80å—ã€‚&lt;/p>
&lt;h2 id="åè®°">åè®°&lt;/h2>
&lt;p>æœ€åæˆ‘ä»¬å‡ åèµ¶åˆ°å®¢è¿ç«™äº†ï¼Œä½†æ˜¯ç›´è¾¾è€å®¶çš„è½¦å»ä¿å…»äº†ï¼Œæˆ‘ä»¬è½¬äº†ä¸¤æ¬¡è½¦å›å®¶äº†ã€‚&lt;/p>
&lt;p>å¦å¤–åœ¨çš„å£«ä¸Šæ¥åˆ°äº†ä¸ªçº¦æˆ‘é¢è¯•çš„ç”µè¯:&amp;gt;&lt;/p></description></item><item><title>vscodeæŒ‰é”®è°ƒæ•´</title><link>https://tab.deoops.com/posts/vscode-hold/</link><pubDate>Sun, 09 May 2021 19:25:25 +0800</pubDate><guid>https://tab.deoops.com/posts/vscode-hold/</guid><description>&lt;img src="https://tab.deoops.com/posts/vscode-hold/vim-jkhl.png" alt="Featured image of post vscodeæŒ‰é”®è°ƒæ•´" />&lt;p>ä»Šå¤©å‘ç°&lt;code>vscodevim&lt;/code>æ’ä»¶ä¸èƒ½è¿ç»­è¾“å…¥æ–¹å‘é”®&lt;code>j&lt;/code>ï¼Œ ä»¥ä¸ºæ˜¯æ’ä»¶çš„é—®é¢˜ï¼Œå…³é—­äº†æ’ä»¶ã€‚&lt;/p>
&lt;p>å‘ç°åœ¨&lt;code>vscode&lt;/code>é‡ŒæŒ‰ä½&lt;code>j&lt;/code>ä¸æ”¾ï¼Œç¼–è¾‘å™¨å¹¶ä¸ä¼šè¿ç»­è¾“å…¥&lt;code>j&lt;/code>ã€‚&lt;/p>
&lt;p>éœ€è¦è°ƒæ•´ç³»ç»Ÿçš„&lt;code>dafaults&lt;/code>å…³é—­&lt;code>PressAndHold&lt;/code>é€‰é¡¹ï¼š&lt;/p>
&lt;p>&lt;a class="link" href="https://github.com/VSCodeVim/Vim/blob/master/README.md#mac" target="_blank" rel="noopener"
>enable key-repeating&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>To enable key-repeating, execute the following in your Terminal, log out and back in, and then restart VS Code:&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">defaults write com.microsoft.VSCode ApplePressAndHoldEnabled -bool &lt;span class="nb">false&lt;/span> &lt;span class="c1"># Enable key-repeating for vs code&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å¿«æ…¢æŒ‡é’ˆ</title><link>https://tab.deoops.com/posts/two-points/</link><pubDate>Mon, 19 Apr 2021 19:56:53 +0800</pubDate><guid>https://tab.deoops.com/posts/two-points/</guid><description>&lt;img src="https://tab.deoops.com/posts/two-points/Image-3.gif" alt="Featured image of post å¿«æ…¢æŒ‡é’ˆ" />&lt;p>4æœˆä»½è…¾è®¯é¢è¯•çš„æ—¶å€™è¢«é—®åˆ°å¦‚ä½•åœ¨ç©ºé—´å¤æ‚åº¦ä¸ºOï¼ˆ1ï¼‰å‰æä¸‹æ£€æŸ¥è¿è¡¨æ˜¯å¦ä¸ºé—­ç¯ï¼š&lt;/p>
&lt;p>å½“æ—¶æ²¡æƒ³å‡ºæ¥ï¼Œé¢è¯•å®˜æé†’ç”¨å¿«æ…¢æŒ‡é’ˆä¹Ÿæ²¡å†™å‡ºæ¥ã€‚&lt;/p>
&lt;p>å›åˆ°å®¶é‡Œæƒ³äº†ä¸‹ï¼Œå…¶å®å½“æ—¶å·²ç»æƒ³å‡ºæ¥äº†ï¼Œæ²¡æ•¢å†™å‡ºæ¥:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">circular&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">head&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">ListNode&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">slow&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fast&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">head&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">head&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">fast&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">fast&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Next&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">slow&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">slow&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Next&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fast&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">fast&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Next&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Next&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">slow&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">fast&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">false&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 133;
flex-basis: 320px"
>
&lt;a href="https://tab.deoops.com/posts/two-points/fast-slow-points.jpeg" data-size="960x720">
&lt;img src="https://tab.deoops.com/posts/two-points/fast-slow-points.jpeg"
width="960"
height="720"
srcset="https://tab.deoops.com/posts/two-points/fast-slow-points_hub5c5dabfad933cb82a6562cb6d3de6a5_42941_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/two-points/fast-slow-points_hub5c5dabfad933cb82a6562cb6d3de6a5_42941_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="Floydâ€™s slow and fast pointers approach">
&lt;/a>
&lt;figcaption>Floydâ€™s slow and fast pointers approach&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>è‡ªç ”</title><link>https://tab.deoops.com/posts/zi-yan/</link><pubDate>Wed, 31 Mar 2021 17:24:52 +0800</pubDate><guid>https://tab.deoops.com/posts/zi-yan/</guid><description>&lt;img src="https://tab.deoops.com/posts/zi-yan/open-source.png" alt="Featured image of post è‡ªç ”" />&lt;p>åŒäº‹é—®æˆ‘ï¼ŒæŠŠä¼ä¸šçš„&lt;code>harbor&lt;/code>é•œåƒä»“åº“æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ä¹‹åï¼Œæœ‰äººæš´åŠ›ç™»é™†æ€ä¹ˆåŠï¼Ÿ&lt;/p>
&lt;p>harboré»˜è®¤æ˜¯æ²¡æœ‰captchaçš„ï¼Œgoogleäº†å¾ˆä¹…ä¹Ÿæ²¡çœ‹åˆ°ã€‚&lt;/p>
&lt;p>å’‹åŠå‘¢ï¼Ÿ&lt;/p>
&lt;p>æ‰€ä»¥è¿˜æ˜¯è‡ªç ”çš„äº§å“å¥½å“¦ï¼Œéšéšä¾¿ä¾¿å°±å¯ä»¥åŠ ä¸ªæ‰‹æœºéªŒè¯ç ã€‚&lt;/p>
&lt;p>psï¼šä»Šå¤©æ˜¯åœ¨æ‹›å•†é‡‘ç§‘çš„æœ€åä¸€å¤©äº†ã€‚&lt;/p></description></item><item><title>React 17.0.2</title><link>https://tab.deoops.com/posts/react-17.0.2/</link><pubDate>Mon, 29 Mar 2021 17:02:01 +0800</pubDate><guid>https://tab.deoops.com/posts/react-17.0.2/</guid><description>&lt;img src="https://tab.deoops.com/posts/react-17.0.2/react-17.jpeg" alt="Featured image of post React 17.0.2" />&lt;p>ä»Šå¤©çœ‹åˆ°react 17.0.2 å‘å¸ƒä¸€ä¸ªç¤¼æ‹œäº†(å¿«æœ‰1å¹´æ²¡å¤§çš„æ›´æ–°äº†ï¼‰ï¼Œæƒ³å‡çº§è¯•ä¸€è¯•ï¼Œåœ¨é¡¹ç›®ä¸‹æ‰§è¡Œ &lt;code>npm update&lt;/code>æŒ‡ä»¤ï¼Œç»“æœæŠ¥é”™å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ— npm update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! code ERESOLVE
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! ERESOLVE unable to resolve dependency tree
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! Found: @babel/core@7.12.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! node_modules/@babel/core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @babel/core@&lt;span class="s2">&amp;#34;7.12.3&amp;#34;&lt;/span> from the root project
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @babel/core@&lt;span class="s2">&amp;#34;^7.9.0&amp;#34;&lt;/span> from @svgr/webpack@5.4.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! node_modules/@svgr/webpack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @svgr/webpack@&lt;span class="s2">&amp;#34;5.4.0&amp;#34;&lt;/span> from the root project
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! &lt;span class="m">9&lt;/span> more &lt;span class="o">(&lt;/span>babel-jest, babel-loader, ...&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! Could not resolve dependency:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! peer @babel/core@&lt;span class="s2">&amp;#34;^7.13.0&amp;#34;&lt;/span> from @babel/plugin-bugfix-v8-spread-parameters-in-optional-chaining@7.13.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! node_modules/@babel/preset-env/node_modules/@babel/plugin-bugfix-v8-spread-parameters-in-optional-chaining
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @babel/plugin-bugfix-v8-spread-parameters-in-optional-chaining@&lt;span class="s2">&amp;#34;^7.13.12&amp;#34;&lt;/span> from @babel/preset-env@7.13.12
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! node_modules/@babel/preset-env
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @babel/preset-env@&lt;span class="s2">&amp;#34;^7.9.5&amp;#34;&lt;/span> from @svgr/webpack@5.4.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! node_modules/@svgr/webpack
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! @svgr/webpack@&lt;span class="s2">&amp;#34;5.4.0&amp;#34;&lt;/span> from the root project
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! Fix the upstream dependency conflict, or retry
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! this &lt;span class="nb">command&lt;/span> with --force, or --legacy-peer-deps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! to accept an incorrect &lt;span class="o">(&lt;/span>and potentially broken&lt;span class="o">)&lt;/span> dependency resolution.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR!
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! See /Users/r/.npm/eresolve-report.txt &lt;span class="k">for&lt;/span> a full report.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! A &lt;span class="nb">complete&lt;/span> log of this run can be found in:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm ERR! /Users/r/.npm/_logs/2021-03-30T08_44_22_160Z-debug.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªé¡¹ç›®è¿è¡Œè¿‡ &lt;code>npm run eject&lt;/code>ï¼Œæ‰€ä»¥æ‹…å¿ƒæ˜¯ejecté€ æˆçš„ã€‚&lt;/p>
&lt;p>äºæ˜¯åœ¨å¦å¤–ä¸€ä¸ªç›®å½•æ‰§è¡Œ&lt;code>npx create-react-app abc&lt;/code>å‘½ä»¤åšæ¥ä¸€ä¸ªå¯¹ç…§ç»„ã€‚&lt;/p>
&lt;p>æŠŠ&lt;code>abc&lt;/code>é¡¹ç›®ejectåå‘ç°npm installä¾ç„¶ä¼šå¤±è´¥ã€‚&lt;/p>
&lt;p>googleå‘ç°æœ‰ç±»ä¼¼çš„&lt;a class="link" href="https://www.gitmemory.com/issue/facebook/create-react-app/10738/807720421" target="_blank" rel="noopener"
>é­é‡&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Humm, if I see things correctly, the resolving dependency error occurs because create-react-app has the &amp;ldquo;@babel/core&amp;rdquo;: dependency fixed to &amp;ldquo;7.12.3&amp;rdquo; in its &amp;ldquo;packages.json&amp;rdquo; file. 3 days ago, @babel/plugin-bugfix-v8-spread-parameters-in-optional-chaining was merged to Babe master branch that requires &amp;ldquo;@babel/core&amp;rdquo; dependency to be &amp;ldquo;7.13.0&amp;rdquo; or greater. I don&amp;rsquo;t know create-react-app too well, but would perhaps relaxing the &amp;ldquo;@babel/core&amp;rdquo; dependency to &amp;ldquo;^7.12.3&amp;rdquo; be a proper way to fix this issue?&lt;/p>
&lt;/blockquote>
&lt;p>ä¿®æ”¹package.jsonæ–‡ä»¶ï¼Œæ·»åŠ &amp;quot;@babel/core&amp;quot;: &amp;ldquo;7.13.14&amp;rdquo;, ä¾èµ–ï¼Œé‡æ–°npm install æ¢å¤æ­£å¸¸ã€‚&lt;/p>
&lt;p>ä¸€ä¸‹æ˜¯å®Œæ•´çš„package.jsonæ–‡ä»¶ï¼Œä¾›å‚è€ƒ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;name&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;abc&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;version&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;0.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;private&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;proxy&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;http://localhost:8080&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;dependencies&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@babel/core&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;7.13.14&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@material-ui/core&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^4.11.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@material-ui/icons&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^4.11.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@pmmmwh/react-refresh-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;0.4.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@svgr/webpack&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;5.5.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@testing-library/jest-dom&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^5.11.10&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@testing-library/react&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^11.2.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@testing-library/user-event&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^12.8.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@tinymce/tinymce-react&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^3.12.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@typescript-eslint/eslint-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^4.5.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;@typescript-eslint/parser&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^4.5.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-eslint&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^10.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-jest&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^26.6.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;8.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-plugin-named-asset-import&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^0.3.7&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-preset-react-app&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^10.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;bfj&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^7.0.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;camelcase&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^6.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;case-sensitive-paths-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;2.3.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;css-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.3.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;dotenv&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;8.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;dotenv-expand&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;5.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^7.11.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-config-react-app&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^6.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-flowtype&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^5.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-import&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^2.22.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-jest&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^24.1.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-jsx-a11y&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^6.3.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-react&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^7.21.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-react-hooks&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^4.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-plugin-testing-library&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^3.9.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslint-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^2.5.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;file-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;6.1.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;fs-extra&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^9.0.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;html-react-parser&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^1.2.4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;html-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.5.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;identity-obj-proxy&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;3.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;jest&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;26.6.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;jest-circus&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;26.6.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;jest-resolve&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;26.6.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;jest-watch-typeahead&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;0.6.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;js-base64&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^3.6.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;mini-css-extract-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;0.11.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;optimize-css-assets-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;5.0.4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;pnp-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.6.4&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;postcss-flexbugs-fixes&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.2.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;postcss-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;3.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;postcss-normalize&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;8.0.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;postcss-preset-env&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;6.7.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;postcss-safe-parser&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;5.0.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;prismjs&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^1.23.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;prompts&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;2.4.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^17.0.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-app-polyfill&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^2.0.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-dev-utils&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^11.0.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-dom&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^17.0.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-hook-form&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^6.15.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-refresh&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^0.8.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;react-router-dom&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^5.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;resolve&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.18.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;resolve-url-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^3.1.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;sass-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^10.0.5&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;semver&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;7.3.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;style-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.3.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;terser-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.2.3&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;tinymce&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^5.7.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;ts-pnp&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;1.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;url-loader&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.1.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;web-vitals&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^1.1.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;webpack&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;4.44.2&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;webpack-dev-server&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;3.11.1&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;webpack-manifest-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;2.2.0&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;workbox-webpack-plugin&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;5.1.4&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;scripts&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;start&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;node scripts/start.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;build&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;node scripts/build.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;test&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;node scripts/test.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;eslintConfig&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;extends&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;react-app&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;react-app/jest&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;browserslist&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;production&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;gt;0.2%&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;not dead&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;not op_mini all&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;development&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;last 1 chrome version&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;last 1 firefox version&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;last 1 safari version&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;jest&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;roots&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/src&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;collectCoverageFrom&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;src/**/*.{js,jsx,ts,tsx}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;!src/**/*.d.ts&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;setupFiles&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;react-app-polyfill/jsdom&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;setupFilesAfterEnv&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/src/setupTests.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;testMatch&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/src/**/__tests__/**/*.{js,jsx,ts,tsx}&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/src/**/*.{spec,test}.{js,jsx,ts,tsx}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;testEnvironment&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;jsdom&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;testRunner&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;/Users/r/repo/github/blog-fn/node_modules/jest-circus/runner.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;transform&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;^.+\\.(js|jsx|mjs|cjs|ts|tsx)$&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/config/jest/babelTransform.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;^.+\\.css$&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/config/jest/cssTransform.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;^(?!.*\\.(js|jsx|mjs|cjs|ts|tsx|css|json)$)&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;&amp;lt;rootDir&amp;gt;/config/jest/fileTransform.js&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;transformIgnorePatterns&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;[/\\\\]node_modules[/\\\\].+\\.(js|jsx|mjs|cjs|ts|tsx)$&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;^.+\\.module\\.(css|sass|scss)$&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;modulePaths&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;moduleNameMapper&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;^react-native$&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;react-native-web&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;^.+\\.module\\.(css|sass|scss)$&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;identity-obj-proxy&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;moduleFileExtensions&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;web.js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;js&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;web.ts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;ts&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;web.tsx&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;tsx&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;json&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;web.jsx&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;jsx&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;node&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;watchPlugins&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;jest-watch-typeahead/filename&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;jest-watch-typeahead/testname&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;resetMocks&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;presets&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;react-app&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;devDependencies&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;babel-plugin-prismjs&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;^2.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>é¡ºä¸°åŒ…è£¹</title><link>https://tab.deoops.com/posts/sf-sz/</link><pubDate>Sat, 20 Mar 2021 17:11:26 +0800</pubDate><guid>https://tab.deoops.com/posts/sf-sz/</guid><description>&lt;img src="https://tab.deoops.com/posts/sf-sz/sf.jpeg" alt="Featured image of post é¡ºä¸°åŒ…è£¹" />&lt;p>å¿«ä»æ·±åœ³å›è€å®¶äº†ï¼Œä¸œè¥¿ä¸¢çš„å·®ä¸å¤šäº†ï¼Œå‰©ä¸‹çš„ä¸œè¥¿ç›´æ¥é¡ºä¸°å¯„å›å®¶ã€‚&lt;/p>
&lt;p>ä¸€å…±å¯„äº†3æ¬¡é¡ºä¸°åŒ…è£¹ã€‚&lt;/p>
&lt;p>å‰ä¸¤æ¬¡çš„é‚£ä¸ªå·¥ä½œäººå‘˜ï¼Œ6å—é’±ä¸€ä¸ªçº¸ç®±ï¼Œè€Œä¸”æŒ‰ç…§ä½“ç§¯ç®—ã€‚&lt;/p>
&lt;p>ç¬¬ä¸€æ¬¡ç®—äº†69kgï¼š4ä¸ªåŒ…è£¹ï¼Œ288+21å…ƒï¼Œ&lt;/p>
&lt;p>ç¬¬äºŒæ¬¡ç®—äº†51kgï¼š 3ä¸ªåŒ…è£¹åŠ ä¸€ä¸ªå°åŒ…è£¹ 216 + 21å…ƒã€‚&lt;/p>
&lt;p>ç¬¬ä¸‰æ¬¡æ¢äº†ä¸ªå·¥ä½œäººå‘˜ç®—äº†38kgï¼šä¸¤ä¸ªçº¸ç®±å’Œæˆ‘è‡ªå·±ç…¤æ°”ç¶çš„çº¸ç®±ä¸ç®— 173 + 21å…ƒã€‚&lt;/p>
&lt;p>ç¬¬ä¸€æ¬¡ç®—äº†4ä¸ªçº¸ç®± 4 * 6 = 24 å—ï¼Œç¬¬äºŒæ¬¡ç®—äº†3ä¸ªçº¸ç®± 3 * 6 = 18 å…ƒï¼Œ ç¬¬ä¸‰æ¬¡æ²¡æœ‰æ”¶çº¸ç®±çš„é’±ã€‚&lt;/p>
&lt;p>ç®—ä¸‹æ¥ï¼Œå¯„çš„è¶Šé‡è¶Šçœé’±ã€‚&lt;/p>
&lt;h3 id="update">update&lt;/h3>
&lt;p>ä»Šå¤©ï¼ˆ3æœˆ31å·ï¼‰å¯„äº†æœ€åä¸€æ¬¡å¿«é€’ï¼Œ33kgã€‚ä¸¤ä¸ªçº¸ç®±ï¼Œä¸€å¤§ä¸€å°ï¼Œå†åŠ ä¸€ä¸ªå¸ç¯·çš„åŒ…ã€‚ä¸€å…± 148 +12 = 169å…ƒã€‚&lt;/p>
&lt;p>çº¸ç®±æ²¡æœ‰æ”¶è´¹ã€‚&lt;/p></description></item><item><title>è°ƒè¯•golangæµ‹è¯•</title><link>https://tab.deoops.com/posts/go-test/</link><pubDate>Wed, 14 Oct 2020 18:38:01 +0800</pubDate><guid>https://tab.deoops.com/posts/go-test/</guid><description>&lt;img src="https://tab.deoops.com/posts/go-test/ta_moderationworkflow.png" alt="Featured image of post è°ƒè¯•golangæµ‹è¯•" />&lt;p>è°ƒè¯•æŸä¸ªgo testç¨‹åºçš„æ—¶å€™ï¼Œéœ€è¦å®ç°&lt;code>confirm/approve&lt;/code>åŠŸèƒ½:&lt;/p>
&lt;blockquote>
&lt;p>æµ‹è¯•å®Œ&lt;code>testCase1&lt;/code>ä¹‹åï¼ˆæˆ–è€…è¯´æ˜¯æŸä¸ªæ–­ç‚¹ï¼‰ï¼Œç”¨æˆ·è¾“å…¥&lt;code>yes&lt;/code>ï¼Œæ‰§è¡Œä¸‹ä¸€ä¸ª&lt;code>case&lt;/code>ï¼Œè¾“å…¥&lt;code>no&lt;/code>ï¼Œ åˆ™é€€å‡ºæ•´ä¸ªæµ‹è¯•ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="åˆ†æ">åˆ†æ&lt;/h2>
&lt;p>ä¸‹æ„è¯†çš„è§‰å¾—è¿™ä¸ªå¾ˆå¥½å®ç°ï¼Œè°ƒç”¨&lt;code>fmt.Scan&lt;/code>åº”è¯¥å°±OKäº†ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å†™çš„æ—¶å€™æ‰å‘ç°ï¼Œ&lt;code>go test&lt;/code> ä¼šå¼ºåˆ¶é‡å®šå‘&lt;code>os.Stdin = /dev/null&lt;/code>å¿½ç•¥æ‰€æœ‰çš„ stdinè¾“å…¥ï¼Œ&lt;/p>
&lt;p>æ‰€ä»¥æ²¡æ³•ä½¿ç”¨ &lt;code>fmt.Scan&lt;/code>æ¥ç­‰å¾…é”®ç›˜(ç”¨æˆ·)çš„è¾“å…¥ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// fmt.Scan reads from os.Stdin, which is set to /dev/null when testing.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Tests should be automated and self-contained anyway, so you don&amp;#39;t want
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// to read from stdin.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// Either use an external file, a bytes.Buffer, or a strings.Reader and
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// call scan.Fscan if you want to test **the literal** `scan` Function.
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>å¯ä»¥&lt;a class="link" href="https://tab.deoops.com/posts/shell-fifo/" >å‚è€ƒäº‹ä»¶é©±åŠ¨&lt;/a>ï¼Œä½¿ç”¨&lt;code>named pipes&lt;/code>æ¥å®ç°&lt;code>confirm/approve&lt;/code>åŠŸèƒ½ï¼š&lt;/p>
&lt;h3 id="æ¶ˆè´¹è€…">æ¶ˆè´¹è€…&lt;/h3>
&lt;p>å…ˆå†™ä¸€ä¸ªæ¶ˆè´¹è€…çš„å‡½æ•°&lt;code>readPipe&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;bufio&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;os&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="mi">6&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">readPipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">readPipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">f&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Open&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;pipe&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatalln&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">defer&lt;/span> &lt;span class="nx">f&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">reader&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bufio&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewScanner&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="nx">reader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Scan&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">reader&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Text&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶ååœ¨æµ‹è¯•çš„caseé‡Œè°ƒç”¨&lt;code>readPipe&lt;/code>å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;testing&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestCase1&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;testing test case 1&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;test case 1 tested&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">readPipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestCase2&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;testing test case 2&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;test case 2 tested&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">readPipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">TestCase3&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">T&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;testing test case 3&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;test case 3 tested&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">readPipe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ç”Ÿæˆè€…">ç”Ÿæˆè€…&lt;/h3>
&lt;p>åˆ›å»º&lt;code>pipe&lt;/code>ï¼Œç„¶åå¾€pipeé‡Œå†™æ•°æ®ï¼Œå°±å¯ä»¥è§¦å‘(&lt;code>unblock&lt;/code>)æ¶ˆè´¹è€…è¿›ç¨‹ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">âœ ~ mkfifo pipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ ls -alh pipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">prw-r--r-- &lt;span class="m">1&lt;/span> r staff 0B &lt;span class="m">4&lt;/span> &lt;span class="m">24&lt;/span> 16:32 pipe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†™å…¥æ•°æ®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">âœ ~ date &amp;gt; pipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ date &amp;gt; pipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ date &amp;gt; pipe
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æµ‹è¯•">æµ‹è¯•&lt;/h2>
&lt;p>è°ƒè¯•çš„ç»“æœå¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">âœ ~ go &lt;span class="nb">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">testing &lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">1&lt;/span> tested
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span> 2020å¹´ 4æœˆ24æ—¥ æ˜ŸæœŸäº” 16æ—¶31åˆ†50ç§’ CST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">testing &lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">2&lt;/span> tested
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">2&lt;/span> 2020å¹´ 4æœˆ24æ—¥ æ˜ŸæœŸäº” 16æ—¶31åˆ†59ç§’ CST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">testing &lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">test&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="m">3&lt;/span> tested
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">3&lt;/span> 2020å¹´ 4æœˆ24æ—¥ æ˜ŸæœŸäº” 16æ—¶32åˆ†08ç§’ CST
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PASS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ok abc 36.016s
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ›´æ¢brewæº</title><link>https://tab.deoops.com/posts/brew-repo/</link><pubDate>Fri, 14 Aug 2020 11:33:00 +0800</pubDate><guid>https://tab.deoops.com/posts/brew-repo/</guid><description>&lt;img src="https://tab.deoops.com/posts/brew-repo/homebrew-social-card.png" alt="Featured image of post æ›´æ¢brewæº" />&lt;p>å›½å†…ç½‘ç»œç¯å¢ƒæ—¥ç›Šæ¶åŠ£ï¼Œæ‰§è¡Œ&lt;code>brew update/upgrade&lt;/code>èŠ±è´¹çš„æ—¶é—´å¤Ÿæˆ‘æ³¡å¥½ä¸€å£¶æ™®æ´±èŒ¶ã€‚&lt;/p>
&lt;p>ä¸è¿‡å¥½æ™¯ä¸é•¿ï¼Œè°èƒ½æƒ³åˆ°é‚£ä¹ˆå¤§çš„æ™®æ´±èŒ¶é¥¼ï¼Œæ—¥ç§¯æœˆç´¯ä¸€ç‚¹ç‚¹çš„è¢«æˆ‘å–å®Œäº†ã€‚&lt;/p>
&lt;p>å“ï¼Œæ€€æ‹æ™®æ´±èŒ¶å‘€ã€‚ æ²¡äº†æ™®æ´±èŒ¶ï¼Œæˆ‘å†³å®šæ¢äº†brewçš„å®˜æ–¹æºï¼Œç»™è‡ªå·±èŠ‚çº¦èŠ‚çº¦ç”Ÿå‘½ã€‚&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>æŒ‘æŒ‘æ‹£æ‹£ä¸€åœˆä¹‹åï¼Œæˆ‘å†³å®šä½¿ç”¨æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™]çš„brewæºã€‚&lt;/p>
&lt;p>æŒ‰ç…§&lt;a class="link" href="https://mirrors.tuna.tsinghua.edu.cn/help/homebrew/" target="_blank" rel="noopener"
>å®˜ç½‘çš„&lt;/a>æŒ‡å¼•å¾ˆå¿«å°±æ¢å¥½äº†repoï¼Œæ•ˆæœå¾ˆå¥½ã€‚&lt;/p>
&lt;p>å’Œ&lt;a class="link" href="https://tab.deoops.com/posts/macos-dns/" >è®¾ç½®macos DNS servers&lt;/a>ä¸€æ ·æˆ‘ä¹Ÿæ•´ç†äº†ä¸ªshellè„šæœ¬ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/local/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>set_qh&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo homebrew/core&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo homebrew/cask&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># revocer&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">recover&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://github.com/Homebrew/brew.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo homebrew/core&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://github.com/Homebrew/homebrew-core.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> git -C &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>brew --repo homebrew/cask&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> remote set-url origin https://github.com/Homebrew/homebrew-cask.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">a&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="s2">&amp;#34;check&amp;#34;&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="c1"># default to check&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;r&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> recover
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;set&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> set_qh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;check&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;goping to EXPORT HOMEBREW_BOTTLE_DOMAIN&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> &lt;span class="nv">HOMEBREW_BOTTLE_DOMAIN&lt;/span>&lt;span class="o">=&lt;/span>https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$HOMEBREW_BOTTLE_DOMAIN&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew config &lt;span class="p">|&lt;/span> grep ORIGIN
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brew cleanup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$a&lt;/span> successed!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šé¢çš„bashè„šæœ¬æ”¯æŒ3ä¸ªå‚æ•° &lt;code>check&lt;/code>,&lt;code>set&lt;/code>å’Œ &lt;code>recover&lt;/code>ï¼Œé»˜è®¤ä½¿ç”¨ &lt;code>check&lt;/code>å‚æ•°ã€‚&lt;/p>
&lt;p>ä¿å­˜ä¸º&lt;code>set-brew-repo.sh&lt;/code>æ–‡ä»¶ï¼Œå†åŠ ä¸Šå¯æ‰§è¡Œæƒé™å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">âœ ~ chmod +x set-brew-repo.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ ./set-brew-repo.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>è®¾ç½®dns</title><link>https://tab.deoops.com/posts/macos-dns/</link><pubDate>Wed, 10 Jun 2020 22:20:03 +0800</pubDate><guid>https://tab.deoops.com/posts/macos-dns/</guid><description>&lt;img src="https://tab.deoops.com/posts/macos-dns/dns-resolver.png" alt="Featured image of post è®¾ç½®dns" />&lt;p>ä¼—æ‰€å‘¨çŸ¥ï¼Œä¿®æ”¹&lt;a class="link" href="https://en.wikipedia.org/wiki/Resolv.conf" target="_blank" rel="noopener"
>&lt;code>/etc/resolv.conf&lt;/code>&lt;/a>é…ç½®æ–‡ä»¶å¯ä»¥é…ç½®Linuxçš„dns è§£ææœåŠ¡å™¨ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@VM-8-3-centos ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /etc/resolv.conf &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Generated by NetworkManager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 183.60.83.19
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 183.60.82.98
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é‚£ä¹ˆè‹¹æœç³»ç»Ÿçš„dns è§£ææœåŠ¡å™¨åº”è¯¥åœ¨å“ªé‡Œé…ç½®å‘¢ï¼Œä¹Ÿæ˜¯é…ç½®/etc/resolv.confæ–‡ä»¶å—ï¼Ÿ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ ~ cat /etc/resolv.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># macOS Notice&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This file is not consulted for DNS hostname resolution, address&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># resolution, or the DNS query routing mechanism used by most&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># processes on this system.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># To view the DNS configuration used by this system, use:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># scutil --dns&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># SEE ALSO&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># dns-sd(1), scutil(8)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This file is automatically generated.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 127.0.0.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nameserver 192.168.1.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ•…äº‹">æ•…äº‹&lt;/h2>
&lt;p>å› ä¸ºæ–°å† çš„çˆ†å‘ï¼Œå…¬å¸ä¸‹æ”¾äº†VPNæƒé™ï¼Œå¯ä»¥åœ¨å®¶æ¥å…¬å¸åŠå…¬ç½‘ç»œåŠå…¬ã€‚&lt;/p>
&lt;p>è¿™æ®µæ—¶é—´æˆ‘åœ¨å®¶äº«å—ä¸æ»‘é¡ºç•…çš„åŠå…¬å†…ç½‘ç½‘ç»œï¼ŒåŸºæœ¬æ²¡é‡åˆ°å•¥é—®é¢˜ï¼Œæ¯å¤©éƒ½ç¾æ»‹æ»‹çš„ã€‚&lt;/p>
&lt;p>æ˜¨å¤©æ‰‹æœºè¿è¥å•†&lt;strong>è”é€š&lt;/strong>çªç„¶æ‰“ç”µè¯ç»™æˆ‘è¯´ï¼Œæˆ‘çš„æ‰‹æœºæ˜¯5Gæ‰‹æœºï¼Œè®¾ç½®ä¸€ä¸‹ç½‘ç»œæ¨¡å¼å¯ä»¥åœ¨åŸæœ‰4Gçš„å¥—é¤ä¸Šä½¿ç”¨5Gç½‘ç»œå•¦ï¼Œè¯šé‚€æˆ‘ä½“éªŒã€‚&lt;/p>
&lt;p>é‚£ä¹ˆ&lt;strong>è”é€š&lt;/strong>æ˜¯&lt;strong>æ€ä¹ˆçŸ¥é“&lt;/strong>æˆ‘ä½¿ç”¨çš„æ˜¯5Gæ‰‹æœºçš„å‘¢ï¼Ÿï¼Ÿï¼Ÿè¿™ä¸ªå…ˆæŒ‰ä¸‹ä¸è¡¨ã€‚&lt;/p>
&lt;p>æˆ‘ç¨ç¨ä½“éªŒäº†ä¸€ä¼šï¼Œ5Gç½‘ç»œçš„é€Ÿåº¦å’Œæ—¶å»¶æœç„¶å’Œå®£ä¼ ä¸­çš„ä¸€æ ·ç‰›é€¼ã€‚&lt;/p>
&lt;p>æˆ‘ä¸ç”±çš„æ„Ÿå¹ï¼šåä¸ºæœç„¶ğŸ‚ğŸºã€‚&lt;/p>
&lt;p>è¿™ä¹ˆå¥½çš„ç½‘ç»œè´¨é‡ï¼Œä¸åº”è¯¥è®©ç¬”è®°æœ¬ä¹Ÿäº«å—äº«å—å—ï¼Ÿ&lt;/p>
&lt;p>è¯ä¸å¤šè¯´æˆ‘ç«‹é©¬æŠŠè‹¹æœç”µè„‘è¿æ¥ä¸Šäº†æ‰‹æœºçƒ­ç‚¹ï¼Œç”¨äº†ä¸å¤šä¹…å°±å‘ç°é‡åˆ°äº†DNSçš„é—®é¢˜ã€‚&lt;/p>
&lt;h3 id="é—®é¢˜">é—®é¢˜&lt;/h3>
&lt;p>è‹¹æœç¬”è®°æœ¬è¿æ¥æ‰‹æœºçƒ­ç‚¹çš„Wi-Fiåï¼Œæ‰‹æœºçƒ­ç‚¹ ä¸ä¼šä½¿ç”¨ VPNæŒ‡å®šçš„DNS serverå»è§£æ åŠå…¬ç½‘ç»œçš„å†…ç½‘åœ°å€ï¼Œå¯¼è‡´æ— å¦¨è®¿é—®å†…ç½‘åŸŸåã€‚&lt;/p>
&lt;h3 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h3>
&lt;p>è§£å†³çš„åŠæ³•ä¹Ÿå¾ˆç®€å•ï¼šæ‰“å¼€ è®¾ç½®-&amp;gt; ç½‘ç»œ -&amp;gt; WI-Fi -&amp;gt; é«˜çº§ -&amp;gt; DNS -&amp;gt; ä¿®æ”¹DNS æœåŠ¡å™¨ å³å¯ã€‚&lt;/p>
&lt;p>é¼“æ£ä¸€ä¼šå‘ç°ï¼Œæ¯æ¬¡æ“ä½œdns serveréƒ½éœ€è¦ç”¨é¼ æ ‡ç‚¹å‡»UIï¼Œå†ç‚¹å‡»6æ¬¡å­èœå•ï¼Œå¤åˆ¶ä¸¤æ¬¡DNS server çš„IP åœ°å€ï¼Œæ‰èƒ½å®Œæˆè®¾ç½®ï¼Œè¿™ç§æ“ä½œå¾ˆä¸ç¨‹åºå‘˜ã€‚&lt;/p>
&lt;p>äºæ˜¯æœç´¢äº†macosè®¾ç½®dns serversçš„å‘½ä»¤ï¼ŒæŠŠä¸Šé¢çš„UIæ“ä½œè„šæœ¬åŒ–äº†ã€‚æ•´ç†äº†ä¸€ä»½&lt;code>bash&lt;/code>è„šæœ¬å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/local/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="nv">a&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="k">:-&lt;/span>&lt;span class="nv">check&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">a&lt;/span>&lt;span class="si">}&lt;/span>ing ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#dns=&amp;#34;100.67.174.10 100.67.174.11&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">dns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;100.67.174.10 100.67.174.11&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;check&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -getinfo wi-fi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -getdnsservers wi-fi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;set&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -setdnsservers wi-fi &lt;span class="nv">$dns&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -getdnsservers wi-fi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;clear&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -setdnsservers wi-fi Empty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> networksetup -getdnsservers wi-fi
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$a&lt;/span> successed!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è„šæœ¬æ”¯æŒ3ä¸ªå‚æ•° &lt;code>check&lt;/code>,&lt;code>set&lt;/code>å’Œ &lt;code>clear&lt;/code>ï¼Œé»˜è®¤ä½¿ç”¨ &lt;code>check&lt;/code>å‚æ•°ã€‚&lt;/p>
&lt;p>ä¿å­˜ä¸º&lt;code>set-dns.sh&lt;/code>æ–‡ä»¶ï¼Œå†åŠ ä¸Šå¯æ‰§è¡Œæƒé™å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ ~ chmod +x set-dns.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ ./set-dns.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>tclå…¥é—¨</title><link>https://tab.deoops.com/posts/tcl-101/</link><pubDate>Tue, 19 May 2020 16:41:43 +0800</pubDate><guid>https://tab.deoops.com/posts/tcl-101/</guid><description>&lt;img src="https://tab.deoops.com/posts/tcl-101/tcl-tk.jpeg" alt="Featured image of post tclå…¥é—¨" />&lt;p>ä½¿ç”¨äº†ä¸€æ®µæ—¶é—´&lt;a class="link" href="https://tab.deoops.com/posts/expect-interactive/" >Expectè‡ªåŠ¨åŒ–å·¥å…·ç®€ä»‹&lt;/a>é‡Œé¢çš„&lt;code>expect&lt;/code>è„šæœ¬ï¼Œå‘ç°å°‘äº†ä¸€äº›åŠŸèƒ½ï¼š&lt;/p>
&lt;ol>
&lt;li>æ€ä¹ˆç»™&lt;code>expect&lt;/code>è„šæœ¬ä¼ å‚æ•°å‘¢ï¼Ÿ&lt;/li>
&lt;li>&lt;code>expect&lt;/code>æ€ä¹ˆè°ƒç”¨ &lt;code>bash/sh&lt;/code>å¤–éƒ¨å‘½ä»¤å‘¢ï¼Ÿ&lt;/li>
&lt;li>&lt;code>expect&lt;/code>æ€ä¹ˆæ“ä½œå­—ç¬¦ä¸²å‘¢ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;h2 id="tcl">tcl&lt;/h2>
&lt;p>å‰é¢çš„æ–‡ç« &lt;a class="link" href="https://tab.deoops.com/posts/expect-interactive/" >Expectå‘½ä»¤&lt;/a>é‡Œé¢æåˆ°è¿‡ï¼Œexpect ä½¿ç”¨çš„æ˜¯&lt;code>Tcl/tk&lt;/code>çš„è¯­æ³•ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ å¤§å®¶Google ä¸€ä¸‹ &lt;code>tcl tutorial&lt;/code>å°±å¯ä»¥è§£å†³ä¸Šé¢ä¸‰ä¸ªé—®é¢˜äº†ã€‚&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;a class="link" href="https://wiki.tcl-lang.org/page/argv" target="_blank" rel="noopener"
>tcl argc argc&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://zetcode.com/lang/tcl/" target="_blank" rel="noopener"
>Tcl tutorial&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;a class="link" href="https://www.tcl.tk/man/tcl8.4/TclCmd/regexp.htm" target="_blank" rel="noopener"
>Tcl regexp&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="new-expect-script">new expect script&lt;/h3>
&lt;p>ç»“åˆä¸Šé¢çš„3ç¯‡æ•™ç¨‹æˆ‘æŠŠä¸Šç¯‡æ–‡ç« è‡ªåŠ¨åŒ–ssh ç™»é™†çš„è„šæœ¬ä¼˜åŒ–å¦‚ä¸‹:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/expect -f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># for anyone not familar with expect&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># should read this awesome article&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://www.pantz.org/software/expect/expect_examples_and_tips.html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">{&lt;/span> &lt;span class="nv">$argc&lt;/span> !&lt;span class="o">=&lt;/span> 1&lt;span class="o">}&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> puts &lt;span class="s2">&amp;#34;must set one argument for server_A host ip&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> puts &lt;span class="s2">&amp;#34;./login.tcl 1.1.2.2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> timeout &lt;span class="m">15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#set info [gets stdin]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> info &lt;span class="o">[&lt;/span>&lt;span class="nb">exec&lt;/span> privateRESTfullAPI2GetPwd -host &lt;span class="nv">$argv&lt;/span>&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> result &lt;span class="o">[&lt;/span>regexp &lt;span class="o">{&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">([&lt;/span>^&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>*&lt;span class="o">)&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">[&lt;/span>^&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>*&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">([&lt;/span>^&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>*&lt;span class="o">)&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">[&lt;/span>^&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>*&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">([&lt;/span>^&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>*&lt;span class="o">)&lt;/span>&lt;span class="se">\&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span> &lt;span class="nv">$info&lt;/span> match host pw1 pw2&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send_user &lt;span class="s2">&amp;#34;going to connected to server_A\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spawn ssh -q -o &lt;span class="nv">StrictHostKeyChecking&lt;/span>&lt;span class="o">=&lt;/span>no nobody@host
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expect &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> timeout &lt;span class="o">{&lt;/span> send_user &lt;span class="s2">&amp;#34;\ntimeout Failed to get password prompt, is VPN on?\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> eof &lt;span class="o">{&lt;/span> send_user &lt;span class="s2">&amp;#34;\nSSH failure for server_A\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;*assword:&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$pwd1&lt;/span>&lt;span class="s2">\r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expect &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> timeout &lt;span class="o">{&lt;/span>send_user &lt;span class="s2">&amp;#34;\nSSH failure for server_B\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Last login:*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send &lt;span class="s2">&amp;#34;su -\r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expect &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> eof &lt;span class="o">{&lt;/span> send_user &lt;span class="s2">&amp;#34;\nSSH failure check your password \n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;å¯†ç &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$pw2&lt;/span>&lt;span class="s2">\r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interact
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç®€å•è§£é‡Šä¸Šé¢çš„è„šæœ¬ï¼š&lt;/p>
&lt;ol>
&lt;li>$argc å‘½ä»¤è¡Œå‚æ•°çš„ä¸ªæ•°ï¼› $argv å‘½ä»¤è¡Œå‚æ•°ï¼ˆä¸å«å‘½ä»¤æœ¬èº«ï¼‰;&lt;/li>
&lt;li>&lt;code>puts&lt;/code> ç›¸å½“äº bash çš„ &lt;code>echo&lt;/code>å‘½ä»¤ ;&lt;/li>
&lt;li>&lt;code>exec&lt;/code> ç›¸å½“äº bashçš„ &lt;code>$()&lt;/code>;&lt;/li>
&lt;li>privateRESTfullAPI2GetPwd -host $argv æ˜¯æˆ‘æœ¬åœ°çš„ä¸€ä¸ªç”¨æ¥æŸ¥è¯¢ä¸»æœºå¯†ç çš„å·¥å…·ï¼Œè¿”å›å€¼çš„æ ¼å¼ä¸ºï¼š&lt;code>Passworod of &amp;quot;1.1.1.1&amp;quot; are &amp;quot;pwd for noby&amp;quot; and &amp;quot;pwd for root&amp;quot;&lt;/code>&lt;/li>
&lt;li>æ­£åˆ™è¡¨è¾¾å¼ &lt;code> {\&amp;quot;([^\&amp;quot;]*)\&amp;quot;[^\&amp;quot;]*\&amp;quot;([^\&amp;quot;]*)\&amp;quot;[^\&amp;quot;]*\&amp;quot;([^\&amp;quot;]*)\&amp;quot;}&lt;/code>ç”¨æ¥æå–ä¸Šé¢&lt;code>privateAPI2GetPwd&lt;/code>è¿”å›å€¼ä¸­3ä¸ª åŒå¼•å·ä¸­çš„å†…å®¹ï¼Œ å³ï¼š host, pwd1, pwd2&lt;/li>
&lt;li>å‘½ä»¤&lt;code>set result [regexp {...ç¬¬äº”æ¡..} $info match host pw1 pw2]&lt;/code>æŠŠä¸Šé¢æ­£åˆ™è¡¨è¾¾å¼çš„çš„3ä¸ª &lt;code>group&lt;/code> åˆ†åˆ«èµ‹å€¼ç»™ &lt;code>host, pw1, pw2&lt;/code>ä¸‰ä¸ªå˜é‡ã€‚ ä¸¢å¼ƒäº†&lt;code>result&lt;/code> å’Œ &lt;code>match&lt;/code> ä¸¤ä¸ªå˜é‡ã€‚&lt;/li>
&lt;/ol></description></item><item><title>socatå·¥å…·</title><link>https://tab.deoops.com/posts/socat-usage/</link><pubDate>Tue, 14 Apr 2020 09:50:07 +0800</pubDate><guid>https://tab.deoops.com/posts/socat-usage/</guid><description>&lt;img src="https://tab.deoops.com/posts/socat-usage/socat.jpeg" alt="Featured image of post socatå·¥å…·" />&lt;p>ä¼—æ‰€å‘¨çŸ¥kubenetestçš„ç«¯å£è½¬å‘åŠŸèƒ½&lt;a class="link" href="https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/#forward-a-local-port-to-a-port-on-the-pod" target="_blank" rel="noopener"
>kubectl port-forward&lt;/a>éå¸¸å®ç”¨ï¼Œå¯ä»¥æé«˜å¼€å‘äººå‘˜çš„debugæ•ˆç‡ã€‚&lt;/p>
&lt;p>å…¶å®&lt;code>kubectl port-forward&lt;/code>çš„åº•å±‚è„æ´»ç´¯æ´»éƒ½æ˜¯&lt;code>socat&lt;/code>å‘½ä»¤åœ¨åšï¼Œ&lt;code>kubectl&lt;/code>åªèƒ½ç®—æ˜¯ä¸€ä¸ªä»£ç†å•†ã€‚&lt;/p>
&lt;h2 id="socat">socat&lt;/h2>
&lt;h3 id="ç«¯å£è½¬å‘">ç«¯å£è½¬å‘&lt;/h3>
&lt;p>&lt;code>socat tcp-listen:58812,reuseaddr,fork tcp:localhost:8000&lt;/code>æŠŠ58812ç«¯å£çš„æµé‡è½¬å‘åˆ° 8000ä¸Šã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bash-5.1# python3 -m http.server &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash-5.1# socat tcp-listen:58812,reuseaddr,fork tcp:localhost:8000 &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash-5.1# curl -I localhost:58812
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HTTP/1.0 &lt;span class="m">200&lt;/span> OK
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Server: SimpleHTTP/0.6 Python/3.10.3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Date: Thu, &lt;span class="m">14&lt;/span> Apr &lt;span class="m">2022&lt;/span> 03:19:15 GMT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-type: text/html&lt;span class="p">;&lt;/span> &lt;span class="nv">charset&lt;/span>&lt;span class="o">=&lt;/span>utf-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Content-Length: &lt;span class="m">336&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»è€Œä½¿å¾—åŸæ¥æ— æ³•è®¿é—®çš„ &lt;code>localhost:8000&lt;/code>ç«¯å£çš„æœåŠ¡ï¼Œç°åœ¨å¯ä»¥é€šè¿‡&lt;code>*:58812&lt;/code>è®¿é—®åˆ°äº†ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">bash-5.1# netstat -nlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Active Internet connections &lt;span class="o">(&lt;/span>only servers&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> 0.0.0.0:58812 0.0.0.0:* LISTEN 10/socat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tcp &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> 0.0.0.0:8000 0.0.0.0:* LISTEN 31/python3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Active UNIX domain sockets &lt;span class="o">(&lt;/span>only servers&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Proto RefCnt Flags Type State I-Node PID/Program name Path
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å…¶ä»–">å…¶ä»–&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">âœ ~ tldr socat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">socat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Multipurpose relay &lt;span class="o">(&lt;/span>SOcket CAT&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Listen to a port, &lt;span class="nb">wait&lt;/span> &lt;span class="k">for&lt;/span> an incoming connection and transfer data to STDIO:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> socat - TCP-LISTEN:8080,fork
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Create a connection to a host and port, transfer data in STDIO to connected host:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> socat - TCP4:www.example.com:80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Forward incoming data of a &lt;span class="nb">local&lt;/span> port to another host and port:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> socat TCP-LISTEN:80,fork TCP4:www.example.com:80
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è¯­æ³•">è¯­æ³•&lt;/h2>
&lt;p>&lt;a class="link" href="https://linux.die.net/man/1/socat" target="_blank" rel="noopener"
>man æ‰‹å†Œ&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Socat is a command line based utility that establishes two bidirectional byte streams and transfers data between them. Because the streams can be constructed from a large set of different types of data sinks and sources (see address types), and because lots of address options may be applied to the streams, socat can be used for many different purposes.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Filan is a utility that prints information about its active file descriptors to stdout. It has been written for debugging socat, but might be useful for other purposes too. Use the -h option to find more infos.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Procan is a utility that prints information about process parameters to stdout. It has been written to better understand some UNIX process properties and for debugging socat, but might be useful for other purposes too.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>The life cycle of a socat instance typically consists of four phases.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>In the init phase, the command line options are parsed and logging is initialized.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>During the open phase, socat opens the first address and afterwards the second address. These steps are usually blocking; thus, especially for complex address types like socks, connection requests or authentication dialogs must be completed before the next step is started.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>In the transfer phase, socat watches both streamscq read and write file descriptors via CWselect() , and, when data is available on one side and can be written to the other side, socat reads it, performs newline character conversions if required, and writes the data to the write file descriptor of the other stream, then continues waiting for more data in both directions.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>When one of the streams effectively reaches EOF, the closing phase begins. Socat transfers the EOF condition to the other stream, i.e. tries to shutdown only its write stream, giving it a chance to terminate gracefully. For a defined time socat continues to transfer data in the other direction, but then closes all remaining channels and terminates.&lt;/p>
&lt;/blockquote></description></item><item><title>TCP/IPæ•™ç¨‹</title><link>https://tab.deoops.com/posts/tcp-ip-tutorial/</link><pubDate>Mon, 13 Apr 2020 22:25:56 +0800</pubDate><guid>https://tab.deoops.com/posts/tcp-ip-tutorial/</guid><description>&lt;img src="https://tab.deoops.com/posts/tcp-ip-tutorial/The-logical-mapping-between-OSI-basic-reference-model-and-the-TCP-IP-stack.png" alt="Featured image of post TCP/IPæ•™ç¨‹" />&lt;p>æœ¬æ–‡ä¸å®šæœŸæ›´æ–° :)&lt;/p>
&lt;p>ä¸Šä¸ªç¤¼æ‹œé€›&lt;a class="link" href="https://news.ycombinator.com/" target="_blank" rel="noopener"
>Hacker News&lt;/a>çœ‹åˆ°æ¨èäº†ä¸€ä»½å†™äº1991å¹´ä»‹ç»TCP/IPåè®®çš„æ–‡ç« &lt;a class="link" href="https://tools.ietf.org/html/rfc1180" target="_blank" rel="noopener"
>A TCP/IP Tutorial&lt;/a>ã€‚&lt;/p>
&lt;p>åˆç•¥çš„æ‰«äº†å‡ çœ¼ï¼Œå‘ç°ä¸é”™ï¼ŒåŠ å…¥äº†æ”¶è—å¤¹ã€‚&lt;/p>
&lt;p>æ˜¨å¤©æ™šä¸ŠæŠ½å‡ºæ—¶é—´æ¥ç»†è¯»äº†ä¸€éè§‰å¾—å¾ˆæœ‰ç¿»è¯‘çš„ä»·å€¼ï¼Œäºæ˜¯è¯•ç€ç¿»è¯‘ä¸€ä¸‹ï¼š&lt;/p>
&lt;h2 id="introduction">Introduction&lt;/h2>
&lt;p>This tutorial contains only one view of the salient points of TCP/IP,
and therefore it is the &amp;ldquo;bare bones&amp;rdquo; of TCP/IP technology. It omits
the history of development and funding, the business case for its
use, and its future as compared to ISO OSI. Indeed, a great deal of
technical information is also omitted. What remains is a minimum of
information that must be understood by the professional working in a
TCP/IP environment. These professionals include the systems
administrator, the systems programmer, and the network manager.&lt;/p>
&lt;p>This tutorial uses examples from the UNIX TCP/IP environment, however
the main points apply across all implementations of TCP/IP.&lt;/p>
&lt;p>Note that the purpose of this memo is explanation, not definition.
If any question arises about the correct specification of a protocol,
please refer to the actual standards defining RFC.&lt;/p>
&lt;p>The next section is an overview of TCP/IP, followed by detailed
descriptions of individual components.&lt;/p>
&lt;ol>
&lt;li>åºè¨€&lt;/li>
&lt;/ol>
&lt;p>è¿™ç¯‡æ•™ç¨‹åªæ˜¯å¯¹ TCP/IP åè®®ä¸­ä¸€äº›æœ€é‡è¦çš„è¦ç‚¹åšæè¿°æ€§çš„ä»‹ç»ï¼Œå› æ­¤å¯ä»¥æŠŠè¿™ç¯‡æ•™ç¨‹çœ‹ä½œæ˜¯TCP/IP æŠ€æœ¯çš„éª¨æ¶ã€‚
è¿™ç¯‡æ•™ç¨‹&lt;strong>ä¸æ¶‰åŠ&lt;/strong> TCP/IP çš„å‘å±•å†å²ï¼Œèµ„é‡‘/èµ„åŠ©æ¥æºï¼Œå•†ä¸šç”¨é€”ä»¥åŠå’ŒISO OSIçš„å¯¹æ¯”æ¥çœ‹TCP/IPçš„æœªæ¥ä¼šæ€æ ·ã€‚è€Œä¸”å¾ˆå¤šè¯¦ç»†çš„æŠ€æœ¯ç»†èŠ‚ä¹Ÿä¸ä¼šåœ¨æœ¬æ–‡ä¸­å¾—åˆ°ä»‹ç»ã€‚
è¿™ç¯‡æ•™ç¨‹æ‰€&lt;strong>æ¶‰åŠ&lt;/strong>çš„å†…å®¹ï¼Œæ°æ°æ˜¯ä¸€ä¸ªæ—¥å¸¸å·¥ä½œåœ¨TCP/IP ç¯å¢ƒçš„ä¸“ä¸šäººå£«&lt;strong>å¿…é¡»&lt;/strong>ç†è§£çš„&lt;strong>æœ€å°‘&lt;/strong>TCP/IPæŠ€æœ¯ä¿¡æ¯é‡ï¼Œä¸èƒ½å†å°‘äº†ã€‚è¿™äº›ä¸“ä¸šäººå£«åŒ…æ‹¬äº†ç³»ç»Ÿç®¡ç†å‘˜ï¼Œç³»ç»Ÿç¨‹åºå‘˜ï¼Œå’Œç½‘ç»œç®¡ç†å‘˜ã€‚
è¿™ç¯‡æ•™ç¨‹ä½¿ç”¨çš„ä¾‹å­éƒ½æ˜¯åœ¨ UNIX TCP/IP ç¯å¢ƒï¼Œä½†æ˜¯è¿™äº›ä¾‹å­æ‰€è¡¨è¾¾çš„ä¸»è¦æ„æ€å¯¹æ‰€æœ‰å®ç°äº†TCP/IPåè®®çš„ç¯å¢ƒæ¥è¯´éƒ½æ˜¯åŒæ ·è¯•ç”¨çš„ã€‚&lt;/p>
&lt;p>&lt;strong>æ³¨æ„&lt;/strong>âš ï¸ è¿™ç¯‡æ•™ç¨‹çš„ç›®çš„æ˜¯è§£é‡Š/ä»‹ç» TCP/IPæŠ€æœ¯ï¼Œå¹¶ä¸æ˜¯ç»™TCP/IP æŠ€æœ¯ä¸‹å®šä¹‰ã€‚&lt;/p>
&lt;p>å¦‚æœè¯»è€…å¯¹è¿™ç¯‡æ•™ç¨‹æè¿°çš„æŸä¸ªåè®®çš„è§„æ ¼/è§„èŒƒäº§ç”Ÿäº†ç–‘é—®ï¼Œè¯·å‚è€ƒè¿™ä¸ªåè®®çš„RFCå…·ä½“çš„è§„èŒƒå®šä¹‰ã€‚
ä¸‹ä¸ªå°èŠ‚æ˜¯å¯¹ TCP/IPæŠ€æœ¯çš„æ¦‚è§ˆï¼Œç„¶åæ˜¯å•ç‹¬çš„å¯¹æ¯ä¸ªTCP/IPç»„ä»¶è¯¦ç»†çš„æè¿°ã€‚&lt;/p>
&lt;h2 id="tcpip-overview">TCP/IP Overview&lt;/h2>
&lt;p>The generic term &amp;ldquo;TCP/IP&amp;rdquo; usually means anything and everything
related to the specific protocols of TCP and IP. It can include
other protocols, applications, and even the network medium. A sample
of these protocols are: UDP, ARP, and ICMP. A sample of these
applications are: TELNET, FTP, and rcp. A more accurate term is
&amp;ldquo;internet technology&amp;rdquo;. A network that uses internet technology is
called an &amp;ldquo;internet&amp;rdquo;.&lt;/p>
&lt;ol start="2">
&lt;li>TCP/IP æ¦‚è§ˆ&lt;/li>
&lt;/ol>
&lt;p>æœ¯è¯­â€œTCP/IPâ€ä¸€èˆ¬æ„ä¹‰ä¸Šæ¥è¯´ï¼Œé€šå¸¸æ˜¯æŒ‡ ä»»ä½•ä»¥åŠæ‰€æœ‰å’Œ â€˜TCP åè®®â€™ï¼Œä¸ â€˜IP åè®®â€™æœ‰å…³çš„æŠ€æœ¯ã€‚ â€œTCP/IPâ€æœ¯è¯­å¯ä»¥æŒ‡ å…¶å®ƒçš„ç½‘ç»œåè®®ï¼Œç½‘ç»œåº”ç”¨ï¼Œç”šè‡³æ˜¯ç‰©ç†ç½‘ç»œåª’ä»‹ã€‚è¿™äº›ç½‘ç»œåè®®å¯ä»¥æ˜¯ï¼šUDP, ARP, å’Œ ICMPï¼› ç½‘ç»œåº”ç”¨å¯ä»¥æ˜¯ï¼šTELNETï¼ŒFTPï¼Œå’Œ RCPã€‚&lt;/p>
&lt;p>â€œTCP/IPâ€æ›´å‡†ç¡®çš„æœ¯è¯­åº”è¯¥æ˜¯â€œäº’è”ç½‘æŠ€æœ¯â€ã€‚å½“ä¸€ä¸ªç½‘ç»œä½¿ç”¨äº†äº’è”ç½‘æŠ€æœ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠè¿™ä¸ªç½‘ç»œå«â€œäº’è”ç½‘â€ã€‚&lt;/p>
&lt;h3 id="basic-structure">Basic Structure&lt;/h3>
&lt;p>To understand this technology you must first understand the following
logical structure:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>----------------------------&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| network applications |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">|... \ | / .. \ | / ...|&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- ----- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |TCP| |UDP| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- ----- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| \ / |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| -------- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| | IP | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- -*------ |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |ARP| | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| \ | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ------ |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |ENET| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ---@-- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>----------&lt;span class="l">|-----------------&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> ----------------------o---------
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> Ethernet Cable
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> Figure 1. Basic TCP/IP Network Node&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This is the logical structure of the layered protocols inside a
computer on an internet. Each computer that can communicate using
internet technology has such a logical structure. It is this logical
structure that determines the behavior of the computer on the
internet. The boxes represent processing of the data as it passes
through the computer, and the lines connecting boxes show the path
of data. The horizontal line at the bottom represents the Ethernet
cable; the &amp;ldquo;o&amp;rdquo; is the transceiver. The &amp;ldquo;*&amp;rdquo; is the IP address and the
&amp;ldquo;@&amp;rdquo; is the Ethernet address. Understanding this logical structure is
essential to understanding internet technology; it is referred to
throughout this tutorial.&lt;/p>
&lt;p>2.1 åŸºç¡€ç»“æ„&lt;/p>
&lt;p>è¦æƒ³ç†è§£TCP/IPæŠ€æœ¯ï¼Œé¦–å…ˆä½ &lt;strong>å¿…é¡»&lt;/strong>è¦ç†è§£ä¸‹é¢å›¾è¡¨å±•ç¤ºçš„ç½‘ç»œèŠ‚ç‚¹é€»è¾‘ç»“æ„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>----------------------------&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ç½‘ç»œåº”ç”¨ |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">|... \ | / .. \ | / ...|&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- ----- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |TCP| |UDP| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- ----- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| \ / |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| -------- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| | IP | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- -*------ |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |ARP| | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ----- | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| \ | |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ------ |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| |ENET| |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">| ---@-- |&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>----------&lt;span class="l">|-----------------&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">|&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>-------------------&lt;span class="l">o---------&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">ä»¥å¤ªç½‘ç½‘çº¿&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="l">å›¾1. åŸºç¡€TCP/IPç½‘ç»œèŠ‚ç‚¹é€»è¾‘ç»“æ„&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šå›¾ï¼ˆå›¾1ï¼‰æç»˜çš„æ˜¯äº’è”ç½‘ä¸ŠæŸå°è®¡ç®—æœºèŠ‚ç‚¹å†…éƒ¨ç½‘ç»œåè®®çš„é€»è¾‘åˆ†å±‚æ¶æ„ã€‚æ¯ä¸€å°èƒ½ä½¿ç”¨äº’è”ç½‘æŠ€æœ¯å’Œå…¶å®ƒè®¡ç®—æœºé€šä¿¡çš„è®¡ç®—æœºéƒ½æœ‰å›¾1æè¿°çš„é€»è¾‘ç»“æ„ã€‚å›¾1æè¿°çš„é€»è¾‘ç»“æ„ä¹Ÿå†³å®šäº†äº’è”ç½‘ä¸Šè®¡ç®—æœºçš„è¡Œä¸ºã€‚&lt;/p>
&lt;p>å›¾1ä¸­çš„ è™šçº¿æ¡† è¡¨ç¤ºå½“æ•°æ®åœ¨è®¡ç®—æœºå†…éƒ¨ä¼ è¾“æ—¶ å¯¹æ•°æ®çš„æŸç§å¤„ç†ï¼Œ è¿æ¥è™šçº¿æ¡†çš„è™šçº¿è¡¨ç¤ºæ•°æ®åœ¨è®¡ç®—æœºå†…éƒ¨ä¼ è¾“çš„è·¯å¾„ã€‚æœ€ä¸‹é¢çš„é‚£æ¡è™šçº¿è¡¨ç¤ºä»¥å¤ªç½‘çº¿ï¼›â€œoâ€è¡¨ç¤ºæ¥æ”¶å‘é€å™¨ï¼Œ â€œ*â€è¡¨ç¤ºIP åœ°å€ï¼Œâ€œ@â€è¡¨ç¤º ä»¥å¤ªï¼ˆMACï¼‰åœ°å€ã€‚&lt;/p>
&lt;p>ç†è§£å›¾1æ‰€æè¿°çš„é€»è¾‘ç»“æ„çš„å¯¹ç†è§£æ•´ä¸ªäº’è”ç½‘æŠ€æœ¯èµ·ç€å…³é”®æ€§ä½œç”¨ï¼›è€Œä¸”å¯¹å›¾1çš„å¼•ç”¨è´¯ç©¿äº†æ•´ç¯‡æ•™ç¨‹ã€‚&lt;/p>
&lt;h3 id="terminology">Terminology&lt;/h3>
&lt;p>The name of a unit of data that flows through an internet is
dependent upon where it exists in the protocol stack. In summary: if
it is on an Ethernet it is called an Ethernet frame; if it is between
the Ethernet driver and the IP module it is called a IP packet; if it
is between the IP module and the UDP module it is called a UDP
datagram; if it is between the IP module and the TCP module it is
called a TCP segment (more generally, a transport message); and if it
is in a network application it is called a application message.&lt;/p>
&lt;p>These definitions are imperfect. Actual definitions vary from one
publication to the next. More specific definitions can be found in
RFC 1122, section 1.3.3.&lt;/p>
&lt;p>A driver is software that communicates directly with the network
interface hardware. A module is software that communicates with a
driver, with network applications, or with another module.&lt;/p>
&lt;p>The terms driver, module, Ethernet frame, IP packet, UDP datagram,
TCP message, and application message are used where appropriate
throughout this tutorial&lt;/p>
&lt;p>2.2 æœ¯è¯­&lt;/p>
&lt;p>æ ¹æ®æ•°æ®åœ¨å›¾1ä¸­è¢«å“ªä¸€å±‚é€»è¾‘å±‚å¤„ç†ï¼Œæˆ‘ä»¬ç»™æ¯å±‚çš„æ•°æ®å—èµ·äº†ä¸åŒçš„åå­—åŠ ä»¥åŒºåˆ†ã€‚&lt;/p>
&lt;p>æ€»çš„æ¥è¯´ï¼Œå¦‚æœæ•°æ®å—åœ¨ä»¥å¤ªç½‘ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®å—å°±è¢«ç§°ä¸º &amp;lsquo;Ethernet frame&amp;rsquo;ï¼›
å¦‚æœæ•°æ®å—&lt;/p></description></item><item><title>SSHä»£ç†ï¼ˆAgentï¼‰</title><link>https://tab.deoops.com/posts/ssh-agent/</link><pubDate>Sun, 12 Apr 2020 11:34:44 +0800</pubDate><guid>https://tab.deoops.com/posts/ssh-agent/</guid><description>&lt;img src="https://tab.deoops.com/posts/ssh-agent/ssh-agent-typical.png" alt="Featured image of post SSHä»£ç†ï¼ˆAgentï¼‰" />&lt;h2 id="é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;p>å·²çŸ¥æœ¬åœ°localå¯ä»¥sshåˆ°server Aå’ŒBï¼Œ&lt;/p>
&lt;p>é—®å¦‚ä½•ä»server A sshåˆ°server Bï¼Œä»¥åŠå¦‚ä½•åœ¨server A å’ŒBä¹‹é—´ä½¿ç”¨scpäº’ä¼ æ–‡ä»¶ ï¼Ÿ&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>é…ç½®&lt;code>ssh_config&lt;/code>ç„¶åä½¿ç”¨ &lt;code>ssh-add&lt;/code>å‘½ä»¤æŒ‡å®šä½¿ç”¨ssh agentå¯ä»¥å¾ˆå®‰å…¨å’Œé«˜æ•ˆçš„è§£å†³ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;h3 id="é…ç½®ssh_config">é…ç½®ssh_config&lt;/h3>
&lt;p>æ³¨æ„çœ‹æ³¨é‡Šï¼Œä¸‹é¢è„šæœ¬æ‰€æœ‰çš„æ“ä½œå’Œé…ç½®éƒ½æ˜¯åœ¨ æœ¬åœ°localä¸Šæ‰§è¡Œçš„:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> vi .ssh/config &lt;span class="c1">## ä¿®æ”¹é…ç½® æ·»åŠ forward agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HOST server-A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName 1.2.3.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> User root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IdentityFile ~/.ssh/serverA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ForwardAgent yes &lt;span class="c1"># ç°åœ¨ serverAå¯ä»¥å’Œlocalæœ¬æœºçš„agenté€šä¿¡å•¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HOST server-B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName 6.7.8.9
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> User root
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IdentityFile ~/.ssh/serverB
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ForwardAgent yes &lt;span class="c1"># ç°åœ¨ serverBå¯ä»¥å’Œlocalæœ¬æœºçš„ssh agent é€šä¿¡å•¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rg Forward /etc/ssh/ssh_config &lt;span class="c1">## æ£€æŸ¥å…¨å±€çš„forwordagenté…ç½®æœ‰æ²¡æœ‰è¢«è¦†ç›–&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$SSH_AUTH_SOCK&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="c1">## æŸ¥çœ‹æœ¬åœ°ssh agentæ˜¯å¦åœ¨è¿è¡Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -L &lt;span class="c1">## æŸ¥çœ‹/æ“ä½œ/åˆ é™¤ ssh agent holdçš„keys&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -K li
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -K ~/.ssh/serverA &lt;span class="c1">## ç»™agent serverA å¯†é’¥ï¼Œä½¿å¾—serverB å¯ä»¥â€œä½¿ç”¨â€ è¿™ä¸ªå¯†é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -K ~/.ssh/serverB &lt;span class="c1">## ç»™agent serverBå¯†é’¥ï¼Œä½¿å¾—serverAå¯ä»¥â€œä½¿ç”¨â€è¿™ä¸ªå¯†é’¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -K ~/.ssh/github &lt;span class="c1">## ç»™é˜¿æ ¹å»· githubå¯†é’¥ï¼Œä½¿å¾—serverAï¼Œ serverBéƒ½å¯ä»¥ssh githubï¼Œæ–¹ä¾¿æµ‹è¯•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ssh-add -L
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="éªŒè¯github">éªŒè¯github&lt;/h3>
&lt;p>ä¹Ÿæ˜¯åœ¨æœ¬æœºlocalæ“ä½œï¼Œä»¥&lt;a class="link" href="https://developer.github.com/v3/guides/using-ssh-agent-forwarding/#troubleshooting-ssh-agent-forwarding" target="_blank" rel="noopener"
>github&lt;/a>ä½œä¸ºæµ‹è¯•ç›®æ ‡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh -T git@github.com &lt;span class="c1">## æœ¬åœ°åŸºå‡†æµ‹è¯•&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh serverA &lt;span class="c1">## æµ‹è¯•serverA &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh -T git@github.com &lt;span class="c1">## æµ‹è¯•/éªŒè¯&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å°ç»“">å°ç»“&lt;/h2>
&lt;p>æ³¨æ„çœ‹æ³¨é‡Šï¼Œæ³¨æ„&lt;code>ForwardAgent&lt;/code>é…ç½®åº”ç”¨åˆ°å“ªä¸ªserverä¸Šäº†ã€‚&lt;/p>
&lt;p>å½“ server å¯ä»¥å’Œlocalæœ¬æœºçš„agenté€šä¿¡çš„æ—¶å€™ï¼Œå°±è¡¨ç¤º server å¥½åƒæ‹¥æœ‰äº†localæœ¬åœ°çš„private keysäº†ã€‚&lt;/p>
&lt;p>å…·ä½“è¯´ï¼š å½“server A çš„ ForwardAgent å¼€å¯æ—¶ï¼Œ server Aå°±å¯ä»¥ç›´æ¥sshåˆ°server Bäº†ï¼Œ&lt;/p>
&lt;p>å¦‚æœè¿™ä¸ªæ—¶å€™ server B çš„ForwordAgentæ²¡æœ‰å¼€å¯ï¼Œserver Bæ˜¯ä¸å¯ä»¥ssh åˆ°server Açš„&lt;/p></description></item><item><title>Expectè‡ªåŠ¨åŒ–å·¥å…·ç®€ä»‹</title><link>https://tab.deoops.com/posts/expect-interactive/</link><pubDate>Thu, 19 Mar 2020 16:07:45 +0800</pubDate><guid>https://tab.deoops.com/posts/expect-interactive/</guid><description>&lt;img src="https://tab.deoops.com/posts/expect-interactive/automate.jpeg" alt="Featured image of post Expectè‡ªåŠ¨åŒ–å·¥å…·ç®€ä»‹" />&lt;p>å…¬å¸æœåŠ¡å™¨ä½¿ç”¨äº†ä¸¤å±‚è·³æ¿æœºï¼Œå¤–é¢çš„ä¸€å°æˆ‘ä»¬ç®¡å®ƒå« &lt;code>server A&lt;/code>ï¼Œ å¦å¤–ä¸€å° å«å®ƒ &lt;code>server B&lt;/code>ã€‚&lt;/p>
&lt;p>è™½ç„¶æˆ‘ä¸çŸ¥é“è¿™ç§åŒä¿é™©ç»™å…¬å¸å¸¦æ¥äº†å¤šå°‘å®‰å…¨æ„Ÿï¼Œä½†æ˜¯æˆ‘çŸ¥é“æˆ‘çš„è¿ç»´æ•ˆç‡é™ä½äº†å·®ä¸å¤š90%å§ :&amp;gt;ã€‚&lt;/p>
&lt;p>&lt;code>server A&lt;/code>è¢«ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼Œ æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ &lt;code>ssh key&lt;/code> åªèƒ½ä½¿ç”¨ &lt;code>password&lt;/code>è®¤è¯&lt;code>ssh&lt;/code>ã€‚&lt;/p>
&lt;p>è¿™è¿˜ä¸ç®—å®Œï¼Œ&lt;code>server A&lt;/code>æ¯3å°æ—¶æ”¹ä¸€æ¬¡è‡ªå·±çš„&lt;code>root&lt;/code>å¯†ç ã€‚&lt;/p>
&lt;p>åé¢çš„&lt;code>server B&lt;/code>è·³æ¿æœºå™¨çš„è‡ªæˆ‘å®‰å…¨æ„Ÿå°±å¼ºå¤šäº†ï¼Œ&lt;code>server B&lt;/code>å¯ä»¥ç›´æ¥å…å¯†ä½¿ç”¨&lt;code>ssh key&lt;/code>ç™»é™†æ‰€æœ‰çš„å†…ç½‘æœåŠ¡å™¨ï¼Œè€Œä¸”å…è®¸&lt;code>server A&lt;/code>å…å¯†ç™»é™†åˆ°è‡ªå·±ã€‚&lt;/p>
&lt;p>æˆ‘å†³å¾—è¿™æ ·ä¸¤æ¬¡ç™»å½•å¾ˆæµªè´¹æ—¶é—´ï¼Œäºæ˜¯å†™äº†ä¸ªè„šæœ¬ä»å¤–ç½‘ä¸€æ¬¡æ€§ç™»é™†åˆ°&lt;code>server B&lt;/code>æœåŠ¡å™¨ä¸Šã€‚&lt;/p>
&lt;h2 id="expect-è„šæœ¬">expect è„šæœ¬&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/usr/bin/expect -f
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># for anyone not familar with expect&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># should read this awesome post&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># https://www.pantz.org/software/expect/expect_examples_and_tips.html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> timeout &lt;span class="m">15&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### CHANGE pwd every 3h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> &lt;span class="nb">pwd&lt;/span> &lt;span class="s2">&amp;#34;mySuperSecretpwd123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> nested_ssh &lt;span class="s2">&amp;#34;ssh server_B&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## for debug&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># log_user 0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># exp_internal 1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send_user &lt;span class="s2">&amp;#34;going to connected to server A\n&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">spawn ssh -q -o &lt;span class="nv">StrictHostKeyChecking&lt;/span>&lt;span class="o">=&lt;/span>no server_A
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expect &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> timeout &lt;span class="o">{&lt;/span> send_user &lt;span class="s2">&amp;#34;\ntimeout Failed to get password prompt, is VPN on?\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> eof &lt;span class="o">{&lt;/span> send_user &lt;span class="s2">&amp;#34;\nSSH failure for server A\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;*assword:&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$pwd&lt;/span>&lt;span class="s2">\r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">expect &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> timeout &lt;span class="o">{&lt;/span>send_user &lt;span class="s2">&amp;#34;\nSSH failure for server B\n&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;Last login:*&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">send &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$nested_ssh&lt;/span>&lt;span class="s2">\r&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">interact
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•&lt;/h3>
&lt;p>ç®€å•è¯´ä¸‹åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>set: è®¾ç½®å˜é‡ï¼›&lt;/li>
&lt;li>spawn: ç»™å¯¹è±¡ä¸€ä¸ªè¿›ç¨‹ç©ºé—´ï¼Œè®©å¯¹è±¡å¯ä»¥è¿è¡Œèµ·æ¥&lt;/li>
&lt;li>expect: æ¨¡æ‹Ÿç”¨æˆ·ç­‰å¾…ï¼Œ&lt;strong>æœŸå¾…&lt;/strong>å¯¹è±¡è¾“å‡ºå­—ç¬¦ä¸²ï¼›&lt;/li>
&lt;li>send: æ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ï¼Œç»™å¯¹è±¡å‘é€å­—ç¬¦ä¸²ï¼›&lt;/li>
&lt;li>send_user: æç¤ºç”¨æˆ·;&lt;/li>
&lt;li>interact: ç”¨æˆ·ç›´æ¥å’Œå¯¹è±¡é€šä¿¡ï¼Œexpectä¸å†åœ¨ä¸­é—´ä¼ è¯äº†ã€‚&lt;/li>
&lt;/ol>
&lt;p>å› ä¸º&lt;code>expect&lt;/code>è¯­æ³•ç»§æ‰¿è‡ª&lt;code>Tcl&lt;/code>ï¼Œæ‰€ä»¥å˜é‡èµ‹å€¼/åˆå§‹åŒ–çš„æ–¹å¼å’Œ &lt;code>Bash&lt;/code>ä¸åŒï¼Œéœ€è¦ä½¿ç”¨&lt;code>set&lt;/code>å…³é”®å­—ã€‚&lt;/p>
&lt;p>æ³¨æ„ç¬¬5ç‚¹&lt;code>send_user&lt;/code>å‘½ä»¤æ˜¯ä¸ºäº†æ›´å¥½çš„ç”¨æˆ·äº¤äº’ï¼Œä¸»è¦æ˜¯ç»™ç”¨æˆ·ä¸€ä¸‹æç¤ºä¿¡æ¯/åé¦ˆä¿¡æ¯ã€‚&lt;/p>
&lt;p>æœ€åæ³¨æ„ï¼š&lt;code>send &amp;quot;$pwd\r&amp;quot;&lt;/code>è¯­å¥çš„&lt;a class="link" href="https://tab.deoops.com/posts/carrier-return/" >è½¬ä»¥ç¬¦&lt;/a>æ˜¯ &lt;code>\r&lt;/code> è€Œä¸æ˜¯&lt;code>\r\n&lt;/code>ã€‚&lt;/p>
&lt;h2 id="è¯¦ç»†è¯­æ³•">è¯¦ç»†è¯­æ³•&lt;/h2>
&lt;p>&lt;code>expect&lt;/code>è¯¦ç»†çš„è¯­æ³•å’Œå‚æ•°è§£é‡Šå‚è€ƒ&lt;a class="link" href="https://www.pantz.org/software/expect/expect_examples_and_tips.html" target="_blank" rel="noopener"
>Expect examples and tips&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>Expect is an automation and testing tool used to automate a process that receives interactive commands. If you can connect to any machine using ssh, telnet, ftp, etc then you can automate the process with an expect script. This works even with local programs where you would have to interact with a script or program on the command line.&lt;/p>
&lt;/blockquote></description></item><item><title>å®¹å™¨PID</title><link>https://tab.deoops.com/posts/container-pid/</link><pubDate>Fri, 13 Mar 2020 22:43:32 +0800</pubDate><guid>https://tab.deoops.com/posts/container-pid/</guid><description>&lt;img src="https://tab.deoops.com/posts/container-pid/the-matrix.jpeg" alt="Featured image of post å®¹å™¨PID" />&lt;p>æ¶æ„éƒ¨çš„åŒäº‹é—®äº†æˆ‘ä¸¤ä¸ªé—®é¢˜:&lt;/p>
&lt;ol>
&lt;li>å®¿ä¸»æœºä¸Šæœ‰ä¸ªè¿›ç¨‹å¾ˆè€— cpuï¼Œæ€ä¹ˆåˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯æŸä¸ªå®¹å™¨çš„è¿›ç¨‹;&lt;/li>
&lt;li>å¦‚æœå®ƒæ˜¯è·‘åœ¨å®¹å™¨é‡Œï¼Œæ€ä¹ˆæŸ¥åˆ°æ˜¯å“ªä¸ªå®¹å™¨(container id);&lt;/li>
&lt;/ol>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>æœ‰ä¸¤ç§æ–¹æ³•æ¥è§£å†³ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p>
&lt;h3 id="cgroup">cgroup&lt;/h3>
&lt;p>é€šè¿‡æŸ¥çœ‹pidçš„cgroupæ˜¯å¦å«æœ‰ &lt;code>slice&lt;/code>ä¿¡æ¯æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å®¹å™¨è¿›ç¨‹:&lt;/p>
&lt;h4 id="ä¸»æœºè¿›ç¨‹-cgroup">ä¸»æœºè¿›ç¨‹ cgroup&lt;/h4>
&lt;p>ç›´æ¥è¿è¡Œåœ¨å®¿ä¸»æœºä¸»çš„è¿›ç¨‹çš„cgroupæ˜¯æ²¡æœ‰&lt;code>slice&lt;/code>ä¿¡æ¯çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /proc/1/cgroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:perf_event:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10:memory:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9:devices:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8:cpuacct,cpu:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7:cpuset:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6:hugetlb:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5:blkio:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4:net_prio,net_cls:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3:freezer:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2:pids:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1:name&lt;span class="o">=&lt;/span>systemd:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /proc/19/cgroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:perf_event:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10:memory:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9:devices:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8:cpuacct,cpu:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7:cpuset:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6:hugetlb:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5:blkio:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4:net_prio,net_cls:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3:freezer:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2:pids:/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1:name&lt;span class="o">=&lt;/span>systemd:/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="k8s-podè¿›ç¨‹-cgroup">k8s podè¿›ç¨‹ cgroup&lt;/h4>
&lt;p>åœ¨å®¿ä¸»æœºä¸Šçœ‹è·‘åœ¨å®¹å™¨è¿›ç¨‹çš„cgroupæ˜¯å¯ä»¥çœ‹åˆ°&lt;code>slice&lt;/code>ä¿¡æ¯çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /proc/20397/cgroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:perf_event:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10:memory:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9:devices:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8:cpuacct,cpu:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7:cpuset:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6:hugetlb:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5:blkio:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4:net_prio,net_cls:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3:freezer:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2:pids:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1:name&lt;span class="o">=&lt;/span>systemd:/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod6d62265d_cd4d_4807_8d2f_386714d5bbdc.slice/docker-c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc.scope
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹åˆ° pid &lt;code>20397&lt;/code>æ˜¯ kubernets podæ‹‰èµ·æ¥çš„è¿›ç¨‹ï¼Œ è€Œä¸”&lt;code>pod ID&lt;/code> æ˜¯ï¼š
&lt;code>6d62265d_cd4d_4807_8d2f_386714d5bbdc&lt;/code>, å¯¹åº”çš„ &lt;code>contariner ID&lt;/code> æ˜¯
&lt;code>c44a782ba5482052e66dc3f5ed3811e2a699db09b6715e26102d582a51ac52cc&lt;/code>&lt;/p>
&lt;h4 id="docker-containerè¿›ç¨‹-cgroup">docker containerè¿›ç¨‹ cgroup&lt;/h4>
&lt;p>docker containre å’Œ k8s ä¸€æ ·ï¼Œä¹Ÿä¼šè®¾ç½®cgroup sliceï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=super123456secret -d mysql:5.7.28&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Unable to find image &lt;span class="s1">&amp;#39;mysql:5.7.28&amp;#39;&lt;/span> locally
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5.7.28: Pulling from library/mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">804555ee0376: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">c53bab458734: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ca9d72777f90: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2d7aad6cb96e: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8d6ca35c7908: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6ddae009e760: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">327ae67bbe7b: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">31f1f8385b27: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">a5a3ad97e819: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">48bede7828ac: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">380afa2e6973: Pull &lt;span class="nb">complete&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Digest: sha256:b38555e593300df225daea22aeb104eed79fc80d2f064fde1e16e1804d00d0fc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Status: Downloaded newer image &lt;span class="k">for&lt;/span> mysql:5.7.28
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># ps aux | grep mysql&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">polkitd &lt;span class="m">23855&lt;/span> 3.0 1.1 &lt;span class="m">1007636&lt;/span> &lt;span class="m">190588&lt;/span> ? Ssl 09:39 0:00 mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">root &lt;span class="m">24176&lt;/span> 0.0 0.0 &lt;span class="m">112724&lt;/span> &lt;span class="m">984&lt;/span> pts/0 S+ 09:39 0:00 grep --color&lt;span class="o">=&lt;/span>auto mysql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /proc/23855/cgroup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:perf_event:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10:memory:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9:devices:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8:cpuacct,cpu:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7:cpuset:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6:hugetlb:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5:blkio:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4:net_prio,net_cls:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3:freezer:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2:pids:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1:name&lt;span class="o">=&lt;/span>systemd:/system.slice/docker-771aa2fdc8cae66a0cb05a4585beff44a69f0f1c5b2a21fd159cbeea0a86d633.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># docker ps | grep 771aa2fdc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">771aa2fdc8ca mysql:5.7.28 &lt;span class="s2">&amp;#34;docker-entrypoint.sâ€¦&amp;#34;&lt;/span> &lt;span class="m">58&lt;/span> seconds ago Up &lt;span class="m">57&lt;/span> seconds 0.0.0.0:3306-&amp;gt;3306/tcp, 33060/tcp mysql
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»ä¸Šé¢bashè„šæœ¬çš„è¾“å‡ºå¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œcgroupé…ç½®çš„&lt;code>container ID&lt;/code> å’Œ docker ps å‘½ä»¤è¾“å‡ºçš„ &lt;code>container ID&lt;/code>æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ &lt;code>771aa2fdc8ca&lt;/code>&lt;/p>
&lt;h3 id="ppid">ppid&lt;/h3>
&lt;p>ä¸‹é¢ä¸¤ç§æ–¹æ³•å’Œdockerå¼ºç›¸å…³ï¼Œä¸æ¨èã€‚&lt;/p>
&lt;h4 id="pstree">pstree&lt;/h4>
&lt;p>è€è€å®å®çš„ä¸€æ­¥æ­¥æ’æŸ¥ä¸»æœºä¸Šæ‰€æœ‰çš„container ppidï¼š
ç”¨ &lt;code>pstree&lt;/code>å‘½ä»¤æŸ¥çœ‹å®¿ä¸»æœºä¸Šçš„è¿›ç¨‹æ ‘ï¼Œçœ‹&lt;code>&amp;lt;pid&amp;gt;&lt;/code> æ˜¯ä¸æ˜¯&lt;code>docker-current&lt;/code>åˆ›å»ºçš„å­è¿›ç¨‹;&lt;/p>
&lt;h4 id="docker-inspect">docker inspect&lt;/h4>
&lt;p>ä½¿ç”¨&lt;code>docker inspect&lt;/code>å‘½ä»¤æŸ¥è¯¢æ‰€æœ‰å®¹å™¨çš„pidï¼Œç„¶ååšè¿‡æ»¤ï¼Œæ‰¾åˆ°è¯¥è¿›ç¨‹å¯¹åº”çš„å®¹å™¨åï¼Œidï¼Œå®¹å™¨çš„è¯¦ç»†ä¿¡æ¯ä¸­ï¼ŒåŒ…å«äº†å®ƒåœ¨å®¿ä¸»æœºä¸Šçš„è¿›ç¨‹å·ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">docker inspect -f &lt;span class="s2">&amp;#34;{{.Id}} {{.State.Pid}} {{.Config.Hostname}}&amp;#34;&lt;/span> &lt;span class="k">$(&lt;/span>docker ps -q&lt;span class="k">)&lt;/span> &lt;span class="p">|&lt;/span> grep &amp;lt;pid&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‘æ•£æ€ç»´">å‘æ•£æ€ç»´&lt;/h2>
&lt;h3 id="matrix">MATRIX&lt;/h3>
&lt;p>é‚£ä¹ˆè¿›ç¨‹è‡ªå·±å¦‚ä½•åˆ¤æ–­è‡ªå·±æ˜¯å¦åœ¨containerä¸­å‘¢ï¼Ÿ&lt;/p>
&lt;p>ç­”æ¡ˆå¾ˆç®€å•ï¼Œå¦‚æœ &lt;code>pid 1&lt;/code> çš„cgroupæœ‰sliceä¿¡æ¯ï¼Œè¯´æ˜è¿›ç¨‹ç°åœ¨åœ¨å®¹å™¨ä¸­ï¼Œå¦åˆ™åˆ™è¯´æ˜ä¸åœ¨å®¹å™¨é‡Œã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># kubectl exec -it binary-controller-7dfd4bbd6f-6hsvd sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ &lt;span class="c1"># ps&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PID USER TIME COMMAND
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> root 0:30 /binary-controller -kubeconfig&lt;span class="o">=&lt;/span>inCluster -mode&lt;span class="o">=&lt;/span>prodution
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">196&lt;/span> root 0:00 sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">202&lt;/span> root 0:00 ps
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/ &lt;span class="c1"># cat /proc/1/cgroup &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">11:hugetlb:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">10:pids:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">9:perf_event:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8:freezer:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7:memory:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6:net_prio,net_cls:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5:blkio:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4:cpuacct,cpu:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3:devices:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2:cpuset:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1:name&lt;span class="o">=&lt;/span>systemd:/kubepods.slice/kubepods-burstable.slice/kubepods-burstable-pod482f0a01_7b3e_48cd_adb6_61c9097b43a4.slice/docker-b3079dba7a1cf909631c2f9e8ad38cc7f193e6ba8fe649d4d6f590a7d11b0509.scope
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## OH NO, I&amp;#39;M IN THE MATRIX&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å‡†ç¡®çš„åˆ†é¡µ</title><link>https://tab.deoops.com/posts/pagination-wf/</link><pubDate>Mon, 02 Mar 2020 11:00:52 +0800</pubDate><guid>https://tab.deoops.com/posts/pagination-wf/</guid><description>&lt;img src="https://tab.deoops.com/posts/pagination-wf/available-paginations.png" alt="Featured image of post å‡†ç¡®çš„åˆ†é¡µ" />&lt;p>æ˜¨å¤©åŒäº‹è°ƒè¯•å‰ç«¯é¡µé¢åˆ†é¡µåŠŸèƒ½æ—¶ï¼Œ å‘ç°äº†ä¸€ä¸ªåˆ†é¡µçš„é—®é¢˜ã€‚&lt;/p>
&lt;p>é—®é¢˜ç®€è¦æè¿°å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>å‰ç«¯é€‰æ‹©ä¸€äº›è¿‡æ»¤æ¡ä»¶ï¼ˆa&amp;amp;&amp;amp;b&amp;amp;&amp;amp;c||d &amp;hellip;ï¼‰å‘åç«¯è¯·æ±‚æ•°æ®ï¼Œè¿‡ä¸€ä¼šå‘ç°ç”¨åŒæ ·çš„è¿‡æ»¤æ¡ä»¶å»æŸ¥è¯¢ï¼Œæ•°æ®å˜å°‘äº†ï¼Œå‰ç«¯çœ‹ä¸Šå»ç¬¬ä¸€é¡µå’Œæœ€åä¸€é¡µæ˜¯ä¸€æ ·çš„ã€‚&lt;/p>
&lt;p>åˆæ­¥æ€€ç–‘æ˜¯åˆ†é¡µå‡ºäº†é—®é¢˜ã€‚&lt;/p>
&lt;p>è¿™ä¸ªåˆ†é¡µçš„é—®é¢˜æ¯”è¾ƒéº»çƒ¦ï¼Œä¸èƒ½ç¨³å®šå¤ç°ï¼Œä¸€ä¼šå‡ºç°ä¸€ä¼šåˆä¸å‡ºç°ã€‚&lt;/p>
&lt;p>åˆ†æäº†å¾ˆé•¿ä¸€æ®µæ—¶é—´åï¼Œå‘ç°æ˜¯åå°çš„å®šæ—¶ä»»åŠ¡æ›´æ–°äº†dbæ•°æ®ä½¿å¾—å¾ˆå¤šæ•°æ®ä¸å†ç¬¦åˆå‰é¢çš„è¿‡æ»¤æ¡ä»¶ï¼Œåç«¯æ¡†æ¶è¿”å›çš„æ€»é¡µç æ•°ï¼Œå’Œdataçš„æ•°é‡ä¸ç¬¦ã€‚&lt;/p>
&lt;p>ä¹Ÿå°±æ˜¯è¯´åç«¯è¿”å›çš„æ€»é¡µç æ•°æ˜¯è„/æ—§æ•°æ®ã€‚&lt;/p>
&lt;h2 id="è„æ•°æ®">è„æ•°æ®&lt;/h2>
&lt;p>æŸ¥çœ‹åç«¯æ¡†æ¶ä»£ç æ—¶å€™ï¼Œå‘ç°åç«¯æŸ¥è¯¢dbçš„æ‰§è¡Œäº†&lt;code>count&lt;/code> å’Œ &lt;code>select&lt;/code> ä¸¤æ¡queryï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">form&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">condition_a&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="c1">-- meamwhile other workers update table_a
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- A LOT in short time
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- or they(the workers) MIGHT lock
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">-- the WHOLE table for READ
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">select&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">form&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">table_name&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">where&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">condition_a&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™å°±æ˜¯æ˜¯é€ æˆè„æ•°æ®çš„åŸå› ã€‚&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;h3 id="window-function">window function&lt;/h3>
&lt;p>å¯ä»¥ç”¨ window function åšåˆ°ä¸Šè¿°ä¸¤æ¡queryçš„åŒæ—¶æŸ¥è¯¢ï¼ˆå…¶å®å°±æ˜¯ä¸€æ¡æŸ¥è¯¢ï¼‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">OVER&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">AS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">full_count&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tbl&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">WHERE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- /* whatever */
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">ORDER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">col1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">LIMIT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">OFFSET&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="common-table-expressions-cte">Common Table Expressions (cte)&lt;/h3>
&lt;blockquote>
&lt;p>However, as Dani pointed out, when OFFSET is at least as great as the number of rows returned from the base query, no rows are returned. So we also don&amp;rsquo;t get full_count.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>If that&amp;rsquo;s not acceptable, a possible workaround to always return the full count would be with a CTE and an OUTER JOIN:&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒ&lt;a class="link" href="https://stackoverflow.com/questions/28888375/run-a-query-with-a-limit-offset-and-also-get-the-total-number-of-rows" target="_blank" rel="noopener"
>Run a query with a LIMIT/OFFSET and also get the total number of rows&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-sql" data-lang="sql">&lt;span class="line">&lt;span class="cl">&lt;span class="k">WITH&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cte&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">AS&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">tbl&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">WHERE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c1">-- /* whatever */
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">TABLE&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cte&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">ORDER&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">BY&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">col1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">LIMIT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="k">OFFSET&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="o">?&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">sub&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="k">RIGHT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">JOIN&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">SELECT&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">count&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">FROM&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="n">cte&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">full_count&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">ON&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="k">true&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å®‰è£…wireguard</title><link>https://tab.deoops.com/posts/try-wireguard/</link><pubDate>Mon, 06 Jan 2020 16:50:26 +0800</pubDate><guid>https://tab.deoops.com/posts/try-wireguard/</guid><description>&lt;img src="https://tab.deoops.com/posts/try-wireguard/site-to-site-complex.svg" alt="Featured image of post å®‰è£…wireguard" />&lt;p>ä»Šå¤©åœ¨hacker newsä¸Šçœ‹åˆ° wireguard macos client å‘å¸ƒäº†ï¼Œå†³å®šè¯•ç”¨ä¸€ä¸‹ã€‚&lt;/p>
&lt;p>å’Œæ‰€æœ‰çš„vpnå®‰è£…ä¸€æ ·ï¼Œwireguardçš„å®‰è£…ä¹Ÿæ˜¯åˆ†ä¸¤æ­¥ï¼Œä¸€æ˜¯å®‰è£…vpn serverï¼ŒäºŒæ˜¯å®‰è£… vpnçš„clientã€‚
å®‰è£…ä¸åˆ†å…ˆåï¼Œé…ç½®å…ˆé…ç½®serverï¼Œç„¶ååœ¨é…ç½®clientã€‚&lt;/p>
&lt;h2 id="æœåŠ¡ç«¯">æœåŠ¡ç«¯&lt;/h2>
&lt;h3 id="å®‰è£…">å®‰è£…&lt;/h3>
&lt;p>æœåŠ¡å™¨ä¸º RHEL 7.6 (Maipo)ï¼Œ æœåŠ¡ç«¯çš„å®‰è£…æµç¨‹:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>sudo -i
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /etc/redhat-release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Red Hat Enterprise Linux Server release 7.6 &lt;span class="o">(&lt;/span>Maipo&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># echo &amp;#34;net.ipv4.ip_forward = 1&amp;#34; &amp;gt;&amp;gt; /etc/sysctl.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># sysctl -p&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### install packages&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># curl -Lo /etc/yum.repos.d/wireguard.repo https://copr.fedorainfracloud.org/coprs/jdoss/wireguard/repo/epel-7/jdoss-wireguard-epel-7.repo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum install -y epel-release wireguard-dkms wireguard-tools&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum install -y epel-release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># rpm -ivh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum update -y&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum install -y epel-release wireguard-dkms wireguard-tools&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># init 6&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="é…ç½®">é…ç½®&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### wireguard server conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat wg.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Interface&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ListenPort&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">58855&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PrivateKey&lt;/span> &lt;span class="o">=&lt;/span> private_key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Peer&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PublicKey&lt;/span> &lt;span class="o">=&lt;/span> public_key_one
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#AllowedIPs = 0.0.0.0/0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AllowedIPs&lt;/span> &lt;span class="o">=&lt;/span> 10.0.0.7/32
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>Peer&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">PublicKey&lt;/span> &lt;span class="o">=&lt;/span> public_key_two
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#AllowedIPs = 0.0.0.0/0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">AllowedIPs&lt;/span> &lt;span class="o">=&lt;/span> 10.0.0.9/32
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å¯åŠ¨wg0è®¾å¤‡">å¯åŠ¨wg0Â è®¾å¤‡&lt;/h3>
&lt;p>è®°å¾—åŠ ä¸Š&lt;code>iptables&lt;/code>è®¾ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### start wg0 device&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat start-wireguard.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip l a dev wg0 &lt;span class="nb">type&lt;/span> wireguard
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip a a dev wg0 10.0.0.1/24
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> wg setconf wg0 wg.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip l &lt;span class="nb">set&lt;/span> up dev wg0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> iptables -A FORWARD -i wg0 -j ACCEPT&lt;span class="p">;&lt;/span> iptables -A FORWARD -o wg0 -j ACCEPT&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯&lt;/h2>
&lt;h3 id="ä¸‹è½½">ä¸‹è½½&lt;/h3>
&lt;p>åœ¨app storeå¯ä»¥ç›´æ¥ä¸‹è½½wireguard å®¢æˆ·ç«¯ã€‚&lt;/p>
&lt;p>å¦‚æœæ˜¯ä¸­å›½å¤§é™†çš„app storeï¼Œ åˆ™éœ€è¦ä¿®æ”¹Apple IDçš„å›½å®¶å’Œåœ°åŒºæ‰èƒ½ä¸‹è½½wireguardå®¢æˆ·ç«¯ã€‚&lt;/p>
&lt;h3 id="é…ç½®-1">é…ç½®&lt;/h3>
&lt;p>æ³¨æ„ &lt;code>[Peer]&lt;/code>çš„ Endpoint å’ŒæœåŠ¡å™¨ç«¯çš„&lt;code>[Interface]&lt;/code>å¯¹ä¸Šï¼ˆéƒ½æ˜¯58855ç«¯å£)ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Interface]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">PrivateKey&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">private_key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">ListenPort&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">54123&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Address&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">10.0.0.9/32&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">DNS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">8.8.8.8, 1.1.1.1, 1.0.0.1, 8.8.4.4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Peer]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">PublicKey&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">server_public_key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">AllowedIPs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">0.0.0.0/0, ::/0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Endpoint&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">server_address:58855&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">PersistentKeepalive&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">30&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æŠ˜è…¾è°ƒè¯•">æŠ˜è…¾è°ƒè¯•&lt;/h2>
&lt;p>å®‰è£…å®Œæˆåï¼Œå¯èƒ½ä¼šé‡åˆ°vpnä¸é€šçš„é—®é¢˜ï¼Œå¯ä»¥å®‰è£…ä¸‹é¢ä»‹ç»çš„Â 
&lt;code>udp&lt;/code> port troubleshootæ–¹æ³•è°ƒè¯•è°ƒè¯•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># nc on client to scan, and tcpdump on server side&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### client side&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ ~ nc -vz -u server &lt;span class="m">58885&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## the -z option to perform a scan instead of attempting to initiate a connection.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### server side&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum install tcpdump&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># tcpdump -i eth0 udp port 58855 -vv -X&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="åè®°">åè®°&lt;/h2>
&lt;p>ä½“éªŒä¸€å¤©ï¼Œå¤§ä½“è¯´æ¥ï¼Œwireguardæ¯”shadowsocks é€Ÿåº¦å¿«ä¸Š6åˆ°8å€ã€‚&lt;/p>
&lt;h3 id="kernel-update">kernel update&lt;/h3>
&lt;p>å½“æˆ‘ä»¬å¯¹ä¸»æœºæ‰§è¡Œå‡çº§Linux kernelæ“ä½œä¹‹åï¼Œéœ€è¦é‡æ–°load wireguard modï¼Œå¦åˆ™ &lt;code>ip link add ...&lt;/code>wg0çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚&lt;/p>
&lt;p>è¿™ä¸ªæ—¶å€™ åˆ é™¤æ—§çš„ dkms modï¼ŒÂ ç„¶åaddæ–°çš„wireguard modå³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">dkms status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls /var/lib/dkms/wireguard/0.0.20191206/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/lib/dkms/wireguard/0.0.20191206/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/lib/dkms/wireguard/0.0.20200105/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf /var/lib/dkms/wireguard/0.0.20191206
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/lib/dkms/wireguard/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm -rf /var/lib/dkms/wireguard/kernel-4.18.0-80.11.2.el8_0.x86_64-x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dkms status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dkms add -m wireguard/0.0.20200105
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dkms status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/wireguard/wg0.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wg-quick up /etc/wireguard/wg0.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æŒ‚è½½ç¡¬ç›˜</title><link>https://tab.deoops.com/posts/load-disk/</link><pubDate>Fri, 18 Oct 2019 10:03:07 +0800</pubDate><guid>https://tab.deoops.com/posts/load-disk/</guid><description>&lt;img src="https://tab.deoops.com/posts/load-disk/disk.jpeg" alt="Featured image of post æŒ‚è½½ç¡¬ç›˜" />&lt;h2 id="update-more-user-friendly">update: more user friendly&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mustBeRoot&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>id -u&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> !&lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;0&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;åªæœ‰rootç”¨æˆ·æ‰èƒ½è¿è¡Œ&amp;#34;&lt;/span> 1&amp;gt;&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;å½“å‰ç™»å½•ç”¨æˆ·`whoami`&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æ•°æ®ç›˜æŒ‚è½½&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checkAndMountDataDisk&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;é€‰æ‹©æ•°æ®ç›˜/åˆ†åŒº ï¼š&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fdisk -l &lt;span class="p">|&lt;/span> grep /dev &lt;span class="p">|&lt;/span> grep G &lt;span class="p">|&lt;/span> cut -f &lt;span class="m">1&lt;/span> -d ,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">read&lt;/span> -p &lt;span class="s2">&amp;#34;è¯·è¾“å…¥ç¡¬ç›˜/åˆ†åŒº åï¼š/dev/&amp;#34;&lt;/span> -r disk_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">disk_id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>blkid &lt;span class="p">|&lt;/span> grep &lt;span class="nv">$disk_name&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$?&lt;/span> -ne &lt;span class="m">0&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;è·å–ç¡¬ç›˜/åˆ†åŒº &lt;/span>&lt;span class="nv">$disk_name&lt;/span>&lt;span class="s2"> uuidå¤±è´¥ï¼Œè¯·æ£€æŸ¥åç§°æ˜¯å¦å‡†ç¡®&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">disk_path&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$disk_id&lt;/span> &lt;span class="p">|&lt;/span> cut -f &lt;span class="m">1&lt;/span> -d &lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;å·²é€‰æ‹© &lt;/span>&lt;span class="nv">$disk_path&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">disk_uuid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>blkid &lt;span class="nv">$disk_path&lt;/span> &lt;span class="p">|&lt;/span> cut -f &lt;span class="m">2&lt;/span> -d &lt;span class="s1">&amp;#39;&amp;#34;&amp;#39;&lt;/span> &lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">disk_info&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>lsblk -f &lt;span class="nv">$disk_path&lt;/span> &lt;span class="p">|&lt;/span> grep &lt;span class="nv">$disk_uuid&lt;/span> &lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$?&lt;/span> -ne &lt;span class="m">0&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;è·å–ç¡¬ç›˜/åˆ†åŒº &lt;/span>&lt;span class="nv">$disk_path&lt;/span>&lt;span class="s2"> è¯¦ç»†ä¿¡æ¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥åç§°æ˜¯å¦æ­£ç¡®&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">fs_type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$disk_info&lt;/span> &lt;span class="p">|&lt;/span> cut -f &lt;span class="m">2&lt;/span> -d &lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$fs_type&lt;/span> !&lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;ext4&amp;#39;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;ç¡¬ç›˜æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ä¸æ˜¯ext4ã€‚&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">read&lt;/span> -p &lt;span class="s2">&amp;#34;æ˜¯å¦æ ¼å¼åŒ–ä¸º ext4ï¼Ÿ è¾“å…¥ y åŒæ„æ ¼å¼åŒ–&amp;#34;&lt;/span> -r format_ext4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$format_ext4&lt;/span> !&lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;y&amp;#39;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;æœªæ ¼å¼åŒ– &lt;/span>&lt;span class="nv">$disk_path&lt;/span>&lt;span class="s2"> æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼Œé€€å‡ºå®‰è£…è„šæœ¬ã€‚&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;å³å°†æ ¼å¼åŒ– &lt;/span>&lt;span class="nv">$disk_path&lt;/span>&lt;span class="s2"> æ–‡ä»¶ç³»ç»Ÿæ ¼å¼....&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfs.ext4 &lt;span class="nv">$disk_path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -d &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$1&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;æ•°æ®ç›˜æŒ‚è½½ç‚¹/dataç›®å½•å·²å­˜åœ¨&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;åˆ›å»ºæ•°æ®ç›˜æŒ‚è½½ç‚¹/dataç›®å½•&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkdir &lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mount &lt;span class="nv">UUID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$disk_uuid&lt;/span> &lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;UUID=&lt;/span>&lt;span class="nv">$disk_uuid&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="nv">$1&lt;/span>&lt;span class="s2"> ext4 defaults 0 0&amp;#34;&lt;/span> &amp;gt;&amp;gt; /etc/fstab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;ç¡¬ç›˜æŒ‚è½½æˆåŠŸ&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checkDataMountpoint&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;æŒ‚è½½æ•°æ®ç›˜&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grep &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$1&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> /etc/fstab &lt;span class="p">|&lt;/span> grep ext4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$?&lt;/span> -ne &lt;span class="m">0&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> checkAndMountDataDisk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;æ•°æ®ç›˜å·²æŒ‚è½½&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mount -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cpAndUntar
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mustBeRoot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">checkDataMountpoint &lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="p">-/data&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="lsblk">lsblk&lt;/h2>
&lt;p>é¦–å…ˆä½¿ç”¨&lt;code>lsblk&lt;/code>æŸ¥çœ‹å½“å‰ç³»ç»Ÿç¡¬ç›˜æŒ‚è½½çš„æƒ…å†µ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@dev-7 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># lsblk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sr0 11:0 &lt;span class="m">1&lt;/span> 1024M &lt;span class="m">0&lt;/span> rom
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vda 253:0 &lt;span class="m">0&lt;/span> 40G &lt;span class="m">0&lt;/span> disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€vda1 253:1 &lt;span class="m">0&lt;/span> 40G &lt;span class="m">0&lt;/span> part /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vdb 253:16 &lt;span class="m">0&lt;/span> 200G &lt;span class="m">0&lt;/span> disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€vdb1 253:17 &lt;span class="m">0&lt;/span> 200G &lt;span class="m">0&lt;/span> part
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="format-and-mount">format and mount&lt;/h2>
&lt;p>æ ¼å¼åŒ–ç¡¬ç›˜ç„¶åæŒ‚è½½åˆ°&lt;code> /media/newdrive&lt;/code> ç›®å½•&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### disk_add_new.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> set_vars&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">fs_ty&lt;/span>&lt;span class="o">=&lt;/span>ext4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">mount_point&lt;/span>&lt;span class="o">=&lt;/span>/media/newdrive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#check=`fdisk -l | grep GB | cut -d &amp;#39;:&amp;#39; -f1 | cut -c 6-`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#new_disk=`echo $check | cut -d &amp;#39; &amp;#39; -f 2`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">new_disk&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># new_disk=${check##*\ }&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> make_file_system&lt;span class="o">(){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfs -t &lt;span class="nv">$fs_ty&lt;/span> &lt;span class="nv">$new_disk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> get_uuid&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">uuid_info&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>blkid &lt;span class="nv">$new_disk&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">uuid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">uuid_info&lt;/span>&lt;span class="p">#*UUID&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$uuid&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s1">&amp;#39;&amp;#34;&amp;#39;&lt;/span> -f 2&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> mount_and_auto_mount&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkdir -p &lt;span class="nv">$mount_point&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mount -t &lt;span class="nv">$fs_ty&lt;/span> &lt;span class="nv">$new_disk&lt;/span> &lt;span class="nv">$mount_point&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> grep &lt;span class="nv">$id&lt;/span> /etc/fstab &lt;span class="o">||&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">UUID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$id&lt;/span> &lt;span class="nv">$mount_point&lt;/span> &lt;span class="nv">$fs_ty&lt;/span> defaults &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &amp;gt;&amp;gt; /etc/fstab
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> run&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> set_vars &lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> make_file_system
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> get_uuid
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> &lt;span class="si">${#&lt;/span>&lt;span class="nv">id&lt;/span>&lt;span class="si">}&lt;/span> -gt &lt;span class="m">30&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mount_and_auto_mount
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">run &lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ‰©å®¹">æ‰©å®¹&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">mount_point&lt;/span>&lt;span class="o">=&lt;/span>/media/newdrive
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># check=`fdisk -l | grep GB | cut -d &amp;#39;:&amp;#39; -f1 | cut -c 6-`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># disk=`echo $check | cut -d &amp;#39; &amp;#39; -f 2`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">disk&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span> &lt;span class="c1"># /dev/sdb sdc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">fs_ty&lt;/span>&lt;span class="o">=&lt;/span>ext4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">e2fsck -f &lt;span class="nv">$disk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">resize2fs &lt;span class="nv">$disk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount -t &lt;span class="nv">$fs_ty&lt;/span> &lt;span class="nv">$disk&lt;/span> &lt;span class="nv">$mount_point&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é€»è¾‘å·">é€»è¾‘å·&lt;/h2>
&lt;h3 id="åˆ›å»ºé€»è¾‘å·">åˆ›å»ºé€»è¾‘å·&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">pvcreate /dev/vdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vgcreate vg02 /dev/vdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">lvcreate -l 90%free -n kubelet vg02
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkfs.xfs -n &lt;span class="nv">ftype&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> /dev/vg02/kubelet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount /dev/vg02/kubelet /var/lib/kubelet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;/dev/mapper/vg02-kubelet /var/lib/kubelet xfs defaults 0 0 &amp;#34;&lt;/span> &amp;gt;&amp;gt; /etc/fstab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ‰©å®¹é€»è¾‘å·">æ‰©å®¹é€»è¾‘å·&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 1. åˆ é™¤æœªæŒ‚è½½çš„é€»è¾‘å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lvremove vg02/kubelet &lt;span class="c1"># lvremove vg02&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 2. åˆ é™¤kubeletçš„ç£ç›˜&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> vgreduce vg02 /dev/vdb &lt;span class="c1"># vgremove vg02&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 3. å°†åŸæ¥çš„ç£ç›˜åŠ åˆ°åˆ«çš„vg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> vgextend vg01 /dev/vdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 4. æ‰©å®¹é€»è¾‘å·&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lvextend -L +200G /dev/vg01/var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 5. ç”Ÿæ•ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> xfs_groups /dev/vg01/var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 6. åˆ é™¤/etc/fstab ä¸­kubeletçš„æŒ‚è½½ç‚¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## vim /etc/fstab +5dd&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="troubleshoot">troubleshoot&lt;/h3>
&lt;p>æœ‰æ—¶å€™åˆ é™¤é€»è¾‘å·ä¼šé‡åˆ°æŠ¥é”™&lt;code>Logical volume vg01/LVgdb contains a filesystem in use&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@cnsz92vl14311 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># umount /dev/vg01/LVgdb &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@cnsz92vl14311 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># lvremove /dev/vg01&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Do you really want to remove active logical volume LVgdb? &lt;span class="o">[&lt;/span>y/n&lt;span class="o">]&lt;/span>: y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Logical volume &lt;span class="s2">&amp;#34;LVgdb&amp;#34;&lt;/span> successfully removed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@cnsz92vl14311 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># lsblk&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vda 252:0 &lt;span class="m">0&lt;/span> 60G &lt;span class="m">0&lt;/span> disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€vda1 252:1 &lt;span class="m">0&lt;/span> 476M &lt;span class="m">0&lt;/span> part /boot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€vda2 252:2 &lt;span class="m">0&lt;/span> 59.5G &lt;span class="m">0&lt;/span> part
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€vg00-root 253:0 &lt;span class="m">0&lt;/span> 10G &lt;span class="m">0&lt;/span> lvm /
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€vg00-home 253:1 &lt;span class="m">0&lt;/span> 500M &lt;span class="m">0&lt;/span> lvm /home
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€vg00-var 253:2 &lt;span class="m">0&lt;/span> 10G &lt;span class="m">0&lt;/span> lvm /var
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â”œâ”€vg00-tmp 253:3 &lt;span class="m">0&lt;/span> 10G &lt;span class="m">0&lt;/span> lvm /tmp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> â””â”€vg00-app 253:4 &lt;span class="m">0&lt;/span> 29G &lt;span class="m">0&lt;/span> lvm /app
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vdb 252:16 &lt;span class="m">0&lt;/span> 300G &lt;span class="m">0&lt;/span> disk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@cnsz92vl14311 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>è¯ä¹¦é—®é¢˜</title><link>https://tab.deoops.com/posts/container-ca/</link><pubDate>Thu, 12 Sep 2019 10:11:32 +0800</pubDate><guid>https://tab.deoops.com/posts/container-ca/</guid><description>&lt;img src="https://tab.deoops.com/posts/container-ca/common-ca.png" alt="Featured image of post è¯ä¹¦é—®é¢˜" />&lt;p>&lt;code>docker run&lt;/code>è°ƒè¯•æŸä¸ªcontaineræŠ¥å¦‚ä¸‹æ‰€ç¤º&lt;code>x509&lt;/code>è¯ä¹¦é”™è¯¯ï¼Œä¸€å¼€å§‹æ€€ç–‘æ˜¯å®¹å™¨ç½‘ç»œï¼ˆ&lt;code>--network host&lt;/code>) çš„é—®é¢˜ :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>deoops@dev-3 ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># docker run --network host datewu/controller:v0.0.2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;level&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;panic&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;error&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;Get https://google.com: x509: certificate signed by unknown authority&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;time&amp;#34;&lt;/span>:1555498448,&lt;span class="s2">&amp;#34;message&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;get max item failed&amp;#34;&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">panic: get max item failed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">goroutine &lt;span class="m">26&lt;/span> &lt;span class="o">[&lt;/span>running&lt;span class="o">]&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com/rs/zerolog.&lt;span class="o">(&lt;/span>*Logger&lt;span class="o">)&lt;/span>.Panic.func1&lt;span class="o">(&lt;/span>0x7773e9, 0x13&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/go/pkg/mod/github.com/rs/zerolog@v1.13.0/log.go:307 +0x4f
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com/rs/zerolog.&lt;span class="o">(&lt;/span>*Event&lt;span class="o">)&lt;/span>.msg&lt;span class="o">(&lt;/span>0xc00012e8a0, 0x7773e9, 0x13&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/go/pkg/mod/github.com/rs/zerolog@v1.13.0/event.go:141 +0x1c1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">github.com/rs/zerolog.&lt;span class="o">(&lt;/span>*Event&lt;span class="o">)&lt;/span>.Msg&lt;span class="o">(&lt;/span>...&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/go/pkg/mod/github.com/rs/zerolog@v1.13.0/event.go:105
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">main.catchUp&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/github/controller/work.go:69 +0x326
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">main.populate&lt;span class="o">(&lt;/span>0xc000114000&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/github/controller/worker.go:10 +0x26
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">created by main.initWork
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> /Users/deoops/github/controller/work.go:84 +0x7f
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é”™è¯¯ä¿¡æ¯å¤§æ¦‚æ˜¯è¯´ client ä¸èƒ½è¯†åˆ«googleçš„https è¯ä¹¦ï¼Œ å¯èƒ½æ˜¯base image &lt;code>alpine&lt;/code>çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>å°†&lt;code>base image&lt;/code>æ”¹ä¸º &lt;code>scratch&lt;/code> ï¼Œç»“æœè¿˜æ˜¯ä¼šæŠ¥&lt;code>x509&lt;/code>é”™ã€‚&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>ç»™ &lt;code>alpine&lt;/code>é•œåƒ &lt;a class="link" href="https://support.circleci.com/hc/en-us/articles/360016505753-Resolve-Certificate-Signed-By-Unknown-Authority-error-in-Alpine-images" target="_blank" rel="noopener"
>åŠ ä¸Šca-certificates&lt;/a>è§£å†³äº†é—®é¢˜:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-dockerfile" data-lang="dockerfile">&lt;span class="line">&lt;span class="cl">&lt;span class="k">FROM&lt;/span>&lt;span class="s"> alpine&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># add Common CA certificates PEM files&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">RUN&lt;/span> apk --no-cache add ca-certificates&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># ....&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"># docker build -t datewu/alpine-ca .&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»¥åç”¨åˆ°&lt;code>alpine&lt;/code>çš„Dockerfile ç›´æ¥ &lt;code>FROM datewu/alpine-ca&lt;/code> é—®é¢˜è§£å†³å•¦ğŸ˜„&lt;/p>
&lt;blockquote>
&lt;p>æ€»ç»“ä¸€ä¸‹ï¼šå½“å®¹å™¨é‡Œçš„è¿›ç¨‹è®¿é—®å¤–éƒ¨tls serveræ—¶ï¼Œå¦‚æœå®¹å™¨å†…æ²¡æœ‰é…ç½®Common CA certificatesï¼Œå®¢æˆ·ç«¯å°±ä¼šå‡ºç°æ— æ³•è¯†åˆ«serverè¯ä¹¦çš„é—®é¢˜ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ps:
ä»Šå¤©åœ¨å†™å­—æ¥¼äºŒæ¥¼å¿«é¤åº—åƒæ™šé¥­çš„æ—¶å€™ï¼Œé‡åˆ°ä¸¤ä¸ªå»ºç­‘å·¥äººï¼Œ50-60å²çš„æ ·å­ï¼Œåƒæ˜¯å¤«å¦»ã€‚&lt;/p>
&lt;p>ä¸¤ä¸ªäººä¸€èµ·æ‰“æ‰åƒäº†10å—é’±ï¼šä¸€äººä¸€ä¸ªç´ èœï¼Œè±†èŠ½èœå’Œé»‘æ²¹ç™½ã€‚&lt;/p>
&lt;p>ppsï¼šå¿«é¤åº—ä¸‹åˆçš„æ±¤æ˜¯å…è´¹çš„ï¼Œæ‰€ä»¥ä»–ä»¬ä¸€äººåˆæ‹¿äº†ä¸€ç¢—æ±¤ï¼Œ&lt;/p>
&lt;p>å›æƒ³èµ·ä»Šå¤©æˆ‘è¿‡æ—©æ‰å°±åƒäº†10å—é’±ï¼Œå—Ÿä¹å”å˜˜ã€‚&lt;/p></description></item><item><title>ç»†è¯´kubeconfig</title><link>https://tab.deoops.com/posts/explain-kubeconfig/</link><pubDate>Sun, 11 Aug 2019 22:09:21 +0800</pubDate><guid>https://tab.deoops.com/posts/explain-kubeconfig/</guid><description>&lt;img src="https://tab.deoops.com/posts/explain-kubeconfig/kubeconfig.png" alt="Featured image of post ç»†è¯´kubeconfig" />&lt;p>ä»Šå¤©å‡†å¤‡ç®¡ç†æŸä¸€ä¸ªkubernetes é›†ç¾¤æ—¶å‘ç°masterä¸»æœº22ç«¯å£å› ä¸ºç®¡ç†çš„éœ€è¦è¢«ç¦ç”¨äº†ï¼Œæ— æ³•ç™»é™†æœåŠ¡å™¨ã€‚&lt;/p>
&lt;p>é—®äº†ä¸€ä¸‹è¿ç»´äººå‘˜ï¼ŒåŸæ¥æ˜¯åŸºäºå®‰å…¨åŸå› ï¼Œå…¬å¸å†³å®šç¦ç”¨æ‰€æœ‰æœåŠ¡å™¨çš„&lt;code>root ssh&lt;/code>ç™»é™†æƒé™ï¼Œ&lt;/p>
&lt;p>å¹³æ—¶æˆ‘éƒ½æ˜¯ssh ç™»é™†åˆ°master nodeï¼Œåœ¨æœåŠ¡å™¨ä¸Šç›´æ¥ä½¿ç”¨kubectlå‘½ä»¤ æŸ¥çœ‹/éƒ¨ç½²/debug deployment/serviceç­‰èµ„æºï¼Œ&lt;/p>
&lt;p>ç°åœ¨åªå¥½ä¿®æ”¹ä¸‹æœ¬åœ° kubeconfig æ–‡ä»¶ï¼Œç”¨è‡ªå·±æœ¬åœ°çš„ &lt;code>kubectl&lt;/code> ç®¡ç†/æ“ä½œkubernetesé›†ç¾¤ã€‚&lt;/p>
&lt;p>æ“ä½œäº†ä¸€æ®µæ—¶é—´åï¼Œå‘ç°ç”¨æœ¬åœ°kubectlæ“ä½œkubernetesä½“éªŒè›®å¥½çš„ï¼Œç‰¹åˆ«æ˜¯æœåŠ¡å™¨ç¼ºå°‘æœ¬åœ°editor(vim) &lt;code>kubectl edit ...&lt;/code> çš„è¯­æ³•é«˜äº®æ”¯æŒã€‚&lt;/p>
&lt;p>é…ç½®kubeconfigè¿‡ç¨‹åˆ†äº«å¦‚ä¸‹ï¼Œå¤§ä½“ä¸Šè¯´è¿‡å°±ä¸¤æ­¥ï¼š&lt;/p>
&lt;ol>
&lt;li>æ·»åŠ  contextï¼›&lt;/li>
&lt;li>use contextã€‚&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vim .kube/config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl config use-context dev-8-admin@kubernetes
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é™¤äº†ä½¿ç”¨vim ç¼–è¾‘ &lt;code>.kube/config&lt;/code> æ–‡ä»¶ï¼Œå¯¹äºä¸€äº›ç®€å•çš„é…ç½®ä¹Ÿå¯ä»¥ä½¿ç”¨&lt;code>kubectl config&lt;/code> command å¿«é€Ÿé…ç½®kubeconfigï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## create new cluster&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> kubectl config set-cluster NAME &lt;span class="o">[&lt;/span>--server&lt;span class="o">=&lt;/span>server&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--certificate-authority&lt;span class="o">=&lt;/span>path/to/certificate/authority&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--insecure-skip-tls-verify&lt;span class="o">=&lt;/span>true&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## create new user&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl config set-credentials NAME &lt;span class="o">[&lt;/span>--client-certificate&lt;span class="o">=&lt;/span>path/to/certfile&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--client-key&lt;span class="o">=&lt;/span>path/to/keyfile&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>--token&lt;span class="o">=&lt;/span>bearer_token&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--username&lt;span class="o">=&lt;/span>basic_user&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--password&lt;span class="o">=&lt;/span>basic_password&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--auth-provider&lt;span class="o">=&lt;/span>provider_name&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>--auth-provider-arg&lt;span class="o">=&lt;/span>&lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>value&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## create new context&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl config set-context &lt;span class="o">[&lt;/span>NAME &lt;span class="p">|&lt;/span> --current&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--cluster&lt;span class="o">=&lt;/span>cluster_nickname&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--user&lt;span class="o">=&lt;/span>user_nickname&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>--namespace&lt;span class="o">=&lt;/span>namespace&lt;span class="o">]&lt;/span> &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## use context&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubectl config use-context CONTEXT_NAME &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦å¤–ï¼Œ&lt;code>kubectl config set&lt;/code> ä¸æ”¯æŒå¯¹ &lt;code>certificate-authority-data&lt;/code>å­—æ®µçš„è®¾ç½®ï¼Œåªæ”¯æŒæŒ‡å®šdataæ–‡ä»¶çš„è·¯å¾„ï¼Œ æ‰€ä»¥æ¨èç”¨vim ç¼–è¾‘kubeconfigæ–‡ä»¶ã€‚&lt;/p>
&lt;h2 id="kuebconfig-demo">kuebconfig demo&lt;/h2>
&lt;p>ä¸‹é¢æ˜¯ä¸€ä»½é…ç½®å¥½çš„ kubeconfig demoæ–‡ä»¶ï¼Œä¾›å‚è€ƒ:
ï¼ˆç•¥å»äº†client çš„è¯ä¹¦, private keyç­‰æ•æ„Ÿä¿¡æ¯ï¼‰&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">clusters&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">certificate-authority-data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">YOUR kubernete CA BASE64 DATA &lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">server&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://test-8:9443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-8&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">certificate-authority&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/Users/r/.minikube/ca.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">server&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://192.168.99.117:8443&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">minikube&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">contexts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-8&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-8-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-8-admin@kubernetes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">cluster&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">minikube&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">minikube&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">minikube&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">current-context&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">test-8-admin@kubernetes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Config&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">preferences&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>{}&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">users&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">dev-8-admin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-certificate-data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">YOUR client CERT BASE64 DATA&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-key-data&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">YOUR client PRIVATE KEY DATA&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">minikube&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">user&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-certificate&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/Users/r/.minikube/client.crt&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">client-key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/Users/r/.minikube/client.key&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="kubecofig-å­—æ®µè§£é‡Š">kubecofig å­—æ®µè§£é‡Š&lt;/h3>
&lt;p>kubeconfigæ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¸Šé¢çš„ç¼–è¾‘è¿‡ç¨‹åˆ°åº•åšäº†ä»€ä¹ˆï¼š&lt;/p>
&lt;p>kubeconfig æ˜¯ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªé…ç½®æ–‡ä»¶ä½¿ç”¨äº† yaml æ–‡ä»¶çš„è¯­æ³•ï¼Œä¸»è¦è®°å½•äº†kubernetes é›†ç¾¤çš„è®¤è¯ä¿¡æ¯ã€‚&lt;/p>
&lt;p>kubectl æˆ–è€…æ˜¯å…¶å®ƒçš„kubernetes clienté€šè¿‡&lt;strong>è§£ækubeconfigæ–‡ä»¶&lt;/strong>å¾—åˆ°kubernetes clusterçš„è®¤è¯ä¿¡æ¯ï¼Œä»è€Œä½¿ç”¨/ç®¡ç† kubernetes é›†ç¾¤ã€‚&lt;/p>
&lt;p>å®‰è£…kubectlçš„æ—¶å€™ï¼Œ&lt;code>~/.kube/config&lt;/code>æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªkubeconfigï¼Œè€Œä¸”å¯ä»¥é…ç½®ç®¡ç†å¤šä¸ªkubernetesé›†ç¾¤ã€‚&lt;/p>
&lt;p>kubeconfigçš„å¯è¯»æ€§å¾ˆé«˜ï¼Œå»ºè®®ä»”ç»†é€šè¯»ä¸‹ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªkubeconfigæ–‡ä»¶åŒ…å«äº†3ä¸ªå¯¹è±¡ï¼Œ ä¸€ç§å…³ç³»:&lt;/p>
&lt;p>ä¸€ä¸ª kubeconfg å¯ä»¥åŒ…å« å¤šä¸ª contextï¼Œå¤šä¸ª clusterï¼Œ å¤šä¸ª userã€‚ æ¯ä¸ª context ç”±ä¸€ä¸ªcluster å’Œ user ç»„æˆã€‚&lt;/p>
&lt;p>clusterç”± apiserveråœ°å€ï¼Œ server ca ä¿¡æ¯ï¼Œå’Œcluster name ç»„æˆã€‚&lt;/p>
&lt;p>user (user çš„å®šä¹‰å…¶å®å°±æ˜¯ kubernetes client çš„ auth å®šä¹‰) çš„å®šä¹‰ç›¸å¯¹çµæ´»äº›ï¼š&lt;/p>
&lt;ol>
&lt;li>å¯ä»¥æ˜¯æˆ‘ä¸Šé¢è´´å‡ºæ¥çš„ certificate è®¤è¯ä¿¡æ¯ï¼›&lt;/li>
&lt;li>ä¹Ÿå¯ä»¥æ˜¯ username/password çš„è®¤è¯ä¿¡æ¯(k3s çš„kubeconfig å°±æ˜¯ç”¨çš„è¿™ç§)ï¼›&lt;/li>
&lt;li>æˆ–è€…æ˜¯ç”¨serviceAccount çš„ tokenè®¤è¯ä¹Ÿå¯ä»¥ï¼Œ&lt;/li>
&lt;/ol>
&lt;p>æ€»çš„è¯´æ¥ä¸€ä»½auth ä¿¡æ¯ å’Œ ä¸€ä¸ªname å¯¹åº”äº†ä¸€ä¸ªuser çš„å®šä¹‰ã€‚&lt;/p>
&lt;p>å¤§å®¶åº”è¯¥æ³¨æ„åˆ°äº† cluster å’Œ user çš„ç»„åˆ&lt;strong>å¯ä»¥å¾ˆçµæ´»&lt;/strong>ï¼Œä»è€Œäº§ç”Ÿå¤šç§ contextã€‚&lt;/p>
&lt;h2 id="client-goæ“ä½œkubecofig">client-goæ“ä½œkubecofig&lt;/h2>
&lt;h3 id="marshal">marshal&lt;/h3>
&lt;p>æŠŠ &lt;code>restclient.Config&lt;/code> ç¼–ç ä¿å­˜åˆ°æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;clientcmdapi &amp;#34;&lt;/span>&lt;span class="nx">k8s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">client&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="k">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tools&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clientcmd&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="s">&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> &amp;#34;&lt;/span>&lt;span class="nx">k8s&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">io&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">client&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="k">go&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">tools&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">clientcmd&lt;/span>&lt;span class="err">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// èŠ‚é€‰ï¼Œæœ‰åˆ å‡
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">snipedDumpKubeconfig&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">globalKubeCfg&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">clientcmdapi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewConfig&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Clusters&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">clusterName&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">clientcmdapi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewCluster&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Clusters&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">clusterName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Server&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Host&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Clusters&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">clusterName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">CertificateAuthorityData&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">CAData&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AuthInfos&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">authName&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">clientcmdapi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewAuthInfo&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AuthInfos&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">authName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">ClientCertificateData&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">CertData&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AuthInfos&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">authName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">ClientKeyData&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">KeyData&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Contexts&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">contextName&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">clientcmdapi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewContext&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Contexts&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">contextName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">Cluster&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">clusterName&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Contexts&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">contextName&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">AuthInfo&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">authName&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">clientcmd&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteToFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">globalKubeCfg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">globalKubeconfFile&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="unmarshal">unmarshal&lt;/h3>
&lt;p>ç”± kubeconfigæ–‡ä»¶ç”Ÿæˆ &lt;code>restclient.Config&lt;/code>ï¼š
åœ¨å®˜æ–¹çš„ &lt;code>k8s.io/client-go/tools/clientcmd&lt;/code> åŒ…ä¸­å¯ä»¥æ‰¾åˆ°exampleï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// RESTConfigFromKubeConfig is a convenience method to give back a restconfig from your kubeconfig bytes.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// For programmatic access, this is what you want 80% of the time
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">RESTConfigFromKubeConfig&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">configBytes&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">restclient&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Config&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">clientConfig&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">NewClientConfigFromBytes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">configBytes&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">clientConfig&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ClientConfig&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// BuildConfigFromFlags is a helper function that builds configs from a master
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// url or a kubeconfig filepath. These are passed in as command line flags for cluster
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// components. Warnings should reflect this usage. If neither masterUrl or kubeconfigPath
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// are passed in we fallback to inClusterConfig. If inClusterConfig fails, we fallback
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// to the default config.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">BuildConfigFromFlags&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">masterUrl&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">kubeconfigPath&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">restclient&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Config&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">kubeconfigPath&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nx">masterUrl&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">klog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Warningf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Neither --kubeconfig nor --master was specified. Using the inClusterConfig. This might not work.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">kubeconfig&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">restclient&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">InClusterConfig&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">kubeconfig&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">klog&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Warning&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;error creating inClusterConfig, falling back to default config: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nf">NewNonInteractiveDeferredLoadingClientConfig&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">ClientConfigLoadingRules&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">ExplicitPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">kubeconfigPath&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">ConfigOverrides&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">ClusterInfo&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">clientcmdapi&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Cluster&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">Server&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">masterUrl&lt;/span>&lt;span class="p">}}).&lt;/span>&lt;span class="nf">ClientConfig&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Systemdé…ç½®é—®é¢˜</title><link>https://tab.deoops.com/posts/systemd-conf/</link><pubDate>Sat, 11 May 2019 16:02:39 +0800</pubDate><guid>https://tab.deoops.com/posts/systemd-conf/</guid><description>&lt;img src="https://tab.deoops.com/posts/systemd-conf/Systemd_components.svg" alt="Featured image of post Systemdé…ç½®é—®é¢˜" />&lt;h2 id="é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;p>ç”¨ kubeadm éƒ¨ç½² kubernetes é›†ç¾¤ï¼Œå¯åŠ¨kubeletæœåŠ¡åï¼Œkubelet daemon ä¼šè®¤ä¸º &lt;code>/etc/sysconfig/kubelet&lt;/code>å†…å®¹çš„ä¼˜å…ˆçº§æ›´é«˜ï¼Œ&lt;/p>
&lt;p>è¦†ç›–&lt;code>KUBELET_EXTRA_ARGS&lt;/code>ç¯å¢ƒå˜é‡&lt;code>--pod-infra-container-image&lt;/code>çš„é…ç½®å†…å®¹ã€‚&lt;/p>
&lt;h3 id="åˆ†æ">åˆ†æ&lt;/h3>
&lt;h4 id="kubeletserviceæ–‡ä»¶">kubelet.serviceæ–‡ä»¶&lt;/h4>
&lt;p>é¦–å…ˆæŸ¥çœ‹&lt;code>/etc/systemd/system/kubelet.service&lt;/code>æ–‡ä»¶:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cat /etc/systemd/system/kubelet.service&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Unit]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Description&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">kubelet: The Kubernetes Node Agent&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Documentation&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">https://kubernetes.io/docs/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Service]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/usr/bin/kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Restart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">always&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">StartLimitInterval&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">RestartSec&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Install]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">WantedBy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">multi-user.target&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„ç¬¬5è¡Œçš„ExecStartæŒ‡ä»¤ä¸º&lt;code>/usr/bin/kubelet&lt;/code>&lt;/p>
&lt;h4 id="kubeletserviced-ç›®å½•">kubelet.service.d ç›®å½•&lt;/h4>
&lt;p>ç„¶åæŸ¥çœ‹kubeletæœåŠ¡çš„é…ç½®ç›®å½•&lt;code>/etc/systemd/system/kubelet.service.d/&lt;/code>ï¼Œæ³¨æ„
&lt;code>kubeadm&lt;/code>ä¼šåœ¨è¿™é‡Œåˆ›å»ºä¸€ä¸ª10-kubeadm.confæ–‡ä»¶æ¥é…ç½®&lt;code>kubelet&lt;/code>å¯åŠ¨æ–¹å¼ï¼ˆå‚æ•°ï¼‰ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cat /etc/systemd/system/kubelet.service.d/10-kubeadm.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Note: This dropin only works with kubeadm and kubelet v1.11+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Service]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Environment&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Environment&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This is a file that &amp;#34;kubeadm init&amp;#34; and &amp;#34;kubeadm join&amp;#34; generates at runtime, populating the KUBELET_KUBEADM_ARGS variable dynamically&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">EnvironmentFile&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">-/var/lib/kubelet/kubeadm-flags.env&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># This is a file that the user can use for overrides of the kubelet args as a last resort. Preferably, the user should use&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># the .NodeRegistration.KubeletExtraArgs object in the configuration files instead. KUBELET_EXTRA_ARGS should be sourced from this file.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">EnvironmentFile&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">-/etc/sysconfig/kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é…ç½®æ–‡ä»¶çš„loadçš„é¡ºåºæ˜¯ä»¥å­—æ¯é¡ºåºæ’åˆ—çš„ï¼Œ å¦‚æœæˆ‘ä»¬ä¹Ÿåœ¨è¿™é‡Œåˆ›å»ºäº†kubeletçš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚20-my-kubelet.confï¼Œ&lt;code>10-*&lt;/code>ä¼šå…ˆè¢«è¯»å–ï¼Œ&lt;code>20-*&lt;/code>å…¶æ¬¡ã€‚&lt;/p>
&lt;p>æ³¨æ„&lt;code>10-kubeadm.conf&lt;/code>æ–‡ä»¶çš„å€’æ•°ç¬¬äºŒè¡Œ&lt;code>ExecStart=ç©ºè¡Œ&lt;/code>ï¼Œè¿™ä¸€è¡Œç­‰æ•ˆäº&lt;code>kubeadm&lt;/code>è¦†ç›–äº†ä¸Šé¢&lt;a class="link" href="#kubeletservice%e6%96%87%e4%bb%b6" >kubelet.service&lt;/a> çš„ExecStartæŒ‡ä»¤ï¼&lt;/p>
&lt;h3 id="ç»“è®º">ç»“è®º&lt;/h3>
&lt;p>&lt;code>[Service]&lt;/code>è¦†ç›–å’Œå……å€¼ç‰¹æ€§ã€‚&lt;/p>
&lt;p>ExecStartå‚æ•°ç‰¹æ€§ï¼šå¦‚æœå·²ç»è®¾ç½®&lt;code>ExecStart&lt;/code>æŒ‡ä»¤å‚æ•°ï¼Œ åç»­ExecStartæŒ‡ä»¤ä¼šå åŠ æ‰€æœ‰çš„å‚æ•°ï¼Œé¡ºåºapplyæ‰€æœ‰æŒ‡ä»¤ã€‚&lt;/p>
&lt;p>å¦‚æœæƒ³è¦æ¸…ç©ºå‰é¢çš„&lt;code>ExecStart&lt;/code>æŒ‡ä»¤ï¼Œåˆ™éœ€è¦å†™ä¸€è¡Œç©ºçš„&lt;code>ExecStart=&lt;/code>,ç„¶åå†™æ–°çš„ExecStart=&amp;hellip;&amp;hellip;æŒ‡ä»¤ã€‚&lt;/p>
&lt;p>åŒç†&lt;code>KUBELET_EXTRA_ARGS&lt;/code>ä¹Ÿä¼šæœ‰è¦†ç›–å’Œæ¸…ç©ºçš„è¯­æ³•ã€‚&lt;/p>
&lt;p>ç›®å‰æˆ‘ä»¬&lt;code>/etc/systemd/system/kubelet.service.d/20-my-kubelet.conf&lt;/code>æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="k">[Service]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">Environment&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;KUBELET_EXTRA_ARGS=--pod-infra-container-image=172.20.8.4/library/pause:3.1 --feature-gates=LocalStorageCapacityIsolation=true \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--kube-reserved-cgroup&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/kubepods.slice --kube-reserved=cpu=500m,memory=500Mi,ephemeral-storage=1Gi \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--system-reserved-cgroup&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/system.slice --system-reserved=cpu=500m,memory=500Mi,ephemeral-storage=1Gi \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--eviction-hard&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">memory.available&amp;lt;500Mi,nodefs.available&amp;lt;10%&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¡¨é¢ä¸Šçœ‹ &lt;code>20-my-kubelet.conf&lt;/code>è¿½åŠ äº†&lt;code>KUBELET_EXTRA_ARGS&lt;/code>ç¯å¢ƒå˜é‡ï¼Œåº”è¯¥æ˜¯æˆåŠŸçš„é…ç½®äº†&lt;code>--pod-infra-container-image&lt;/code>å‚æ•°ï¼Œ&lt;/p>
&lt;p>ä½†æ˜¯åœ¨&lt;code>10-kubeadm.conf&lt;/code>æ–‡ä»¶é‡Œå·²ç»å®šä¹‰&lt;code>EnvironmentFile=-/etc/sysconfig/kubelet&lt;/code>ï¼Œç„¶å
åœ¨&lt;code>/etc/sysconfig/kubelet&lt;/code>é‡Œæœ‰ä¸€å¥&lt;code>KUBELET_EXTRA_ARGS=&lt;/code>ï¼Œç­‰äºå·åé¢æ— å€¼ï¼Œæ¸…ç©ºäº†&lt;code>KUBELET_EXTRA_ARGS&lt;/code>ç¯å¢ƒå˜é‡ã€‚&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>åˆ é™¤20-my-kubelet.confæ–‡ä»¶ï¼Œç›´æ¥åœ¨/etc/systemconf/kubeletä¸­å®šä¹‰KUBELET_EXTRA_ARGSå‚æ•°å®šä¹‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># cat /etc/systemconf/kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#KUBELET_EXTRA_ARGS=&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">KUBELET_EXTRA_ARGS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">--pod-infra-container-image=192.168.9.20/library/pause:3.1 --feature-gates=LocalStorageCapacityIsolation=true \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--kube-reserved-cgroup&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/kubepods.slice --kube-reserved=cpu=500m,memory=500Mi,ephemeral-storage=1Gi \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--system-reserved-cgroup&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/system.slice --system-reserved=cpu=500m,memory=500Mi,ephemeral-storage=1Gi \&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">--eviction-hard&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">memory.available&amp;lt;500Mi,nodefs.available&amp;lt;10%&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¿®æ”¹å®Œé…ç½®æ–‡ä»¶åï¼Œæ‰§è¡Œ&lt;code>kubeadm init&lt;/code>å¯ä»¥çœ‹åˆ° &lt;code>pod-infra-contrainer-image&lt;/code>é…ç½®ç”Ÿæ•ˆäº†ã€‚&lt;/p>
&lt;p>å‚è€ƒ&lt;a class="link" href="https://www.digitalocean.com/community/tutorials/understanding-systemd-units-and-unit-files" target="_blank" rel="noopener"
>systemd config&lt;/a>&lt;/p></description></item><item><title>Neutronå°è®°</title><link>https://tab.deoops.com/posts/neutron-port/</link><pubDate>Sun, 21 Apr 2019 18:39:27 +0800</pubDate><guid>https://tab.deoops.com/posts/neutron-port/</guid><description>&lt;img src="https://tab.deoops.com/posts/neutron-port/Neutron-Networking-CompNet-v1.png" alt="Featured image of post Neutronå°è®°" />&lt;p>å‰æ®µæ—¶é—´çš„èŠ±äº†å¾ˆå¤šåŠŸå¤«å¯¹æ¥k8så’Œopenstackçš„kuryr-kubernetesç½‘è·¯ç»„ä»¶ã€‚
å­¦åˆ°äº†å¾ˆå¤šopenstackçš„çŸ¥è¯†ï¼Œä»Šå¤©æŠ½å‡ºæ—¶é—´æ¥æ•´ç†ä¸‹ã€‚&lt;/p>
&lt;h2 id="client">client&lt;/h2>
&lt;p>é¦–å…ˆæ˜¯ install openstack-cli neutron clientï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat /etc/redhat-release&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Red Hat Enterprise Linux Server release 7.5 &lt;span class="o">(&lt;/span>Maipo&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#### add openstack yum repo source&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># vi /etc/yum.repos.d/openstack.repo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># yum install -y python2-openstackclient openstack-neutron&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops shells&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat source&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_PROJECT_DOMAIN_NAME&lt;/span>&lt;span class="o">=&lt;/span>default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_USER_DOMAIN_NAME&lt;/span>&lt;span class="o">=&lt;/span>default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_PROJECT_NAME&lt;/span>&lt;span class="o">=&lt;/span>your_project_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_USERNAME&lt;/span>&lt;span class="o">=&lt;/span>your_use_name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_PASSWORD&lt;/span>&lt;span class="o">=&lt;/span>your_pwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_AUTH_URL&lt;/span>&lt;span class="o">=&lt;/span>http://10.8.1.3:35357/v3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_IDENTITY_API_VERSION&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">OS_IMAGE_API_VERSION&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="vip">vip&lt;/h3>
&lt;p>æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ª&lt;code>virtual IP&lt;/code>éªŒè¯ä¸Šä¸€æ­¥é…ç½®çš„openstack sourceå¯¹ä¸å¯¹ ï¼š&lt;/p>
&lt;ol>
&lt;li>åˆ›å»º vip å¯¹åº”çš„port;&lt;/li>
&lt;li>æŠŠ ä¸Šä¸€æ­¥åˆ›å»ºå¥½çš„portåŠ å…¥åˆ° vm ipå¯¹åº”port çš„ &lt;code>allow-address-pairs&lt;/code> å±æ€§ä¸­;&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops shells&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat vip.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ./source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">network&lt;/span>&lt;span class="o">=&lt;/span>your_network_id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### i&amp;#39;ve comment out the create Port operation&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#subnet=you_subnet_id&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#for i in {62..64}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># echo $i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># neutron port-create --fixed-ip subnet_id=$subnet,ip_address=10.0.1.$i --device-owner &amp;#39;Virtual IP&amp;#39; --no-security-groups --name &amp;#39;Virtual IP&amp;#39; $network&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># openstack port list | grep -E &amp;#39;10.0.1.6(2|3|4)&amp;#39; | cut -d &amp;#39;|&amp;#39; -f 4,5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#p1=mac_address=fa:16:3e:aa:6b:68,ip_address=&amp;#39;10.0.1.64&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#p2=mac_address=fa:16:3e:1d:11:2d,ip_address=&amp;#39;10.0.1.62&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#p3=mac_address=fa:16:3e:b8:47:f9,ip_address=&amp;#39;10.0.1.63&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">p1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">ip_address&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.1.64&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">p2&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">ip_address&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.1.62&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">p3&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">ip_address&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.1.63&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">p4&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">ip_address&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;10.0.1.80&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#for p in `neutron port-list --device-owner compute:nova -f value | grep -E &amp;#39;10.0.1.5(1|2|3)&amp;#39; | cut -d &amp;#39; &amp;#39; -f 1 `;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> p in &lt;span class="sb">`&lt;/span>neutron port-list --device-owner compute:nova -f value &lt;span class="p">|&lt;/span> grep -E &lt;span class="s1">&amp;#39;10.0.1&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s1">&amp;#39; &amp;#39;&lt;/span> -f &lt;span class="m">1&lt;/span> &lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$p&lt;/span> &lt;span class="nv">$p1&lt;/span> &lt;span class="nv">$p2&lt;/span> &lt;span class="nv">$p3&lt;/span> &lt;span class="nv">$p4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">### must NOT set virtual ip Port macaddress&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">### leave it empty to use host port macaddress&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> neutron port-update &lt;span class="nv">$p&lt;/span> --allowed-address-pair &lt;span class="nv">$p1&lt;/span> --allowed-address-pair &lt;span class="nv">$p2&lt;/span> --allowed-address-pair &lt;span class="nv">$p3&lt;/span> --allowed-address-pair &lt;span class="nv">$p4&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="create-port">create port&lt;/h3>
&lt;p>ç”³è¯·åˆ›å»º&lt;code>port&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops shells&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat create-port.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#!/bin/bash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ./source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">network&lt;/span>&lt;span class="o">=&lt;/span>your_network_id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">subnet&lt;/span>&lt;span class="o">=&lt;/span>your_subnetwork_id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> setup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#i=$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#ip_addr=10.0.1.$((i+1))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;going to create ip ...&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#neutron port-create --fixed-ip subnet_id=$subnet,ip_address=$ip_addr --device-owner &amp;#39;compute:kuryr&amp;#39; --no-security-groups --name &amp;#39;concurrent load test IP&amp;#39; $network&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> neutron port-create &lt;span class="nv">subnet_id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$subnet&lt;/span> --device-owner &lt;span class="s1">&amp;#39;compute:kuryr&amp;#39;&lt;/span> --no-security-groups --name &lt;span class="s1">&amp;#39;concurrent load test IP lll&amp;#39;&lt;/span> &lt;span class="nv">$network&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in &lt;span class="sb">`&lt;/span>seq &lt;span class="nv">$1&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">time&lt;/span> setup &lt;span class="nv">$i&lt;/span> &lt;span class="p">&amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="update-allow-address-pairs">update allow-address-pairs&lt;/h3>
&lt;p>æ‰¹é‡update allow-address-pairs:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops shells&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat allow-address-pairs-load-test.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ./source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">vm_port&lt;/span>&lt;span class="o">=&lt;/span>vm_port_id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">function&lt;/span> setup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">mac&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>&lt;span class="nb">echo&lt;/span> $&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>$&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>:$&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>$&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>:$&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>$&lt;span class="o">[&lt;/span>RANDOM%10&lt;span class="o">]&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">ip_addr&lt;/span>&lt;span class="o">=&lt;/span>10.0.1.&lt;span class="k">$((&lt;/span>i+1&lt;span class="k">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">param&lt;/span>&lt;span class="o">+=&lt;/span>&lt;span class="s2">&amp;#34; --allowed-address-pair ip_address=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">ip_addr&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">,mac_address=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">mac&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#echo $vm_port $param&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neutron port-update &lt;span class="nv">$vm_port&lt;/span> &lt;span class="nv">$param&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> starting
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in &lt;span class="sb">`&lt;/span>seq &lt;span class="nv">$1&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="c1">## for i in `jot $1`; do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$i&lt;/span>&lt;span class="s2">...&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">time&lt;/span> setup &lt;span class="nv">$i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="delete-port--allowed-address-pairs">delete port &amp;amp; allowed-address-pairs&lt;/h3>
&lt;p>æ¸…ç† Port å’Œ Port allowed-address-pairs&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>. ./source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#neutron port-list --device-owner compute:kuryr&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neutron port-delete &lt;span class="sb">`&lt;/span>neutron port-list --device-owner compute:kuryr -c id -f value&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">neutron port-list --device-owner compute:nova &lt;span class="p">|&lt;/span> grep 10.0.1 &lt;span class="p">|&lt;/span> grep -vE &lt;span class="s1">&amp;#39;10.0.1.5(1|2|3)&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> p in &lt;span class="sb">`&lt;/span>neutron port-list --device-owner compute:nova -f value &lt;span class="p">|&lt;/span> grep 10.0.1 &lt;span class="p">|&lt;/span> cut -d &lt;span class="s1">&amp;#39; &amp;#39;&lt;/span> -f &lt;span class="m">1&lt;/span> &lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> neutron port-update &lt;span class="nv">$p&lt;/span> --allowed-address-pairs &lt;span class="nv">action&lt;/span>&lt;span class="o">=&lt;/span>clear &lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="trunk-port">trunk port&lt;/h3>
&lt;p>åˆ›å»ºtrunk å­port&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in &lt;span class="sb">`&lt;/span>openstack port list &lt;span class="p">|&lt;/span> grep ACTIVE &lt;span class="p">|&lt;/span>grep -vE &lt;span class="s1">&amp;#39;(22.1.104|1.106|132|117|129)&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print $2}&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">do&lt;/span> openstack network trunk &lt;span class="nb">unset&lt;/span> --subport &lt;span class="nv">$i&lt;/span> trunktest&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> i in &lt;span class="sb">`&lt;/span>openstack port list &lt;span class="p">|&lt;/span> grep DOWN &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{print $2}&amp;#39;&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">do&lt;/span> openstack port delete &lt;span class="nv">$i&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">############################################&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack network create â€”share â€”external â€”provider-physical-network provider â€”provider-network-type vlan â€”provider-segment &lt;span class="m">162&lt;/span> podlan162 â€”transparent-vlan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack subnet create â€”no-dhcp â€”subnet-range 172.23.0.0/16 â€”gateway 172.23.0.254 â€”network podlan162 â€”allocation-pool &lt;span class="nv">start&lt;/span>&lt;span class="o">=&lt;/span>172.23.1.101,end&lt;span class="o">=&lt;/span>172.23.1.201 â€”dns-nameserver 114.114.114.114 jyvlan162sub2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack port create â€”network podlan162 â€”fixed-ip &lt;span class="nv">subnet&lt;/span>&lt;span class="o">=&lt;/span>jyvlan162sub2,ip-address&lt;span class="o">=&lt;/span>172.23.1.129 â€”project admin v162port
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># openstack trunk ç«¯å£åŠ å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack network trunk create â€”parent-port v162port trunktest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack network create â€”share â€”external â€”provider-physical-network provider â€”provider-network-type vlan â€”provider-segment &lt;span class="m">163&lt;/span> podlan163 â€”transparent-vlan
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack subnet create â€”no-dhcp â€”subnet-range 172.24.0.0/16 â€”gateway 172.24.0.254 â€”network podlan163 â€”allocation-pool &lt;span class="nv">start&lt;/span>&lt;span class="o">=&lt;/span>172.24.1.101,end&lt;span class="o">=&lt;/span>172.24.1.201 â€”dns-nameserver 114.114.114.114 jyvlan164sub2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack port create â€”network podlan163 â€”fixed-ip &lt;span class="nv">subnet&lt;/span>&lt;span class="o">=&lt;/span>jyvlan164sub2,ip-address&lt;span class="o">=&lt;/span>172.24.1.129 â€”project admin v163port
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openstack network trunk &lt;span class="nb">set&lt;/span> trunktest â€”subport &lt;span class="nv">port&lt;/span>&lt;span class="o">=&lt;/span>v163port,segmentation-type&lt;span class="o">=&lt;/span>vlan,segmentation-id&lt;span class="o">=&lt;/span>&lt;span class="m">163&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># æµ‹è¯•å­ç½‘ï¼Œæµ‹è¯•163 tag&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ip link add link eth0 name eth0.163 &lt;span class="nb">type&lt;/span> vlan id &lt;span class="m">163&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ip link &lt;span class="nb">set&lt;/span> dev eth0.163 address fa:16:3e:26:a8:08
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ip link &lt;span class="nb">set&lt;/span> dev eth0.163 up
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>nopCloserå‡½æ•°</title><link>https://tab.deoops.com/posts/read-again/</link><pubDate>Wed, 17 Apr 2019 21:39:31 +0800</pubDate><guid>https://tab.deoops.com/posts/read-again/</guid><description>&lt;img src="https://tab.deoops.com/posts/read-again/nopcloser.png" alt="Featured image of post nopCloserå‡½æ•°" />&lt;p>update: &lt;code>ioutil&lt;/code>é€æ¸è¢«&lt;code>io&lt;/code> å–ä»£ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">ioutil&lt;/span> &lt;span class="c1">// import &amp;#34;io/ioutil&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">NopCloser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span> &lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Reader&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ReadCloser&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">NopCloser&lt;/span> &lt;span class="nx">returns&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">ReadCloser&lt;/span> &lt;span class="nx">with&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="nx">Close&lt;/span> &lt;span class="nx">method&lt;/span> &lt;span class="nx">wrapping&lt;/span> &lt;span class="nx">the&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">provided&lt;/span> &lt;span class="nx">Reader&lt;/span> &lt;span class="nx">r&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">As&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">Go&lt;/span> &lt;span class="mf">1.16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">function&lt;/span> &lt;span class="nx">simply&lt;/span> &lt;span class="nx">calls&lt;/span> &lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NopCloser&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">package&lt;/span> &lt;span class="nx">io&lt;/span> &lt;span class="c1">// import &amp;#34;io&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">NopCloser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">r&lt;/span> &lt;span class="nx">Reader&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nx">ReadCloser&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">NopCloser&lt;/span> &lt;span class="nx">returns&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">ReadCloser&lt;/span> &lt;span class="nx">with&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">no&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="nx">Close&lt;/span> &lt;span class="nx">method&lt;/span> &lt;span class="nx">wrapping&lt;/span> &lt;span class="nx">the&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">provided&lt;/span> &lt;span class="nx">Reader&lt;/span> &lt;span class="nx">r&lt;/span>&lt;span class="p">.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æœ€è¿‘ä½¿ç”¨&lt;a class="link" href="https://github.com/h2non/baloo" target="_blank" rel="noopener"
>baloo&lt;/a>å†™é›†æˆæµ‹è¯•ï¼Œé‡åˆ°äº†ä¸ªéœ€æ±‚ï¼Œ
åœ¨&lt;code>unmarshal&lt;/code>responesä¹‹åï¼ˆæˆ–è€…ä¹‹å‰ï¼‰è¿˜è¦å†è¾“å‡ºä¸€æ¬¡responseçš„çº¯æ–‡æœ¬æ ¼å¼ä¾›debugå‚è€ƒã€‚&lt;/p>
&lt;p>å³éœ€è¦å¤šæ¬¡è¯»http.Resp.Bodyã€‚&lt;/p>
&lt;h2 id="é—®é¢˜">é—®é¢˜&lt;/h2>
&lt;p>response.Body åªèƒ½è¯»ä¸€æ¬¡ï¼Œè¯»å®Œä¹‹åå†è¿›è¡Œreadæ“ä½œå°±ä¼šé‡åˆ°&lt;code>EOF&lt;/code> errorã€‚&lt;/p>
&lt;h2 id="åˆ†æé—®é¢˜">åˆ†æé—®é¢˜&lt;/h2>
&lt;p>æ¨¡ç³Šè®°å¾—&lt;code>baloo&lt;/code>åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­èƒ½å¤šæ¬¡(&lt;code>JSON()&lt;/code> å’Œ &lt;code>String()&lt;/code>)è¯»å–response.Bodyå†…å®¹ã€‚&lt;/p>
&lt;p>ä»”ç»†å»çœ‹äº†ä¸‹&lt;code>baloo&lt;/code>çš„æºä»£ç ï¼Œå‘ç°&lt;code>baloo&lt;/code>è‡ªå·±åœ¨å†…éƒ¨ å°è£…äº†ä¸€ä¸ªå¯¹è±¡ &lt;code>http.RawResonse&lt;/code> ï¼Œä½¿ç”¨äº† &lt;code>iouti.NopCloser&lt;/code>å‡½æ•°é‡æ–°å¡«å……äº†&lt;code>res.Body&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">readBodyJSON&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">http&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Response&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">([]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">body&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadAll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Body&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">byte&lt;/span>&lt;span class="p">{},&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// Re-fill body reader stream after reading it
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">res&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Body&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NopCloser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewBuffer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">body&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="nx">body&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>æœ‰äº†&lt;code> ioutil.NopCloser&lt;/code>å‡½æ•°ï¼Œå¯ä»¥å¾ˆå¿«é€Ÿçš„å†™å‡º&lt;code>debugPlugin&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">debugPlugin&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">p&lt;/span> &lt;span class="nx">plugin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Plugin&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">f&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Context&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">h&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Handler&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">res&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadAll&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Response&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Body&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;response:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;response Type:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Response&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Header&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Content-Type&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// should CLOSE, due to next Close method will be no-op
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Response&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Body&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ctx&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Response&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Body&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NopCloser&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">bytes&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewBuffer&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">res&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">h&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Next&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">p&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">plugin&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewResponsePlugin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ³¨æ„ï¼šåº”è¯¥å…ˆ &lt;code>resp.Body.Close()&lt;/code> æ‰ï¼Œç„¶åé‡æ–°å¡«å……readerã€‚&lt;/p>
&lt;p>å› ä¸ºæ–°çš„&lt;code>Response.Body.Close()&lt;/code>æ˜¯ &lt;code>no-op&lt;/code>æ“ä½œï¼Œä¸ä¼šå»close ä¹‹å‰çš„Bodyï¼Œå¯èƒ½ä¼šé€ æˆèµ„æºæ³„æ¼ã€‚&lt;/p></description></item><item><title>Mysql Autocommité—®é¢˜</title><link>https://tab.deoops.com/posts/mysql-autocommit/</link><pubDate>Fri, 12 Apr 2019 10:37:04 +0800</pubDate><guid>https://tab.deoops.com/posts/mysql-autocommit/</guid><description>&lt;img src="https://tab.deoops.com/posts/mysql-autocommit/Start-ad-hoc-Transaction.jpeg" alt="Featured image of post Mysql Autocommité—®é¢˜" />&lt;p>å®¢æˆ·åé¦ˆæˆ‘ä»¬çš„äº§å“æœ‰ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ã€‚&lt;/p>
&lt;p>æ·»åŠ å®Œå•†å“åï¼Œå¯ä»¥çœ‹åˆ°å•†å“ï¼Œä½†æ˜¯ä¸€åˆ·æ–°é¡µé¢ï¼Œåˆšæ‰æ·»åŠ çš„å•†å“å°±æ¶ˆå¤±å•¦ã€‚&lt;/p>
&lt;p>ä»¥å‰æ²¡ç¢°åˆ°è¿‡ï¼Œä¸€ç›´éƒ½ç”¨çš„å¥½å¥½çš„ä¸ºä»€ä¹ˆä»Šå¤©å°±ä¸è¡Œäº†å‘¢ï¼Ÿ&lt;/p>
&lt;h2 id="åˆ†æé—®é¢˜">åˆ†æé—®é¢˜&lt;/h2>
&lt;p>æ—¢ç„¶ä¸€åˆ·æ–°å³æ¶ˆå¤±äº†ï¼Œå°±è¯æ˜æ²¡æœ‰å†™å…¥åˆ°æ•°æ®åº“ã€‚&lt;/p>
&lt;p>æ²¡å†™å…¥åˆ°æ•°æ®åº“æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿ API ä¹Ÿæ²¡æœ‰æŠ¥é”™å‘€ï¼Ÿ&lt;/p>
&lt;p>æ›´åŠ å¥‡æ€ªçš„æ˜¯ï¼Œæœ‰çš„é¡µé¢æœ‰è¿™ä¸ªé—®é¢˜ï¼Œæœ‰çš„æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>åç«¯çš„API æœ‰çš„æ˜¯golangå†™çš„ï¼Œæœ‰çš„æ˜¯Javaå†™çš„ã€‚&lt;/p>
&lt;p>&lt;code>golang&lt;/code> ormå¯¹mysql æ•°æ®åº“çš„å†™æ“ä½œå­˜åœ¨ä¸Šé¢è¯´çš„åˆ·æ–°å°±ä¸¢å¤±çš„é—®é¢˜ï¼Œ&lt;code>Java&lt;/code>çš„ormå¯¹mysqlçš„å†™æ“ä½œæ²¡æœ‰é—®é¢˜ã€‚&lt;/p>
&lt;p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p>
&lt;h2 id="dba">Â DBA&lt;/h2>
&lt;p>æ’æŸ¥äº†å¾ˆä¹…å‘ç°åŸæ¥æ˜¯å®¢æˆ·é‚£è¾¹çš„DBAæŠŠ mysqlçš„ &lt;code>session autocommit&lt;/code>çš„é…ç½®å…³é—­å•¦ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://dev.mysql.com/doc/refman/5.6/en/innodb-autocommit-commit-rollback.html" target="_blank" rel="noopener"
>autocommit&lt;/a>&lt;/p>
&lt;p>ç¿»äº†ä¸‹æ–‡æ¡£ï¼Œç¡®å®šã€€&lt;code>Java&lt;/code>çš„ormæ¡†æ¶ä¼šå¿½ç•¥mysql serverçš„é…ç½®é»˜è®¤è‡ªå·±commitï¼Œ&lt;code>golang&lt;/code>çš„ormåˆ™æ²¡æœ‰è¿™ä¸ªä¼˜åŒ–ï¼ˆä¹Ÿè®¸æ˜¯æœ‰ä½†æˆ‘ä»¬æ²¡æœ‰å¯ç”¨ï¼Ÿï¼‰ã€‚&lt;/p>
&lt;p>æ‰€ä»¥ä¼šå‡ºç° javaçš„åç«¯æ˜¯æ­£å¸¸çš„ï¼Œgolangçš„åç«¯å†™ä¸äº†mysqlã€‚
ã€€&lt;/p>
&lt;h2 id="è§£å†³æ–¹æ¡ˆ">è§£å†³æ–¹æ¡ˆ&lt;/h2>
&lt;p>å®¢æˆ·DBAå¼€å¯&lt;code>autocommit&lt;/code>é…ç½®é¡¹åï¼Œäº§å“ä¸šåŠ¡æ¢å¤æ­£å¸¸ã€‚&lt;/p></description></item><item><title>Macvlanè·¯ç”±è§„åˆ™</title><link>https://tab.deoops.com/posts/macvlan-route/</link><pubDate>Mon, 11 Mar 2019 11:33:48 +0800</pubDate><guid>https://tab.deoops.com/posts/macvlan-route/</guid><description>&lt;img src="https://tab.deoops.com/posts/macvlan-route/Macvlan-network-with-traffic-flows.png" alt="Featured image of post Macvlanè·¯ç”±è§„åˆ™" />&lt;p>å¯¹macvlan ä¸ç†Ÿæ‚‰çš„åŒå­¦ï¼Œå¯ä»¥å…ˆçœ‹ä¸‹è¿™ç¯‡&lt;a class="link" href="https://developers.redhat.com/blog/2018/10/22/introduction-to-linux-interfaces-for-virtual-networking/#macvlan" target="_blank" rel="noopener"
>macvlan virtual networkç®€ä»‹&lt;/a>&lt;/p>
&lt;p>é»˜è®¤æƒ…å†µä¸‹Linux kernelä¼šé˜»æ­¢(drop)å®¿ä¸»æœºï¼ˆhost eth0ï¼‰è™šæ‹Ÿå‡ºæ¥çš„ macvlan networkï¼ˆ&lt;code>bridge mode&lt;/code>ï¼‰ å’Œå®¿ä¸»æœºhost eth0ï¼‰ä¹‹é—´ç½‘ç»œæ•°æ®åŒ…ã€‚&lt;/p>
&lt;p>è°ƒè¯•äº†ä¸€æ®µæ—¶é—´åï¼Œæˆ‘ä»¬å‘ç°äº†å¯ä»¥é€šè¿‡è·¯ç”±è¡¨æ¥ç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚
å…·ä½“å®æ–½çš„æ–¹æ³•å¦‚ä¸‹ï¼š&lt;/p>
&lt;blockquote>
&lt;p>åœ¨host network namesapcesä¸‹æ–°å¢ ä¸€ä¸ªmacvlan deviceï¼Œç„¶åæ·»åŠ è·¯ç”±è§„åˆ™å³å¯ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>é€šä¿¡çš„ä¸¤ä¸ªæ–¹å‘ç®€å•è§£é‡Šå¦‚ä¸‹ï¼š&lt;/p>
&lt;h2 id="eth0host---podmacvlan">eth0(host) -&amp;gt; pod(macvlan)&lt;/h2>
&lt;p>å®¿ä¸»æœºhost eth0 é€šè¿‡break0 è®¾å¤‡ å’Œroute tableçš„è·¯ç”±è§„åˆ™ å¯ä»¥è®¿é—®åˆ°podï¼ˆåœ¨macvlanä¸­ï¼‰&lt;/p>
&lt;p>shellè°ƒè¯•è„šæœ¬å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ip link add break0 link eth0 &lt;span class="nb">type&lt;/span> macvlan mode bridge
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># NOTE: if use /24 CIDR will auto add a route rule &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># (100.75.30.0/24 dev break0 proto kernel scope link src 100.75.30.1) &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># which we don&amp;#39;t need&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ifconfig break0 100.75.30.7/32 up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ip r a 100.75.30.71 dev break0 &lt;span class="c1"># 100.75.30.71 is a pod ip for test&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å› ä¸ºkuryræ˜¯ç”¨pythoné…ç½®ç½‘ç»œçš„ï¼Œæ‰€ä»¥ä¹Ÿæä¾›å¯¹åº”çš„pythonè„šæœ¬å¦‚ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pyroute2&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">IPDB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">_create_break0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">IPDB&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">ipdb&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">ipdb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">interfaces&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">IF_NAME&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">up&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">commit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">ipdb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">create&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ifname&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">IF_NAME&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">kind&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">MACVLAN_KIND&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">link&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">ipdb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">interfaces&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parent&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">macvlan_mode&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">MACVLAN_MODE_BRIDGE&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_ip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">addr&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;/32&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">up&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="n">ipdb_exceptions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CreateException&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LOG&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Exception when create break0 device &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">_route_spec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="p">{&lt;/span>&lt;span class="s2">&amp;#34;dst&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ip&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34;/32&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;oif&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">idx&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">add_route&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">spec&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">_route_spec&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ip&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">with&lt;/span> &lt;span class="n">IPDB&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">ipdb&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ipdb&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">routes&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">spec&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">commit&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">except&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ipdb_exceptions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CommitException&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">link_exceptions&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">NetlinkError&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">LOG&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">info&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;Exception &lt;/span>&lt;span class="si">%s&lt;/span>&lt;span class="s2"> when add route table &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">ip&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="pod---eth0host">pod -&amp;gt; eth0(host)&lt;/h2>
&lt;p>å› ä¸ºæ˜¯2å±‚æ‰“é€šçš„ï¼Œæ‰€ä»¥åªè¦æœ‰mac_addrå°±å¯ä»¥è®¿é—®ï¼Œå’Œpodä»¥åŠå®¿ä¸»æœºeth0&lt;strong>å…·ä½“çš„IP&lt;/strong> åœ°å€æ²¡å…³ç³»ã€‚&lt;/p>
&lt;p>åœ¨pod é‡Œé¢ä½¿ç”¨ &lt;code>arp -n&lt;/code> å¯ä»¥çœ‹åˆ°ï¼Œhost IPï¼ˆ100.75.30.51ï¼‰ å’Œ break0 ï¼ˆ100.75.30.7ï¼‰ çš„IP
å¯¹åº”çš„æ˜¯åŒä¸€ä¸ªmac addrï¼Œ éƒ½æ˜¯ break0çš„mac addrã€‚&lt;/p>
&lt;p>åœ¨ä¸»æœºä¸Šæ·»åŠ  è·¯ç”± &lt;code>ip r add 100.75.30.71 dev break0&lt;/code> ï¼ˆ100.75.30.71 æ˜¯pod çš„IPåœ°å€ï¼‰ï¼Œ&lt;/p>
&lt;p>ç„¶ååœ¨ pod ä¸Šping ä¸‹ host IPï¼Œ å®¿ä¸»æœºeth0çš„hostIP å’Œ break0 çš„ä¸¤ä¸ªæ¡ç›®å°±ä¼šåœ¨podçš„arp è¡¨é‡Œæ˜¾ç¤ºå‡ºæ¥ã€‚&lt;/p>
&lt;p>å¦‚æœåªæ˜¯ä» host ping podï¼Œ åˆ™ podçš„arp è¡¨åªæ˜¾ç¤º break0 è¿™ä¸ªæ¡ç›®ã€‚&lt;/p></description></item><item><title>Markdownè¯­æ³•æŒ‡å—</title><link>https://tab.deoops.com/posts/markdown-syntax/</link><pubDate>Mon, 11 Mar 2019 00:00:00 +0000</pubDate><guid>https://tab.deoops.com/posts/markdown-syntax/</guid><description>&lt;img src="https://tab.deoops.com/posts/markdown-syntax/pawel-czerwinski-8uZPynIu-rQ-unsplash.jpg" alt="Featured image of post Markdownè¯­æ³•æŒ‡å—" />&lt;p>This article offers a sample of basic Markdown syntax that can be used in Hugo content files, also it shows whether basic HTML elements are decorated with CSS in a Hugo theme.&lt;/p>
&lt;h2 id="headings">Headings&lt;/h2>
&lt;p>The following HTML &lt;code>&amp;lt;h1&amp;gt;&lt;/code>â€”&lt;code>&amp;lt;h6&amp;gt;&lt;/code> elements represent six levels of section headings. &lt;code>&amp;lt;h1&amp;gt;&lt;/code> is the highest section level while &lt;code>&amp;lt;h6&amp;gt;&lt;/code> is the lowest.&lt;/p>
&lt;h1 id="h1">H1&lt;/h1>
&lt;h2 id="h2">H2&lt;/h2>
&lt;h3 id="h3">H3&lt;/h3>
&lt;h4 id="h4">H4&lt;/h4>
&lt;h5 id="h5">H5&lt;/h5>
&lt;h6 id="h6">H6&lt;/h6>
&lt;h2 id="paragraph">Paragraph&lt;/h2>
&lt;p>Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.&lt;/p>
&lt;p>Itatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.&lt;/p>
&lt;h2 id="blockquotes">Blockquotes&lt;/h2>
&lt;p>The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a &lt;code>footer&lt;/code> or &lt;code>cite&lt;/code> element, and optionally with in-line changes such as annotations and abbreviations.&lt;/p>
&lt;h4 id="blockquote-without-attribution">Blockquote without attribution&lt;/h4>
&lt;blockquote>
&lt;p>Tiam, ad mint andaepu dandae nostion secatur sequo quae.
&lt;strong>Note&lt;/strong> that you can use &lt;em>Markdown syntax&lt;/em> within a blockquote.&lt;/p>
&lt;/blockquote>
&lt;h4 id="blockquote-with-attribution">Blockquote with attribution&lt;/h4>
&lt;blockquote>
&lt;p>Don&amp;rsquo;t communicate by sharing memory, share memory by communicating.&lt;!-- raw HTML omitted -->
â€” &lt;!-- raw HTML omitted -->Rob Pike&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>&lt;!-- raw HTML omitted -->&lt;/p>
&lt;/blockquote>
&lt;h2 id="tables">Tables&lt;/h2>
&lt;p>Tables aren&amp;rsquo;t part of the core Markdown spec, but Hugo supports supports them out-of-the-box.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Name&lt;/th>
&lt;th>Age&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Bob&lt;/td>
&lt;td>27&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Alice&lt;/td>
&lt;td>23&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="inline-markdown-within-tables">Inline Markdown within tables&lt;/h4>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Italics&lt;/th>
&lt;th>Bold&lt;/th>
&lt;th>Code&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;em>italics&lt;/em>&lt;/td>
&lt;td>&lt;strong>bold&lt;/strong>&lt;/td>
&lt;td>&lt;code>code&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="code-blocks">Code Blocks&lt;/h2>
&lt;h4 id="code-block-with-backticks">Code block with backticks&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;!doctype html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span> &lt;span class="na">lang&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;en&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">meta&lt;/span> &lt;span class="na">charset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Example HTML5 Document&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Test&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="code-block-indented-with-four-spaces">Code block indented with four spaces&lt;/h4>
&lt;pre>&lt;code>&amp;lt;!doctype html&amp;gt;
&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
&amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
&amp;lt;title&amp;gt;Example HTML5 Document&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
&amp;lt;p&amp;gt;Test&amp;lt;/p&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code>&lt;/pre>
&lt;h4 id="code-block-with-hugos-internal-highlight-shortcode">Code block with Hugo&amp;rsquo;s internal highlight shortcode&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&amp;lt;!doctype html&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span> &lt;span class="na">lang&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;en&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">meta&lt;/span> &lt;span class="na">charset&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;utf-8&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Example HTML5 Document&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Test&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="list-types">List Types&lt;/h2>
&lt;h4 id="ordered-list">Ordered List&lt;/h4>
&lt;ol>
&lt;li>First item&lt;/li>
&lt;li>Second item&lt;/li>
&lt;li>Third item&lt;/li>
&lt;/ol>
&lt;h4 id="unordered-list">Unordered List&lt;/h4>
&lt;ul>
&lt;li>List item&lt;/li>
&lt;li>Another item&lt;/li>
&lt;li>And another item&lt;/li>
&lt;/ul>
&lt;h4 id="nested-list">Nested list&lt;/h4>
&lt;ul>
&lt;li>Fruit
&lt;ul>
&lt;li>Apple&lt;/li>
&lt;li>Orange&lt;/li>
&lt;li>Banana&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Dairy
&lt;ul>
&lt;li>Milk&lt;/li>
&lt;li>Cheese&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="other-elements--abbr-sub-sup-kbd-mark">Other Elements â€” abbr, sub, sup, kbd, mark&lt;/h2>
&lt;p>&lt;!-- raw HTML omitted -->GIF&lt;!-- raw HTML omitted --> is a bitmap image format.&lt;/p>
&lt;p>H&lt;!-- raw HTML omitted -->2&lt;!-- raw HTML omitted -->O&lt;/p>
&lt;p>X&lt;!-- raw HTML omitted -->n&lt;!-- raw HTML omitted --> + Y&lt;!-- raw HTML omitted -->n&lt;!-- raw HTML omitted --> = Z&lt;!-- raw HTML omitted -->n&lt;!-- raw HTML omitted -->&lt;/p>
&lt;p>Press &lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted -->CTRL&lt;!-- raw HTML omitted -->+&lt;!-- raw HTML omitted -->ALT&lt;!-- raw HTML omitted -->+&lt;!-- raw HTML omitted -->Delete&lt;!-- raw HTML omitted -->&lt;!-- raw HTML omitted --> to end the session.&lt;/p>
&lt;p>Most &lt;!-- raw HTML omitted -->salamanders&lt;!-- raw HTML omitted --> are nocturnal, and hunt for insects, worms, and other small creatures.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>The above quote is excerpted from Rob Pike&amp;rsquo;s &lt;a class="link" href="https://www.youtube.com/watch?v=PAAkCSZUG1c" target="_blank" rel="noopener"
>talk&lt;/a> during Gopherfest, November 18, 2015.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description></item><item><title>æ•°å­¦ç¬¦å·KaTeX</title><link>https://tab.deoops.com/posts/math-typesetting/</link><pubDate>Fri, 08 Mar 2019 00:00:00 +0000</pubDate><guid>https://tab.deoops.com/posts/math-typesetting/</guid><description>&lt;img src="https://tab.deoops.com/posts/math-typesetting/katex.png" alt="Featured image of post æ•°å­¦ç¬¦å·KaTeX" />&lt;p>Mathematical notation in a Hugo project can be enabled by using third party JavaScript libraries.&lt;/p>
&lt;p>In this example we will be using &lt;a class="link" href="https://katex.org/" target="_blank" rel="noopener"
>KaTeX&lt;/a>&lt;/p>
&lt;ul>
&lt;li>Create a partial under &lt;code>/layouts/partials/math.html&lt;/code>&lt;/li>
&lt;li>Within this partial reference the &lt;a class="link" href="https://katex.org/docs/autorender.html" target="_blank" rel="noopener"
>Auto-render Extension&lt;/a> or host these scripts locally.&lt;/li>
&lt;li>Include the partial in your templates like so:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="o">{{&lt;/span> &lt;span class="k">if&lt;/span> or .Params.math .Site.Params.math &lt;span class="o">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{{&lt;/span> partial &lt;span class="s2">&amp;#34;math.html&amp;#34;&lt;/span> . &lt;span class="o">}}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{{&lt;/span> end &lt;span class="o">}}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>To enable KaTex globally set the parameter &lt;code>math&lt;/code> to &lt;code>true&lt;/code> in a project&amp;rsquo;s configuration&lt;/li>
&lt;li>To enable KaTex on a per page basis include the parameter &lt;code>math: true&lt;/code> in content files&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Note:&lt;/strong> Use the online reference of &lt;a class="link" href="https://katex.org/docs/supported.html" target="_blank" rel="noopener"
>Supported TeX Functions&lt;/a>&lt;/p>
&lt;h3 id="examples">Examples&lt;/h3>
&lt;p>Block math:
$$
\varphi = 1+\frac{1} {1+\frac{1} {1+\frac{1} {1+\cdots} } }
$$&lt;/p></description></item><item><title>æ— æ³•åˆ›å»ºmacvlanè®¾å¤‡</title><link>https://tab.deoops.com/posts/macvlan-busy/</link><pubDate>Thu, 07 Mar 2019 11:17:49 +0800</pubDate><guid>https://tab.deoops.com/posts/macvlan-busy/</guid><description>&lt;img src="https://tab.deoops.com/posts/macvlan-busy/maxresdefault.jpeg" alt="Featured image of post æ— æ³•åˆ›å»ºmacvlanè®¾å¤‡" />&lt;p>æœ€è¿‘ç»™å®¢æˆ·è°ƒè¯• macvlan networkæ—¶ï¼Œé‡åˆ°äº†&lt;code>Linux kernel&lt;/code> æŠ¥é”™
&lt;code>SIOCSIFFKAGS: Device or resource busy.&lt;/code> æ— æ³•åˆ›å»ºç½‘ç»œdeviceã€‚&lt;/p>
&lt;p>ç»“æœé•¿æ—¶é—´çš„debugåˆ†æï¼Œ
å‘ç°é—®é¢˜æ˜¯é«˜å¹¶å‘å‹æµ‹ åˆ›å»ºå’Œé‡Šæ”¾&lt;code>macvlan device&lt;/code>çš„æ—¶å€™ï¼Œè®¾å¤‡çš„&lt;code>mac address&lt;/code>å‡ºç°äº†é‡å¤ã€‚&lt;/p>
&lt;p>psï¼šè¿™ä¸ªé—®é¢˜åªå‡ºç°åœ¨ &lt;code>macvlan&lt;/code>network çš„è®¾å¤‡ä¸­ã€‚&lt;/p>
&lt;p>å¯ä»¥ç”¨ä¸‹é¢çš„shellè„šæœ¬æ¥å¤ç°macvlan &lt;code>Device or resource busy&lt;/code>çš„é”™è¯¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="k">function&lt;/span> setup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip l a m&lt;span class="nv">$i&lt;/span> address 00:40:2F:4D:5E:6F link eth0 &lt;span class="nb">type&lt;/span> macvlan mode bridge
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip netns add ns&lt;span class="nv">$i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip l &lt;span class="nb">set&lt;/span> m&lt;span class="nv">$i&lt;/span> netns ns&lt;span class="nv">$i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sleep &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ip netns &lt;span class="nb">exec&lt;/span> ns&lt;span class="nv">$i&lt;/span> ifconfig m&lt;span class="nv">$i&lt;/span> 10.0.0.&lt;span class="k">$((&lt;/span>i+1&lt;span class="k">))&lt;/span>/24 up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> cleaning up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ip -all netns d
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> creating netsnses
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> i in &lt;span class="sb">`&lt;/span>seq &lt;span class="nv">$1&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$i&lt;/span>....
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#setup $i &amp;amp;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> setup &lt;span class="nv">$i&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æœæŠŠ macvlan ç±»å‹æ”¹ä¸º dummy (ä¸Šé¢è„šæœ¬ç¬¬5è¡Œ type macvlan æ”¹ä¸º type &lt;code>dummy&lt;/code>) ï¼Œå³ä½¿ MAC address é‡å¤ä¹Ÿä¸ä¼šå¼•å‘kernel æŠ¥é”™ã€‚&lt;/p></description></item><item><title>podç”Ÿå‘½å‘¨æœŸäº‹ä»¶ç”Ÿæˆå™¨</title><link>https://tab.deoops.com/posts/pleg-unhealth/</link><pubDate>Mon, 11 Feb 2019 10:33:42 +0800</pubDate><guid>https://tab.deoops.com/posts/pleg-unhealth/</guid><description>&lt;img src="https://tab.deoops.com/posts/pleg-unhealth/reboot.jpeg" alt="Featured image of post podç”Ÿå‘½å‘¨æœŸäº‹ä»¶ç”Ÿæˆå™¨" />&lt;h2 id="pleg">PLEG&lt;/h2>
&lt;p>ä¸ç†Ÿæ‚‰PLEG(Pod Lifecycle Event Generator)çš„åŒå­¦ï¼Œå¯ä»¥å…ˆçœ‹ä¸‹è¿™ç¯‡æ–‡ç« &lt;a class="link" href="https://developers.redhat.com/blog/2019/11/13/pod-lifecycle-event-generator-understanding-the-pleg-is-not-healthy-issue-in-kubernetes" target="_blank" rel="noopener"
>What is PLEG?&lt;/a>ã€‚&lt;/p>
&lt;p>è¿™ç¯‡æ–‡ç« å¯¹plegæ˜¯ä»€ä¹ˆå’Œå¸¸è§çš„&lt;code>unhealthy&lt;/code>é—®é¢˜æœ‰å¾ˆè¯¦ç»†çš„ä»‹ç»ã€‚&lt;/p>
&lt;h3 id="cni">cni&lt;/h3>
&lt;p>å½“k8sçš„ cni æ’ä»¶æ€§èƒ½è¾ƒå·®ï¼Œnodeä¸Šçš„pod æ•°é‡è¾ƒå¤šï¼ˆå¤§äº 80ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°PLEGå‡ºé”™çš„é—®é¢˜:&lt;/p>
&lt;blockquote>
&lt;p>PLEG is not healthy: pleg was last seen active 6m55.488150776s ago; threshold is 3m0s&lt;/p>
&lt;/blockquote>
&lt;p>è°ƒè¯•&lt;a class="link" href="https://github.com/openstack/kuryr-kubernetes" target="_blank" rel="noopener"
>kuryr&lt;/a> cniçš„æ—¶å€™ï¼Œå‘ç°å½“openstack &lt;code>neutron&lt;/code>æœåŠ¡å‹åŠ›æ¯”è¾ƒå¤§çš„æ—¶å€™ã€‚&lt;/p>
&lt;p>cniè¿™è¾¹ç”³è¯·å’Œé‡Šæ”¾ portçš„æ—¶å»¶ä¼šç›¸åº”çš„å¢åŠ ï¼Œå¯¼è‡´è™šæ‹Ÿæœºå¤§é‡å †ç§¯æ— æ•ˆçš„netnsï¼Œ&lt;/p>
&lt;p>ç„¶åå°±ä¼šé‡åˆ°ç”±&lt;code>kueblet PLEG not healthy&lt;/code>å¼•èµ·çš„docker hang ä½é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="docker">docker&lt;/h2>
&lt;p>é‡å¯ docker å’Œ kueblet å¯ä»¥æš‚æ—¶è§£å†³PLEG unhealthyã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl restart docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart kubelet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># do NOT use `docker rm -vf`,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># which will kill running containers&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker rm -v &lt;span class="sb">`&lt;/span>docker ps -qa&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å»ºè®®åŒæ—¶ä¿®æ”¹ &lt;a class="link" href="https://www.ibm.com/support/knowledgecenter/en/SSBS6K_3.1.1/troubleshoot/docker_pods_overload.html" target="_blank" rel="noopener"
>kubelet å¯åŠ¨å‚æ•°&lt;/a> &amp;ndash;housekeeping-interval=30s&lt;/p></description></item><item><title>bcè¯­è¨€</title><link>https://tab.deoops.com/posts/bc-language/</link><pubDate>Mon, 22 Oct 2018 18:16:25 +0800</pubDate><guid>https://tab.deoops.com/posts/bc-language/</guid><description>&lt;img src="https://tab.deoops.com/posts/bc-language/calculator.jpeg" alt="Featured image of post bcè¯­è¨€" />&lt;h2 id="base">base&lt;/h2>
&lt;p>é€šè¿‡ä¿®æ”¹&lt;code>ibase&lt;/code>å’Œ&lt;code>obase&lt;/code>å¯ä»¥å®ç°å„ç§è¿›åˆ¶çš„è½¬åŒ–ï¼Œæ¯”å¦‚åè¿›åˆ¶å’ŒäºŒè¿›åˆ¶å’Œåå…­è¿›åˆ¶ä¹‹é—´çš„è½¬æ¢ï¼›&lt;/p>
&lt;blockquote>
&lt;p>If you arenâ€™t familiar with conversion between decimal, binary, and hexadecimal formats, you can
use a calculator utility such as bc or dc to convert between different radix representations. For
example, in bc, you can run the command obase=2; 240 to print the number 240 in binary
(base 2) form.&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>â¯ bc -q
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ibase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">obase
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1+ &lt;span class="m">3&lt;/span> *3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">obase&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">245&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">11110101&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">255&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">11111111&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">192&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">11000000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">168&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10101000&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">172&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10101100&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">obase&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">34&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">22&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">172&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AC
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">^D%
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="syntax">syntax&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> bc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> An arbitrary precision calculator language.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> More information: https://manned.org/bc.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Start bc in interactive mode using the standard math library:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bc -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Calculate the result of an expression:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bc &lt;span class="o">&amp;lt;&amp;lt;&amp;lt;&lt;/span> &lt;span class="s2">&amp;#34;(1 + 2) * 2 ^ 2&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Calculate the result of an expression and force the number of decimal places to 10:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bc &lt;span class="o">&amp;lt;&amp;lt;&amp;lt;&lt;/span> &lt;span class="s2">&amp;#34;scale=10; 5 / 3&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Calculate the result of an expression with sine and cosine using mathlib:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> bc -l &lt;span class="o">&amp;lt;&amp;lt;&amp;lt;&lt;/span> &lt;span class="s2">&amp;#34;s(1) + c(1)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Podç”Ÿå‘½å‘¨æœŸå’ŒLivenessçš„åŒºåˆ«</title><link>https://tab.deoops.com/posts/pod-life-live/</link><pubDate>Tue, 18 Sep 2018 23:33:25 +0800</pubDate><guid>https://tab.deoops.com/posts/pod-life-live/</guid><description>&lt;img src="https://tab.deoops.com/posts/pod-life-live/hook.gif" alt="Featured image of post Podç”Ÿå‘½å‘¨æœŸå’ŒLivenessçš„åŒºåˆ«" />&lt;p>ä»Šå¤©æµ‹è¯•ç»™æˆ‘åé¦ˆäº†ä¸€ä¸ªpodé—®é¢˜ï¼Œæµ‹è¯•ç»™å‡ºçš„ use case æè¿°å¦‚ä¸‹ï¼š&lt;/p>
&lt;p>é…ç½®ä¸€ä¸ªnginxçš„webæœåŠ¡ï¼›&lt;/p>
&lt;ol>
&lt;li>åœ¨ç”Ÿå‘½å‘¨æœŸä¸­é€‰æ‹©httpåè®®ï¼Œç«¯å£é…ç½®80ï¼Œè·¯å¾„é…ç½®/errorpathï¼›&lt;/li>
&lt;li>æœåŠ¡ä¸­podèƒ½æ­£å¸¸å¯åŠ¨ï¼›&lt;/li>
&lt;li>é¢„æœŸåœ¨podçš„äº‹ä»¶ä¸­åº”è¯¥æœ‰ä¸€ä¸ªâ€œFailedPostStartHookâ€é”™è¯¯ä¿¡æ¯ã€‚&lt;/li>
&lt;li>æµ‹è¯•äººå‘˜å‘ç°ï¼Œç¬¬4ç‚¹çš„é¢„æœŸæ²¡æœ‰è¾¾åˆ°ï¼Œpod æ­£å¸¸å¯åŠ¨äº†ï¼Œå´æ²¡æœ‰ &lt;code>FailedPostStarHook&lt;/code>äº‹ä»¶å‡ºç°ã€‚&lt;/li>
&lt;/ol>
&lt;p>ç®€å•åˆ†æäº†ä¸€ä¸‹ï¼Œæˆ‘å‘ç°æ˜¯æµ‹è¯•äººå‘˜æŠŠpodçš„&lt;code>lifecycle&lt;/code>å’Œ podçš„&lt;code>liveness/readiness&lt;/code> è¯ºæ··æ·†äº†ï¼Œä»è€Œå†™å‡ºäº†é”™çš„test caseã€‚&lt;/p>
&lt;h2 id="lifecycle-handlers">Lifecycle handlers&lt;/h2>
&lt;p>é¦–å…ˆå›é¡¾ä¸‹pod lifecycleçš„ä½œç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kubectl explain pod.spec.containers.lifecycle.postStart
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">RESOURCE: postStart &amp;lt;Object&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DESCRIPTION:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PostStart is called immediately after a container is created. If the
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> handler fails, the container is terminated and restarted according to its
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> restart policy. Other management of the container blocks &lt;span class="k">until&lt;/span> the hook
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> completes. More info: https://kubernetes.io/docs/concepts/containers/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> container-lifecycle-hooks/#container-hooks/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Handler defines a specific action that should be taken
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç®€å•ç¿»è¯‘ä¸‹å°±æ˜¯è¯´ï¼Œ &lt;code>kubernetes&lt;/code> æä¾›çš„pod startå’Œexitçš„ lifecycle hooks æ–¹ä¾¿å¼€å‘äººå‘˜hookedåˆ°&lt;/p>
&lt;p>ä¸‹é¢ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸï¼š&lt;/p>
&lt;ol>
&lt;li>é€šçŸ¥å¤–éƒ¨ä¸–ç•Œpodå·²ç»å¯åŠ¨å®Œæˆ (postStart)&lt;/li>
&lt;li>podä¼˜é›…çš„é€€å‡º (preStop)&lt;/li>
&lt;/ol>
&lt;p>psï¼š&lt;code>init container&lt;/code>å¯ä»¥è§£å†³ä¾èµ–é—®é¢˜ï¼Œä¸è¦å’ŒpostStart hooksæ··æ·†äº†å“¦ã€‚&lt;/p>
&lt;h3 id="ä¸¾ä¾‹å­">ä¸¾ä¾‹å­&lt;/h3>
&lt;p>å½“postStart hookçš„&lt;strong>handler&lt;/strong>å‘é€httpè¯·æ±‚åˆ°æŒ‡å®šçš„portå’Œpathæ—¶ï¼Œ å¦‚æœexit code ä¸ä¸º0æ—¶ï¼Œ&lt;/p>
&lt;p>ä¼šè§¦å‘ &lt;code>FailedPostStartHook&lt;/code> äº‹ä»¶ï¼Œç„¶åæ‰§è¡Œç”¨æˆ·ç»™å®šçš„hook/handlerã€‚&lt;/p>
&lt;p>æ³¨æ„ï¼šlifecycle hooksä¸ä¼šç†ä¼šhttp è‡ªèº«çš„ response codeå¥åº·ä¸å¦ï¼Œ&lt;/p>
&lt;p>åªè¦&lt;strong>handler&lt;/strong> exit code ä¸º0 podå°±ä¼šæ­£å¸¸å¯åŠ¨ï¼Œä¸è§¦å‘ä»»ä½•äº‹ä»¶ã€‚&lt;/p>
&lt;p>å¯ä»¥é…ç½®ä¸€ä¸ªé”™è¯¯çš„ç«¯å£ä½¿äº§ç”Ÿ&lt;code>FailedPostStartHook&lt;/code> eventï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">apiVersion&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">kind&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Pod&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">metadata&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">lifecycle90&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">containers&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">nginx:latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ng&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">imagePullPolicy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Never&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">readinessProbe&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">httpGet&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">lifecycle&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">postStart&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">httpGet&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c">## change this to 8080 or 9090 to get the FailedPostStartHook event&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/teststart&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">preStop&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">httpGet&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">port&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">80&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/teststop&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ç›¸å…³ä»£ç ">ç›¸å…³ä»£ç &lt;/h3>
&lt;p>talk is cheap.&lt;/p>
&lt;p>&lt;code>handler&lt;/code>åªå…³å¿ƒ&lt;a class="link" href="https://sourcegraph.com/github.com/kubernetes/kubernetes/-/blob/pkg/kubelet/lifecycle/handlers.go?L72" target="_blank" rel="noopener"
>getHTTPRespBody&lt;/a> è·å–bodyçš„è¿‡ç¨‹æ˜¯å¦æœ‰erräº§ç”Ÿï¼Œ å¹¶ä¸å…³å¿ƒhttp respond codeã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 179;
flex-basis: 430px"
>
&lt;a href="https://tab.deoops.com/posts/pod-life-live/getBody.png" data-size="1488x830">
&lt;img src="https://tab.deoops.com/posts/pod-life-live/getBody.png"
width="1488"
height="830"
srcset="https://tab.deoops.com/posts/pod-life-live/getBody_hu1de47f0bc59d2d72f7f84f5247757181_215040_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/pod-life-live/getBody_hu1de47f0bc59d2d72f7f84f5247757181_215040_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="getHTTPRespBody">
&lt;/a>
&lt;figcaption>getHTTPRespBody&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h2 id="livenessreadiness-probe">Liveness/readiness probe&lt;/h2>
&lt;p>pod liveness/readiness &lt;strong>probe&lt;/strong> åˆ™ä¼šæ£€æŸ¥ http code æ˜¯å¦ä¸º &lt;code>2xx&lt;/code>æ¥ç¡®å®š&lt;strong>probe&lt;/strong> æ˜¯å¦æˆåŠŸã€‚&lt;/p>
&lt;h3 id="ç›¸å…³ä»£ç -1">ç›¸å…³ä»£ç &lt;/h3>
&lt;p>talk is cheap.&lt;/p>
&lt;p>&lt;a class="link" href="https://sourcegraph.com/github.com/kubernetes/kubernetes/-/blob/pkg/kubelet/prober/prober.go?L183" target="_blank" rel="noopener"
>runProbe&lt;/a> è°ƒç”¨&lt;a class="link" href="https://sourcegraph.com/github.com/kubernetes/kubernetes/-/blob/pkg/probe/http/http.go?L129" target="_blank" rel="noopener"
>http.Probe&lt;/a>ï¼Œ&lt;code>DoHTTPProbe&lt;/code>ä¼šæ£€æŸ¥http response codeã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 170;
flex-basis: 408px"
>
&lt;a href="https://tab.deoops.com/posts/pod-life-live/httpCode.png" data-size="1830x1076">
&lt;img src="https://tab.deoops.com/posts/pod-life-live/httpCode.png"
width="1830"
height="1076"
srcset="https://tab.deoops.com/posts/pod-life-live/httpCode_hu635bd497a36d20f21b0e9bb81ddae9bc_294012_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/pod-life-live/httpCode_hu635bd497a36d20f21b0e9bb81ddae9bc_294012_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="doHTTPProbe">
&lt;/a>
&lt;figcaption>doHTTPProbe&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>ä»æºç å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°ï¼Œ lifecyce çš„&lt;strong>handler&lt;/strong> åªå‘é€äº†http è¯·æ±‚ï¼Œå¹¶æ²¡æœ‰æ£€æŸ¥ http response code,
liveness/readiness çš„&lt;strong>prober&lt;/strong> åˆ™åšäº†http response code çš„æ£€æŸ¥ã€‚&lt;/p></description></item><item><title>VPCæ¨¡å¼</title><link>https://tab.deoops.com/posts/flannel-vpc/</link><pubDate>Tue, 11 Sep 2018 10:07:04 +0800</pubDate><guid>https://tab.deoops.com/posts/flannel-vpc/</guid><description>&lt;img src="https://tab.deoops.com/posts/flannel-vpc/flannel-vpc-mode.png" alt="Featured image of post VPCæ¨¡å¼" />&lt;p>ä¹‹å‰å†™äº†ä¸€ç¯‡post &lt;a class="link" href="https://tab.deoops.com/posts/tx-flannel/" >é€‚é…è…¾è®¯äº‘backend&lt;/a> çš„æ–‡ç« ï¼Œä»ä»£ç çš„è§’åº¦ç®€å•è®°å½•äº†flannel
&lt;code>vpc backend&lt;/code>å®ç°è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>è¿™ç¯‡æ–‡ç« æ˜¯å¯¹å‰é¢æ–‡ç« çš„è¡¥å……ï¼Œå…¨å±€é¸Ÿç°æç»˜äº†flannel &lt;code>vpc backend&lt;/code>ç½‘ç»œæ•°æ®åŒ…çš„æµåŠ¨è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>æ€»ä½“æ¥çœ‹&lt;code>vpc&lt;/code> å’Œ &lt;code>host-gw&lt;/code> æ¨¡å¼æ˜¯å¾ˆç±»ä¼¼çš„ï¼Œç†è§£&lt;code>host-gateway&lt;/code>æ¨¡å¼ å¯¹ç†è§£&lt;code>vpc&lt;/code> æ¨¡å¼å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/p>
&lt;h2 id="host-gw">host gw&lt;/h2>
&lt;p>host gateway æ¨¡å¼ï¼š&lt;/p>
&lt;blockquote>
&lt;p>host-gw adds route table entries on hosts, so that host know how to traffic container network packets.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>This works on L2, because it only concerns hosts, switches and containers. switches does not care IP and route, hosts know containers exists, and how to route to them, containers just send and receive data.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>If hosts are at different networks, L3 is introduced, and routers are involved. routers have no idea that containers exists, and any containers packet will be dropped, making communication impossible.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>Of course, you can add route table entries on routers, but that is out of control flannel.&lt;/p>
&lt;/blockquote>
&lt;h3 id="l2">L2&lt;/h3>
&lt;p>ä¸ºä»€ä¹ˆhost-gwæ¨¡å¼ä¸‹ï¼ŒäºŒå±‚ç½‘ç»œä¸€å®šè¦æ‰“é€š:&lt;/p>
&lt;p>stackoverflow ä¸Šé¢å·²ç»æœ‰&lt;a class="link" href="https://stackoverflow.com/questions/45293321/why-host-gw-of-flannel-requires-direct-layer2-connectivity-between-hosts" target="_blank" rel="noopener"
>å¾ˆå¥½çš„å›ç­”&lt;/a>ï¼Œæˆ‘æ‘˜æŠ„è¿‡æ¥ï¼š&lt;/p>
&lt;p>host-gw adds route table entires on each host. And the entries are as following:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-s" data-lang="s">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Destination&lt;/span> &lt;span class="n">Gateway&lt;/span> &lt;span class="n">Genmask&lt;/span> &lt;span class="n">Flags&lt;/span> &lt;span class="n">Metric&lt;/span> &lt;span class="n">Ref&lt;/span> &lt;span class="n">Use&lt;/span> &lt;span class="n">Iface&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0.0.0.0&lt;/span> &lt;span class="m">10.110.110.1&lt;/span> &lt;span class="m">0.0.0.0&lt;/span> &lt;span class="n">UG&lt;/span> &lt;span class="m">100&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="n">eth0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10.100.14.0&lt;/span> &lt;span class="m">10.110.110.21&lt;/span> &lt;span class="m">255.255.255.0&lt;/span> &lt;span class="n">UG&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="n">eth0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10.100.38.0&lt;/span> &lt;span class="m">0.0.0.0&lt;/span> &lt;span class="m">255.255.255.0&lt;/span> &lt;span class="n">U&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="n">docker0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">10.110.110.0&lt;/span> &lt;span class="m">0.0.0.0&lt;/span> &lt;span class="m">255.255.255.0&lt;/span> &lt;span class="n">U&lt;/span> &lt;span class="m">100&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="n">eth0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">169.254.169.254&lt;/span> &lt;span class="m">10.110.110.1&lt;/span> &lt;span class="m">255.255.255.255&lt;/span> &lt;span class="n">UGH&lt;/span> &lt;span class="m">100&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="n">eth0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>The most import item is the value of Gateway(10.110.110.21).&lt;/p>
&lt;/blockquote>
&lt;p>The route table will change the destination mac address to the mac_address of node(10.110.110.21) which is connected L2 directly to 10.110.110.22(current node).&lt;/p>
&lt;p>If not L2 connected, the packet can not be delivered to nodes(next-hop)&lt;/p>
&lt;h2 id="vpc">vpc&lt;/h2>
&lt;h3 id="æ•°æ®åŒ…">æ•°æ®åŒ…&lt;/h3>
&lt;p>&lt;code>vpc backend&lt;/code>æ¨¡å¼ä¸‹ç½‘ç»œæ•°æ®åŒ…çš„æµåŠ¨è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;ol>
&lt;li>Flanneld åœ¨æ¯ä¸ªnode èŠ‚ç‚¹åˆ›å»ºä¸€ä¸ª cni0 çš„ç½‘æ¡¥bridgeè®¾å¤‡ï¼Œnodeé‡Œé¢çš„podä¹‹é—´çš„é€šä¿¡èµ°cni0ç½‘æ¡¥ï¼›&lt;/li>
&lt;li>Node å’Œ åœ¨æœ¬æœºä¸Šçš„pod é€šä¿¡é€šè¿‡nodeçš„route table è½¬å‘åˆ°cni0ï¼›&lt;/li>
&lt;li>vpc backendé€‚é…å™¨è°ƒç”¨vpc sdkåœ¨vpcç½‘ç»œä¸­ç»´æŠ¤äº†ä¸€ä¸ªvpc route tableï¼›&lt;/li>
&lt;li>Node å’Œå…¶å®ƒnodeé‡Œé¢çš„podé€šä¿¡ï¼Œæ˜¯å…ˆé€šè¿‡ vpc route table æ‰¾åˆ° pod å­ç½‘ æ‰€å¯¹åº”nodeï¼Œç„¶åå†é€šè¿‡è¿™ä¸ªnodeæŠŠç½‘ç»œæµé‡è½¬å‘åˆ°podï¼›&lt;/li>
&lt;li>è·¨node çš„pod é€šä¿¡é€šè¿‡è¿™ä¸ªroute tableæ‰¾åˆ°podç½‘æ®µæ‰€åœ¨çš„nodeï¼Œç„¶åè½½é€šè¿‡ node èŠ‚ç‚¹ä¸Šçš„route table è½¬å‘åˆ°å¯¹åº”node ä¸Šcni0è®¾å¤‡ä¸Šç„¶åæ‰¾åˆ°å¯¹åº”çš„podï¼›&lt;/li>
&lt;li>VPCä¸Šçš„æ™®é€švm(å³ï¼Œè¯¥vmä¸æ˜¯k8s node)å’Œ k8s podä¹‹é—´çš„é€šä¿¡ä¸ ä¸Šé¢ç¬¬4ï¼Œ5ç‚¹ é€šä¿¡æ˜¯ä¸€æ ·çš„ã€‚&lt;/li>
&lt;/ol>
&lt;h3 id="l2åŒºåˆ«">L2åŒºåˆ«&lt;/h3>
&lt;p>host-gw mode å› ä¸ºæ˜¯åœ¨node èŠ‚ç‚¹ä¸Š æ·»åŠ çš„ route è§„åˆ™ï¼Œæ‰€ä»¥æ‰€æœ‰çš„èŠ‚ç‚¹è¦äºŒå±‚switchæ‰“é€šï¼Œå¦åˆ™ ä¸‹ä¸€è·³(next-hop)è·³ä¸è¿‡å»ï¼Œæ²¡äººå¸®å¿™è½¬å‘äºŒå±‚æ•°æ®åŒ…(frame)ã€‚&lt;/p>
&lt;p>vpc backend mode å› ä¸ºæ˜¯åœ¨äº‘å‚å•†æä¾›çš„å¤–éƒ¨routerä¸Šæ·»åŠ çš„ route è§„åˆ™ï¼Œå¯¹vmåšåˆ°äº†æ— æ„ŸçŸ¥ï¼Œæ‰€ä»¥ vmä¹‹é—´æ— éœ€æ‰“é€š äºŒå±‚ switchã€‚&lt;/p></description></item><item><title>å­ç›®å½•çˆ¶ç›®å½•</title><link>https://tab.deoops.com/posts/path-overlap/</link><pubDate>Mon, 10 Sep 2018 21:20:33 +0800</pubDate><guid>https://tab.deoops.com/posts/path-overlap/</guid><description>&lt;img src="https://tab.deoops.com/posts/path-overlap/Half-overlapping-paths-of-AB.png" alt="Featured image of post å­ç›®å½•çˆ¶ç›®å½•" />&lt;p>æœ€è¿‘å¼€å‘çš„é‡åˆ°ä¸€ä¸ªéœ€æ±‚æ˜¯åœ¨åˆ¤æ–­ ä¸¤ä¸ªç›®å½•æ˜¯å¦ç›¸äº’åŒ…å«ã€‚&lt;/p>
&lt;p>æƒ³ç€ç”¨æ­£åˆ™è¡¨è¾¾å¼æˆ–è€…é€’å½’å»è§£å†³ï¼Œæ£é¼“ä¸€æ®µæ—¶é—´åå‘ç°æ€»æœ‰äº›edge case ä¸èƒ½coveråˆ°ï¼Œ&lt;/p>
&lt;p>åæ¥å‘ç°ç”¨ python çš„pathlib å¯ä»¥å¾ˆå¥½çš„è§£å†³ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="cl">&lt;span class="kn">from&lt;/span> &lt;span class="nn">pathlib&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Path&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">overlapping&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">):&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">True&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">a_path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">b_path&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">a_path&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">b_path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parents&lt;/span> &lt;span class="ow">or&lt;/span> &lt;span class="n">b_path&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">a_path&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">parents&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ”¶é›†å®¹å™¨syslog</title><link>https://tab.deoops.com/posts/pod-syslog/</link><pubDate>Mon, 03 Sep 2018 20:46:00 +0800</pubDate><guid>https://tab.deoops.com/posts/pod-syslog/</guid><description>&lt;img src="https://tab.deoops.com/posts/pod-syslog/local-domain-socket.png" alt="Featured image of post æ”¶é›†å®¹å™¨syslog" />&lt;p>æœ‰ä¸€ä¸ªapp è·‘åœ¨podé‡Œé¢ï¼Œè¿™ä¸ªapp é»˜è®¤ä¼šè¾“å‡ºè‡ªå·±çš„è¿è¡Œæ—¥å¿—åˆ°syslogdï¼Œ&lt;/p>
&lt;p>è¯·é—®å¦‚ä½•è®©hostä¸»æœºä¸Šè¿è¡Œçš„syslogdæ—¥å¿—æ”¶é›†å™¨æ”¶é›†åˆ°ä¸Šé¢appè¾“å‡ºçš„è¿è¡Œæ—¥å¿—å‘¢ï¼Ÿ&lt;/p>
&lt;h2 id="devlog">/dev/log&lt;/h2>
&lt;p>ç­”æ¡ˆï¼šæŠŠ ä¸»æœºçš„ &lt;code>/dev/log&lt;/code>ç›®å½•æŒ‚è½½åˆ° pod é‡Œé¢çš„ &lt;code>/dev/log&lt;/code>å³å¯ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Some of these messages need to be brought to a system administratorâ€™s attention immediately. And it may not be just any system administrator â€“ there may be a particular system administrator who deals with a particular kind of message. Other messages just need to be recorded for future reference if there is a problem. Still others may need to have information extracted from them by an automated process that generates monthly reports.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>To deal with these messages, most Unix systems have a facility called &amp;ldquo;Syslog.&amp;rdquo; It is generally based on a daemon called â€œSyslogdâ€ Syslogd listens for messages on a Unix domain socket named /dev/log.&lt;/p>
&lt;/blockquote>
&lt;p>å‚è€ƒ&lt;a class="link" href="https://www.gnu.org/software/libc/manual/html_node/Overview-of-Syslog.html" target="_blank" rel="noopener"
>syslog overview&lt;/a>&lt;/p>
&lt;h3 id="mountpath">mountPath&lt;/h3>
&lt;p>å…·ä½“æ¥è¯´å°±åœ¨ pod çš„yaml å®šä¹‰ä¸­ï¼Œæ·»åŠ  hostPath volumeï¼Œç„¶åæŒ‚è½½åˆ°podé‡Œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">syslog&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">mountPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/dev/log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">volumes&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">syslog&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">hostPath&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">path&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/dev/log&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨&lt;code>client-go&lt;/code>ç­‰sdkä¸­è¿™æ ·å†™å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Volume&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;syslog&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">VolumeSource&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VolumeSource&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">HostPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">HostPathVolumeSource&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Path&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;/dev/log&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">Containers&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Container&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Container&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">VolumeMount&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">Name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;syslog&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">MountPath&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;/dev/log&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>è°ƒåº¦åˆ°masterèŠ‚ç‚¹</title><link>https://tab.deoops.com/posts/master-affinity/</link><pubDate>Sat, 18 Aug 2018 20:57:52 +0800</pubDate><guid>https://tab.deoops.com/posts/master-affinity/</guid><description>&lt;img src="https://tab.deoops.com/posts/master-affinity/toleration.webp" alt="Featured image of post è°ƒåº¦åˆ°masterèŠ‚ç‚¹" />&lt;p>ä¸€èˆ¬æ¥è¯´ï¼Œkubernetes çš„podæ˜¯ä¸åœ¨master èŠ‚ç‚¹ä¸Šè¿è¡Œçš„ã€‚&lt;/p>
&lt;p>å¦‚æœè¦æ±‚pod å¿…é¡»è¢«è°ƒåº¦åˆ°master èŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå¯ä»¥ä¿®æ”¹pod çš„ toleration å’Œ affinityã€‚&lt;/p>
&lt;h2 id="tolerationå’Œaffinity">tolerationå’Œaffinityï¼š&lt;/h2>
&lt;p>åœ¨podåŠ ä¸Štolerationå’Œaffinityé…ç½®&lt;/p>
&lt;h3 id="yaml">yaml&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">spec&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tolerations&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;node-role.kubernetes.io/master&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">operator&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;Equal&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">value&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;true&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">effect&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;NoSchedule&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">affinity&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeAffinity&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">requiredDuringSchedulingIgnoredDuringExecution&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">nodeSelectorTerms&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">matchExpressions&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">key&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">node-role.kubernetes.io/master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">operator&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Exists&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="go">go&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">Operator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TolerationOpExists&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">Effect&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TaintEffectNoSchedule&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">Affinity&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Affinity&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">NodeAffinity&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeAffinity&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">RequiredDuringSchedulingIgnoredDuringExecution&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelector&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">NodeSelectorTerms&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelectorTerm&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelectorTerm&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">MatchExpressions&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelectorRequirement&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelectorRequirement&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">Key&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s">&amp;#34;node-role.kubernetes.io/master&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="nx">Operator&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">apiv1&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NodeSelectorOpExists&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">+&lt;/span> &lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æ›¿æ¢k8sæ‰€æœ‰è¯ä¹¦</title><link>https://tab.deoops.com/posts/k8s-certs/</link><pubDate>Fri, 10 Aug 2018 20:27:10 +0800</pubDate><guid>https://tab.deoops.com/posts/k8s-certs/</guid><description>&lt;img src="https://tab.deoops.com/posts/k8s-certs/k8s.webp" alt="Featured image of post æ›¿æ¢k8sæ‰€æœ‰è¯ä¹¦" />&lt;p>å®¢æˆ·éœ€è¦æŠŠkubernetes &lt;code>apiserver/etcd/kubelet/kubectl&lt;/code> ç­‰æ‰€æœ‰çš„è¯ä¹¦æœ‰æ•ˆæœŸä¿®æ”¹ä¸º100å¹´ã€‚&lt;/p>
&lt;p>å¾ˆæ˜æ˜¾è¿™æ˜¯ä¸€ä¸ªä¸åˆç†çš„éœ€æ±‚ï¼Œä¸è¿‡å®¢æˆ·è¯´ä»€ä¹ˆå°±æ˜¯ä»€ä¹ˆã€‚&lt;/p>
&lt;p>äºæ˜¯ç»å‡ å¤©çš„è°ƒè¯•æœ‰äº†ä¸‹é¢çš„è¿™ä¸ª &lt;code>Makefile&lt;/code>æ‰¹é‡ç”Ÿæˆæ‰€æœ‰(&lt;code>FILES&lt;/code>å˜é‡)çš„è¯ä¹¦ã€‚&lt;/p>
&lt;p>å¦‚æœå¯¹makefileçš„è¯­æ³•ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹çœ‹&lt;a class="link" href="https://tab.deoops.com/posts/makefile-tutorial/" >Makefileç®€ä»‹&lt;/a>&lt;/p>
&lt;h2 id="makefile">makefile&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nv">FILES&lt;/span> &lt;span class="o">=&lt;/span> ca.crt ca.key sa.key sa.pub front-proxy-ca.crt front-proxy-ca.key etcd_ca.crt etcd_ca.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONFS&lt;/span> &lt;span class="o">=&lt;/span> admin.conf controller-manager.conf kubelet.conf scheduler.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">SELFS&lt;/span> &lt;span class="o">=&lt;/span> kubelet.crt.self kubelet.crt.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#KEYs = ca.key front-proxy-ca.key etcd_ca.key sa.key
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#CAs = ca.crt front-proxy-ca.crt etcd_ca.crt
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#PUBs = sa.pub
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## kubernetes will sign certificate
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## automatically, so below
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## csr/cert is for test purpose
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#CSR = apiserver.csr apiserver-kubelet-client.csr
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CERT_KEYS&lt;/span> &lt;span class="o">=&lt;/span> apiserver.key apiserver-kubelet-client.key front-proxy-client.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CERTS&lt;/span> &lt;span class="o">=&lt;/span> apiserver.cert apiserver-kubelet-client.cert front-proxy-client.cert
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># openssl genrsa -des3 -out rootCA.key 4096
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CMD_CREATE_PRIVATE_KEY&lt;/span> &lt;span class="o">=&lt;/span> openssl genrsa -out &lt;span class="nv">$@&lt;/span> &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CMD_CREATE_PUBLIC_KEY&lt;/span> &lt;span class="o">=&lt;/span> openssl rsa -in $&amp;lt; -pubout -out &lt;span class="nv">$@&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># openssl req -x509 -new -nodes -key rootCA.key -sha256 -days 1024 -out rootCA.crt
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CMD_CREATE_CA&lt;/span> &lt;span class="o">=&lt;/span> openssl req -x509 -new -nodes -key $&amp;lt; -sha256 -days &lt;span class="m">36500&lt;/span> -out &lt;span class="nv">$@&lt;/span> -subj &lt;span class="s1">&amp;#39;/CN=kubernetes&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># openssl req -new -key mydomain.com.key -out mydomain.com.csr
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CMD_CREATE_CSR&lt;/span> &lt;span class="o">=&lt;/span> openssl req -new -key $&amp;lt; -out &lt;span class="nv">$@&lt;/span> -config &lt;span class="k">$(&lt;/span>word 2,$^&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># openssl x509 -req -in mydomain.com.csr -CA rootCA.crt -CAkey rootCA.key -CAcreateserial -out mydomain.com.crt -days 500 -sha256
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CMD_SIGN_CERT&lt;/span> &lt;span class="o">=&lt;/span> openssl x509 -req -in $&amp;lt; -CA &lt;span class="k">$(&lt;/span>word 2,$^&lt;span class="k">)&lt;/span> -CAkey &lt;span class="k">$(&lt;/span>word 3,$^&lt;span class="k">)&lt;/span> -CAcreateserial -out &lt;span class="nv">$@&lt;/span> -days &lt;span class="m">36500&lt;/span> -sha256 -extfile &lt;span class="k">$(&lt;/span>word 4,$^&lt;span class="k">)&lt;/span> -extensions my_extensions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># generata self sign certificate
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CMD_CREATE_CERT&lt;/span> &lt;span class="o">=&lt;/span> openssl req -x509 -new -nodes -key $&amp;lt; -sha256 -days &lt;span class="m">36500&lt;/span> -out &lt;span class="nv">$@&lt;/span> -subj &lt;span class="s1">&amp;#39;/CN=nodeXXX@timestamp1531732165&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CMD_MSG&lt;/span> &lt;span class="o">=&lt;/span> @echo generating &lt;span class="nv">$@&lt;/span> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">MASTER_IP&lt;/span> &lt;span class="o">:=&lt;/span> 192.168.1.200 &lt;span class="c1">## REMEMBER CHANGE ME&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">clean&lt;/span> &lt;span class="n">check&lt;/span> &lt;span class="n">self_sign&lt;/span> &lt;span class="n">rename&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> ${&lt;span class="n">FILES&lt;/span>} ${&lt;span class="n">CONFS&lt;/span>} ${&lt;span class="n">CERT_KEYS&lt;/span>} ${&lt;span class="n">CERTS&lt;/span>}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm &lt;span class="si">${&lt;/span>&lt;span class="nv">FILES&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">CONFS&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">CERT_KEYS&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">CERTS&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">self_sign&lt;/span>&lt;span class="o">:&lt;/span> ${&lt;span class="n">SELFS&lt;/span>}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">check&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> f in *.cert *.crt&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$$&lt;/span>f&lt;span class="p">;&lt;/span> openssl x509 -noout -dates -in &lt;span class="nv">$$&lt;/span>f&lt;span class="p">;&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;===&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">rename&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> f in *.cert&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$$&lt;/span>f&lt;span class="p">;&lt;/span> mv &lt;span class="nv">$$&lt;/span>f &lt;span class="nv">$$&lt;/span>&lt;span class="o">{&lt;/span>f%.*&lt;span class="o">}&lt;/span>.crt&lt;span class="p">;&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;=====&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.key&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_CREATE_PRIVATE_KEY&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.pub&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_CREATE_PUBLIC_KEY&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.self&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_CREATE_CERT&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.crt&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">key&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_CREATE_CA&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.csr&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">key&lt;/span> %.&lt;span class="n">csr&lt;/span>.&lt;span class="n">cnf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_CREATE_CSR&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.cert&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">csr&lt;/span> &lt;span class="n">ca&lt;/span>.&lt;span class="n">crt&lt;/span> &lt;span class="n">ca&lt;/span>.&lt;span class="n">key&lt;/span> %.&lt;span class="n">csr&lt;/span>.&lt;span class="n">cnf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#%.cert: %.csr front-proxy-ca.crt front-proxy-ca.key %.csr.cnf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CMD_SIGN_CERT&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.conf&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">cert&lt;/span> %-&lt;span class="n">conf&lt;/span>.&lt;span class="n">sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sh &lt;span class="k">$(&lt;/span>word 2,$^&lt;span class="k">)&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">MASTER_IP&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸Šé¢çš„&lt;code>Makefile&lt;/code>è¿˜éœ€è¦å¯¹åº”çš„&lt;code>csr&lt;/code>å’Œ &lt;code>conffiles&lt;/code>ã€‚&lt;/p>
&lt;h3 id="admincsrcnf">admin.csr.cnf&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat &lt;span class="s">&amp;lt;&amp;lt;EOF &amp;gt; admin.conf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">apiVersion: v1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">clusters:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">- cluster:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> certificate-authority-data: $(cat ca.crt | base64 | tr -d &amp;#39;\n&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> server: https://$1:6443
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> name: kubernetes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">contexts:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">- context:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> cluster: kubernetes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> user: kubernetes-admin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> name: kubernetes-admin@kubernetes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">current-context: kubernetes-admin@kubernetes
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">kind: Config
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">preferences: {}
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">users:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">- name: kubernetes-admin
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> user:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> client-certificate-data: $(cat admin.cert | base64 | tr -d &amp;#39;\n&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> client-key-data: $(cat admin.key | base64 | tr -d &amp;#39;\n&amp;#39;)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="admin-confsh">admin-conf.sh&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="k">[ req ]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">prompt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">no&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">utf8&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">distinguished_name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">my_req_distinguished_name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">req_extensions&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">my_extensions&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[ my_req_distinguished_name ]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">C&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">dn&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">ST&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">lol&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">L&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">dota&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">O&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">system:masters # change this&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">CN&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">kubernetes-admin # change this&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[ my_extensions ]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">basicConstraints&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">CA:FALSE&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">subjectKeyIdentifier&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">hash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># subjectAltName=@my_subject_alt_names&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># [ my_subject_alt_names ]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.1 = *.oats.org&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.2 = *.oats.net&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.3 = *.oats.in&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.4 = oats.org&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.5 = oats.net&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># DNS.6 = oats.in&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="kubeadm">kubeadm&lt;/h2>
&lt;p>å®‰è£…k8sé›†ç¾¤çš„æ—¶å€™ï¼Œä½¿ç”¨&lt;code>kubeadm phase certs&lt;/code>å‘½ä»¤æ›´æ–°è¯ä¹¦å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kubeadm alpha phase certs all --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase kubelet config write-to-disk --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase kubelet write-env-file --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase kubeconfig kubelet --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase kubeconfig all --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## --experimental-cluster-signing-duration=187600h0m0s&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase controlplane all --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start kubelet
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kubeadm alpha phase mark-master --config kubeadm-config.yaml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## kubeadm join 172.16.0.5:6443 --token xvrmo8.lk0ec7ifzn8mdflu2 --discovery-token-unsafe-skip-ca-verification&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>flannel vpc</title><link>https://tab.deoops.com/posts/tx-flannel/</link><pubDate>Wed, 08 Aug 2018 18:59:00 +0800</pubDate><guid>https://tab.deoops.com/posts/tx-flannel/</guid><description>&lt;img src="https://tab.deoops.com/posts/tx-flannel/flannel-vpc.png" alt="Featured image of post flannel vpc" />&lt;p>update: flannelä»v0.14.0(2021/05/27)å¼€å§‹å·²ç»æ”¯æŒ&lt;a class="link" href="https://github.com/flannel-io/flannel/tree/master/backend/tencentvpc" target="_blank" rel="noopener"
>è…¾è®¯äº‘çš„vpc backend&lt;/a>äº†ã€‚&lt;/p>
&lt;p>å®¢æˆ·éœ€è¦åœ¨è…¾è®¯äº‘ä¸Šéƒ¨ç½²&lt;code>kubernetes&lt;/code>é›†ç¾¤è€Œä¸”é€‰ç”¨çš„ç½‘ç»œæ’ä»¶æ˜¯flannelï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸º&lt;code>flannel&lt;/code> æ·»åŠ  è…¾è®¯äº‘ vpc çš„ backend é€‚é…ã€‚&lt;/p>
&lt;p>æˆ‘å¤§è‡´çœ‹äº†ä¸‹githubä¸Š &lt;a class="link" href="https://github.com/coreos/flannel/tree/master/backend" target="_blank" rel="noopener"
>é˜¿é‡Œäº‘ å’Œ aws&lt;/a> é€‚é…å™¨çš„ä»£ç ï¼Œå‘ç°å¹¶ä¸å¤æ‚ï¼Œflannelå·²ç»æŠŠæ‰€æœ‰çš„dirty work flannel éƒ½åŒ…è£…å¥½APIäº†ã€‚&lt;/p>
&lt;p>ç¨ç¨äº†è§£ä¸€äº›ç½‘ç»œè®¾å¤‡æˆ–è€…Linuxç½‘ç»œç›¸å…³çš„å‘½ä»¤ï¼ˆæ¯”å¦‚&lt;code>route table&lt;/code>ï¼‰å°±å¯ä»¥æ¯”è¾ƒè½»æ¾çš„å†™å‡ºflannelé€‚é…å™¨ã€‚&lt;/p>
&lt;p>æ•´ä¸ªé€‚é…è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‹é¢4ä¸ªæ­¥éª¤ï¼š&lt;/p>
&lt;ol>
&lt;li>å®šä¹‰ TxVpcBackend struct, å®ç°New func åœ¨init funcä¸­æ³¨å†Œ;&lt;/li>
&lt;li>è°ƒç”¨è…¾è®¯äº‘SDK å®ç° RegisterNetwork method;&lt;/li>
&lt;li>æœ€ååœ¨main.goä¸­ æ³¨å†Œè…¾è®¯äº‘backend å³å¯ï¼›&lt;/li>
&lt;li>éƒ¨ç½²deployment çš„æ—¶å€™é€‰æ‹© tx-vpc çš„backend å³å¯.&lt;/li>
&lt;/ol>
&lt;p>ä¸‹é¢ç»“åˆéƒ¨åˆ†ä»£ç å…·ä½“çš„è¯´ä¸‹å®ç°è¿‡ç¨‹ï¼š&lt;/p>
&lt;h2 id="å¼€å‘">å¼€å‘&lt;/h2>
&lt;h3 id="å®šä¹‰ç»“æ„ä½“">å®šä¹‰ç»“æ„ä½“&lt;/h3>
&lt;p>åªæ˜¯æ­ä¸€ä¸ªæ¶å­ï¼Œæ–¹ä¾¿æ³¨å†Œåˆ°flannel backendä¸Šï¼Œä¸å«å…·ä½“é€‚é…å™¨çš„é€»è¾‘ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">type&lt;/span> &lt;span class="nx">TxVpcBackend&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sm&lt;/span> &lt;span class="nx">subnet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Manager&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">extIface&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ExternalInterface&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">New&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">sm&lt;/span> &lt;span class="nx">subnet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Manager&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">extIface&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ExternalInterface&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Backend&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">be&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">TxVpcBackend&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">sm&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">sm&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">extIface&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">extIface&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">be&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Register&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;tx-vpc&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">New&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®ç°registernetwork">å®ç°RegisterNetwork&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">be&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">TxVpcBackend&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">RegisterNetwork&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Context&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">config&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">subnet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Config&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Network&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 1. Parse our configuration
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">cfg&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">AccessKeyID&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">AccessKeySecret&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}{}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">len&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Backend&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">json&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Unmarshal&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">config&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Backend&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">cfg&lt;/span>&lt;span class="p">);&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;error decoding VPC backend config: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Infof&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Unmarshal Configure : %v\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// 2. Acquire the lease form subnet manager
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">attrs&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">subnet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">LeaseAttrs&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">PublicIP&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">ip&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">FromIP&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">be&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">extIface&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ExtAddr&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">l&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">be&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">AcquireLease&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">ctx&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">attrs&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">switch&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">case&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Canceled&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">context&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">DeadlineExceeded&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">default&lt;/span>&lt;span class="p">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;failed to acquire lease: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeyID&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeySecret&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeyID&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ACCESS_KEY_ID&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeySecret&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ACCESS_KEY_SECRET&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeyID&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="o">||&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeySecret&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;ACCESS_KEY_ID and ACCESS_KEY_SECRET must be provided! &amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">createRoute&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">l&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Subnet&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">(),&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeyID&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">cfg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">AccessKeySecret&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Errorf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Error DescribeVRouters: %s .\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">backend&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">SimpleNetwork&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">SubnetLease&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">l&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">ExtIface&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">be&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">extIface&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">},&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸»è¦é€»è¾‘æ˜¯ ä½¿ç”¨è…¾è®¯äº‘çš„SDK åœ¨vpc ç½‘ç»œä¸‹åˆ›å»ºroute , å³ä¸Šé¢çš„&lt;/p>
&lt;p>&lt;code>err = createRoute(l.Subnet.String(), cfg.AccessKeyID, cfg.AccessKeySecret&lt;/code>&lt;/p>
&lt;p>å› ä¸º&lt;code>createRoute Func&lt;/code>å’Œ è…¾è®¯äº‘sdk çš„å®ç°å¼ºç›¸å…³ï¼Œæ‰€ä»¥æˆ‘å°±ä¸å±•å¼€äº†ï¼Œä¸ªäººå¯ä»¥å»githubä¸ŠæŸ¥çœ‹è…¾è®¯äº‘çš„sdkæ–‡æ¡£ã€‚&lt;/p>
&lt;h3 id="targetrout">targetRout&lt;/h3>
&lt;p>æœ€åtargetRoute åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">targetRoute&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">vpc&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Route&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">DestinationCidrBlock&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringPtr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dest&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">GatewayType&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringPtr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;NORMAL_CVM&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">GatewayId&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringPtr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">nextHop&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">RouteDescription&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">common&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringPtr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">desc&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34; flannel podCIDR&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="registry">registry&lt;/h3>
&lt;p>åœ¨&lt;code>main.go&lt;/code>æ–‡ä»¶ä¸­åŠ å¦‚&lt;code>import&lt;/code> pkgå³å¯æ³¨å†Œè…¾è®¯äº‘é€‚é…å™¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">_&lt;/span> &lt;span class="s">&amp;#34;github.com/coreos/flannel/backend/txvpc&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="éƒ¨ç½²">éƒ¨ç½²&lt;/h2>
&lt;h3 id="ä¿®æ”¹deploymnet">ä¿®æ”¹deploymnet&lt;/h3>
&lt;p>ä¿®æ”¹å®˜æ–¹çš„deployment yaml æ–‡ä»¶ä¸­ net-conf.jsonå­—æ®µï¼Œ
æŠŠ&lt;code>&amp;quot;Type&amp;quot;: &lt;/code>æ”¹æˆ&lt;code>tx-vpc&lt;/code>å³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">net-conf.json&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> &amp;#34;Network&amp;#34;: &amp;#34;10.244.0.0/16&amp;#34;,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> &amp;#34;Backend&amp;#34;: {
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> &amp;#34;Type&amp;#34;: &amp;#34;tx-vpc&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="sd"> }&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ–°å»ºramè´¦æˆ·">æ–°å»ºRAMè´¦æˆ·&lt;/h3>
&lt;p>åœ¨è…¾è®¯äº‘çš„dashboardæ–°å»º RAM å¸æˆ·ï¼Œèµ‹äºˆvpcç½‘ç»œè¯»å†™æƒé™ã€‚&lt;/p>
&lt;p>è®°ä¸‹ AccessKeyID å’Œ AccessKeySecret;&lt;/p>
&lt;p>ä¿®æ”¹deploymentä¸­å¡«å†™&lt;code>deploy.yaml&lt;/code>ä¸ºä¸Šä¸€æ­¥ä¸­è®°å½•çš„ &lt;code>AccessKeyID&lt;/code> å’Œ &lt;code>AccessKeySecret&lt;/code>å€¼ã€‚&lt;/p>
&lt;p>æœ€åï¼Œç”¨kubectl éƒ¨ç½²flannleå³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">kubectl create -f deploy.yaml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Makefileç®€ä»‹</title><link>https://tab.deoops.com/posts/makefile-tutorial/</link><pubDate>Fri, 27 Jul 2018 12:38:51 +0800</pubDate><guid>https://tab.deoops.com/posts/makefile-tutorial/</guid><description>&lt;img src="https://tab.deoops.com/posts/makefile-tutorial/gnu-make.png" alt="Featured image of post Makefileç®€ä»‹" />&lt;p>ç½‘ç»œä¸Šå…³äº &lt;code>makefile&lt;/code>çš„æ•™ç¨‹æœ‰å¾ˆå¤šï¼Œç”±äºæˆ‘æ—¥å¸¸ä¸æ˜¯å†™&lt;code>c/c++&lt;/code>çš„ï¼Œ
ä¸å¸¸ä½¿ç”¨&lt;code>makefile&lt;/code>ï¼Œéœ€è¦ç”¨çš„æ—¶å€™æ€»æ˜¯è¦é‡æ–°Googleæœç´¢makefileçš„è¯­æ³•ã€‚&lt;/p>
&lt;p>ç´¢æ€§æ•´ç†å‡ºæ¥è¿™ç¯‡ makefile æ•™ç¨‹ï¼Œå¤‡å¿˜ã€‚&lt;/p>
&lt;h2 id="æ•™ç¨‹">æ•™ç¨‹&lt;/h2>
&lt;p>Makefileç®€æ˜“æ•™ç¨‹ï¼š&lt;/p>
&lt;h3 id="åŸºæœ¬è¯­æ³•">åŸºæœ¬è¯­æ³•&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">target&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">dependency&lt;/span>1 &lt;span class="n">dependency&lt;/span>2 ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">[TAB]&lt;/span> &lt;span class="err">action1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">[TAB]&lt;/span> &lt;span class="err">action2&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä¸‹é¢çš„makefileæ‘˜æŠ„è‡ª&lt;a class="link" href="https://opensourceforu.com/2012/06/gnu-make-in-detail-for-beginners/" target="_blank" rel="noopener"
>GNU Make in Detail for Beginners&lt;/a>ï¼Œè¿™ç¯‡å…¥é—¨æ–‡ç« æŠŠmakefileçš„è¯­æ³•å†™çš„éå¸¸é€å½»ã€‚&lt;/p>
&lt;p>æ¨èå¤§å®¶å¤šè¯»å‡ é&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="c">##### makefile for compile C programs
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Compiler to use
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">CC&lt;/span> &lt;span class="o">=&lt;/span> gcc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># -g for debug, -O2 for optimise and -Wall additonal messages
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">OPTIONS&lt;/span> &lt;span class="o">=&lt;/span> -O2 -g -Wall
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Directory for header file
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">INCLUDES&lt;/span> &lt;span class="o">=&lt;/span> -I .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># List of objects to be build
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">OBJS&lt;/span> &lt;span class="o">=&lt;/span> main.o module.o
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">all&lt;/span> &lt;span class="n">list&lt;/span> &lt;span class="n">clean&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> ${&lt;span class="n">OBJS&lt;/span>}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s2">&amp;#34;Building...&amp;#34;&lt;/span> &lt;span class="c1"># print &amp;#34;Building...&amp;#34; message&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CC&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">OPTIONS&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">INCLUDES&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">OBJS&lt;/span>&lt;span class="si">}&lt;/span> -o main_bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.o&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">c&lt;/span> &lt;span class="c"># &amp;#39;%&amp;#39; pattern wildcard matching
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">CC&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">OPTIONS&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">INCLUDES&lt;/span>&lt;span class="si">}&lt;/span> -c %.c
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">list&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="k">$(&lt;/span>shell ls&lt;span class="k">)&lt;/span> &lt;span class="c1"># print output of command `ls`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo Cleaning up...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -rf *.0 &lt;span class="c1"># &amp;#39;-&amp;#39; prefix for ignoring errors and continue execution&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm main_bin
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#### makefile for img manage
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">FILES&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">$(&lt;/span>shell find imgs -type f -iname &lt;span class="s2">&amp;#34;*.jpg&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> sed &lt;span class="s1">&amp;#39;s/imgs/thumb/g&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">CONVERT_CMD&lt;/span> &lt;span class="o">=&lt;/span> convert -resize &lt;span class="s2">&amp;#34;100x100&amp;#34;&lt;/span> $&amp;lt; &lt;span class="nv">$@&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">MSG&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;\nUpdating thumbnail&amp;#34;&lt;/span> &lt;span class="nv">$@&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">all_thumb&lt;/span>&lt;span class="o">:&lt;/span> ${&lt;span class="n">FILES&lt;/span>}
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">thumb/%.jpg&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">imgs&lt;/span>/%.&lt;span class="n">jpg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CONVERT_CMD&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">thumb/%.JPG&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">imgs&lt;/span>/%.&lt;span class="n">JPG&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">MSG&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="si">${&lt;/span>&lt;span class="nv">CONVERT_CMD&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">clean_all&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo Cleaning up files...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -rm -rf thumb/*.&lt;span class="o">{&lt;/span>jpg,JPG&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å˜é‡">å˜é‡&lt;/h3>
&lt;h4 id="èµ‹å€¼">èµ‹å€¼&lt;/h4>
&lt;h5 id="simple-assignment-">Simple assignment (:=)&lt;/h5>
&lt;p>We can assign values (RHS) to variables (LHS) with this operator, for example: CC := gcc. With simple assignment (:=), the value is expanded and stored to all occurrences in the Makefile when its first definition is found.&lt;/p>
&lt;p>For example, when a CC := ${GCC} ${FLAGS} simple definition is first encountered, CC is set to gcc -W and wherever ${CC} occurs in actions, it is replaced with gcc -W.&lt;/p>
&lt;h5 id="recursive-assignment-">Recursive assignment (=)&lt;/h5>
&lt;p>Recursive assignment (the operator used is =) involves variables and values that are not evaluated immediately on encountering their definition, but are re-evaluated every time they are encountered in an action that is being executed. As an example, say we have:&lt;/p>
&lt;p>GCC = gcc
FLAGS = -W
With the above lines, CC = ${GCC} {FLAGS} will be converted to gcc -W only when an action like ${CC} file.c is executed somewhere in the Makefile. With recursive assignation, if the GCC variable is changed later (for example, GCC = c++), then when it is next encountered in an action line that is being updated, it will be re-evaluated, and the new value will be used; ${CC} will now expand to c++ -W.&lt;/p>
&lt;p>We will also have an interesting and useful application further in the article, where this feature is used to deal with varying cases of filename extensions of image files.&lt;/p>
&lt;h5 id="conditional-assignment-">Conditional assignment (?=)&lt;/h5>
&lt;p>Conditional assignment statements assign the given value to the variable only if the variable does not yet have a value.&lt;/p>
&lt;h5 id="appending-">Appending (+=)&lt;/h5>
&lt;p>The appending operation appends texts to an existing variable. For example:&lt;/p>
&lt;p>CC = gcc
CC += -W
CC now holds the value gcc -W.&lt;/p>
&lt;h4 id="actionå†…ç½®å˜é‡">actionå†…ç½®å˜é‡&lt;/h4>
&lt;p>The &lt;code>%&lt;/code> character can be used for wildcard pattern-matching, to provide generic targets. For example:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">%.o&lt;/span>&lt;span class="o">:&lt;/span> %.&lt;span class="n">c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">[TAB]&lt;/span> &lt;span class="err">actions&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>When &lt;code>%&lt;/code> appears in the dependency list, it is replaced with the same string that was used to perform substitution in the target.
Inside actions, we can use special variables for matching filenames. Some of them are:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="k">$@&lt;/span> &lt;span class="err">(full&lt;/span> &lt;span class="err">target&lt;/span> &lt;span class="err">name&lt;/span> &lt;span class="err">of&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">current&lt;/span> &lt;span class="err">target)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">$?&lt;/span> &lt;span class="err">(returns&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">dependencies&lt;/span> &lt;span class="err">that&lt;/span> &lt;span class="err">are&lt;/span> &lt;span class="err">newer&lt;/span> &lt;span class="err">than&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">current&lt;/span> &lt;span class="err">target)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">$*&lt;/span> &lt;span class="err">(returns&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">text&lt;/span> &lt;span class="err">that&lt;/span> &lt;span class="err">corresponds&lt;/span> &lt;span class="err">to&lt;/span> &lt;span class="err">%&lt;/span> &lt;span class="err">in&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">target)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">$&amp;lt;&lt;/span> &lt;span class="err">(name&lt;/span> &lt;span class="err">of&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">first&lt;/span> &lt;span class="err">dependency)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">dep.o&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">dep&lt;/span>.&lt;span class="n">src&lt;/span> &lt;span class="n">config&lt;/span>1.&lt;span class="n">cfg&lt;/span> &lt;span class="n">config&lt;/span>2.&lt;span class="n">cfg&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo the second preq is &lt;span class="k">$(&lt;/span>word 2,$^&lt;span class="k">)&lt;/span>, the third is &lt;span class="k">$(&lt;/span>word 3,$^&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">$^&lt;/span> &lt;span class="err">(name&lt;/span> &lt;span class="err">of&lt;/span> &lt;span class="err">all&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">dependencies&lt;/span> &lt;span class="err">with&lt;/span> &lt;span class="err">space&lt;/span> &lt;span class="err">as&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">delimiter)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">Instead&lt;/span> &lt;span class="err">of&lt;/span> &lt;span class="err">writing&lt;/span> &lt;span class="err">each&lt;/span> &lt;span class="err">of&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">file&lt;/span> &lt;span class="err">names&lt;/span> &lt;span class="err">in&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">actions&lt;/span> &lt;span class="err">and&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">target,&lt;/span> &lt;span class="err">we&lt;/span> &lt;span class="err">can&lt;/span> &lt;span class="err">use&lt;/span> &lt;span class="err">shorthand&lt;/span> &lt;span class="err">notations&lt;/span> &lt;span class="err">based&lt;/span> &lt;span class="err">on&lt;/span> &lt;span class="err">the&lt;/span> &lt;span class="err">above,&lt;/span> &lt;span class="err">to&lt;/span> &lt;span class="err">write&lt;/span> &lt;span class="err">more&lt;/span> &lt;span class="err">generic&lt;/span> &lt;span class="err">Makefiles.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="action-modifiers">action modifiers&lt;/h3>
&lt;p>We can change the behaviour of the actions we use by prefixing certain action modifiers to the actions. Two important action modifiers are:&lt;/p>
&lt;h4 id="--minus">- (minus)&lt;/h4>
&lt;p>Prefixing &lt;code>-&lt;/code> to any action causes any error that occurs while executing the action to be ignored.&lt;/p>
&lt;p>By default, execution of a Makefile stops when any command returns a non-zero (error) value.
If an error occurs, a message is printed, with the status code of the command, and noting that the error has been ignored.
Looking at the Makefile from our sample project: in the clean target, the rm target_bin command will produce an error if that file does not exist (this could happen if the project had never been compiled, or if make clean is run twice consecutively).
To handle this, we can prefix the rm command with a minus, to ignore errors: -rm target_bin.&lt;/p>
&lt;h4 id="-at">@ (at)&lt;/h4>
&lt;p>&lt;code>@&lt;/code> suppresses the standard print-action-to-standard-output behaviour of make, for the action/command that is prefixed with @.
For example, to echo a custom message to standard output, we want only the output of the echo command, and donâ€™t want to print the echo command line itself. @echo Message will print â€œMessageâ€ without the echo command line being printed.&lt;/p>
&lt;h4 id="phony">.PHONY&lt;/h4>
&lt;p>Use PHONY to avoid file-target name conflicts.
Remember the all and clean special targets in our Makefile?
What happens when the project directory has files with the names all or clean?
The conflicts will cause errors.
Use the &lt;code>.PHONY&lt;/code> directive to specify which targets are not to be treated as files â€” for example: &lt;code>.PHONY: all clean&lt;/code>.&lt;/p>
&lt;h3 id="å…¶å®ƒ">å…¶å®ƒ&lt;/h3>
&lt;h4 id="dry-run">dry run&lt;/h4>
&lt;p>Simulating make without actual execution.
At times, maybe when developing the Makefile, we may want to trace the make execution (and view the logged messages) without actually running the actions, which is time consuming.
Simply use &lt;code>make -n&lt;/code> to do a â€œdry runâ€.&lt;/p>
&lt;h4 id="shell">shell&lt;/h4>
&lt;p>Using the shell command output in a variable
Sometimes we need to use the output from one command/action in other places in the Makefile â€” for example, checking versions/locations of installed libraries, or other files required for compilation.
We can obtain the shell output using the shell command.
For example, to return a list of files in the current directory into a variable, we would run: &lt;code>LS_OUT = $(shell ls)&lt;/code>.&lt;/p>
&lt;h4 id="nested-makefiles">Nested Makefiles&lt;/h4>
&lt;p>Nested Makefiles (which are Makefiles in one or more subdirectories that are also executed by running the make command in the parent directory) can be useful for building smaller projects as part of a larger project. To do this, we set up a target whose action changes directory to the subdirectory, and invokes make again:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">subtargets&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">cd&lt;/span> subdirectory &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="k">$(&lt;/span>MAKE&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Instead of running the make command, we used &lt;code>$(MAKE)&lt;/code>, an environment variable, to provide flexibility to include arguments.
For example, if you were doing a â€œdry runâ€ invocation: if we used the make command directly for the subdirectory, the simulation option (-n) would not be passed, and the commands in the subdirectoryâ€™s Makefile would actually be executed.
To enable use of the -n argument, use the $(MAKE) variable.&lt;/p>
&lt;h2 id="å®è·µ">å®è·µ&lt;/h2>
&lt;p>åœ¨golangé¡¹ç›®é‡Œçš„&lt;a class="link" href="https://github.com/datewu/project-abc/blob/master/Makefile" target="_blank" rel="noopener"
>å®è·µ&lt;/a>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Include variables from .envrc files
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="err">-include&lt;/span> &lt;span class="err">.envrc&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># HELPERS
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## help: print this help message
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">help&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">help&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s2">&amp;#34;\t##IMPORTANT##: please run &amp;#39;echo .envrc &amp;gt;&amp;gt; .gitignore&amp;#39; at very first time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Usage:&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @sed -n &lt;span class="s1">&amp;#39;s/^##//p&amp;#39;&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">MAKEFILE_LIST&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="p">|&lt;/span> column -t -s &lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> sed -e &lt;span class="s1">&amp;#39;s/^/ /&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Create the new confirm target.
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">confirm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">confirm&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo -n &lt;span class="s1">&amp;#39;Are you sure? [y/N] &amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">read&lt;/span> ans &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="o">[&lt;/span> &lt;span class="nv">$$&lt;/span>&lt;span class="o">{&lt;/span>ans:-N&lt;span class="o">}&lt;/span> &lt;span class="o">=&lt;/span> y &lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># DEVELOPMENT
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## run/main: run the cmd/main binary file
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">run&lt;/span>/&lt;span class="n">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">run/main&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go run ./cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## run/debug: debug app use dlv
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">run&lt;/span>/&lt;span class="n">debug&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">run/debug&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dlv debug ./cmd --headless --listen :4040
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## run/test: runs go test with default values
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">run&lt;/span>/&lt;span class="n">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">run/test&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go &lt;span class="nb">test&lt;/span> -timeout 300s -v -count&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> -race ./...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## run/update: runs go get -u &amp;amp;&amp;amp; go mod tidy
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">run&lt;/span>/&lt;span class="n">update&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">run/update&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go get -u ./...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod tidy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## db/psql: connection to the database using psql
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">db&lt;/span>/&lt;span class="n">psql&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">db/psql&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @psql &lt;span class="si">${&lt;/span>&lt;span class="nv">PG_DSN&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## db/generate use sqlc generated models and queries
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">db&lt;/span>/&lt;span class="n">generate&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">db/generate&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;sqlc generate in internal/sqlc fold&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @cd internal/sqlc &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sqlc generate &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">cd&lt;/span> ../..
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## db/migrations/new name=$1: create a new database migration
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">db&lt;/span>/&lt;span class="n">migrations&lt;/span>/&lt;span class="n">new&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">db/migrations/new&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Creating migrate files for ${name}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @migrate create -seq -ext&lt;span class="o">=&lt;/span>.sql -dir&lt;span class="o">=&lt;/span>./migrations &lt;span class="si">${&lt;/span>&lt;span class="nv">name&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## db/migrations/up: apply all up database migrations
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">db&lt;/span>/&lt;span class="n">migrations&lt;/span>/&lt;span class="n">up&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">db/migrations/up&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">confirm&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Running up migrations...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @migrate -path ./migrations -database &lt;span class="si">${&lt;/span>&lt;span class="nv">PG_DSN&lt;/span>&lt;span class="si">}&lt;/span> up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># QUALITY CONTROL
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## audit: tidy dependencies and format, vet and test all code
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">audit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">audit&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Tidying and verifying module dependencies...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod tidy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod verify
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Formatting code...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go fmt ./...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Vetting code...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go vet ./...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#staticcheck ./... # go install honnef.co/go/tools/cmd/staticcheck@latest&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Running tests...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go &lt;span class="nb">test&lt;/span> -race -vet&lt;span class="o">=&lt;/span>off ./...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## vendor: tidy and vendor dependencies
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">vendor&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">vendor&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Tidying and verifying module dependencies...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod tidy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod verify
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Vendoring dependencies...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go mod vendor
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># BUILD
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ==================================================================================== #
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">#current_time = $(shell date --iso-8601=seconds)
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nv">current_time&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">$(&lt;/span>shell date -u +&lt;span class="s2">&amp;#34;%Y-%m-%dT%H:%M:%SZ&amp;#34;&lt;/span>&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">git_description&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">$(&lt;/span>shell git describe --always --dirty --tags --long&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">linker_flags&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;-s -X main.buildTime=${current_time} -X main.version=${git_description}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## build/api: build the cmd/api application
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">build&lt;/span>/&lt;span class="n">api&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">build/main&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">audit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s1">&amp;#39;Building cmd/...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> go build -ldflags&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">linker_flags&lt;/span>&lt;span class="si">}&lt;/span> -o&lt;span class="o">=&lt;/span>./bin/cmd ./cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#go tool dist list&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">GOOS&lt;/span>&lt;span class="o">=&lt;/span>linux &lt;span class="nv">GOARCH&lt;/span>&lt;span class="o">=&lt;/span>amd64 go build -ldflags&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">linker_flags&lt;/span>&lt;span class="si">}&lt;/span> -o&lt;span class="o">=&lt;/span>./bin/linux_amd64/cmd ./cmd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">## build/dlv-debug: build the application with dlv gcflags
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">build&lt;/span>/&lt;span class="n">dlv&lt;/span>-&lt;span class="n">debug&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">build/dlv-debug&lt;/span>&lt;span class="o">:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @echo &lt;span class="s2">&amp;#34;Building for delve debug...&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> @go build &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -ldflags &lt;span class="si">${&lt;/span>&lt;span class="nv">linker_flags&lt;/span>&lt;span class="si">}&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -ldflags&lt;span class="o">=&lt;/span>-compressdwarf&lt;span class="o">=&lt;/span>&lt;span class="nb">false&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -gcflags&lt;span class="o">=&lt;/span>&lt;span class="nv">all&lt;/span>&lt;span class="o">=&lt;/span>-d&lt;span class="o">=&lt;/span>checkptr &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -gcflags&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;all=-N -l&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span> -o ./bin/debug ./cmd
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>äº‹ä»¶é©±åŠ¨</title><link>https://tab.deoops.com/posts/shell-fifo/</link><pubDate>Wed, 27 Jun 2018 12:20:29 +0800</pubDate><guid>https://tab.deoops.com/posts/shell-fifo/</guid><description>&lt;img src="https://tab.deoops.com/posts/shell-fifo/pm.png" alt="Featured image of post äº‹ä»¶é©±åŠ¨" />&lt;p>åœ¨shellè„šæœ¬é‡Œä½¿ç”¨&lt;code>mkfifo&lt;/code>å‘½ä»¤åˆ›å»º&lt;code>named pipes&lt;/code>å¯ä»¥å®ç°ç®€å•çš„äº‹ä»¶é©±åŠ¨ï¼Œ
é¿å…pollï¼ˆè½®è¯¢ï¼‰å¸¦æ¥çš„æ—¶å»¶ï¼ˆnot real-timeï¼‰å’Œèµ„æºæ¶ˆè€—çš„é—®é¢˜ã€‚&lt;/p>
&lt;h2 id="mkfifo">mkfifo&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ man mkfifo &lt;span class="p">|&lt;/span> head -n &lt;span class="m">12&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">MKFIFO&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span> General Commands Manual MKFIFO&lt;span class="o">(&lt;/span>1&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">NAME
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfifo â€“ make fifos
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SYNOPSIS
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfifo &lt;span class="o">[&lt;/span>-m mode&lt;span class="o">]&lt;/span> fifo_name ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">DESCRIPTION
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfifo creates the fifos requested, in the order specified. By default,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> the resulting fifos have mode &lt;span class="m">0666&lt;/span> &lt;span class="o">(&lt;/span>rw-rw-rw-&lt;span class="o">)&lt;/span>, limited by the current
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> umask&lt;span class="o">(&lt;/span>2&lt;span class="o">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="consumer">consumer&lt;/h3>
&lt;p>æ¶ˆè´¹è€…ä»¥blockedçš„çŠ¶æ€ç›‘å¬&lt;code>äº‹ä»¶çš„å‘ç”Ÿ&lt;/code>ï¼Œç„¶å&lt;code>handle&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">pipe&lt;/span>&lt;span class="o">=&lt;/span>/tmp/testpipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">trap&lt;/span> &lt;span class="s2">&amp;#34;rm -f &lt;/span>&lt;span class="nv">$pipe&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> EXIT
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[[&lt;/span> ! -p &lt;span class="nv">$pipe&lt;/span> &lt;span class="o">]]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mkfifo &lt;span class="nv">$pipe&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">while&lt;/span> &lt;span class="nb">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="nb">read&lt;/span> line &amp;lt;&lt;span class="nv">$pipe&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[[&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$line&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s1">&amp;#39;quit&amp;#39;&lt;/span> &lt;span class="o">]]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">break&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$line&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;consumer exiting&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="producer">producer&lt;/h3>
&lt;p>ç”Ÿäº§è€…å¾€&lt;code>pipe&lt;/code>é‡Œå†™å…¥å†…å®¹ï¼Œ&lt;code>è§¦å‘äº‹ä»¶&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">pipe&lt;/span>&lt;span class="o">=&lt;/span>/tmp/testpipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">if&lt;/span> &lt;span class="o">[[&lt;/span> ! -p &lt;span class="nv">$pipe&lt;/span> &lt;span class="o">]]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Reader not running&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">exit&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">1&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="s2">&amp;#34;Hello from &lt;/span>&lt;span class="nv">$$&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$msg&lt;/span> &amp;gt;&lt;span class="nv">$pipe&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å®¡è®¡ç›®å½•</title><link>https://tab.deoops.com/posts/audit-file/</link><pubDate>Wed, 20 Jun 2018 17:02:58 +0800</pubDate><guid>https://tab.deoops.com/posts/audit-file/</guid><description>&lt;img src="https://tab.deoops.com/posts/audit-file/audit.jpeg" alt="Featured image of post å®¡è®¡ç›®å½•" />&lt;p>ä»Šå¤©è°ƒè¯•å®¹å™¨åº”ç”¨çš„æ—¶å€™å‘ç°ï¼Œappè¿è¡Œä¸€æ®µæ—¶é—´åï¼Œå®¹å™¨å¤–æŒ‚çš„ä¸€ä¸ªvolumnä¼šå¶å‘æ€§çš„è¢«åˆ é™¤ã€‚
äºæ˜¯éœ€è¦ç›‘æ§ä¸‹åˆ°åº•æ˜¯è°/å“ªä¸ªè¿›ç¨‹æŠŠæ–‡ä»¶ç›®å½•ç»™åˆ é™¤äº†ã€‚&lt;/p>
&lt;p>googleä¸€é˜µå­åï¼Œå‘ç°å¯ä»¥ä½¿ç”¨&lt;code>auditd&lt;/code> æœåŠ¡æ¥ç›‘æ§å’Œæœç´¢å‡ºéƒ½æœ‰é‚£äº›è¿›ç¨‹æ“ä½œå¤Ÿç›®æ ‡æ–‡ä»¶/ç›®å½•ã€‚&lt;/p>
&lt;p>æ•´ä¸ªè¿‡ç¨‹åˆ†ä¸º3æ­¥ï¼š&lt;/p>
&lt;ol>
&lt;li>å¼€å¯ auditd æœåŠ¡ï¼›&lt;/li>
&lt;li>ä½¿ç”¨auditctl é…ç½® auditdæœåŠ¡ï¼›&lt;/li>
&lt;li>ä¸€æ®µæ—¶é—´ä¹‹å ä½¿ç”¨ ausearch æ¥æŸ¥çœ‹/æœç´¢å®¡è®¡çš„æ—¥å¿—ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="å¯åŠ¨ç›‘æ§">å¯åŠ¨ç›‘æ§&lt;/h2>
&lt;p>å¼€å¯&lt;code>auditd&lt;/code>æœåŠ¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">systemctl start auditd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## you may need `mkdir /var/log/audit`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ·»åŠ ç›‘æ§è§„åˆ™">æ·»åŠ ç›‘æ§è§„åˆ™&lt;/h2>
&lt;p>ç¼–è¾‘å®¡è®¡è§„åˆ™ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## list existing rules&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auditctl -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## clean existing rules&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auditctl -D
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## watch /var/run/yourfolder&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">auditctl -w /var/run/yourfolder -p war -k serachkey
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="auditctlè¯­æ³•">auditctlè¯­æ³•&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@ddeoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># auditctl -h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">usage: auditctl &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -a &amp;lt;l,a&amp;gt; Append rule to end of &amp;lt;l&amp;gt;ist with &amp;lt;a&amp;gt;ction
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -A &amp;lt;l,a&amp;gt; Add rule at beginning of &amp;lt;l&amp;gt;ist with &amp;lt;a&amp;gt;ction
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -b &amp;lt;backlog&amp;gt; Set max number of outstanding audit buffers
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> allowed &lt;span class="nv">Default&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">64&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -c Continue through errors in rules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -C &lt;span class="nv">f&lt;/span>&lt;span class="o">=&lt;/span>f Compare collected fields &lt;span class="k">if&lt;/span> available:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Field name, operator&lt;span class="o">(=&lt;/span>,!&lt;span class="o">=)&lt;/span>, field name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -d &amp;lt;l,a&amp;gt; Delete rule from &amp;lt;l&amp;gt;ist with &amp;lt;a&amp;gt;ction
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">l&lt;/span>&lt;span class="o">=&lt;/span>task,exit,user,exclude
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">a&lt;/span>&lt;span class="o">=&lt;/span>never,always
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -D Delete all rules and watches
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -e &lt;span class="o">[&lt;/span>0..2&lt;span class="o">]&lt;/span> Set enabled flag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -f &lt;span class="o">[&lt;/span>0..2&lt;span class="o">]&lt;/span> Set failure flag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">0&lt;/span>&lt;span class="o">=&lt;/span>silent &lt;span class="nv">1&lt;/span>&lt;span class="o">=&lt;/span>printk &lt;span class="nv">2&lt;/span>&lt;span class="o">=&lt;/span>panic
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -F &lt;span class="nv">f&lt;/span>&lt;span class="o">=&lt;/span>v Build rule: field name, operator&lt;span class="o">(=&lt;/span>,!&lt;span class="o">=&lt;/span>,&amp;lt;,&amp;gt;,&amp;lt;&lt;span class="o">=&lt;/span>,
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &amp;gt;&lt;span class="o">=&lt;/span>,&lt;span class="p">&amp;amp;&lt;/span>,&lt;span class="p">&amp;amp;&lt;/span>&lt;span class="o">=)&lt;/span> value
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -h Help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -i Ignore errors when reading rules from file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -k &amp;lt;key&amp;gt; Set filter key on audit rule
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -l List rules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -m text Send a user-space message
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -p &lt;span class="o">[&lt;/span>r&lt;span class="p">|&lt;/span>w&lt;span class="p">|&lt;/span>x&lt;span class="p">|&lt;/span>a&lt;span class="o">]&lt;/span> Set permissions filter on watch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">r&lt;/span>&lt;span class="o">=&lt;/span>read, &lt;span class="nv">w&lt;/span>&lt;span class="o">=&lt;/span>write, &lt;span class="nv">x&lt;/span>&lt;span class="o">=&lt;/span>execute, &lt;span class="nv">a&lt;/span>&lt;span class="o">=&lt;/span>attribute
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -q &amp;lt;mount,subtree&amp;gt; make subtree part of mount point&lt;span class="err">&amp;#39;&lt;/span>s dir watches
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -r &amp;lt;rate&amp;gt; Set limit in messages/sec &lt;span class="o">(&lt;/span>&lt;span class="nv">0&lt;/span>&lt;span class="o">=&lt;/span>none&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -R &amp;lt;file&amp;gt; &lt;span class="nb">read&lt;/span> rules from file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -s Report status
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -S syscall Build rule: syscall name or number
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -t Trim directory watches
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -v Version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -w &amp;lt;path&amp;gt; Insert watch at &amp;lt;path&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -W &amp;lt;path&amp;gt; Remove watch at &amp;lt;path&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --loginuid-immutable Make loginuids unchangeable once &lt;span class="nb">set&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --reset-lost Reset the lost record counter
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="åˆ†ææ—¥å¿—">åˆ†ææ—¥å¿—&lt;/h2>
&lt;p>æŸ¥çœ‹/æœç´¢ å®¡è®¡æ—¥å¿—ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># ausearch -k wiserun -i &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8377&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>no &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>ENOTEMPTY&lt;span class="o">(&lt;/span>ç›®å½•éç©º&lt;span class="o">)&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42038ca80 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x200 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8376&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>no &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>EISDIR&lt;span class="o">(&lt;/span>æ˜¯ä¸€ä¸ªç›®å½•&lt;span class="o">)&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42038ca60 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8378&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>openat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>yes &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">6&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42038cae0 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>O_RDONLY&lt;span class="p">|&lt;/span>O_CLOEXEC &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8379&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>no &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>EISDIR&lt;span class="o">(&lt;/span>æ˜¯ä¸€ä¸ªç›®å½•&lt;span class="o">)&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42003e3c0 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8380&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>yes &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42003e410 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x200 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8381&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>no &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>EISDIR&lt;span class="o">(&lt;/span>æ˜¯ä¸€ä¸ªç›®å½•&lt;span class="o">)&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42038cb80 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">type&lt;/span>&lt;span class="o">=&lt;/span>SYSCALL &lt;span class="nv">msg&lt;/span>&lt;span class="o">=&lt;/span>audit&lt;span class="o">(&lt;/span>2018å¹´06æœˆ20æ—¥ 14:22:33.669:8382&lt;span class="o">)&lt;/span> : &lt;span class="nv">arch&lt;/span>&lt;span class="o">=&lt;/span>x86_64 &lt;span class="nv">syscall&lt;/span>&lt;span class="o">=&lt;/span>unlinkat &lt;span class="nv">success&lt;/span>&lt;span class="o">=&lt;/span>yes &lt;span class="nv">exit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> &lt;span class="nv">a0&lt;/span>&lt;span class="o">=&lt;/span>0xffffffffffffff9c &lt;span class="nv">a1&lt;/span>&lt;span class="o">=&lt;/span>0xc42038cbc0 &lt;span class="nv">a2&lt;/span>&lt;span class="o">=&lt;/span>0x200 &lt;span class="nv">a3&lt;/span>&lt;span class="o">=&lt;/span>0x0 &lt;span class="nv">items&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="nv">ppid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">20523&lt;/span> &lt;span class="nv">pid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">1890&lt;/span> &lt;span class="nv">auid&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">uid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">gid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">euid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">suid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsuid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">egid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">sgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">fsgid&lt;/span>&lt;span class="o">=&lt;/span>root &lt;span class="nv">tty&lt;/span>&lt;span class="o">=(&lt;/span>none&lt;span class="o">)&lt;/span> &lt;span class="nv">ses&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nb">unset&lt;/span> &lt;span class="nv">comm&lt;/span>&lt;span class="o">=&lt;/span>yes_i_changed_you &lt;span class="nv">exe&lt;/span>&lt;span class="o">=&lt;/span>/root/yes_i_changed_you &lt;span class="nv">key&lt;/span>&lt;span class="o">=&lt;/span>wiserun
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ausearchè¯­æ³•">ausearchè¯­æ³•&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deoops ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># ausearch -h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">usage: ausearch &lt;span class="o">[&lt;/span>options&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -a,--event &amp;lt;Audit event id&amp;gt; search based on audit event id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --arch &amp;lt;CPU&amp;gt; search based on the CPU architecture
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -c,--comm &amp;lt;Comm name&amp;gt; search based on &lt;span class="nb">command&lt;/span> line name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --checkpoint &amp;lt;checkpoint file&amp;gt; search from last &lt;span class="nb">complete&lt;/span> event
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --debug Write malformed events that are skipped to stderr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -e,--exit &amp;lt;Exit code or errno&amp;gt; search based on syscall &lt;span class="nb">exit&lt;/span> code
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -f,--file &amp;lt;File name&amp;gt; search based on file name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -ga,--gid-all &amp;lt;all Group id&amp;gt; search based on All group ids
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -ge,--gid-effective &amp;lt;effective Group id&amp;gt; search based on Effective
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> group id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -gi,--gid &amp;lt;Group Id&amp;gt; search based on group id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -h,--help &lt;span class="nb">help&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -hn,--host &amp;lt;Host Name&amp;gt; search based on remote host name
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -i,--interpret Interpret results to be human readable
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -if,--input &amp;lt;Input File name&amp;gt; use this file instead of current logs
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --input-logs Use the logs even &lt;span class="k">if&lt;/span> stdin is a pipe
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> --just-one Emit just one event
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -k,--key &amp;lt;key string&amp;gt; search based on key field
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -l, --line-buffered Flush output on every line
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -m,--message &amp;lt;Message type&amp;gt; search based on message &lt;span class="nb">type&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -n,--node &amp;lt;Node name&amp;gt; search based on machine&lt;span class="s1">&amp;#39;s name
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -o,--object &amp;lt;SE Linux Object context&amp;gt; search based on context of object
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -p,--pid &amp;lt;Process id&amp;gt; search based on process id
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -pp,--ppid &amp;lt;Parent Process id&amp;gt; search based on parent process id
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -r,--raw output is completely unformatted
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -sc,--syscall &amp;lt;SysCall name&amp;gt; search based on syscall name or number
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -se,--context &amp;lt;SE Linux context&amp;gt; search based on either subject or
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> object
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> --session &amp;lt;login session id&amp;gt; search based on login session id
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -su,--subject &amp;lt;SE Linux context&amp;gt; search based on context of the Subject
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -sv,--success &amp;lt;Success Value&amp;gt; search based on syscall or event
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> success value
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -te,--end [end date] [end time] ending date &amp;amp; time for search
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -ts,--start [start date] [start time] starting data &amp;amp; time for search
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -tm,--terminal &amp;lt;TerMinal&amp;gt; search based on terminal
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s1"> -ua,--uid-all &amp;lt;all User id&amp;gt; search based on All user id&amp;#39;&lt;/span>s
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -ue,--uid-effective &amp;lt;effective User id&amp;gt; search based on Effective
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> user id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -ui,--uid &amp;lt;User Id&amp;gt; search based on user id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -ul,--loginuid &amp;lt;login id&amp;gt; search based on the User&lt;span class="err">&amp;#39;&lt;/span>s Login id
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -uu,--uuid &amp;lt;guest UUID&amp;gt; search &lt;span class="k">for&lt;/span> events related to the virtual
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> machine with the given UUID.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -v,--version version
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -vm,--vm-name &amp;lt;guest name&amp;gt; search &lt;span class="k">for&lt;/span> events related to the virtual
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> machine with the name.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -w,--word string matches are whole word
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -x,--executable &amp;lt;executable name&amp;gt; search based on executable name
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="tips">TIPS&lt;/h2>
&lt;p>å¦‚æœéœ€è¦è®°å½•è¢«å®¡è®¡å¯¹è±¡è¢«åˆ é™¤äº‹ä»¶ï¼Œåˆ™éœ€è¦å®¡è®¡è¯¥å¯¹è±¡çš„ä¸Šä¸€çº§ç›®å½•ã€‚&lt;/p>
&lt;p>&lt;a class="link" href="https://stackoverflow.com/questions/29519590/monitor-audit-file-delete-on-linux" target="_blank" rel="noopener"
>Monitor/audit file delete on Linux&lt;/a>&lt;/p></description></item><item><title>å†…æ ¸å‡çº§</title><link>https://tab.deoops.com/posts/kernel-upgrade/</link><pubDate>Wed, 16 May 2018 16:50:31 +0800</pubDate><guid>https://tab.deoops.com/posts/kernel-upgrade/</guid><description>&lt;img src="https://tab.deoops.com/posts/kernel-upgrade/kernel.png" alt="Featured image of post å†…æ ¸å‡çº§" />&lt;p>ä¼—æ‰€å‘¨çŸ¥centosçš„å†…æ ¸ç‰ˆæœ¬é€‰æ‹©å¾ˆä¿å®ˆï¼Œå¾ˆå¤šæ–°å†…æ ¸çš„æ–°ç‰¹æ€§ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œå’Œdebugæ–¹é¢çš„ç‰¹æ€§éƒ½æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥ç»™centoså‡çº§ä¸‹ kernelå§ã€‚&lt;/p>
&lt;p>æ•´ä¸ªå‡çº§å®‰è£…çš„è¿‡ç¨‹å…¶å®æŒºç®€å•çš„ä¸€å…±åˆ†ä¸º4æ­¥ï¼š&lt;/p>
&lt;ol>
&lt;li>æ‰¾åˆ°repoæºï¼›&lt;/li>
&lt;li>yumå®‰è£…æœ€æ–°çš„kernelï¼›&lt;/li>
&lt;li>ä¿®æ”¹grub2å¯åŠ¨é¡¹ï¼›&lt;/li>
&lt;li>ç§»é™¤æ—§çš„kernelã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;h3 id="elrepo">elrepo&lt;/h3>
&lt;p>è®¿é—®&lt;a class="link" href="http://elrepo.org/tiki/tiki-index.php" target="_blank" rel="noopener"
>elrepo website&lt;/a>æŸ¥çœ‹å¯¹åº” centos ç‰ˆæœ¬æœ€æ–°çš„kernel repoæºã€‚
ç„¶åä½¿ç”¨&lt;code>rpm&lt;/code>æ·»åŠ kernelæºï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-3.el7.elrepo.noarch.rpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="install">install&lt;/h3>
&lt;p>å®‰è£…å†…æ ¸ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum --disablerepo&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;\*&amp;#34;&lt;/span> --enablerepo&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;elrepo-kernel&amp;#34;&lt;/span> list available
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>elrepo-kernel install kernel-ml kernel-ml-devel
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="boot">boot&lt;/h3>
&lt;p>ä¿®æ”¹&lt;code>grub2&lt;/code>å¯åŠ¨é¡¹ï¼Œå¼€æœºä½¿ç”¨æ–°çš„å†…æ ¸ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">awk -F&lt;span class="se">\&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;$1==&amp;#34;menuentry &amp;#34; {print i++ &amp;#34; : &amp;#34; $2}&amp;#39;&lt;/span> /etc/grub2.cfg
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">grub2-set-default &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">init &lt;span class="m">6&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="cleanup">cleanup&lt;/h3>
&lt;p>åˆ é™¤æ—§å†…æ ¸&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">package-cleanup --oldkernels --count&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uname -a
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.howtoforge.com/tutorial/how-to-upgrade-kernel-in-centos-7-server/" target="_blank" rel="noopener"
>How to Upgrade Kernel on CentOS 7&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://www.tecmint.com/install-upgrade-kernel-version-in-centos-7/" target="_blank" rel="noopener"
>How to Install or Upgrade to Kernel 4.15 in CentOS 7&lt;/a>&lt;/p></description></item><item><title>vimé…ç½®</title><link>https://tab.deoops.com/posts/vim-conf/</link><pubDate>Mon, 14 May 2018 11:42:23 +0800</pubDate><guid>https://tab.deoops.com/posts/vim-conf/</guid><description>&lt;img src="https://tab.deoops.com/posts/vim-conf/vim.png" alt="Featured image of post vimé…ç½®" />&lt;p>ä½¿ç”¨vimæœ‰7ï¼Œ8å¹´äº†ï¼Œæ•´ç†ä¸€ä¸‹è‡ªå·±ç”¨åˆ°çš„vimé…ç½®ï¼Œæ–¹ä¾¿è‡ªæŸ¥ã€‚&lt;/p>
&lt;h2 id="vim">vim&lt;/h2>
&lt;h3 id="basic">basic&lt;/h3>
&lt;p>åŸºæœ¬è®¾ç½®ï¼Œè¯­æ³•é«˜äº®ï¼Œè¡Œå·ï¼Œç­‰ç­‰ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">execute&lt;/span> &lt;span class="nx">pathogen&lt;/span>#&lt;span class="nx">infect&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">syntax&lt;/span> &lt;span class="nx">on&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">filetype&lt;/span> &lt;span class="nx">plugin&lt;/span> &lt;span class="nx">indent&lt;/span> &lt;span class="nx">on&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">number&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="paste">paste&lt;/h3>
&lt;p>å¤åˆ¶ç²˜è´´ï¼š
&lt;a class="link" href="https://stackoverflow.com/questions/2514445/turning-off-auto-indent-when-pasting-text-into-vim" target="_blank" rel="noopener"
>disable auto indent&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="line">&lt;span class="cl">&lt;span class="nx">set&lt;/span> &lt;span class="nx">paste&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>Notice the â€œâ€“ INSERT (paste) â€“â€ at the bottom of the Vim window.&lt;/p>
&lt;/blockquote>
&lt;h3 id="fold">fold&lt;/h3>
&lt;p>ä»£ç æŠ˜å ï¼š
&lt;a class="link" href="http://vim.wikia.com/wiki/Folding" target="_blank" rel="noopener"
>Folding wiki&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; close zc&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; open zo&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="font">font&lt;/h3>
&lt;p>å®‰è£…å­—ä½“ï¼š
&lt;a class="link" href="https://github.com/powerline/powerline" target="_blank" rel="noopener"
>install powerline font&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">wget https://github.com/powerline/powerline/raw/develop/font/PowerlineSymbols.otf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">open .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># double click the otf file you&amp;#39;ve just downloaded.&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="kubectl-eidt-issue">kubectl eidt issue&lt;/h3>
&lt;p>ä½¿ç”¨&lt;code>kubectl edit&lt;/code>æ—¶ï¼Œå½“yamlæ–‡ä»¶çš„annotationè¡Œè¿‡å¤§ä¼šæŠ¥é”™:&lt;/p>
&lt;p>&lt;code>annotation: kubectl.kubernetes.io/last-applied-configuration is too large&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; annotation: kubectl.kubernetes.io/last-applied-configuration&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; is too large&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">maxmempattern&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">200000&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="neovim">neovim&lt;/h2>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 177;
flex-basis: 425px"
>
&lt;a href="https://tab.deoops.com/posts/vim-conf/neovim.png" data-size="996x562">
&lt;img src="https://tab.deoops.com/posts/vim-conf/neovim.png"
width="996"
height="562"
srcset="https://tab.deoops.com/posts/vim-conf/neovim_hu5b6b3b4ece43278365f5779b75ee7ecd_83052_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/vim-conf/neovim_hu5b6b3b4ece43278365f5779b75ee7ecd_83052_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="neovim v0.5.1">
&lt;/a>
&lt;figcaption>neovim v0.5.1&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>ä»Šå¹´ï¼ˆ2020ï¼‰ï¼Œæˆ‘ä»vim 8 è¿ç§»åˆ°äº†&lt;code>neovim&lt;/code>ï¼Œä¸‹é¢æ˜¯ &lt;code>~/.config/nvim/init.vim&lt;/code>çš„é…ç½®å†…å®¹&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; cp from ~/.vimrc&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; execute pathogen#infect()&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;syntax on&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;filetype plugin indent on&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">language&lt;/span> &lt;span class="nx">en_US&lt;/span>.&lt;span class="nx">UTF&lt;/span>&lt;span class="m">-8&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">rtp&lt;/span>&lt;span class="p">+=&lt;/span>&lt;span class="sr">/usr/&lt;/span>&lt;span class="nx">local&lt;/span>&lt;span class="sr">/opt/&lt;/span>&lt;span class="nx">fzf&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">number&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">encoding&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">utf&lt;/span>&lt;span class="m">-8&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; You need to set ignorecase if you want to use what smartcase provides&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">ignorecase&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">smartcase&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; kubectl edit&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; annotation: kubectl.kubernetes.io/last-applied-configuration&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; is too large&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">maxmempattern&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">200000&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;set foldmethod=syntax&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;set clipboard=unnamed&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34;autocmd vimenter * NERDTree&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;autocmd StdinReadPre * let s:std_in=1&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;autocmd VimEnter * if argc() == 0 &amp;amp;&amp;amp; !exists(&amp;#34;s:std_in&amp;#34;) | NERDTree | endif&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">StdinReadPre&lt;/span> * &lt;span class="k">let&lt;/span> &lt;span class="nx">s&lt;/span>:&lt;span class="nx">std_in&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">VimEnter&lt;/span> * &lt;span class="k">if&lt;/span> &lt;span class="nx">argc&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">==&lt;/span> &lt;span class="m">1&lt;/span> &amp;amp;&amp;amp; &lt;span class="nx">isdirectory&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">argv&lt;/span>&lt;span class="p">()&lt;/span>[&lt;span class="m">0&lt;/span>]&lt;span class="p">)&lt;/span> &amp;amp;&amp;amp; &lt;span class="p">!&lt;/span>&lt;span class="nx">exists&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s2">&amp;#34;s:std_in&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">exe&lt;/span> &lt;span class="s1">&amp;#39;NERDTree&amp;#39;&lt;/span> &lt;span class="nx">argv&lt;/span>&lt;span class="p">()&lt;/span>[&lt;span class="m">0&lt;/span>] &lt;span class="p">|&lt;/span> &lt;span class="nx">wincmd&lt;/span> &lt;span class="nx">p&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">ene&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">exe&lt;/span> &lt;span class="s1">&amp;#39;cd &amp;#39;&lt;/span>.&lt;span class="nx">argv&lt;/span>&lt;span class="p">()&lt;/span>[&lt;span class="m">0&lt;/span>] &lt;span class="p">|&lt;/span> &lt;span class="k">endif&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">call&lt;/span> &lt;span class="nx">plug&lt;/span>#&lt;span class="nx">begin&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">stdpath&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;data&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> .&lt;span class="s1">&amp;#39;/plugged&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; call plug#begin(&amp;#39;~/.vim/plugged&amp;#39;)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; Make sure you use single quotes&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;tpope/vim-commentary&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;vim-airline/vim-airline&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;vim-airline/vim-airline-themes&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Shorthand notation; fetches https://github.com/junegunn/vim-easy-align&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;junegunn/vim-easy-align&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Any valid git URL is allowed&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;https://github.com/junegunn/vim-github-dashboard.git&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Multiple Plug commands can be written in a single line using | separators&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;SirVer/ultisnips&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;honza/vim-snippets&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; On-demand loading&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;scrooloose/nerdtree&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;on&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;NERDTreeToggle&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;preservim/tagbar&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; Plug &amp;#39;tpope/vim-fireplace&amp;#39;, { &amp;#39;for&amp;#39;: &amp;#39;clojure&amp;#39; }&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Using a non-default branch&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;rdnetto/YCM-Generator&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;branch&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;stable&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Using a tagged release; wildcard allowed (requires git 1.9.2 or above)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;fatih/vim-go&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;do&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;:GoUpdateBinaries&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; &amp;#34; Plugin outside ~/.vim/plugged with post-update hook&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;junegunn/fzf&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;dir&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;~/.fzf&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;do&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;./install --all&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;junegunn/fzf.vim&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; Track the engine.&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;SirVer/ultisnips&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; Snippets are separated from the engine. Add this if you want them:&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;honza/vim-snippets&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="nx">has&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;nvim&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;Shougo/deoplete.nvim&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;do&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;:UpdateRemotePlugins&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">else&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;Shougo/deoplete.nvim&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;roxma/nvim-yarp&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;roxma/vim-hug-neovim-rpc&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">endif&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;tpope/vim-sensible&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;rust-lang/rust.vim&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; for reactjs jsx&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;pangloss/vim-javascript&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;leafgarland/typescript-vim&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;peitalin/vim-jsx-typescript&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">Plug&lt;/span> &lt;span class="s1">&amp;#39;styled-components/vim-styled-components&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;branch&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;main&amp;#39;&lt;/span> }&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; Plug &amp;#39;autozimu/LanguageClient-neovim&amp;#39;, {&amp;#39;branch&amp;#39;: &amp;#39;next&amp;#39;, &amp;#39;do&amp;#39;: &amp;#39;bash install.sh&amp;#39; }&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;Plug &amp;#39;jparise/vim-graphql&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34;Plug &amp;#39;neoclide/coc.nvim&amp;#39;, {&amp;#39;branch&amp;#39;: &amp;#39;release&amp;#39;}&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">call&lt;/span> &lt;span class="nx">plug&lt;/span>#&lt;span class="nx">end&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; let g:coc_global_extensions = [&amp;#39;coc-json&amp;#39;, &amp;#39;coc-tsserver&amp;#39;]&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; for js/ts synax&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; syntax highlighting can get out of sync i&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; https://thoughtbot.com/blog/modern-typescript-and-react-development-in-vim&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">BufEnter&lt;/span> *.{&lt;span class="nx">js&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">jsx&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">ts&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">tsx&lt;/span>} :&lt;span class="nx">syntax&lt;/span> &lt;span class="nx">sync&lt;/span> &lt;span class="nx">fromstart&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">BufLeave&lt;/span> *.{&lt;span class="nx">js&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">jsx&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">ts&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">tsx&lt;/span>} :&lt;span class="nx">syntax&lt;/span> &lt;span class="nx">sync&lt;/span> &lt;span class="nx">clear&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">deoplete&lt;/span>#&lt;span class="nx">enable_at_startup&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">go_def_mode&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s1">&amp;#39;gopls&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">go_info_mode&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s1">&amp;#39;gopls&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">UltiSnipsEditSplit&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s2">&amp;#34;vertical&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">call&lt;/span> &lt;span class="nx">deoplete&lt;/span>#&lt;span class="nx">custom&lt;/span>#&lt;span class="nx">option&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;omni_patterns&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> { &lt;span class="s1">&amp;#39;go&amp;#39;&lt;/span>: &lt;span class="s1">&amp;#39;[^. *\t]\.\w*&amp;#39;&lt;/span> }&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34;set list&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;set listchars=tab:&amp;gt;-&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">tabstop&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">4&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;set expandtab&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;set shiftwidth=2&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">autoindent&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">smartindent&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">mapleader&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span> &lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">nmap&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">C&lt;/span>&lt;span class="p">-&lt;/span>&lt;span class="nx">P&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> :&lt;span class="nx">FZF&lt;/span>&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nx">CR&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">NERDTreeShowHidden&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; If more than one window and previous buffer was NERDTree, go back to it.&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">BufEnter&lt;/span> * &lt;span class="k">if&lt;/span> &lt;span class="nx">bufname&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;#&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">=~&lt;/span># &lt;span class="s2">&amp;#34;^NERD_tree_&amp;#34;&lt;/span> &amp;amp;&amp;amp; &lt;span class="nx">winnr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;$&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="nx">b&lt;/span># &lt;span class="p">|&lt;/span> &lt;span class="k">endif&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">plug_window&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s1">&amp;#39;noautocmd vertical topleft new&amp;#39;&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="nx">has&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;nvim&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c"> &amp;#34;highlight! link TermCursor Cursor&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span> &lt;span class="nx">highlight&lt;/span>&lt;span class="p">!&lt;/span> &lt;span class="nx">TermCursorNC&lt;/span> &lt;span class="nx">guibg&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">red&lt;/span> &lt;span class="nx">guifg&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="nx">white&lt;/span> &lt;span class="nx">ctermbg&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">1&lt;/span> &lt;span class="nx">ctermfg&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">15&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">endif&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="nx">set&lt;/span> &lt;span class="nx">clipboard&lt;/span>&lt;span class="p">+=&lt;/span>&lt;span class="nx">unnamedplus&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="k">let&lt;/span> &lt;span class="nx">g&lt;/span>:&lt;span class="nx">go_imports_autosave&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&amp;#34; nmap &amp;lt;silent&amp;gt; gd &amp;lt;Plug&amp;gt;(coc-definition)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; nmap &amp;lt;silent&amp;gt; gy &amp;lt;Plug&amp;gt;(coc-type-definition)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; nmap &amp;lt;silent&amp;gt; gr &amp;lt;Plug&amp;gt;(coc-references)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34; nmap &amp;lt;leader&amp;gt;rn &amp;lt;Plug&amp;gt;(coc-rename)&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">&lt;/span>&lt;span class="c">&amp;#34;let g:LanguageClient_serverCommands = {&amp;#39;javascript&amp;#39;: [&amp;#39;javascript-typescript-stdio&amp;#39;]}&lt;/span>&lt;span class="err">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>é…ç½®vscode eslint</title><link>https://tab.deoops.com/posts/vscode-eslint/</link><pubDate>Mon, 16 Apr 2018 16:34:09 +0800</pubDate><guid>https://tab.deoops.com/posts/vscode-eslint/</guid><description>&lt;img src="https://tab.deoops.com/posts/vscode-eslint/eslint-airbnb.jpeg" alt="Featured image of post é…ç½®vscode eslint" />&lt;p>ç¦»èŒä¸€æ®µæ—¶é—´äº†ï¼Œéœ€è¦è‡ªå·±å†™ç‚¹å‰ç«¯ä»£ç ã€‚
å¥ˆä½•&lt;code>vim&lt;/code>çš„jsæ’ä»¶å¯¹&lt;code>jsx&lt;/code>çš„æ”¯æŒä¸å¤ªå‹å¥½ï¼Œæ‰€ä»¥è½¬å‘&lt;code>vscode&lt;/code>å†™ç‚¹&lt;code>jsx&lt;/code>ã€‚&lt;/p>
&lt;p>å†™äº†äº›&lt;code>react app&lt;/code>ä»£ç åï¼Œ&lt;code>IDE&lt;/code>åˆ°å¤„é£˜çº¢è‰²çš„æ³¢æµªçº¿ã€°ï¸ã€°ï¸ã€°ï¸ï¼Œå¾ˆæ˜¯æ¼äººã€‚&lt;/p>
&lt;p>å…¨å±€é…ç½®&lt;code>react eslint&lt;/code>å¥½å¤šäº†ï¼Œ è®°å½•ä¸‹é…ç½®çš„è¿‡ç¨‹å¤‡æŸ¥ã€‚&lt;/p>
&lt;h2 id="é…ç½®">é…ç½®&lt;/h2>
&lt;p>åŸºæœ¬ä¸Šæ˜¯ç”¨äº†&lt;code>airbnb&lt;/code>çš„é…ç½®ï¼š&lt;/p>
&lt;p>å…·ä½“çš„æ­¥éª¤å¾ˆç®€å•ï¼Œä¸¤æ­¥å°±å¥½äº†ï¼š&lt;/p>
&lt;ol>
&lt;li>npmå®‰è£…eslintå’Œè¦ç”¨åˆ°pluginï¼›&lt;/li>
&lt;li>æ ¹æ®éœ€æ±‚é…ç½®å…¨å±€çš„&lt;code>eslintrc&lt;/code>æ–‡ä»¶&lt;/li>
&lt;/ol>
&lt;h3 id="plugin">plugin&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">npm install -g jshint
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm install -g eslint eslint-config-airbnb-base eslint-plugin-import
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi .eslintrc.js
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /usr/local/bin/npm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls /usr/local/lib/node_modules/eslint-config-airbnb-base
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm link eslint-config-airbnb-base
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls node_modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm link eslint-plugin-import
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm i -g eslint-plugin-react
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm i -g eslint-plugin-jsx-a11y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm link eslint-plugin-jsx-a11y eslint-plugin-react
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi .eslintrc.js
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="elinttcjs">.elinttc.js&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// ~/.eslintrc.js
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="nx">module&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">exports&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nx">parser&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s2">&amp;#34;babel-eslint&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;plugins&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;react&amp;#34;&lt;/span>&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;extends&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;airbnb-base&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;eslint:recommended&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;plugin:react/recommended&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">],&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;rules&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// &amp;#34;no-unused-vars&amp;#34;:0,
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="s2">&amp;#34;no-console&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="s1">&amp;#39;off&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;max-len&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">120&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,{&lt;/span>&lt;span class="nx">ignoreComments&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">}]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// &amp;#34;prop-types&amp;#34;: [2]
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">},&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;env&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;browser&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;node&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s2">&amp;#34;jasmine&amp;#34;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.robinwieruch.de/react-eslint-webpack-babel/" target="_blank" rel="noopener"
>react eslint webpack babel&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="http://www.zsoltnagy.eu/use-eslint-like-a-pro-with-es6-and-react/" target="_blank" rel="noopener"
>Use ESLint Like a Pro with ES6 and React&lt;/a>&lt;/p></description></item><item><title>é…ç½®http selinux</title><link>https://tab.deoops.com/posts/http-selinux/</link><pubDate>Mon, 16 Apr 2018 16:10:45 +0800</pubDate><guid>https://tab.deoops.com/posts/http-selinux/</guid><description>&lt;img src="https://tab.deoops.com/posts/http-selinux/selinux.webp" alt="Featured image of post é…ç½®http selinux" />&lt;p>ä»Šå¤©åœ¨&lt;code>digitocean&lt;/code>ä¸€å°æ–°ç”³è¯·çš„ä¸»æœºä¸Šéƒ¨ç½²webåº”ç”¨ã€‚éƒ¨ç½²å®Œæˆï¼Œæ‰“å¼€æµè§ˆå™¨å‘ç°æŠ¥é”™403ã€‚&lt;/p>
&lt;p>éƒ¨ç½²çš„webåº”ç”¨å¾ˆç®€å•ï¼Œåç«¯ç”¨nginxåšäº†&lt;a class="link" href="https://tab.deoops.com/posts/nginx-proxy/" >åå‘ä»£ç†&lt;/a>ï¼Œåº”è¯¥æ²¡å•¥å¤§é—®é¢˜ã€‚&lt;/p>
&lt;p>è¿›ä¸€æ­¥æ‰“å¼€chromeçš„consoleï¼Œå‘ç°å¯¹&lt;code>static file&lt;/code>çš„è®¿é—®æŠ¥é”™&lt;code>403&lt;/code>ï¼Œè¿˜æ²¡åˆ°åç«¯å°±å·²ç»æŠ¥é”™äº†ï¼Œ
ä¼°è®¡åé¢çš„ upstream socketä¹Ÿä¼šæŠ¥é”™ã€‚&lt;/p>
&lt;p>&lt;code>ssh&lt;/code>ç™»é™†åˆ°æœåŠ¡å™¨ä¸Šçœ‹äº†ä¸‹nginxçš„æ—¥å¿—ï¼Œå‘ç°æ˜¯æƒé™çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>è¿›ä¸€æ­¥debugäº†ä¹‹åå‘ç°è™šæ‹Ÿæœºå¼€å¯selinuxï¼Œå½“æ—¶å¿ƒå¤´å°±ä¸€ç´§ï¼Œä¼°è®¡è¦æ”¹selinuxé…ç½®äº†ï¼Œè¿™æ˜¯ä¸ªéº»çƒ¦äº‹å„¿ã€‚&lt;/p>
&lt;p>æƒ³ç®€å•ç‚¹ç›´æ¥å…³é—­selinuxï¼Œè½¬å¿µä¸€æƒ³&lt;code>digitocean&lt;/code>çš„ä¸»æœºç›´æ¥æš´éœ²åœ¨internerä¸Šï¼Œå¼€ç€selinux å…¶å®æ˜¯ä¸ªå¾ˆå¥½çš„ä¿æŠ¤ã€‚&lt;code>digitocean&lt;/code>æ‰“å¼€è‡ªæœ‰å®ƒæ‰“å¼€çš„é“ç†ï¼Œæˆ‘çŒœå¯èƒ½æœ‰å¾ˆå¤švmè¢«æ”»ç ´æ²¦ä¸ºåƒµå°¸ç½‘ç»œäº†ã€‚&lt;/p>
&lt;p>googleæœç´¢äº†selinuxçš„web serverå¸¸ç”¨çš„é…ç½®ï¼ŒéªŒè¯åï¼Œè§£å†³äº†&lt;code>nginx 403&lt;/code>çš„é—®é¢˜ã€‚è®°å½•åˆ†äº«å¦‚ä¸‹ï¼š&lt;/p>
&lt;h2 id="check-selinux">check seLinux&lt;/h2>
&lt;h3 id="æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€">æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€&lt;/h3>
&lt;p>&lt;a class="link" href="https://www.centos.org/docs/5/html/5.1/Deployment_Guide/sec-selinux-status-viewing.html" target="_blank" rel="noopener"
>æŸ¥çœ‹selinuxé…ç½®å’ŒçŠ¶æ€&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deo ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># sestatus -v&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SELinux status: enabled
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SELinuxfs mount: /sys/fs/selinux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">SELinux root directory: /etc/selinux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Loaded policy name: targeted
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Current mode: enforcing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Mode from config file: enforcing
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Policy MLS status: enabled
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Policy deny_unknown status: allowed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Max kernel policy version: &lt;span class="m">28&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Process contexts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Current context: unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Init context: system_u:system_r:init_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/sshd system_u:system_r:sshd_t:s0-s0:c0.c1023
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File contexts:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Controlling terminal: unconfined_u:object_r:user_devpts_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/passwd system_u:object_r:passwd_file_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/etc/shadow system_u:object_r:shadow_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/bash system_u:object_r:shell_exec_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/login system_u:object_r:login_exec_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/bin/sh system_u:object_r:bin_t:s0 -&amp;gt; system_u:object_r:shell_exec_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/sbin/agetty system_u:object_r:getty_exec_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/sbin/init system_u:object_r:bin_t:s0 -&amp;gt; system_u:object_r:init_exec_t:s0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/sbin/sshd system_u:object_r:sshd_exec_t:s0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æŸ¥çœ‹æ–‡ä»¶ç›®å½•çš„selinux-label">æŸ¥çœ‹æ–‡ä»¶ç›®å½•çš„selinux label&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deo &lt;span class="o">]&lt;/span>&lt;span class="c1"># ls -Z /opt/todolist&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r--. root root unconfined_u:object_r:admin_home_t:s0 index.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x. root root unconfined_u:object_r:admin_home_t:s0 static
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@deo &lt;span class="o">]&lt;/span>&lt;span class="c1"># ls -Z /usr/share/nginx/html&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r--. root root system_u:object_r:httpd_sys_content_t:s0 50x.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r--. root root system_u:object_r:httpd_sys_content_t:s0 index.html
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="meat">meat&lt;/h2>
&lt;p>ä¸‹é¢ä¸¤ç§æ–¹æ³•é€‰ä¸€ç§å°±å¯ä»¥äº†&lt;/p>
&lt;h3 id="label">label&lt;/h3>
&lt;p>ä¿®æ”¹ç›®å½•labelä½¿å¾—selinux æ”¾è¡Œnginx:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chcon -Rt httpd_sys_content_t /opt/todolist/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -Z /opt/todolist/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-rw-r--r--. root root unconfined_u:object_r:httpd_sys_content_t:s0 index.html
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">drwxr-xr-x. root root unconfined_u:object_r:httpd_sys_content_t:s0 static
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">setsebool -P httpd_can_network_connect &lt;span class="m">1&lt;/span> &lt;span class="p">;&lt;/span> setsebool -P httpd_enable_homedirs on
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">701&lt;/span> /home/dir
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="semanage">semanage&lt;/h3>
&lt;p>æˆ–è€…ä½¿ç”¨&lt;code>semanage&lt;/code>å‘½ä»¤ä¿®æ”¹&lt;code>enforcement mode&lt;/code>ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">~ &lt;span class="o">[&lt;/span>root@jp ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># cat fix_selinux_ng.sh&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semanage permissive -a httpd_tp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>segmanage&lt;/code>è¯­æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>root@jp ~&lt;span class="o">]&lt;/span>&lt;span class="c1"># semanage -h&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">usage: semanage &lt;span class="o">[&lt;/span>-h&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">{&lt;/span>import,export,login,user,port,ibpkey,ibendport,interface,module,node,fcontext,boolean,permissive,dontaudit&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ...
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">semanage is used to configure certain elements of SELinux policy with-out
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">requiring modification to or recompilation from policy source.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">positional arguments:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">{&lt;/span>import,export,login,user,port,ibpkey,ibendport,interface,module,node,fcontext,boolean,permissive,dontaudit&lt;span class="o">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> import Import &lt;span class="nb">local&lt;/span> customizations
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> Output &lt;span class="nb">local&lt;/span> customizations
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> login Manage login mappings between linux users and SELinux
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> confined users
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> user Manage SELinux confined users &lt;span class="o">(&lt;/span>Roles and levels &lt;span class="k">for&lt;/span> an
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SELinux user&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> port Manage network port &lt;span class="nb">type&lt;/span> definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ibpkey Manage infiniband ibpkey &lt;span class="nb">type&lt;/span> definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ibendport Manage infiniband end port &lt;span class="nb">type&lt;/span> definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> interface Manage network interface &lt;span class="nb">type&lt;/span> definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> module Manage SELinux policy modules
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> node Manage network node &lt;span class="nb">type&lt;/span> definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fcontext Manage file context mapping definitions
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> boolean Manage booleans to selectively &lt;span class="nb">enable&lt;/span> functionality
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> permissive Manage process &lt;span class="nb">type&lt;/span> enforcement mode
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dontaudit Disable/Enable dontaudit rules in policy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">optional arguments:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> -h, --help show this &lt;span class="nb">help&lt;/span> message and &lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a class="link" href="https://thecruskit.com/fixing-403-errors-when-using-nginx-with-selinux/" target="_blank" rel="noopener"
>Fixing 403 errors when using nginx with SELinux&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://stackoverflow.com/questions/25995060/nginx-cannot-connect-to-jenkins-on-centos-7" target="_blank" rel="noopener"
>NGinX cannot connect to Jenkins on CentOS 7&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://serverfault.com/questions/686732/nginx-refuses-to-read-new-directory-in-home" target="_blank" rel="noopener"
> Nginx refuses to read new directory in /home&lt;/a>&lt;/p></description></item><item><title>åˆ†é¡µæ‰“å°æ—¥å¿—</title><link>https://tab.deoops.com/posts/git-pager/</link><pubDate>Sat, 14 Apr 2018 10:38:59 +0800</pubDate><guid>https://tab.deoops.com/posts/git-pager/</guid><description>&lt;img src="https://tab.deoops.com/posts/git-pager/pager.jpeg" alt="Featured image of post åˆ†é¡µæ‰“å°æ—¥å¿—" />&lt;p>é»˜è®¤é…ç½®å‘½ä»¤&lt;code>git log&lt;/code>ä¼šåœ¨æ–°çš„çª—å£æ‰“å°æ—¥å¿—å†…å®¹ï¼Œéœ€è¦æ•²ä¸€ä¸‹é”®ç›˜&lt;code>q&lt;/code> æ‰èƒ½è¿”å›å½“å‰ç›®å½•ï¼Œä¸æ–¹ä¾¿è¿ç»­æŸ¥çœ‹:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>otherbranch&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## NOTE content below will be displayed on new window/buff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">* 40303b7 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; otherbranch&lt;span class="o">)&lt;/span> thirdcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span> * 3e6e2f7 &lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">|&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">* f40475e &lt;span class="o">(&lt;/span>tag: firstcommittag&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>END&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## press `q` to exist&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git log --no-pager
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fatal: unrecognized argument: --no-pager
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯ä»¥æŠŠé»˜è®¤çš„åˆ†é¡µæ”¹ä¸º&lt;code>inline&lt;/code>æ¨¡å¼ï¼Œå¯ä»¥æ›´å¿«çš„æŸ¥çœ‹è¿ç»­çš„æ—¥å¿—ï¼š&lt;/p>
&lt;h2 id="meat">meat&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># use --no-pager options&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or set pager to cat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git config --global core.pager cat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># or set pager to less&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># git config --global core.pager &amp;#34;less -erX&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="demo">demo&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">* f40475e &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git branch otherbranch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git tag firstcommittag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">* f40475e &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master, tag: firstcommittag, otherbranch&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> date &amp;gt;&amp;gt; afile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> âœ— git commit -am secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>master 3e6e2f7&lt;span class="o">]&lt;/span> secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> file changed, &lt;span class="m">1&lt;/span> insertion&lt;span class="o">(&lt;/span>+&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git checkout .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * 3e6e2f7 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; master&lt;span class="o">)&lt;/span> secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * f40475e &lt;span class="o">(&lt;/span>tag: firstcommittag, otherbranch&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> git checkout otherbranch
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Switched to branch &lt;span class="s1">&amp;#39;otherbranch&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>otherbranch&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * 3e6e2f7 &lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * f40475e &lt;span class="o">(&lt;/span>HEAD -&amp;gt; otherbranch, tag: firstcommittag&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>otherbranch&lt;span class="o">)&lt;/span> date &amp;gt;&amp;gt; afile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>otherbranch&lt;span class="o">)&lt;/span> âœ— git commit -am thirdcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span>otherbranch 40303b7&lt;span class="o">]&lt;/span> thirdcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">1&lt;/span> file changed, &lt;span class="m">1&lt;/span> insertion&lt;span class="o">(&lt;/span>+&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> âœ lgthw_orign git:&lt;span class="o">(&lt;/span>otherbranch&lt;span class="o">)&lt;/span> git log --oneline --decorate --all --graph
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * 40303b7 &lt;span class="o">(&lt;/span>HEAD -&amp;gt; otherbranch&lt;span class="o">)&lt;/span> thirdcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span> * 3e6e2f7 &lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> secondcommit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">|&lt;/span>/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> * f40475e &lt;span class="o">(&lt;/span>tag: firstcommittag&lt;span class="o">)&lt;/span> firstcommit
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å‚è€ƒ">å‚è€ƒ&lt;/h3>
&lt;p>&lt;a class="link" href="http://blog.timlockridge.com/blog/2013/01/22/changing-the-display-of-git-log/" target="_blank" rel="noopener"
>Changing the Display of Git Log&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>FYI, &lt;code>cat&lt;/code> is not the ideal pager for me, since it displays the full git log from the beginning if I don&amp;rsquo;t append a -1 in the end of the command.
&lt;code>more&lt;/code> was not a good candidate either, since colors was not well displayed in the console with &lt;code>more&lt;/code>
I preferred to keep &lt;code>less&lt;/code> as the pager, but display content in the console.
So for me :
git config &amp;ndash;global core.pager &amp;ldquo;less -erX&amp;rdquo;
(important option here is the -X option)&lt;/p>
&lt;/blockquote></description></item><item><title>pipåŒ…å†²çª</title><link>https://tab.deoops.com/posts/python-import/</link><pubDate>Fri, 30 Mar 2018 10:21:25 +0800</pubDate><guid>https://tab.deoops.com/posts/python-import/</guid><description>&lt;img src="https://tab.deoops.com/posts/python-import/pip.png" alt="Featured image of post pipåŒ…å†²çª" />&lt;p>é‡åˆ°ä¸€ä¸ªå¥‡æ€ªçš„é—®é¢˜æ‰§è¡Œ&lt;code>certbot&lt;/code>ä¼šæŠ¥é”™ï¼Œ&lt;code>moudle conflict&lt;/code>å’Œ &lt;code>No module&lt;/code>ï¼Œä½†æ˜¯&lt;code>yum install certbot&lt;/code>çš„æ—¶å€™æ²¡æœ‰æŠ¥é”™ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/bin/certbot&amp;#34;&lt;/span>, line 7, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from certbot.main import main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/certbot/main.py&amp;#34;&lt;/span>, line 17, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from certbot import account
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/certbot/account.py&amp;#34;&lt;/span>, line 17, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from acme import messages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/acme/messages.py&amp;#34;&lt;/span>, line 7, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from acme import challenges
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/acme/challenges.py&amp;#34;&lt;/span>, line 11, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">import requests
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/requests/__init__.py&amp;#34;&lt;/span>, line 58, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from . import utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/requests/utils.py&amp;#34;&lt;/span>, line 32, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from .exceptions import InvalidURL
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/requests/exceptions.py&amp;#34;&lt;/span>, line 10, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">from .packages.urllib3.exceptions import HTTPError as BaseHTTPError
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File &lt;span class="s2">&amp;#34;/usr/lib/python2.7/site-packages/requests/packages/__init__.py&amp;#34;&lt;/span>, line 95, in load_module
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">raise ImportError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;No module named &amp;#39;%s&amp;#39;&amp;#34;&lt;/span> % &lt;span class="o">(&lt;/span>name,&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ImportError: No module named &lt;span class="s1">&amp;#39;requests.packages.urllib3&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install requests urllib3 pyOpenSSL --force --upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">An unexpected error occurred:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">VersionConflict: &lt;span class="o">(&lt;/span>setuptools 0.9.8 &lt;span class="o">(&lt;/span>/usr/lib/python2.7/site-packages&lt;span class="o">)&lt;/span>, Requirement.parse&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;setuptools&amp;gt;=1.0&amp;#39;&lt;/span>&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install --upgrade pip setuptools
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="meat">meat&lt;/h2>
&lt;p>å¼„äº†å¾ˆä¹…å†³å®šæŠ›å¼ƒ&lt;code>yum&lt;/code>ç›´æ¥ä½¿ç”¨ &lt;code>pip&lt;/code>å®‰è£…certbotï¼Œå®‰è£…å®Œæˆåï¼Œå‘ç°ä¸å†æŠ¥é”™ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum install openssl-devel python-devel
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install --upgrade pip setuptools
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install certbot
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pip install requests urllib3 pyOpenSSL --force --upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">certbot -d tab.deoops.com --manual --preferred-challenges dns certonly
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å°ç»“">å°ç»“&lt;/h2>
&lt;p>æœ¬æ¥æ˜¯ä¸æƒ³å†™è¿™ç¯‡åšæ–‡çš„ï¼Œä¼°æ‘¸ç€&lt;code>letsencrypt&lt;/code>å®˜æ–¹ è¿Ÿæ—©ä¼šä¿®å¤certbot rpmåŒ…çš„ï¼Œç»“æœä¸€ç­‰å°±æ˜¯ä¸¤ä¸ªæœˆï¼Œ
letsencryptéƒ½æ²¡ä¿®å¤ rpmåŒ…ã€‚&lt;/p>
&lt;p>æœ€è¿‘å¤šå°æœåŠ¡å™¨çš„&lt;code>certbot&lt;/code>å®‰è£…åˆé‡åˆ°è¿™ä¸ªä¸å…¼å®¹çš„é—®é¢˜ï¼Œæ¯æ¬¡å»å…¶å®ƒçš„æœåŠ¡å™¨ä¸Šæ‰¾&lt;code>command history&lt;/code>æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥è®°ä¸‹æ¥æ–¹ä¾¿æŸ¥æ‰¾ã€‚&lt;/p></description></item><item><title>éƒ¨ç½²moodle</title><link>https://tab.deoops.com/posts/install-moodle/</link><pubDate>Tue, 20 Mar 2018 13:58:27 +0800</pubDate><guid>https://tab.deoops.com/posts/install-moodle/</guid><description>&lt;img src="https://tab.deoops.com/posts/install-moodle/moodle.png" alt="Featured image of post éƒ¨ç½²moodle" />&lt;p>å®¢æˆ·éœ€è¦éƒ¨ç½²ä¸€å¥— &lt;a class="link" href="https://download.moodle.org/releases/latest/" target="_blank" rel="noopener"
>moodle&lt;/a> æ•™å­¦ç³»ç»Ÿã€‚&lt;/p>
&lt;p>å»&lt;a class="link" href="https://moodle.org/" target="_blank" rel="noopener"
>moodleå®˜ç½‘&lt;/a>å¤§è‡´çœ‹äº†ä¸€åœˆï¼Œå‘ç°moodle æ˜¯ä¸€ä¸ªå…¸å‹çš„PHP webåº”ç”¨ã€‚&lt;/p>
&lt;p>å…¶å®è¿™ç§&lt;code>LAMP (Linux, Apache, MySQL, PHP/Perl/Python)&lt;/code>çš„åº”ç”¨ï¼Œ&lt;/p>
&lt;p>æˆ‘ä¸€èˆ¬ä¼šç”¨docker componseå¿«é€Ÿéƒ¨ç½²çš„ï¼Œæ¯”å¦‚è¿™ä¸ª&lt;a class="link" href="https://github.com/bitnami/bitnami-docker-moodle/blob/master/docker-compose.yml" target="_blank" rel="noopener"
>docker componse&lt;/a>çœ‹ä¸Šå»å°±å¾ˆä¸é”™ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å®¢æˆ·ä¸æƒ³ç”¨dockerï¼Œè¦æ±‚ç›´æ¥åœ¨vmä¸Šéƒ¨ç½²ã€‚&lt;/p>
&lt;p>åˆæ­¥ç¡®è®¤éƒ¨ç½²ç¯å¢ƒä¸ºï¼š &lt;code>nginx(let's encrypt)&lt;/code> + &lt;code>php 7.2&lt;/code> + &lt;code>pg 10&lt;/code> + &lt;code>Centos 7.4&lt;/code> ã€‚&lt;/p>
&lt;h2 id="å®‰è£…è½¯ä»¶">å®‰è£…è½¯ä»¶&lt;/h2>
&lt;h3 id="åˆå§‹åŒ–ä¸»æœº">åˆå§‹åŒ–ä¸»æœº&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">hostnamectl set-hostname deoops.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># disable passwd login; use ssh-key only&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum update -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum upgrade -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">init &lt;span class="m">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># add remi repo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…nginx">å®‰è£…nginx&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum install nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum -y install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum-config-manager --enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## å®‰è£…let&amp;#39;s encrypt certbot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install certbot-nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## ç­¾å‘è¯ä¹¦&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">certbot --nginx certonly
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /etc/nginx/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…php-dependency">å®‰è£…php dependency&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php-fpm php-common php-opcache php-pecl-apcu php-cli php-pear php-pdo php-mysqlnd php-pgsql php-pecl-mongodb php-pecl-redis php-pecl-memcache php-pecl-memcached php-gd php-mbstring php-mcrypt php-xml
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="é…ç½®nginx--php-fpm">é…ç½®nginx + php-fpm&lt;/h3>
&lt;p>è¯¦ç»†çš„é…ç½®å†…å®¹çœ‹&lt;a class="link" href="#%e9%85%8d%e7%bd%ae" >è¿™é‡Œ&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vi /etc/nginx/nginx.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv mood.conf /etc/nginx/conf.d/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -ahl /etc/php-fpm.d/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv www.conf /etc/php-fpm.d/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv php.ini /etc/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start php-fpm.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> php-fpm.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…postgresql-10">å®‰è£…postgresql 10&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">fdisk -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">bash newDisk.sh /dev/vdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir /media/data/mood
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir /media/data/pgdata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-centos10-10-2.noarch.rpm -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install postgresql10 -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install postgresql10-server postgresql10-contrib -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/lib/pgsql/10/data/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R postgres:postgres /media/data/pgdata
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /usr/lib/systemd/system/postgresql-10.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/usr/pgsql-10/bin/postgresql-10-setup initdb
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> postgresql-10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start postgresql-10
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="é…ç½®postgresql-hba">é…ç½®postgresql hba&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">netstat -nlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /media/data/pgdata/pg_hba.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart postgresql-10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…moodle-34">å®‰è£…moodle 34&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv moodle-latest-34.tgz zh_cn.zip /media/data/mood/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /media/data/mood/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tar xzf moodle-latest-34.tgz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/nginx/conf.d/mood.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R nginx:nginx /media/data/mood
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/lib/php/session/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /run/php-fpm/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp &lt;span class="p">|&lt;/span> grep php
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R nginx:nginx /var/lib/php/session/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…moodleä¾èµ–åŒ…">å®‰è£…moodleä¾èµ–åŒ…&lt;/h3>
&lt;p>å®‰è£… &lt;code>zip&lt;/code>,&lt;code>xmlrpc&lt;/code>,&lt;code>soap&lt;/code>ç­‰ä¾èµ–åŒ…ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php72-php-zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart nginx.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">init &lt;span class="m">6&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php72-php-pecl-zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php-zip
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php-intl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install phpxmlrpc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php-xmlrpc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum --enablerepo&lt;span class="o">=&lt;/span>remi,remi-php72 install php-soap
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart php-fpm.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="é…ç½®">é…ç½®&lt;/h2>
&lt;h3 id="é…ç½®nginx-php-fpm">é…ç½®nginx php-fpm&lt;/h3>
&lt;p>moodleä½¿ç”¨çš„nginx é…ç½®ï¼ŒåŸºæœ¬é€‚ç”¨äºæ‰€æœ‰çš„php åº”ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># PHP Upstream Handler
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">upstream&lt;/span> &lt;span class="s">php-handler&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="s">unix:/run/php-fpm/php-fpm.sock&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server_name&lt;/span> &lt;span class="s">moodle-demo.deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl&lt;/span> &lt;span class="no">on&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="s">[::]:443&lt;/span> &lt;span class="s">ssl&lt;/span> &lt;span class="s">ipv6only=on&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">listen&lt;/span> &lt;span class="mi">443&lt;/span> &lt;span class="s">ssl&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">ssl_certificate&lt;/span> &lt;span class="s">/etc/letsencrypt/live/moodle-demo.deoops.com/fullchain.pem&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">ssl_certificate_key&lt;/span> &lt;span class="s">/etc/letsencrypt/live/moodle-demo.deoops.com/privkey.pem&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">include&lt;/span> &lt;span class="s">/etc/letsencrypt/options-ssl-nginx.conf&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="kn">ssl_dhparam&lt;/span> &lt;span class="s">/etc/letsencrypt/ssl-dhparams.pem&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">root&lt;/span> &lt;span class="s">/media/data/mood/moodle&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">rewrite&lt;/span> &lt;span class="s">^/(.*\.php)(/)(.*)&lt;/span>$ &lt;span class="s">/&lt;/span>&lt;span class="nv">$1?file=/$3&lt;/span> &lt;span class="s">last&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="s">^~&lt;/span> &lt;span class="s">/&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">try_files&lt;/span> &lt;span class="nv">$uri&lt;/span> &lt;span class="nv">$uri/&lt;/span> &lt;span class="s">/index.php?q=&lt;/span>&lt;span class="nv">$request_uri&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">index&lt;/span> &lt;span class="s">index.php&lt;/span> &lt;span class="s">index.html&lt;/span> &lt;span class="s">index.htm&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="p">~&lt;/span> &lt;span class="sr">\.php$&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">include&lt;/span> &lt;span class="s">fastcgi.conf&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">fastcgi_pass&lt;/span> &lt;span class="s">php-handler&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># http -&amp;gt; https
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">if&lt;/span> &lt;span class="s">(&lt;/span>&lt;span class="nv">$host&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">moodle-demo.deoops.com)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">return&lt;/span> &lt;span class="mi">301&lt;/span> &lt;span class="s">https://&lt;/span>&lt;span class="nv">$host$request_uri&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="s">[::]:80&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server_name&lt;/span> &lt;span class="s">moodle-demo.deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">return&lt;/span> &lt;span class="mi">404&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="c1"># managed by Certbot
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="é…ç½®httpsè¯ä¹¦">é…ç½®httpsè¯ä¹¦&lt;/h3>
&lt;p>é…ç½®let&amp;rsquo;s encryptè‡ªæ›´æ–°&lt;code>crontab&lt;/code> job:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">certbot renew --dry-run
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">crontab -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">crontab -l
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> 0,12 * * * python -c &lt;span class="s1">&amp;#39;import random; import time; time.sleep(random.random() * 3600)&amp;#39;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> certbot renew
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a class="link" href="https://docs.moodle.org/33/en/PostgreSQL" target="_blank" rel="noopener"
>moodle: set up postgresql counts and database&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://www.howtoforge.com/tutorial/how-to-install-moodle-32-on-centos-7/" target="_blank" rel="noopener"
>PHP(php-fpm) nginx&lt;/a>&lt;/p></description></item><item><title>æ•°æ®åº“å¤‡ä»½</title><link>https://tab.deoops.com/posts/postgresql-backup/</link><pubDate>Sat, 24 Feb 2018 11:21:55 +0800</pubDate><guid>https://tab.deoops.com/posts/postgresql-backup/</guid><description>&lt;img src="https://tab.deoops.com/posts/postgresql-backup/postgresql-backup.jpeg" alt="Featured image of post æ•°æ®åº“å¤‡ä»½" />&lt;p>å·¥ä½œéœ€è¦å®šæ—¶å¤‡ä»½postgresql slaveæ•°æ®åº“æ•°æ®æ•°æ®ï¼ŒæœåŠ¡å™¨ä¸Šè¿è¡Œäº†ä¸¤ä¸ª&lt;code>slave&lt;/code>å®ä¾‹ï¼Œéš¶å±äºä¸¤ä¸ªä¸åŒçš„&lt;code>master&lt;/code>ã€‚&lt;/p>
&lt;h2 id="å¤‡ä»½">å¤‡ä»½&lt;/h2>
&lt;p>ä¸¤ä¸ª&lt;code>slave server&lt;/code>å®ä¾‹åˆ†åˆ«ç›‘å¬åœ¨ &lt;code>5432&lt;/code>å’Œ &lt;code>4432&lt;/code>ç«¯å£&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Daily PostgreSQL maintenance: vacuuming and backuping.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">##&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">set&lt;/span> -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">for&lt;/span> port in &lt;span class="m">5432&lt;/span> 4432&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">BACKDIR&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/data/pg_back/&lt;/span>&lt;span class="nv">$port&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> -d &lt;span class="nv">$BACKDIR&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">||&lt;/span> mkdir -p &lt;span class="nv">$BACKDIR&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;[`date`] begin Maintaining pg on port &lt;/span>&lt;span class="nv">$port&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># no need to use -U option for DB in $(psql -l -t -p $port |awk &amp;#39;{ print $1}&amp;#39; |grep -vE &amp;#39;^-|:|^List|^Name|template[0|1]|postgres|\|&amp;#39;); do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">### swith form &amp;#39;awk and grep&amp;#39; hacks to psql options and &amp;#39;select sql&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">### which is more dbaer professioner :)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">for&lt;/span> DB in &lt;span class="k">$(&lt;/span>psql -AqXtc &lt;span class="s1">&amp;#39;SELECT datname FROM pg_database WHERE datistemplate = false;&amp;#39;&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34; [`date`] Maintaining &lt;/span>&lt;span class="nv">$DB&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">PREFIX&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$BACKDIR&lt;/span>&lt;span class="s2">/&lt;/span>&lt;span class="nv">$DB&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># NO need to do `vacuum` on slaves&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># do `vacunm` on master instead&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># echo &amp;#39;VACUUM&amp;#39; | psql -U postgres -hlocalhost -d $DB&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">DUMP&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$PREFIX&lt;/span>&lt;span class="s2">.`date &amp;#39;+%Y%m%d&amp;#39;`.sql.gz&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># no need for -U postgres option&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pg_dump -p &lt;span class="nv">$port&lt;/span> &lt;span class="nv">$DB&lt;/span> &lt;span class="p">|&lt;/span> gzip -c &amp;gt; &lt;span class="nv">$DUMP&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">PREV&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$PREFIX&lt;/span>&lt;span class="s2">.`date -d&amp;#39;1 day ago&amp;#39; &amp;#39;+%Y%m%d&amp;#39;`.sql.gz&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># md5sum -b $DUMP &amp;gt; $DUMP.md5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">md5&lt;/span>&lt;span class="o">=(&lt;/span>&lt;span class="k">$(&lt;/span>md5sum -b &lt;span class="nv">$DUMP&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$md5&lt;/span> &amp;gt; &lt;span class="nv">$DUMP&lt;/span>.md5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="o">[&lt;/span> -f &lt;span class="nv">$PREV&lt;/span>.md5 &lt;span class="o">]&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> diff &lt;span class="nv">$PREV&lt;/span>.md5 &lt;span class="nv">$DUMP&lt;/span>.md5&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rm -f &lt;span class="nv">$PREV&lt;/span> &lt;span class="nv">$PREV&lt;/span>.md5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">fi&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">## delete too old backup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nv">TOOOLD&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$PREFIX&lt;/span>&lt;span class="s2">.`date -d&amp;#39;15 day ago&amp;#39; &amp;#39;+%Y%m%d&amp;#39;`.sql.gz&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="o">[&lt;/span> -f &lt;span class="nv">$TOOOLD&lt;/span> &lt;span class="o">]&lt;/span> &lt;span class="o">||&lt;/span> rm -f &lt;span class="nv">$TOOOLD&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;[`date`] Maintain pg on port &lt;/span>&lt;span class="nv">$port&lt;/span>&lt;span class="s2"> finished&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">done&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a class="link" href="https://luxagraf.net/src/automatic-offsite-postgresql-backups" target="_blank" rel="noopener"
>å‚è€ƒï¼šAutomatic Offsite PostgreSQL Backups Without a Password&lt;/a>&lt;/p>
&lt;p>&lt;a class="link" href="https://stackoverflow.com/a/5773761" target="_blank" rel="noopener"
>å‚è€ƒï¼šOnly get hash value using md5sum (without filename) &lt;/a>&lt;/p>
&lt;h3 id="å®šæ—¶">å®šæ—¶&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">chmod +x pg_backup.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">crontab -e
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># 16 2 * * * /var/lib/pgsql/pg_backup.sh &amp;gt;&amp;gt; /var/log/psql_corn_bak.log&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># */3 * * * * /var/lib/pgsql/pg_backup.sh &amp;gt;&amp;gt; /var/log/psql_corn_bak.log 2&amp;gt;&amp;amp;1 ## every 3 minutes&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="psql">psql&lt;/h2>
&lt;p>ä¸€èˆ¬æƒ…å†µä¸‹&lt;code>psql&lt;/code>çš„å·¥ä½œæ¨¡å¼æ˜¯å’Œäººçš„ç›¸äº’äº¤äº’æ¨¡å¼(interpreter)ï¼Œåœ¨shellè„šæœ¬é‡Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„options &lt;code> -AqXt -c&lt;/code>
ä¼šæ›´å®ç”¨å†™&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">-A: The output is not aligned&lt;span class="p">;&lt;/span> by default, the output is aligned.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-q &lt;span class="o">(&lt;/span>quiet&lt;span class="o">)&lt;/span>: This option forces psql not to write a welcome message or any other
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">informational output.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-t: This option tells psql to write the tuples only, without any header
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">information.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-X: This option informs psql to ignore the psql configuration that is stored in
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">~/.psqlrc file.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-o: This option specifies psql to output the query result to a certain location.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-F: This option determines the field separator between columns. This option can
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">be used to generate CSV, which is useful to import data to Excel files.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">PGOPTIONS: psql can use PGOPTIONS to add command-line options to send to the
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server at runtime. This can be used to control statement behavior such as to
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">allow index scan only or to specify the statement timeout.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="demo">demo&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="nv">connection_number&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>&lt;span class="nv">PGOPTIONS&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;--statement_timeout=0&amp;#39;&lt;/span> psql -AqXt -c&lt;span class="s2">&amp;#34;SELECT count(*) FROM pg_stat_activity&amp;#34;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># The result of the command psql -AqXt â€“d postgres -c &amp;#34;SELECT count(*) FROM pg_stat_activity&amp;#34; is assigned to a bash variable. &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#The options -AqXt, as discussed previously, cause psql to return only the result without any decoration, as follows:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql -AqXt -c &lt;span class="s2">&amp;#34;SELECT count(*) FROM pg_stat_activity&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ä¸¤ä¸ªå¥´éš¶</title><link>https://tab.deoops.com/posts/postgre-two-slaves/</link><pubDate>Mon, 05 Feb 2018 21:55:41 +0800</pubDate><guid>https://tab.deoops.com/posts/postgre-two-slaves/</guid><description>&lt;img src="https://tab.deoops.com/posts/postgre-two-slaves/postgres-replication.jpeg" alt="Featured image of post ä¸¤ä¸ªå¥´éš¶" />&lt;p>ä¸€èˆ¬postgresé«˜å¯ç”¨é›†ç¾¤æ˜¯ä¸€ä¸ªmasteré…ä¸€ä¸ªslaveï¼Œä½†æ˜¯å¼€å‘è¿™è¾¹éœ€è¦åšdbçš„è¯»å†™åˆ†ç¦»ï¼Œæ‰€ä»¥è¿ç»´è¿™è¾¹
åˆæ·»åŠ äº†ä¸€å°slaveä¸“é—¨æš´éœ²å‡ºæ¥åšè¯»æ“ä½œã€‚åŸæ¥çš„slaveè¿˜æ˜¯åªåšå¤‡ä»½ã€‚&lt;/p>
&lt;h2 id="ha">HA&lt;/h2>
&lt;p>ä¸€ä¸»ä¸€ä»é«˜å¯ç”¨çš„é…ç½®å¯ä»¥å‚è€ƒä¸‹é¢è¿™ç¯‡æ–‡ç« 
&lt;a class="link" href="https://altecnotes.wordpress.com/2017/03/24/streaming-replication-with-postgresql/" target="_blank" rel="noopener"
>postgres streaming replication&lt;/a>ï¼Œæœ‰æ—¶é—´çš„è¯æˆ‘å¯èƒ½ä¼šæ¬è¿ä¸€ä¸‹ :)&lt;/p>
&lt;h2 id="å®‰è£…é…ç½®">å®‰è£…é…ç½®&lt;/h2>
&lt;p>å› ä¸ºpgæ•°æ®åº“é›†ç¾¤å·²ç»é…ç½®å¥½äº†ä¸€ä¸»ä¸€ä»ï¼Œæ‰€ä»¥åœ¨masterä¸»æœºä¸Š&lt;strong>ä¸éœ€è¦&lt;/strong>é…ç½®&lt;code>pg_hba.conf&lt;/code>,
æˆ–è€…&lt;code>CREATE ROLE&lt;/code>ç­‰ç­‰ã€‚&lt;/p>
&lt;p>æ·»åŠ ç¬¬äºŒä¸ª&lt;code>slave&lt;/code>éœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p>
&lt;ol>
&lt;li>ç­‰å¾…pg_basebackup&lt;code>replicas stream&lt;/code>æ•°æ®åŒæ­¥å®Œæˆåï¼Œå†å¯åŠ¨ &lt;code>postgresql-9.6 service&lt;/code>;&lt;/li>
&lt;li>ä¿®æ”¹&lt;code>PG_DATA_DIR&lt;/code>ç›®å½•çš„æƒé™;&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rm /etc/yum.repos.d/pgdg-96-redhat.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install https://download.postgresql.org/pub/repos/yum/9.6/redhat/rhel-7-x86_64/pgdg-centos96-9.6-3.noarch.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install -y postgresql96
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install -y postgresql96-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install -y postgresql96-contrib
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /usr/lib/systemd/system/postgresql-9.6.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mkdir /data/pg9.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown postgres:postgres /data/pg9.6/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /data/pg9.6/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pg_basebackup --help
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## you can add option --checkpoint=fast for an instance backup&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## qhich is not recommend&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pg_basebackup -X stream -D /data/pg9.6/ -P -R -h 10.3.3.3 -U replicator
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls /data/pg9.6/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /data/pg9.6/recovery.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /data/pg9.6/postgresql.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start postgresql-9.6.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /data/pg9.6/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown -R postgres:postgres /data/pg9.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">700&lt;/span> /data/pg9.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start postgresql-9.6.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp &lt;span class="p">|&lt;/span> grep &lt;span class="m">5432&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> postgresql-9.6.service
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="check">check&lt;/h3>
&lt;p>åœ¨masterä¸»æœºä¸ŠæŸ¥çœ‹&lt;code>pg_stat_replication&lt;/code>è¡¨æ•°æ®ï¼ŒéªŒè¯ç¬¬äºŒä¸ªslaveæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># on MASTER machine&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>dba_lol@pg_master ~&lt;span class="o">]&lt;/span>$ sudo su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ä¸Šä¸€æ¬¡ç™»å½•ï¼šäº” 2æœˆ &lt;span class="m">23&lt;/span> 17:12:02 HKT 2018pts/1 ä¸Š
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">-bash-4.2$ psql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql &lt;span class="o">(&lt;/span>9.6.6&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Type &lt;span class="s2">&amp;#34;help&amp;#34;&lt;/span> &lt;span class="k">for&lt;/span> help.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">postgres&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="c1"># select * from pg_stat_replication;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pid &lt;span class="p">|&lt;/span> usesysid &lt;span class="p">|&lt;/span> usename &lt;span class="p">|&lt;/span> application_name &lt;span class="p">|&lt;/span> client_addr &lt;span class="p">|&lt;/span> client_hostname &lt;span class="p">|&lt;/span> client_port &lt;span class="p">|&lt;/span> backend_start &lt;span class="p">|&lt;/span> backend_xmin &lt;span class="p">|&lt;/span> state &lt;span class="p">|&lt;/span> sent_location &lt;span class="p">|&lt;/span> write_location &lt;span class="p">|&lt;/span> flush_location &lt;span class="p">|&lt;/span> replay_location &lt;span class="p">|&lt;/span> sync_priorit
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">y &lt;span class="p">|&lt;/span> sync_state
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">------+----------+---------+------------------+-------------+-----------------+-------------+-------------------------------+--------------+-----------+---------------+----------------+----------------+-----------------+-------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">--+------------
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">6720&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="m">19367&lt;/span> &lt;span class="p">|&lt;/span> replicator &lt;span class="p">|&lt;/span> walreceiver &lt;span class="p">|&lt;/span> 10.2.2.2 &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="m">49308&lt;/span> &lt;span class="p">|&lt;/span> 2018-01-24 18:20:47.114058+08 &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> streaming &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD20 &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> &lt;span class="p">|&lt;/span> async
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="m">446&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="m">19367&lt;/span> &lt;span class="p">|&lt;/span> replicator &lt;span class="p">|&lt;/span> walreceiver &lt;span class="p">|&lt;/span> 10.2.2.4 &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="m">54836&lt;/span> &lt;span class="p">|&lt;/span> 2018-02-21 13:21:39.420745+08 &lt;span class="p">|&lt;/span> &lt;span class="p">|&lt;/span> streaming &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD60 &lt;span class="p">|&lt;/span> 82/6B07DD20 &lt;span class="p">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> &lt;span class="p">|&lt;/span> async
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">(&lt;/span>&lt;span class="m">2&lt;/span> rows&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">postgres&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="c1"># &lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ps">PS&lt;/h2>
&lt;h3 id="add-slave-to-slave">add slave to slave&lt;/h3>
&lt;p>ç¼–è¾‘&lt;code>recover.conf&lt;/code> æ–‡ä»¶ çš„ &lt;code>primary_conninfo&lt;/code>åœ°å€ä¿¡æ¯å¯ä»¥å®ç°&lt;code>slave&lt;/code> -&amp;gt; &lt;code>slave&lt;/code>çš„æ•°æ®åŒæ­¥ã€‚&lt;/p></description></item><item><title>orangeç½‘å…³</title><link>https://tab.deoops.com/posts/try-orange/</link><pubDate>Mon, 05 Feb 2018 19:37:23 +0800</pubDate><guid>https://tab.deoops.com/posts/try-orange/</guid><description>&lt;img src="https://tab.deoops.com/posts/try-orange/orange.png" alt="Featured image of post orangeç½‘å…³" />&lt;p>å‡ å¤©ä¹‹å‰è¯•ç”¨è¿‡äº†&lt;a class="link" href="https://tab.deoops.com/posts/try-kong" >kong&lt;/a>æ•ˆæœä¸ç†æƒ³ ï¼Œä»Šå¤©æ¥ä½¿ç”¨ä¸‹å°ç±³å‡ºå“ï¼ˆå­˜ç–‘ï¼Ÿï¼‰çš„ &lt;a class="link" href="https://github.com/sumory/orange" target="_blank" rel="noopener"
>orange&lt;/a>ç½‘å…³ã€‚&lt;/p>
&lt;p>ä¸€ä¸ªæ˜æ˜¾çš„åŒºåˆ«æ˜¯ kongçš„åç«¯å­˜å‚¨ä½¿ç”¨äº†postgresqlï¼Œorangeä½¿ç”¨çš„æ˜¯mysqlã€‚&lt;/p>
&lt;p>å¥½äº†ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œè´´å‡ºå®‰è£…éƒ¨ç½²çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p>
&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;h3 id="mysql">mysql&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>wget http://repo.mysql.com/mysql-community-release-el7-5.noarch.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo rpm -ivh mysql-community-release-el7-5.noarch.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install mysql-server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> mysqld
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mysql_secure_installation
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi save_your_root_pwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/sumory/orange.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> orange/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> install/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">head orange-v0.6.4.sql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">head -n &lt;span class="m">100&lt;/span> orange-v0.6.4.sql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">head -n &lt;span class="m">50&lt;/span> orange-v0.6.4.sql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql -V
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql -u root -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> orange/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> install/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql -u o_usr -p o_database &amp;lt; orange-v0.6.4.sql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mysql -u o_usr -p o_database
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="orange">orange&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>yum remove kong-community-edition &lt;span class="c1">## get rid of annoying lua 5.1 version conflict&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /data/nginx/conf/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp api.conf api.conf.bak.18.03.09 &lt;span class="c1">## always backup conf files : )&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nginx -s stop
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp &lt;span class="p">|&lt;/span> grep &lt;span class="m">443&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> mv /usr/sbin/nginx /usr/sbin/nginx_old
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> yum install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum-config-manager --add-repo https://openresty.org/package/centos/openresty.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> yum install openresty openresty-resty -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/sumory/orange.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">git clone https://github.com/sumory/lor.git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv lor ~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv orange ~
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> lor/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ../orange/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">make install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /usr/local/bin/orange /bin/orange
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ln -s /usr/local/openresty/nginx/sbin/nginx /bin/nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv /home/deoops/orange.conf /home/deoops/nginx.conf /usr/local/orange/conf/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /usr/local/orange/conf/orange.conf &lt;span class="c1">## make sure orange.conf has the right mysql server info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /data/nginx/conf/api.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chown root:root /usr/local/orange/conf/*.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">orange start
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp &lt;span class="p">|&lt;/span> grep &lt;span class="m">443&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å°ç»“">å°ç»“&lt;/h2>
&lt;p>ç”¨äº†å‡ å¤©ï¼Œæ„Ÿè§‰UIæ¯”èµ·kongæ¥è¯´ç®€å•äº›ï¼Œå¼€ç®±å³ç”¨çš„åŠŸèƒ½æ¯”kongä¹Ÿå¤šä¸€äº›ã€‚
ç¨³å®šæ€§è¿˜æœ‰å¾…è¿›ä¸€æ­¥çš„è§‚å¯Ÿã€‚&lt;/p></description></item><item><title>kongç½‘å…³</title><link>https://tab.deoops.com/posts/try-kong/</link><pubDate>Sat, 03 Feb 2018 18:05:04 +0800</pubDate><guid>https://tab.deoops.com/posts/try-kong/</guid><description>&lt;img src="https://tab.deoops.com/posts/try-kong/kong.png" alt="Featured image of post kongç½‘å…³" />&lt;p>updated: kongä¸æ»¡è¶³è¦æ±‚ï¼Œåé¢è°ƒç ”äº†å¦å¤–ä¸€ä¸ªAPIäº§å“ &lt;a class="link" href="https://tab.deoops.com/posts/try-orange" >orange&lt;/a>&lt;/p>
&lt;p>2015å¹´æ¥è§¦openrestyçš„æ—¶å€™æ¥è§¦è¿‡kongï¼Œäº†è§£åˆ°kongæ˜¯åŸºäºopenrestyäºŒæ¬¡å¼€å‘çš„å•†ä¸šäº§å“ï¼Œ&lt;/p>
&lt;p>æ­£å¥½ç›®å‰æ–°å…¬å¸è¦è°ƒç ”ç¨³å®šå¥½ç”¨çš„&lt;code>API Gateway&lt;/code>äº§å“ï¼Œæ‰€ä»¥æœ¬æ–‡ç®€å•è®°å½•ä¸‹æˆ‘å¯¹kongçš„å®‰è£…é…ç½®æ„Ÿå—ã€‚&lt;/p>
&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">yum install https://bintray.com/kong/kong-community-edition-rpm/download_file?file_path&lt;span class="o">=&lt;/span>centos/7/kong-community-edition-0.12.1.el7.noarch.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl stop nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp&lt;span class="p">|&lt;/span>grep &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/kong/kong.conf.default
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vipw
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">create user kong&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">create database kong ownner kong&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">create database kong owner kong&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /etc/kong/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp kong.conf.default kong.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi kong.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong migrations up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql -U kong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">tail /media/data/pgdata/log/postgresql-Wed.log
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /media/data/pgdata/pg_hba.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart postgresql-10.service
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong migrations up
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong check
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong start
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp &lt;span class="p">|&lt;/span> grep &lt;span class="m">80&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">which nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl localhost:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /usr/local/kong/nginx-kong.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">which -a nginx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong restart --nginx-conf /etc/nginx/nginx.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.tmpl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/nginx/nginx.conf.tmpl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">kong restart --nginx-conf /etc/nginx/nginx.conf.tmpl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">which -a npm
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å®‰è£…æ§åˆ¶å°">å®‰è£…æ§åˆ¶å°&lt;/h3>
&lt;p>ä½¿ç”¨&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">which -a docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum remove docker docker-common docker-selinux docker-engine
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install -y yum-utils device-mapper-persistent-data lvm2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install docker-ce
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker run hello-world
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -sSL https://get.daocloud.io/daotools/set_mirror.sh &lt;span class="p">|&lt;/span> sh -s http://2b77623e.m.daocloud.io
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl &lt;span class="nb">enable&lt;/span> docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker run -d --rm -p 8080:8080 pgbi/kong-dashboard start --kong-url http://10.0.0.1:8001 --basic-auth &lt;span class="nv">usrtest&lt;/span>&lt;span class="o">=&lt;/span>pwdtest
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">docker ps -a
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">### registe the very first api through kong admin api&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -i -X POST --url http://10.0.0.11:8001/apis --data &lt;span class="s1">&amp;#39;name=admin-api&amp;#39;&lt;/span> --data &lt;span class="s1">&amp;#39;hosts=a.k.deoops.com&amp;#39;&lt;/span> --data &lt;span class="s1">&amp;#39;upstream_url=http://localhost:8080&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å°ç»“">å°ç»“&lt;/h2>
&lt;p>å¼€æºKong çš„é™åˆ¶æ¯”è¾ƒå¤šï¼Œ&lt;a class="link" href="https://tab.deoops.com/posts/nginx-proxy/" >åå‘ä»£ç†&lt;/a>é…ç½®åŸºæœ¬ä¸Šé æ’ä»¶ï¼Œå¯¹ç°å­˜çš„nginxçš„confå…¼å®¹æ€§ä¸å‹å¥½ã€‚
ç®€å•çš„&lt;code>proxy_cache&lt;/code>é…ç½®ä¸€å®šè¦ä¼ä¸šç‰ˆæ‰æ”¯æŒï¼Œä¸‹é¢çš„æ›´åŠ &lt;code>ç²¾ç»†&lt;/code>é…ç½®ä¹Ÿæ²¡æœ‰æ”¯æŒï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl"> &lt;span class="k">valid_referers&lt;/span> &lt;span class="s">*.deoops.cn&lt;/span> &lt;span class="s">deoops.cn&lt;/span> &lt;span class="s">*.deoops.com&lt;/span> &lt;span class="s">deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">add_header&lt;/span> &lt;span class="s">&amp;#39;Access-Control-Allow-Headers&amp;#39;&lt;/span> &lt;span class="s">&amp;#39;os,&lt;/span> &lt;span class="s">ver,&lt;/span> &lt;span class="s">hwid,&lt;/span> &lt;span class="s">innerver,&lt;/span> &lt;span class="s">channel,&lt;/span> &lt;span class="s">net,&lt;/span> &lt;span class="s">token,&lt;/span> &lt;span class="s">et&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">proxy_cache&lt;/span> &lt;span class="s">my_cache&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">proxy_cache_valid&lt;/span> &lt;span class="mi">200&lt;/span> &lt;span class="mi">302&lt;/span> &lt;span class="mi">304&lt;/span> &lt;span class="s">10s&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">proxy_ignore_headers&lt;/span> &lt;span class="s">Expires&lt;/span> &lt;span class="s">Cache-Control&lt;/span> &lt;span class="s">Set-Cookie&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">proxy_cache_key&lt;/span> &lt;span class="nv">$host$request_uri$is_args$args$http_token&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="s">(&lt;/span>&lt;span class="nv">$request_uri&lt;/span> &lt;span class="p">~&lt;/span> &lt;span class="sr">img_vercode&lt;/span> &lt;span class="s">)&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">set&lt;/span> &lt;span class="nv">$no_proxy_cache&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="s">(&lt;/span>&lt;span class="nv">$remote_addr&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="mi">114&lt;/span>&lt;span class="s">.13.118.24)&lt;/span>&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">set&lt;/span> &lt;span class="nv">$no_proxy_cache&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>initä¼˜å…ˆçº§</title><link>https://tab.deoops.com/posts/golang-init/</link><pubDate>Tue, 23 Jan 2018 16:23:01 +0800</pubDate><guid>https://tab.deoops.com/posts/golang-init/</guid><description>&lt;img src="https://tab.deoops.com/posts/golang-init/init.png" alt="Featured image of post initä¼˜å…ˆçº§" />&lt;p>å‡è®¾ä¸€ä¸ªgolangé¡¹ç›®çš„ä¸‰ä¸ªæºæ–‡ä»¶&lt;code>a.go&lt;/code>,&lt;code>b.go&lt;/code>, &lt;code>c.go&lt;/code>ï¼Œéƒ½å®šä¹‰äº†&lt;code>function inint(){}&lt;/code>å‡½æ•°ï¼Œ&lt;/p>
&lt;p>å…¶ä¸­&lt;code>c.go&lt;/code>æ–‡ä»¶åˆå§‹åŒ–äº†ä¸€ä¸ªå…¨å±€å˜é‡&lt;code>globalVar&lt;/code>ï¼ŒåŒæ—¶&lt;code>a.go&lt;/code> æˆ–è€…&lt;code>b.go&lt;/code>çš„&lt;code>init func&lt;/code> å¼•ç”¨äº†è¿™ä¸ªå…¨å±€å˜é‡&lt;code>globalVar&lt;/code>ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨&lt;code>a.go&lt;/code>å’Œ &lt;code>b.go&lt;/code>çš„init funcä¸­ &lt;code>globalVar&lt;/code>çš„å¼•ç”¨æ˜¯ç©ºå€¼ã€‚&lt;/p>
&lt;h2 id="ç¤ºä¾‹">ç¤ºä¾‹&lt;/h2>
&lt;h3 id="æ–‡ä»¶ç»“æ„">æ–‡ä»¶ç»“æ„&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ tree
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ a.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ b.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ c.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â”œâ”€â”€ go.mod
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â””â”€â”€ main.go
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="m">0&lt;/span> directories, &lt;span class="m">5&lt;/span> files
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æºä»£ç ">æºä»£ç &lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// file `a.go`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// globalVar is empty
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;globalVar in a.go:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">globalVar&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// file `b.go`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// globalVar is empty
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;globalVar in b.go:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">globalVar&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// file `c.go`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;time&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">globalVar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">initVar&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;globalVar in c.go:&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">globalVar&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">initVar&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">20&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Millisecond&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="s">&amp;#34;late is better than never&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// file `main.go`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">globalVar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;vim-go&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="result">result&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ go build -o demo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">â¯ ./demo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">globalVar in a.go:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">globalVar in b.go:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">globalVar in c.go: late is better than never
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vim-go
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•&lt;/h2>
&lt;p>ç®€å•çš„è§£å†³åŠæ³•å¯ä»¥æ˜¯é‡å‘½å&lt;code>c.go&lt;/code>ä¸º&lt;code>0a.go&lt;/code>ä¿è¯&lt;code>0a.go&lt;/code>ä¸­çš„&lt;code>init&lt;/code>æœ€æ—©æ‰§è¡Œå®Œæˆï¼Œ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mv c.go 01.go
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªè§£å†³æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯å¯ä»¥ä¸ç”¨ä¿®æ”¹ä»£ç ï¼Œä½†æ˜¯ä¸å¤Ÿä¼˜é›…ã€‚&lt;/p>
&lt;p>æ¯”è¾ƒå¥½çš„è§£å†³æ–¹å¼åº”è¯¥æ˜¯ï¼Œä¸è¦åœ¨&lt;code>init func&lt;/code>é‡Œåˆå§‹åŒ–å…¨å±€å˜é‡ï¼Œåº”è¯¥ç›´æ¥åœ¨&lt;code>top block context&lt;/code>ä¸­å¯¹å…¨å±€å˜é‡åˆå§‹åŒ–ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-golang" data-lang="golang">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">// file `c.go`
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">var&lt;/span> &lt;span class="nx">globalVar&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">initVar&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="kd">func&lt;/span> &lt;span class="nf">init&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>è¯•ç”¨Azure Centosè™šæ‹Ÿæœº</title><link>https://tab.deoops.com/posts/azure-centos/</link><pubDate>Wed, 15 Nov 2017 10:48:20 +0800</pubDate><guid>https://tab.deoops.com/posts/azure-centos/</guid><description>&lt;img src="https://tab.deoops.com/posts/azure-centos/Azure.png" alt="Featured image of post è¯•ç”¨Azure Centosè™šæ‹Ÿæœº" />&lt;p>æ¢äº†ä»½å·¥ä½œï¼Œæ–°å…¬å¸æ˜¯åšåŠ å¯†å¸äº¤æ˜“æ‰€çš„ï¼ŒæœåŠ¡å™¨éƒ½åœ¨å›½å¤–ã€‚æ‰€ä»¥æœ‰æœºä¼šæ¥è§¦åˆ°äº†å¾®è½¯çš„azureäº‘æœåŠ¡ï¼Œ
æœåŠ¡å™¨åŸºæœ¬éƒ½åœ¨äºšå¤ªåŒºæ–°åŠ å¡ã€‚&lt;/p>
&lt;p>psï¼šè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å®æ“å•å°é…ç½®32c64gçš„è™šæ‹Ÿæœºï¼Œçºªå¿µä¸€ä¸‹ã€‚ä»¥å‰å·¥ä½œä¸­æœ€å¤šå°±8c16gï¼Œæ•°é‡çš„è¯ä¸¤ä¸‰ç™¾å°æœºå™¨ã€‚&lt;/p>
&lt;h2 id="history">history&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">uname -a &lt;span class="c1"># kernel info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /etc/redhat-release
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">df -alh &lt;span class="c1"># query disk info&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ifconfig
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ping 10.0.0.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh 10.0.0.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls .ssh/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv azagent .ssh/id_rsa
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh .ssh/id_rsa
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh 10.0.0.6
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ping jd.com
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sudo yum install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum -y upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum -y upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum -y update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum-config-manager --add-repo https://openresty.org/package/centos/openresty.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install openresty &lt;span class="c1"># install web server&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vi /etc/ssh/sshd_config
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl status sshd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl restart sshd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl restart sshd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install ansible
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install ansible
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl status openresty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> openresty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start openresty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -I localhost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">uptime
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">date
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo install git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install git
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">locate openresty
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpm -qc openresty &lt;span class="c1"># query configuration file&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">wget https://copr.fedorainfracloud.org/coprs/dheche/prometheus/repo/epel-7/dheche-prometheus-epel-7.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">head dheche-prometheus-epel-7.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">suod mv dheche-prometheus-epel-7.repo /etc/yum.repos.d/prometheus.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo mv dheche-prometheus-epel-7.repo /etc/yum.repos.d/prometheus.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install prometheus-node
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vi /etc/yum.repos.d/prometheus.repo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install prometheus2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install node_exporter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install alertmanager
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">vi /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vi /etc/hosts
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh ten
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo vi /etc/yum.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls /var/cache/yum/x86_64/7/prometheus/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls /var/cache/yum/x86_64/7/prometheus/packages/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /var/cache/yum/x86_64/7/prometheus/packages/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yum install yum-utils
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">history&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yumdownloader prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yumdownloader prometheus2 &lt;span class="c1"># download installed rmp packages&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yumdownloader node_exporter.x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo yumdownloader alertmanager.x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">scp node_exporter-0.15.2-1.el7.centos.x86_64.rpm ten:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh ten
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh ten &lt;span class="s1">&amp;#39;sudo systemctl enable node_exporter&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh ten &lt;span class="s1">&amp;#39;sudo systemctl start node_exporter&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start node_exporter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> node_exporter
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> alertmanger
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> alertmanager
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start alertmanager
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">netstat -nlp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -i &lt;span class="c1"># su to root&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">pwd&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rm prometheus-1.8.2-1.el7.centos.x86_64.rpm
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl &lt;span class="nb">enable&lt;/span> prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo systemctl start prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat/etc/passwd
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rpm -qc prometheus2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /etc/default/prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">id prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat /etc/default/prometheus
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ls -alh /etc/prometheus/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo -i
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ€»çš„è¯´æ¥æ•²äº†100æ¥æ¡æŒ‡ä»¤ï¼Œæ¯”è¾ƒé‡è¦çš„æ˜¯ä¸‹é¢ä¸‰æ¡æŒ‡ä»¤ï¼š&lt;/p>
&lt;ol>
&lt;li>&lt;code>sudo -i&lt;/code>åˆ‡æ¢ä¸ºrootç”¨æˆ·ï¼›&lt;/li>
&lt;li>&lt;code>yumdownloader &lt;/code>ä¿å­˜é€šè¿‡yumå®‰è£…çš„rpmåŒ… (é…åˆ&lt;code>yum -C install &lt;/code>å’Œ&lt;code>SCP&lt;/code>å¯ä»¥åŠ å¿«LANä¸‹æ‰€æœ‰ä¸»æœºçš„å®‰è£…é€Ÿåº¦)ï¼›&lt;/li>
&lt;li>&lt;code>rpm -qc &lt;/code>æŸ¥è¯¢å®‰è£…åŒ…é…ç½®ä¿¡æ¯;&lt;/li>
&lt;/ol>
&lt;h2 id="timeout">timeout&lt;/h2>
&lt;p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒAzure çš„Linuxä¸»æœºçš„&lt;code>sshd&lt;/code> æœåŠ¡ä¼šæŠŠé—²ç€è¶…è¿‡1åˆ†é’Ÿçš„å®¢æˆ·ç«¯è¸¢ä¸‹çº¿&lt;code>ssh session timeout&lt;/code>ã€‚
ä¿®æ”¹æœ¬åœ°&lt;code>ssh&lt;/code> å®¢æˆ·ç«¯è¿æ¥é…ç½®æ·»åŠ &lt;code>ServerAliveInterval&lt;/code>ç­‰é…ç½®é¡¹å°±å¯ä»¥è§„é¿ä¸Šé¢è¯´çš„timeouté™åˆ¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#### .ssh/config snippet&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">HOST singapore2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> HostName 40.50.60.70
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> IdentityFile ~/.ssh/az
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServerAliveInterval &lt;span class="m">120&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ServerAliveCountMax &lt;span class="m">30&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ConnectTimeout &lt;span class="m">30&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>æŸ¥æ‰¾æ–‡ä»¶</title><link>https://tab.deoops.com/posts/find-locate/</link><pubDate>Sat, 16 Sep 2017 08:09:57 +0800</pubDate><guid>https://tab.deoops.com/posts/find-locate/</guid><description>&lt;img src="https://tab.deoops.com/posts/find-locate/fzf-command.png" alt="Featured image of post æŸ¥æ‰¾æ–‡ä»¶" />&lt;h2 id="tldr">TLDR;&lt;/h2>
&lt;ol>
&lt;li>&lt;code>find&lt;/code>: æœ‰å¾ˆå¤šè¿‡æ»¤è§„åˆ™æŸ¥æ‰¾æ–‡ä»¶/ç›®å½•/è®¾å¤‡ï¼Œè€Œä¸”å¯ä»¥é€’å½’æŸ¥è¯¢æŸä¸€ä¸ªç›®å½•ä¸‹çš„ç›®å½•æˆ–æ–‡ä»¶ï¼Œæœ€åé™¤äº†æ‰“å°æŸ¥è¯¢ç»“æœä»¥å¤–ï¼Œè¿˜å¯ä»¥åšå…¶å®ƒæ“ä½œï¼ˆæ¯”å¦‚åˆ é™¤è¯¥æ–‡ä»¶ï¼‰ï¼›&lt;/li>
&lt;li>&lt;code>locate&lt;/code>: åˆ™ç®€å•å¾ˆå¤šï¼Œæ ¹æ®å…³é”®å­— åœ¨ç¼“å­˜indexä¸­ æ£€ç´¢å‡ºå«æœ‰è¯¥å…³é”®å­—çš„æ–‡ä»¶æˆ–è€…ç›®å½•ï¼›&lt;/li>
&lt;li>&lt;code>fzf&lt;/code>: å®æ—¶æ¨¡ç³ŠæŸ¥è¯¢ï¼Œå¯ä»¥é›†æˆåˆ°å¸¸ç”¨çš„IDEä¸­ï¼ˆæ¯”å¦‚&lt;code>fzf.vim&lt;/code>)ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="demo">demo&lt;/h2>
&lt;h3 id="find">find&lt;/h3>
&lt;p>The syntax of the Find command is:&lt;/p>
&lt;p>&lt;code>find [-H] [-L] [-P] [-D debugopts] [-Olevel] [starting-point...] [expression]&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>find . -name &lt;span class="s2">&amp;#34;*tar*gz&amp;#34;&lt;/span> -delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find . -name &lt;span class="s2">&amp;#34;*tar*xz&amp;#34;&lt;/span> -delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find . -name &lt;span class="s2">&amp;#34;*tar.xz&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">du -sh .
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find . -name &lt;span class="s2">&amp;#34;*zip*&amp;#34;&lt;/span> -delete
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">find . -type f &lt;span class="p">|&lt;/span> perl -lne &lt;span class="s1">&amp;#39;print if -B&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs rm -f &lt;span class="c1"># delete all binary files under . recursivly&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="locate">locate&lt;/h3>
&lt;p>The syntax of the Locate command is:&lt;/p>
&lt;p>&lt;code>locate [OPTION]... PATTERN..&lt;/code>&lt;/p>
&lt;p>æŸ¥è¯¢&lt;code>postgreql db&lt;/code>çš„é…ç½®æ–‡ä»¶ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>locate *hba_conf*
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># equal to this&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">su - postgres
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">psql
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">show config_file&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">show hba_file&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="fzf">fzf&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">tldr fzf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fzf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Command-line fuzzy finder.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Similar to sk.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">More information: https://github.com/junegunn/fzf.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Start fzf on all files in the specified directory:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> find path/to/directory -type f &lt;span class="p">|&lt;/span> fzf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Start fzf &lt;span class="k">for&lt;/span> running processes:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ps aux &lt;span class="p">|&lt;/span> fzf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Select multiple files with Shift + Tab and write to a file:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> find path/to/directory -type f &lt;span class="p">|&lt;/span> fzf --multi &amp;gt; filename
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Start fzf with a specified query:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fzf --query &lt;span class="s2">&amp;#34;query&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Start fzf on entries that start with core and end with either go, rb, or py:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fzf --query &lt;span class="s2">&amp;#34;^core go&lt;/span>$&lt;span class="s2"> | rb&lt;/span>$&lt;span class="s2"> | py&lt;/span>$&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">- Start fzf on entries that not match pyc and match exactly travis:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fzf --query &lt;span class="s2">&amp;#34;!pyc &amp;#39;travis&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">See also: sk
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 159;
flex-basis: 382px"
>
&lt;a href="https://tab.deoops.com/posts/find-locate/fzf.png" data-size="1418x890">
&lt;img src="https://tab.deoops.com/posts/find-locate/fzf.png"
width="1418"
height="890"
srcset="https://tab.deoops.com/posts/find-locate/fzf_hu582dc8c5511da3cda2a6630bb19f3b70_557722_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/find-locate/fzf_hu582dc8c5511da3cda2a6630bb19f3b70_557722_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="fzf search result">
&lt;/a>
&lt;figcaption>fzf search result&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>ä»£ç†å’Œåå‘ä»£ç†</title><link>https://tab.deoops.com/posts/nginx-proxy/</link><pubDate>Fri, 19 May 2017 10:30:05 +0800</pubDate><guid>https://tab.deoops.com/posts/nginx-proxy/</guid><description>&lt;img src="https://tab.deoops.com/posts/nginx-proxy/reverse-proxy-packet-flow.png" alt="Featured image of post ä»£ç†å’Œåå‘ä»£ç†" />&lt;h2 id="ä»£ç†">ä»£ç†&lt;/h2>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 166;
flex-basis: 399px"
>
&lt;a href="https://tab.deoops.com/posts/nginx-proxy/proxies.png" data-size="1323x794">
&lt;img src="https://tab.deoops.com/posts/nginx-proxy/proxies.png"
width="1323"
height="794"
srcset="https://tab.deoops.com/posts/nginx-proxy/proxies_hu3e3b7387a325d4f477d582dfaa11e0f9_514323_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/nginx-proxy/proxies_hu3e3b7387a325d4f477d582dfaa11e0f9_514323_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="proxies">
&lt;/a>
&lt;figcaption>proxies&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h3 id="æ­£å‘ä»£ç†">(æ­£å‘)ä»£ç†&lt;/h3>
&lt;p>ä»£ç†ä¸€èˆ¬æ˜¯æŒ‡æ­£å‘ä»£ç†ï¼Œæ¯”å¦‚ç¿»å¢™è½¯ä»¶&lt;code>shadowsocks&lt;/code>å°±æ˜¯ä¸€ç§æ­£å‘ä»£ç†ã€‚ shadowsocksé€šè¿‡&lt;code>socks 5&lt;/code>åè®®
åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šï¼Œ&lt;/p>
&lt;p>ä»£ç†æˆ‘ä»¬ï¼ˆclientï¼‰å»è®¿é—®è¢«å¢™çš„èµ„æºï¼ˆgoogle/twitter/Facebookç­‰æœåŠ¡å™¨ï¼‰ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 214;
flex-basis: 514px"
>
&lt;a href="https://tab.deoops.com/posts/nginx-proxy/proxy-server.png" data-size="1462x682">
&lt;img src="https://tab.deoops.com/posts/nginx-proxy/proxy-server.png"
width="1462"
height="682"
srcset="https://tab.deoops.com/posts/nginx-proxy/proxy-server_hu862ce645965adb3b4cc7718adef8e305_78870_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/nginx-proxy/proxy-server_hu862ce645965adb3b4cc7718adef8e305_78870_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="forward proxy server">
&lt;/a>
&lt;figcaption>forward proxy server&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;blockquote>
&lt;p>A proxy server, sometimes referred to as a forward proxy, is a server that routes traffic between client(s) and another system, usually external to the network. By doing so, it can regulate traffic according to preset policies, convert and mask client IP addresses, enforce security protocols, and block unknown traffic.&lt;/p>
&lt;/blockquote>
&lt;h3 id="åå‘ä»£ç†">åå‘ä»£ç†&lt;/h3>
&lt;p>åå‘ä»£ç†æ˜¯è¯´æˆ‘ä»¬ï¼ˆclientï¼‰è¢«ä»£ç†äº†ï¼Œ æˆ‘ä»¬è‡ªå·±è¿˜ä¸çŸ¥é“ã€‚
æˆ‘ä»¬ä»¥ä¸ºå’Œæˆ‘ä»¬æ‰“äº¤é“çš„ï¼ˆå¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼‰çš„æ˜¯nginx æœåŠ¡å™¨ï¼Œå…¶å®nginxçœŸæ­£å¤„ç†æˆ‘ä»¬è¯·æ±‚çš„æ˜¯ngixåé¢çš„&lt;code>upstream&lt;/code>åœ¨
å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚é€»è¾‘ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 242;
flex-basis: 581px"
>
&lt;a href="https://tab.deoops.com/posts/nginx-proxy/reverse-proxy.png" data-size="800x330">
&lt;img src="https://tab.deoops.com/posts/nginx-proxy/reverse-proxy.png"
width="800"
height="330"
srcset="https://tab.deoops.com/posts/nginx-proxy/reverse-proxy_hu8eb6024cc5014449d5925ea11f2cc90b_21131_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/nginx-proxy/reverse-proxy_hu8eb6024cc5014449d5925ea11f2cc90b_21131_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="reverse proxy server">
&lt;/a>
&lt;figcaption>reverse proxy server&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;blockquote>
&lt;p>A reverse proxy is a type of proxy server. Unlike a traditional proxy server, which is used to protect clients, a reverse proxy is used to protect servers. A reverse proxy is a server that accepts a request from a client, forwards the request to another one of many other servers, and returns the results from the server that actually processed the request to the client as if the proxy server had processed the request itself. The client only communicates directly with the reverse proxy server and it does not know that some other server actually processed its request.&lt;/p>
&lt;/blockquote>
&lt;h2 id="config">config&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### common set_header
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /opt/nginx/conf.d/common.proxy;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">proxy_hide_header&lt;/span> &lt;span class="s">Vary&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">Accept-Encoding&lt;/span> &lt;span class="s">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_ignore_headers&lt;/span> &lt;span class="s">Cache-Control&lt;/span> &lt;span class="s">Expires&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">Cookie&lt;/span> &lt;span class="nv">$http_cookie&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">Referer&lt;/span> &lt;span class="nv">$http_referer&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">X-Forwarded-Host&lt;/span> &lt;span class="nv">$host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">X-Forwarded-Server&lt;/span> &lt;span class="nv">$host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">X-Forwarded-For&lt;/span> &lt;span class="nv">$proxy_add_x_forwarded_for&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">Host&lt;/span> &lt;span class="nv">$http_host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">X-Real-IP&lt;/span> &lt;span class="nv">$remote_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># csrf
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>&lt;span class="k">proxy_set_header&lt;/span> &lt;span class="s">X-CSRF-TOKEN&lt;/span> &lt;span class="nv">$http_x_xsrf_token&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_buffer_size&lt;/span> &lt;span class="mi">128&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_buffers&lt;/span> &lt;span class="mi">16&lt;/span> &lt;span class="mi">64k&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_busy_buffers_size&lt;/span> &lt;span class="mi">128&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">proxy_temp_file_write_size&lt;/span> &lt;span class="mi">128&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="demo">demo&lt;/h2>
&lt;p>ä¸‹é¢çš„ä¸¤ä¸ªdemoéƒ½ä½¿ç”¨äº†&lt;code>include /opt/nginx/conf.d/common.proxy&lt;/code>æŒ‡ä»¤ï¼Œæ¥åŒ…å«ä¸Šé¢çš„proxyé…ç½®ã€‚&lt;/p>
&lt;h3 id="http">http&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### demo1-http
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">upstream&lt;/span> &lt;span class="s">upV1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9090&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9090&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">upstream&lt;/span> &lt;span class="s">upV2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">8080&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="s">default&lt;/span> &lt;span class="s">backlog=16384&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server_name&lt;/span> &lt;span class="s">api.deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">access_log&lt;/span> &lt;span class="s">/data/nginx/logs/grafana_access.log&lt;/span> &lt;span class="s">main&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">error_log&lt;/span> &lt;span class="s">/data/nginx/logs/grafanar_err.log&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">include&lt;/span> &lt;span class="s">/opt/nginx/conf.d/common.proxy&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="s">/v1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_redirect&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">http://upV1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="s">/v2&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_redirect&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">http://upV2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="https">https&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### demo2-https
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="mi">443&lt;/span> &lt;span class="s">default&lt;/span> &lt;span class="s">ssl&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server_name&lt;/span> &lt;span class="s">deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">root&lt;/span> &lt;span class="s">/usr/local/nginx/html&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">index&lt;/span> &lt;span class="s">index.html&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_ssl_session_reuse&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_session_cache&lt;/span> &lt;span class="s">shared:SSL:1m&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_session_timeout&lt;/span> &lt;span class="mi">10m&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_certificate&lt;/span> &lt;span class="s">/var/lib/teleport/deoops.com/cert.pem&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_certificate_key&lt;/span> &lt;span class="s">/var/lib/teleport/deoops.com/key.pem&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_verify_client&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_protocols&lt;/span> &lt;span class="s">SSLv3&lt;/span> &lt;span class="s">TLSv1&lt;/span> &lt;span class="s">TLSv1.1&lt;/span> &lt;span class="s">TLSv1.2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_ciphers&lt;/span> &lt;span class="s">RC4:HIGH:!aNULL:!MD5&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">ssl_prefer_server_ciphers&lt;/span> &lt;span class="no">on&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="s">/&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_redirect&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">Host&lt;/span> &lt;span class="nv">$http_host&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">X-Real-IP&lt;/span> &lt;span class="nv">$remote_addr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_set_header&lt;/span> &lt;span class="s">X-Forwared-For&lt;/span> &lt;span class="nv">$proxy_add_x_forwarded_for&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">https://localhost:33000&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>ç¼“å­˜é™æ€æ–‡ä»¶</title><link>https://tab.deoops.com/posts/nginx-cache/</link><pubDate>Sat, 29 Apr 2017 15:36:18 +0800</pubDate><guid>https://tab.deoops.com/posts/nginx-cache/</guid><description>&lt;img src="https://tab.deoops.com/posts/nginx-cache/tmpfs.png" alt="Featured image of post ç¼“å­˜é™æ€æ–‡ä»¶" />&lt;p>ä¼—æ‰€å‘¨çŸ¥nginxæœ‰å¾ˆå¼ºçš„åˆ†å‘é™æ€æ–‡ä»¶çš„èƒ½åŠ›ï¼Œå¾ˆå¤šæ—¶å€™nginxå¯¹é™æ€èµ„æºåˆ†å‘èƒ½åŠ›çš„ç“¶é¢ˆå’Œ&lt;code>redis&lt;/code>ä¸€æ ·åœ¨ä¸»æœºçš„ç½‘å¡ä¸Šã€‚&lt;/p>
&lt;p>(ä¸€èˆ¬è™šæ‹Ÿæœºçš„ç½‘å¡åªæœ‰500mbpsï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¸‡å…†çš„ç‰©ç†ç½‘å¡å°±å½“æˆ‘æ²¡è¯´ï¼‰&lt;/p>
&lt;p>å’Œrediså¯¹æ¯”ï¼Œnginxæœ‰å¦å¤–ä¸€ä¸ªç“¶é¢ˆåœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜IOä¸Šï¼ŒSSDç¡¬ç›˜æƒ…å†µä¼šå¥½ä¸€äº›ï¼Œ
æ‰€ä»¥å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šæŠŠ nginxçš„cache åšåœ¨ç³»ç»Ÿçš„ssdç¡¬ç›˜ä¸Šï¼Œ&lt;/p>
&lt;p>å…¶å®è¿˜å¯ä»¥ç›´æ¥æŠŠcacheæ”¾åˆ°å†…å­˜æ–‡ä»¶ç³»ç»Ÿé‡Œï¼Œè¿›ä¸€æ­¥æå‡ç£ç›˜ioååã€‚&lt;/p>
&lt;h2 id="tmpfs">tmpfs&lt;/h2>
&lt;p>&lt;a class="link" href="https://www.jamescoyle.net/knowledge/951-the-difference-between-a-tmpfs-and-ramfs-ram-disk" target="_blank" rel="noopener"
>differences between ramfs and tmpfs&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>mkdir /mnt/ramdisk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mount -t tmpfs -o &lt;span class="nv">size&lt;/span>&lt;span class="o">=&lt;/span>512m tmpfs /mnt/ramdisk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;tmpfs /mnt/ramdisk tmpfs nodev,nosuid,noexec,nodiratime,size=1024M 0 0&amp;#39;&lt;/span> &amp;gt;&amp;gt; /etc/fstab
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="nginx">nginx&lt;/h2>
&lt;h3 id="http-cache-config">http cache config&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="k">http&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">more_set_headers&lt;/span> &lt;span class="s">&amp;#39;Server:&lt;/span> &lt;span class="s">CachedLOL&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache_path&lt;/span> &lt;span class="s">/var/cache/nginx&lt;/span> &lt;span class="s">levels=1:2&lt;/span> &lt;span class="s">use_temp_path=on&lt;/span> &lt;span class="s">keys_zone=one:500m&lt;/span> &lt;span class="s">max_size=5g&lt;/span> &lt;span class="s">inactive=120m&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_temp_path&lt;/span> &lt;span class="s">/var/cache/nginx/tmp&lt;/span> &lt;span class="mi">1&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="location-conf">location conf&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-nginx" data-lang="nginx">&lt;span class="line">&lt;span class="cl">&lt;span class="k">upstream&lt;/span> &lt;span class="s">upV1&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.5&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9090&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server&lt;/span> &lt;span class="n">172.26.2.6&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="mi">9090&lt;/span> &lt;span class="s">fail_timeout=0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">server&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">listen&lt;/span> &lt;span class="mi">80&lt;/span> &lt;span class="s">default&lt;/span> &lt;span class="s">backlog=16384&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">server_name&lt;/span> &lt;span class="s">tab.deoops.com&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">location&lt;/span> &lt;span class="p">~&lt;/span>&lt;span class="sr">*&lt;/span> &lt;span class="s">(&lt;/span> &lt;span class="s">/static.*|/list.+|/&lt;/span> &lt;span class="s">)&lt;/span>$ &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_redirect&lt;/span> &lt;span class="no">off&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache&lt;/span> &lt;span class="no">on&lt;/span>&lt;span class="s">e&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_ignore_headers&lt;/span> &lt;span class="s">&amp;#34;Set-Cookie&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_hide_header&lt;/span> &lt;span class="s">&amp;#34;Set-Cookie&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">add_header&lt;/span> &lt;span class="s">X-Cache&lt;/span> &lt;span class="nv">$upstream_cache_status&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache_key&lt;/span> &lt;span class="nv">$uri$is_args$args$mobile&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache_min_uses&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache_valid&lt;/span> &lt;span class="mi">120m&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_cache_use_stale&lt;/span> &lt;span class="s">error&lt;/span> &lt;span class="s">timeout&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_buffering&lt;/span> &lt;span class="no">on&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kn">proxy_pass&lt;/span> &lt;span class="s">http://upV1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å®‰è£…é…ç½®openvpn</title><link>https://tab.deoops.com/posts/install-openvpn/</link><pubDate>Mon, 20 Feb 2017 13:24:19 +0800</pubDate><guid>https://tab.deoops.com/posts/install-openvpn/</guid><description>&lt;img src="https://tab.deoops.com/posts/install-openvpn/openvpnflows.jpeg" alt="Featured image of post å®‰è£…é…ç½®openvpn" />&lt;p>å¼€å‘éœ€è¦èƒ½è°ƒç”¨&lt;code>facebook&lt;/code>çš„æ¥å£ï¼Œæˆ‘ä»¬è¿ç»´è¿™è¾¹éœ€è¦é…ç½®ä¸€å°æµ‹è¯•æœåŠ¡å™¨èƒ½è®¿é—®&lt;code>facebook&lt;/code>ï¼Œç”¨shadowsocks
å’Œsquid ä»£ç†ï¼Œæ€§èƒ½ä¸å¤Ÿå¥½ã€‚æ‰€ä»¥å†³å®šä¸Šopenvpnã€‚&lt;/p>
&lt;p>ç®€å•è®°å½•ä¸‹openVPNçš„å®‰è£…é…ç½®è¿‡ç¨‹ï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå‡æ˜¯centos 7ã€‚&lt;/p>
&lt;h2 id="æœåŠ¡ç«¯">æœåŠ¡ç«¯&lt;/h2>
&lt;h3 id="å®‰è£…">å®‰è£…&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>yum install epel-release -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install openvpn openssl -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="è‡ªç­¾åè¯ä¹¦">è‡ªç­¾åè¯ä¹¦&lt;/h4>
&lt;p>ä½¿ç”¨&lt;code>openssl&lt;/code>å·¥å…·ç”Ÿäº§è‡ªç­¾åçš„caï¼Œè¯ä¹¦ï¼Œclient.keyï¼Œå¹¶æŠŠè¿™äº›è¯ä¹¦ä¼ ç»™å®¢æˆ·ç«¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### CA&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl dhparam -out /etc/openvpn/dh.pem &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl genrsa -out /etc/openvpn/ca.key &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl req -new -key /etc/openvpn/ca.key -out /etc/openvpn/ca.csr -subj /CN&lt;span class="o">=&lt;/span>OpenVPN-CA/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl x509 -req -in /etc/openvpn/ca.csr -out /etc/openvpn/ca.crt -signkey /etc/openvpn/ca.key -days &lt;span class="m">3650&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="m">01&lt;/span> &amp;gt; /etc/openvpn/ca.srl
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">600&lt;/span> /etc/openvpn/ca.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### Server &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl genrsa -out /etc/openvpn/server.key &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl req -new -key /etc/openvpn/server.key -out /etc/openvpn/server.csr -subj /CN&lt;span class="o">=&lt;/span>OpenVPN/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl x509 -req -in /etc/openvpn/server.csr -out /etc/openvpn/server.crt -CA /etc/openvpn/ca.crt -CAkey /etc/openvpn/ca.key -days &lt;span class="m">3650&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">600&lt;/span> /etc/openvpn/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### Client&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl genrsa -out /etc/openvpn/client.key &lt;span class="m">2048&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl req -new -key /etc/openvpn/client.key -out /etc/openvpn/client.csr -subj /CN&lt;span class="o">=&lt;/span>OpenVPN-Client/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">openssl x509 -req -in /etc/openvpn/client.csr -out /etc/openvpn/client.crt -CA /etc/openvpn/ca.crt -CAkey /etc/openvpn/ca.key -days &lt;span class="m">3650&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">chmod &lt;span class="m">600&lt;/span> /etc/openvpn/client.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">### æŠŠclinetçš„è¯ä¹¦ç§é’¥å’Œcaæ­£å¼ä¼ ç»™å®¢æˆ·ç«¯&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">scp /etc/openvpn/ca.crt /etc/openvpn/client.crt /etc/openvpn/client.key client:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="é…ç½®">é…ç½®&lt;/h3>
&lt;h4 id="æœåŠ¡ç«¯é…ç½®æ–‡ä»¶">æœåŠ¡ç«¯é…ç½®æ–‡ä»¶:&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/openvpn/server.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">server 10.8.0.0 255.255.255.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">verb &lt;span class="m">3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key /etc/openvpn/server.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ca /etc/openvpn/ca.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cert /etc/openvpn/server.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dh /etc/openvpn/dh.pem
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">keepalive &lt;span class="m">10&lt;/span> &lt;span class="m">120&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persist-key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">persist-tun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">comp-lzo
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">push &lt;span class="s2">&amp;#34;redirect-gateway def1 bypass-dhcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">push &lt;span class="s2">&amp;#34;dhcp-option DNS 8.8.8.8&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">push &lt;span class="s2">&amp;#34;dhcp-option DNS 8.8.4.4&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">user nobody
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">group nogroup
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">proto udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">port &lt;span class="m">1194&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dev tun1194
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">status openvpn-status.log
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="kernel-iptables">kernel iptables&lt;/h4>
&lt;p>æ‰“å¼€æœåŠ¡å™¨è·¯ç”±é…ç½®ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="nb">echo&lt;/span> &lt;span class="s1">&amp;#39;net.ipv4.ip_forward=1&amp;#39;&lt;/span> &amp;gt;&amp;gt; /etc/sysctl.conf
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysctl -p
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å¯åŠ¨">å¯åŠ¨&lt;/h3>
&lt;p>æœåŠ¡å™¨å¯åŠ¨openVPNæœåŠ¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>systemctl &lt;span class="nb">enable&lt;/span> openvpn@server
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">systemctl start openvpn@server
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯&lt;/h2>
&lt;h3 id="å®‰è£…-1">å®‰è£…&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>yum install epel-release -y
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">yum install openvpn -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="é…ç½®-1">é…ç½®&lt;/h3>
&lt;h4 id="è¯ä¹¦">è¯ä¹¦&lt;/h4>
&lt;p>æŠŠå‰é¢æœåŠ¡ç«¯ç­¾åçš„è¯ä¹¦ç§»åŠ¨åˆ°é…ç½®ç›®å½•ä¸‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cp">&lt;/span>mv ~/ca.crt /etc/openvpn
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mv ~/client* /etc/openvpn/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/openvpn/client.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">client
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nobind
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dev tun
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">redirect-gateway def1 bypass-dhcp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">remote CHANGE_TO_YOUR_SERVER_IP &lt;span class="m">1194&lt;/span> udp
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">comp-lzo yes
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#duplicate-cn&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">key /etc/openvpn/client.key
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cert /etc/openvpn/client.crt
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ca /etc/openvpn/ca.crt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="å¯åŠ¨-1">å¯åŠ¨&lt;/h3>
&lt;p>å®¢æˆ·ç«¯å¯åŠ¨openVPNæœåŠ¡ï¼š&lt;/p>
&lt;pre tabindex="0">&lt;code>#!/bin/bash
systemctl enable openvpn@client
systemctl start openvpn@client
&lt;/code>&lt;/pre>&lt;p>&lt;a class="link" href="https://www.rosehosting.com/blog/how-to-install-openvpn-on-centos-7/" target="_blank" rel="noopener"
>å‚è€ƒHow to Install OpenVPN on CentOS 7&lt;/a>&lt;/p></description></item><item><title>Ansible</title><link>https://tab.deoops.com/posts/ansible-memo/</link><pubDate>Sat, 16 Apr 2016 11:33:05 +0800</pubDate><guid>https://tab.deoops.com/posts/ansible-memo/</guid><description>&lt;img src="https://tab.deoops.com/posts/ansible-memo/ansible.png" alt="Featured image of post Ansible" />&lt;p>æœ¬æ–‡ä¸å®šæœŸæ›´æ–° :)&lt;/p>
&lt;p>&lt;a class="link" href="https://www.redhat.com/en/blog/system-administrators-guide-getting-started-ansible-fast?extIdCarryOver=true&amp;amp;sc_cid=701f2000001OH7YAAW" target="_blank" rel="noopener"
>A system administrator&amp;rsquo;s guide to getting started with Ansible&lt;/a>&lt;/p>
&lt;h2 id="ad-hoc">ad-hoc&lt;/h2>
&lt;p>ç®¡ç†é›†ç¾¤çš„æ—¶å€™ï¼Œå¸¸å¸¸æ¥ä¸åŠå†™playbooksï¼Œåªéœ€è¦æ‰§è¡Œä¸€äº›ad-hocæŸ¥çœ‹æŸäº›ä¸»æœºçš„çŠ¶æ€ï¼Œ
æˆ–è€…æ‰¹é‡ä¿®æ”¹/ä¸Šä¼ é…ç½®æ–‡ä»¶åˆ°æŸäº›ä¸»æœºã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ansible all -m copy -a &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>&lt;span class="s1">&amp;#39;src=dvd.repo dest=/etc/yum.repos.d owner=root group=root mode=0644&amp;#39;&lt;/span> -b
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="playbook">playbook&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ansible-playbook -i prod_hosts demo.yml --skip-tag downloaded
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="host-file">host file&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="line">&lt;span class="cl">&lt;span class="k">[api]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">tt ansible_host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">test&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">tt3 ansible_host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">test3&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">tt8 ansible_host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">test8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">[db]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">pg1 ansible_host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">db88&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="na">pg2 ansible_host&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">db98&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="task">task&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># demo.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nn">---&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>- &lt;span class="nt">hosts&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">db&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">vars&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tar_src&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;tars/postgres_exporter_v0.4.1_linux-amd64.tar.gz&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tar_dest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/usr/bin/&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">service_src&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;services/postgres_exporter.service&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">service_dest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;/usr/lib/systemd/system/&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># works on centos; ubuntu is &amp;#39;/etc/systemd/system/&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tasks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">debug&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">var=ansible_default_ipv4.address&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">untar to /usr/bin&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">unarchive&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">src&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ tar_src }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ tar_dest }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">become&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">download and untar prometheus tarball&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">tags&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">downloaded&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">unarchive&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">src&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ prometheus_tarball_url }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ prometheus_install_path }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">copy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">no&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">copy service file&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">copy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">src&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ service_src }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">dest&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;{{ service_dest }}&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">become&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ensure node_export is ebalbe and running&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">systemd&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">postgres_exporter&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">enabled&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">yes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">daemon_reload&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">yes&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">state&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">started&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">become&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>tcpæ€§èƒ½è°ƒä¼˜</title><link>https://tab.deoops.com/posts/tcp-tune/</link><pubDate>Tue, 05 Apr 2016 18:58:52 +0800</pubDate><guid>https://tab.deoops.com/posts/tcp-tune/</guid><description>&lt;img src="https://tab.deoops.com/posts/tcp-tune/sysctl.jpeg" alt="Featured image of post tcpæ€§èƒ½è°ƒä¼˜" />&lt;p>æˆ‘ä»¬ä¸€èˆ¬ä¼šè°ƒæ•´å†…æ ¸tcpå‚æ•°ä»¥æé«˜webæœåŠ¡å™¨(æ¯”å¦‚ngin)çš„æ€§èƒ½ã€‚&lt;/p>
&lt;h2 id="sysctl">sysctl&lt;/h2>
&lt;p>åŠ è½½Linux å†…æ ¸é…ç½®&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">sysctl -p /etc/sysctl.d/xxx-xxx.conf
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="meat">meat&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># /etc/sysctl.d/00-network.conf&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Receive Queue Size per CPU Core, number of packets&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Example server: 8 cores&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.core.netdev_max_backlog &lt;span class="o">=&lt;/span> &lt;span class="m">4096&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># SYN Backlog Queue, number of half-open connections&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.tcp_max_syn_backlog &lt;span class="o">=&lt;/span> &lt;span class="m">32768&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Accept Queue Limit, maximum number of established&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># connections waiting for accept() per listener.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.core.somaxconn &lt;span class="o">=&lt;/span> &lt;span class="m">65535&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Maximum number of SYN and SYN+ACK retries before&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># packet expires.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.tcp_syn_retries &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.tcp_synack_retries &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Timeout in seconds to close client connections in&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># TIME_WAIT after receiving FIN packet.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.tcp_fin_timeout &lt;span class="o">=&lt;/span> &lt;span class="m">5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Disable SYN cookie flood protection&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">net.ipv4.tcp_syncookies &lt;span class="o">=&lt;/span> &lt;span class="m">0&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Maximum number of threads system can have, total.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Commented, may not be needed. See user limits.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#kernel.threads-max = 3261780&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Maximum number of file descriptors system can have, total.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Commented, may not be needed. See user limits.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#fs.file-max = 3261780&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å†è§scripttogrğŸ‘‹</title><link>https://tab.deoops.com/posts/blog-scripttogr/</link><pubDate>Mon, 13 Jul 2015 19:29:06 +0800</pubDate><guid>https://tab.deoops.com/posts/blog-scripttogr/</guid><description>&lt;img src="https://tab.deoops.com/posts/blog-scripttogr/scriptogr.png" alt="Featured image of post å†è§scripttogrğŸ‘‹" />&lt;p>å¾ˆä¹…ä»¥å‰æœ‰å¹¸é‡åˆ°ä¸€æ¬¾å¾ˆå¹²å‡€ç®€æ´ blog saasäº§å“ï¼Œå¯ä»¥é€šè¿‡emailå’Œdropboxå†™/å¤‡ä»½æ–‡ç« ã€‚&lt;/p>
&lt;p>ä»Šå¤©å‘ç°&lt;a class="link" href="https://scriptogr.am/" target="_blank" rel="noopener"
>scripttogr&lt;/a> å·²ç»å…³é—­ä¸è¿è¥äº†ã€‚&lt;/p>
&lt;p>å¯æƒœäº†ã€‚&lt;/p>
&lt;p>å¥½çš„äº§å“ä¸ä¸€å®šèƒ½æ´»ä¸‹å»ï¼Œå¯æƒœäº†ã€‚&lt;/p></description></item><item><title>è„šæœ¬æ³¨å…¥</title><link>https://tab.deoops.com/posts/opkg-inject/</link><pubDate>Thu, 18 Jun 2015 13:32:58 +0800</pubDate><guid>https://tab.deoops.com/posts/opkg-inject/</guid><description>&lt;img src="https://tab.deoops.com/posts/opkg-inject/opkg.png" alt="Featured image of post è„šæœ¬æ³¨å…¥" />&lt;p>ä½¿ç”¨opkgå®‰è£…è½¯ä»¶æ—¶ï¼Œå¸¸å¸¸éœ€è¦å¯¹å€™è½¯ä»¶åŒ…è¿›è¡Œåˆå§‹åŒ–æˆ–è€…è‡ªå®šä¹‰åŒ–æ“ä½œï¼Œè¿™ç§å¼€å‘éœ€æ±‚ä¸€èˆ¬å†™ç»™shellè„šæœ¬å°±å¯ä»¥å¯¹ä»˜äº†ã€‚
ç°åœ¨çš„é—®é¢˜æ˜¯å½“è¿™äº›è„šæœ¬å¤šäº†ä¹‹åï¼ŒåŸä½œè€…ä¹Ÿä¸æ„¿æ„ä¿®æ”¹å®‰è£…åŒ…ï¼Œæˆ‘ä»¬æ€ä¹ˆåˆ†å‘è¿™äº›è‡ªå®šä¹‰çš„è„šæœ¬ï¼Œèƒ½ä¸èƒ½æŠŠè‡ªå®šä¹‰çš„è¿™äº›è„šæœ¬ç¼–è¯‘åˆ°opkgåŒ…é‡Œï¼Ÿ&lt;/p>
&lt;h2 id="ä½ç½®">ä½ç½®&lt;/h2>
&lt;p>æŠŠæœ¬åœ°çš„shellè„šæœ¬æ”¾åœ¨openwert ä»“åº“çš„è¿™ä¸ªç›®å½•ï¼Œç¼–è¯‘openwrtçš„æ—¶å€™å°±ä¼šè¢«æ‰“åŒ…åˆ°å¯¹åº”opkgäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">/barrier_breaker/package/package-abc &lt;span class="c1"># package makefileæ–‡ä»¶æ‰€åœ¨&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">package-abc/files &lt;span class="c1"># shellè„šæœ¬æ”¾ç½®ç›®å½•&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="æ­¥éª¤">æ­¥éª¤&lt;/h2>
&lt;ol>
&lt;li>ä¿®æ”¹Makefile&lt;/li>
&lt;/ol>
&lt;p>åœ¨&lt;code>package&lt;/code>ç›®å½•ä¸‹ä»»æ„æ‰¾ä¸€ä¸ªpackageç›®å½•ï¼Œæ¯”å¦‚&lt;code>chinadns&lt;/code>,
ç„¶åä¿®æ”¹Makefileæ–‡ä»¶ã€‚
åœ¨installè¯­å¥åæ·»åŠ  :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="k">$(&lt;/span>INSTALL_BIN&lt;span class="k">)&lt;/span> ./files/your_script.sh &lt;span class="k">$(&lt;/span>1&lt;span class="k">)&lt;/span>/etc/config/your_script.sh
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>
&lt;p>æ”¾ç½®è„šæœ¬
å°†è„šæœ¬your_script.shæ”¾ç½®åœ¨filesç›®å½•ä¸‹ï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>é€‰æ‹©opkg
åœ¨make menuconfig å›¾åƒç•Œé¢ä¸­é€‰æ‹©ä¿®æ”¹è¿‡çš„åŒ…ï¼ˆchinadnsï¼‰&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="é™„">é™„&lt;/h2>
&lt;p>package å’Œæ³¨å…¥æ–‡ä»¶ç›¸å…³çš„éƒ¨åˆ†&lt;code>makefile&lt;/code>ä»£ç :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="c">##
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> include &lt;span class="k">$(&lt;/span>TOPDIR&lt;span class="k">)&lt;/span>/rules.mk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_NAME:&lt;span class="o">=&lt;/span>xxx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_RELEASE:&lt;span class="o">=&lt;/span>&lt;span class="m">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_SOURCE:&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>PKG_NAME&lt;span class="k">)&lt;/span>-&lt;span class="k">$(&lt;/span>PKG_VERSION&lt;span class="k">)&lt;/span>.tar.gz
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_SOURCE_URL:&lt;span class="o">=&lt;/span>https://github.com/xxx/releases/download/v&lt;span class="k">$(&lt;/span>PKG_VERSION&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_MD5SUM:&lt;span class="o">=&lt;/span>f772a750580243cfxcsfd2xc39d7b9171b1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PKG_BUILD_DIR:&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>BUILD_DIR&lt;span class="k">)&lt;/span>/&lt;span class="k">$(&lt;/span>PKG_NAME&lt;span class="k">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> include &lt;span class="k">$(&lt;/span>INCLUDE_DIR&lt;span class="k">)&lt;/span>/package.mk
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">##
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> define Package/xxx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> SECTION:&lt;span class="o">=&lt;/span>net
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> CATEGORY:&lt;span class="o">=&lt;/span>Network
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> TITLE:&lt;span class="o">=&lt;/span>xxx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> endef
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">###
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> define Package/xxx/description
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> button haha upgrade.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> endef
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">###
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#define Package/xxx/conffiles&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#/etc/config/system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#/etc/hotplug.d/button/00-button&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#endef&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">###
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> define Package/wps_button/install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#$(INSTALL_DIR) $(1)/etc/init.d&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">$(&lt;/span>INSTALL_BIN&lt;span class="k">)&lt;/span> ./files/xxx &lt;span class="k">$(&lt;/span>1&lt;span class="k">)&lt;/span>/etc/config/xxx
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#$(INSTALL_DATA) ./files/system.conf $(1)/etc/config/system&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> endef
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">###
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">$(&lt;/span>&lt;span class="nb">eval&lt;/span> &lt;span class="k">$(&lt;/span>call BuildPackage,xxx&lt;span class="k">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">##
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>å­—ç¬¦ä¸²</title><link>https://tab.deoops.com/posts/shell-string/</link><pubDate>Sun, 17 May 2015 15:11:27 +0800</pubDate><guid>https://tab.deoops.com/posts/shell-string/</guid><description>&lt;img src="https://tab.deoops.com/posts/shell-string/comma-seperator.png" alt="Featured image of post å­—ç¬¦ä¸²" />&lt;p>è¿ç»´äººå‘˜/ç³»ç»Ÿç®¡ç†å‘˜æ¯å¤©è¦åœ¨ç»ˆç«¯æ•²å…¥å¤§é‡å‘½ä»¤ï¼Œä¹Ÿè¦ä¿®æ”¹æŸ¥çœ‹å¤§é‡æ–‡æœ¬é…ç½®æ–‡ä»¶ï¼Œæ—¥å¿—ä¿¡æ¯ã€‚
ç”šè‡³å¯ä»¥å¤¸å¼ ä¸€ç‚¹è¯´Linux/Unix system adminçš„å…¨éƒ¨å·¥ä½œå°±æ˜¯å’Œå­—ç¬¦ä¸²æ‰“äº¤é“ã€‚&lt;/p>
&lt;h2 id="binary">binary&lt;/h2>
&lt;p>å¤§å®¶éƒ½çŸ¥é“æ–‡æœ¬æ–‡ä»¶æ˜¯å­—ç¬¦ä¸²ç»„æˆçš„ï¼Œå…¶å®äºŒè¿›åˆ¶æ–‡ä»¶é‡Œé¢å…¶å®ä¹ŸåŒ…å«äº†å¾ˆå¤šå­—ç¬¦ä¸²ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">âœ infra-api git:&lt;span class="o">(&lt;/span>dev&lt;span class="o">)&lt;/span> file infra-api
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">infra-api: Mach-O 64-bit executable x86_64
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ infra-api git:&lt;span class="o">(&lt;/span>dev&lt;span class="o">)&lt;/span> strings infra-api &lt;span class="p">|&lt;/span> head
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">flag
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">hash&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mime
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">path
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sort
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sync
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">time&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">*int
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">AAAA
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Addr
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">âœ infra-api git:&lt;span class="o">(&lt;/span>dev&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‘½ä»¤">å‘½ä»¤&lt;/h2>
&lt;p>æ”¶é›†ä¸€äº›å¸¸ç”¨çš„shell å­—ç¬¦ä¸²æ“ä½œå‘½ä»¤&lt;/p>
&lt;h3 id="cut">cut&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">â¯ tldr cut
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Cut out fields from stdin or files.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> More information: https://www.gnu.org/software/coreutils/cut.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out the first sixteen characters of each line of stdin:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -c 1-16
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out the first sixteen characters of each line of the given files:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -c 1-16 file
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out everything from the 3rd character to the end of each line:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -c 3-
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out the fifth field of each line, using a colon as a field delimiter &lt;span class="o">(&lt;/span>default delimiter is tab&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -d&lt;span class="s1">&amp;#39;:&amp;#39;&lt;/span> -f5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out the 2nd and 10th fields of each line, using a semicolon as a delimiter:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -d&lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span> -f2,10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> - Cut out the fields &lt;span class="m">3&lt;/span> through to the end of each line, using a space as a delimiter:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cut -d&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span> -f3-
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="catless">cat/less&lt;/h3>
&lt;p>catï¼Œä¸»è¦æœ‰ä¸‰å¤§ä½¿ç”¨åœºæ™¯ï¼š&lt;/p>
&lt;p>ä¸€æ¬¡æ˜¾ç¤ºæ•´ä¸ªæ–‡ä»¶ &lt;code>cat filename&lt;/code>;
ä»æ ‡å‡†è¾“å…¥æµï¼ˆé”®ç›˜ï¼‰æ–°å»ºä¸€ä¸ªæ–‡ä»¶ã€‚&lt;code>cat &amp;gt; filename&lt;/code>;
å°†å‡ ä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼š &lt;code>cat file1 file2 &amp;gt; file&lt;/code>ã€‚
å‚æ•°ï¼š
-n æˆ– &amp;ndash;number ç”± 1 å¼€å§‹å¯¹æ‰€æœ‰è¾“å‡ºçš„è¡Œæ•°ç¼–å·
-b æˆ– &amp;ndash;number-nonblank å’Œ -n ç›¸ä¼¼ï¼Œåªä¸è¿‡å¯¹äºç©ºç™½è¡Œä¸ç¼–å·
-s æˆ– &amp;ndash;squeeze-blank å½“é‡åˆ°æœ‰è¿ç»­ä¸¤è¡Œä»¥ä¸Šçš„ç©ºç™½è¡Œï¼Œå°±ä»£æ¢ä¸ºä¸€è¡Œçš„ç©ºç™½è¡Œ
-v æˆ– &amp;ndash;show-nonprinting
ä¾‹ï¼š&lt;/p>
&lt;ol>
&lt;li>æŠŠ textfile1 çš„æ¡£æ¡ˆå†…å®¹åŠ ä¸Šè¡Œå·åè¾“å…¥ textfile2 è¿™ä¸ªæ¡£æ¡ˆé‡Œ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat -n textfile1 &amp;gt; textfile2
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>æŠŠ textfile1 å’Œ textfile2 çš„æ¡£æ¡ˆå†…å®¹åŠ ä¸Šè¡Œå·ï¼ˆç©ºç™½è¡Œä¸åŠ ï¼‰ä¹‹åå°†å†…å®¹é™„åŠ åˆ° textfile3 é‡Œã€‚&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat -b textfile1 textfile2 &amp;gt;&amp;gt; textfile3
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="3">
&lt;li>æ¸…ç©ºtest.txt&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">cat /dev/null &amp;gt; /etc/test.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;strong>å¦å¤–ï¼Œæœ¬æ–‡è¯»å–æ–‡ä»¶çš„æ“ä½œå¯ç”¨lesså‘½ä»¤æ›¿ä»£ï¼Œlesså‘½ä»¤é€Ÿåº¦ä¼šæ›´å¿«äº›&lt;/strong>&lt;/p>
&lt;h3 id="awk">awk&lt;/h3>
&lt;p>awkå¯ä»¥ç®—ç‹¬ç«‹çš„ä¸€é—¨ç¼–ç¨‹è¯­è¨€ï¼Œä¸¾ä¸¤ä¸ªä¾‹å­ï¼š&lt;/p>
&lt;ol>
&lt;li>æˆªå–è·¯ç”±å™¨MACåœ°å€åå››ä½&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="k">$(&lt;/span>cat /sys/class/ieee80211/&lt;span class="si">${&lt;/span>&lt;span class="nv">dev&lt;/span>&lt;span class="si">}&lt;/span>/macaddress&lt;span class="k">)&lt;/span> &lt;span class="p">|&lt;/span> awk -F &lt;span class="s2">&amp;#34;:&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{ print $5&amp;#34;&amp;#34;$6 }&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> tr a-z A-Z
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> sd:3s:xf:0h:w4:n8 &lt;span class="p">|&lt;/span> awk -F &lt;span class="s2">&amp;#34;:&amp;#34;&lt;/span> &lt;span class="s1">&amp;#39;{ print $5&amp;#34;&amp;#34;$6 }&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> tr a-z A-Z
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">W4N8
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>å¯¹æŸä¸€åˆ—æ±‚å’Œ&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">awk -F&lt;span class="s1">&amp;#39;,&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{sum+=$2;} END{print sum;}&amp;#39;&lt;/span> file.txt
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="è¿è¡Œæ–¹å¼">è¿è¡Œæ–¹å¼&lt;/h4>
&lt;ol>
&lt;li>å‘½ä»¤è¡Œæ–¹å¼&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">awk &lt;span class="o">[&lt;/span>-F field-separator&lt;span class="o">]&lt;/span> &lt;span class="s1">&amp;#39;commands&amp;#39;&lt;/span> input-file&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­ï¼Œcommands æ˜¯awkå‘½ä»¤ï¼Œ[-FåŸŸåˆ†éš”ç¬¦]æ˜¯å¯é€‰çš„ã€‚ input-file(s) æ˜¯å¾…å¤„ç†çš„æ–‡ä»¶ã€‚
åœ¨awkä¸­ï¼Œæ–‡ä»¶çš„æ¯ä¸€è¡Œä¸­ï¼Œç”±åŸŸåˆ†éš”ç¬¦åˆ†å¼€çš„æ¯ä¸€é¡¹ç§°ä¸ºä¸€ä¸ªåŸŸã€‚é€šå¸¸ï¼Œåœ¨ä¸æŒ‡å-FåŸŸåˆ†éš”ç¬¦çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤çš„åŸŸåˆ†éš”ç¬¦æ˜¯ç©ºæ ¼ã€‚&lt;/p>
&lt;ol start="2">
&lt;li>
&lt;p>è„šæœ¬æ–¹å¼
å°†æ‰€æœ‰çš„awkæŒ‡ä»¤å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä½¿awkç¨‹åºå¯æ‰§è¡Œï¼Œç„¶åæŠŠawkè§£é‡Šå™¨ä½œä¸ºè„šæœ¬çš„é¦–è¡Œï¼Œå³å¯è¿è¡Œawkè„šæœ¬ã€‚
æŠŠè„šæœ¬é¦–è¡Œï¼ˆmagic bangï¼‰ï¼š&lt;code>#!/bin/sh&lt;/code> æ¢æˆï¼š &lt;code>#!/bin/awk&lt;/code> å³å¯ï¼Œä»¥ &lt;code>which awk&lt;/code> çš„è¾“å‡ºä¸ºå‡†ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†æ‰€æœ‰çš„awkå‘½ä»¤æ’å…¥ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ï¼Œç„¶åè°ƒç”¨ï¼š&lt;/p>
&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">awk -f awk-script-file input-file&lt;span class="o">(&lt;/span>s&lt;span class="o">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å…¶ä¸­ï¼Œ-fé€‰é¡¹åŠ è½½awk-script-fileä¸­çš„awkè„šæœ¬ï¼Œinput-file(s)è·Ÿä¸Šé¢çš„æ˜¯ä¸€æ ·çš„ã€‚&lt;/p>
&lt;h3 id="tr">tr&lt;/h3>
&lt;p>tr å‘½ä»¤ä»æ ‡å‡†è¾“å…¥åˆ é™¤æˆ–æ›¿æ¢å­—ç¬¦ï¼Œå¹¶å°†ç»“æœå†™å…¥æ ‡å‡†è¾“å‡ºã€‚æ ¹æ®ç”± String1 å’Œ String2 å˜é‡æŒ‡å®šçš„å­—ç¬¦ä¸²ä»¥åŠæŒ‡å®šçš„æ ‡å¿—ï¼Œtr å‘½ä»¤å¯æ‰§è¡Œä¸‰ç§æ“ä½œã€‚&lt;/p>
&lt;p>æœ¬æ–‡ä½¿ç”¨äº†ç®€å•çš„&lt;strong>æ›¿æ¢&lt;/strong>æ“ä½œã€‚&lt;em>å°å†™å­—æ¯è½¬ä¸ºå¤§å†™å­—æ¯ã€‚&lt;/em>&lt;/p></description></item><item><title>å¢åŠ å›ºä»¶å¤§å°</title><link>https://tab.deoops.com/posts/firmware-size/</link><pubDate>Thu, 07 May 2015 11:45:48 +0800</pubDate><guid>https://tab.deoops.com/posts/firmware-size/</guid><description>&lt;img src="https://tab.deoops.com/posts/firmware-size/wr703n.jpeg" alt="Featured image of post å¢åŠ å›ºä»¶å¤§å°" />&lt;p>å¾ˆå¤šè·¯ç”±å™¨çš„flashå®¹é‡åªæœ‰4må¤§ï¼Œæ‰€ä»¥ç»å¤§å¤šæ•°openwrtå›ºä»¶ä¹Ÿæ˜¯4må¤§å°ã€‚
å½“æˆ‘ä»¬æ‰‹åŠ¨æ”¹é€ è·¯ç”±å™¨åŠ å¤§flashå®¹é‡åï¼Œå¯ä»¥è°ƒæ•´openwrté»˜è®¤è®¾ç½®ä½¿å¾—ç¼–è¯‘å‡ºæ¥çš„factoryå¯ä»¥æœ‰8mçš„å¤§å°ï¼Œ
ä»è€Œå®‰è£…æ›´å¤šçš„å†…ç½®è½¯ä»¶ã€‚&lt;/p>
&lt;p>æœ¬æ–‡ä»¥wr703nè·¯ç”±å™¨ ä¸ºä¾‹å­ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹å¦‚ä½•åŠ å¤§å›ºä»¶çš„å®¹é‡ï¼Œè®©æˆ‘ä»¬é¢„å®‰è£…æ›´å¤šå†…ç½®è½¯ä»¶ã€‚&lt;/p>
&lt;h3 id="æŸ¥çœ‹">æŸ¥çœ‹&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># ./tools/firmware-utils/src/mktplinkfw.c&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fw_max_lenä¸º0xfc0000ï¼Œ16M flash
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">fw_max_lenä¸º0x7c0000ï¼Œ8M flash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ä¿®æ”¹">ä¿®æ”¹&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># ./target/linux/ar71xx/image/Makefile
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># å°†703nçš„4Mlzmaæ”¹ä¸º8Mlzmaæˆ–16Mlzma
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c">&lt;/span> &lt;span class="k">$(&lt;/span>&lt;span class="nb">eval&lt;/span> &lt;span class="k">$(&lt;/span>call SingleProfile,TPLINK-LZMA,&lt;span class="k">$(&lt;/span>fs_64kraw&lt;span class="k">)&lt;/span>,TLWR703,tl-wr703n-v1,TL-WR703N,ttyATH0,115200,0x07030101,1,8Mlzma&lt;span class="k">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>åˆ·æœºHG255d</title><link>https://tab.deoops.com/posts/router-hg255d/</link><pubDate>Tue, 17 Mar 2015 09:09:58 +0800</pubDate><guid>https://tab.deoops.com/posts/router-hg255d/</guid><description>&lt;img src="https://tab.deoops.com/posts/router-hg255d/hg255d.jpg" alt="Featured image of post åˆ·æœºHG255d" />&lt;h2 id="äº¤å‰ç¼–è¯‘">äº¤å‰ç¼–è¯‘&lt;/h2>
&lt;ol>
&lt;li>åœ¨ubuntuä¸‹å®‰è£…ç¼–è¯‘å·¥å…·ï¼ˆgcc,xmllib,cmake, git ç­‰)ï¼›&lt;/li>
&lt;li>gitå…‹éš†openwrtä»“åº“ï¼š&lt;code>git clone git://git.openwrt.org/14.07/openwrt.git&lt;/code>ï¼›&lt;/li>
&lt;li>è‡ªå®šä¹‰kernel targetï¼š&lt;/li>
&lt;/ol>
&lt;p>æºä»£ç åš&lt;a class="link" href="http://my.oschina.net/osbin/blog/278782" target="_blank" rel="noopener"
>ä¸¤å¤„ä¿®æ”¹&lt;/a> :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">target/linux/ramips/image/Makefile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">/base-files/lib/ramips.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">target/linux/ramips/base-files/lib/preinit/06_set_iface_mac
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="4">
&lt;li>åœ¨å¼¹å‡ºçš„make menuconfig å›¾åƒç•Œé¢ä¸­é€‰æ‹©cpuå‹å·ï¼›&lt;/li>
&lt;li>æ‰“å¼€vpnå¼€å§‹ç¼–è¯‘å›ºä»¶ã€‚&lt;/li>
&lt;/ol>
&lt;h2 id="ç»“æœ">ç»“æœ&lt;/h2>
&lt;p>äº¤å‰ç¼–è¯‘å®Œæˆåï¼Œæ ¹æ®ä¸Šä¸€æ­¥é€‰æ‹©çš„å®‰è£…åŒ…çš„å¤šå°‘ï¼Œbinç›®å½•ä¸‹ä¼šç”Ÿæˆå¯¹åº”çš„opkgåŒ…ï¼Œå’Œå›ºä»¶ï¼š&lt;/p>
&lt;ol>
&lt;li>factoryæ–‡ä»¶ï¼Œå¯ä»¥ç§°ä½œåº•åŒ…ï¼›&lt;/li>
&lt;li>sysupgradeæ–‡ä»¶ï¼Œå¯ä»¥ç§°ä½œå‡çº§åŒ…ï¼›&lt;/li>
&lt;/ol>
&lt;h3 id="webubootçƒ§å½•åˆ·æœº">web/ubootçƒ§å½•åˆ·æœº&lt;/h3>
&lt;ol>
&lt;li>æ¥é€šè·¯ç”±å™¨ç”µæºï¼ŒæŒ‰ä½WPSæŒ‰é’®ä¸æ”¾ï¼Œç„¶åæŒ‰ç”µæºé”®å¼€æœºï¼Œ power LEDå¿«é—ªå³æ¾å¼€WPSé”®ï¼Œæ­¤æ—¶è·¯ç”±å™¨å·²åŠ å…¥å‡çº§æ¨¡å¼ï¼›&lt;/li>
&lt;li>è®¿é—®è·¯ç”±å™¨webåœ°å€ï¼ˆå¦‚ï¼šhttp://192.168.1.1), æŒ‰ç…§webç•Œé¢æç¤ºé€‰å–factoryæ–‡ä»¶å®Œæˆå›ºä»¶çƒ§å½•åˆ·æœºï¼›&lt;/li>
&lt;/ol>
&lt;h3 id="sshftp-çƒ§å½•">ssh/ftp çƒ§å½•&lt;/h3>
&lt;p>å¯ä»¥ç›´æ¥æ‰§è¡Œ&lt;code>sysupgrade&lt;/code>å‘½ä»¤çƒ§å½•ä¼°è®¡ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">ssh-keygen -f &lt;span class="s2">&amp;#34;/home/openwrt-qqm/.ssh/known_hosts&amp;#34;&lt;/span> -R 192.168.1.1 &lt;span class="c1">#å¯ä»¥çœç•¥æ­¤æ¡å‘½ä»¤ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">scp xxxxxx-squashfs-sysupgrade.bin root@192.168.1.1:/tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">ssh root@192.168.1.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> /tmp/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sysupgrade -n xxxxxxxxxxx-sysupgrade.bin
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="opkg">opkg&lt;/h3>
&lt;p>çƒ§å½•å®Œç³»ç»Ÿå›ºä»¶åï¼Œå¯ä»¥ä½¿ç”¨&lt;code>opkg&lt;/code>å®‰è£…è½¯ä»¶åŒ…ï¼Œæ¯”å¦‚&lt;code>china-dns&lt;/code>, &lt;code>shadowsocks&lt;/code>, &lt;code>openvpn&lt;/code>ï¼Œç­‰ç­‰ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 100;
flex-basis: 240px"
>
&lt;a href="https://tab.deoops.com/posts/router-hg255d/hg255d.jpg" data-size="310x310">
&lt;img src="https://tab.deoops.com/posts/router-hg255d/hg255d.jpg"
width="310"
height="310"
srcset="https://tab.deoops.com/posts/router-hg255d/hg255d_hu95abe093e5988d14ccd200bc31cd3495_35267_480x0_resize_q75_box.jpg 480w, https://tab.deoops.com/posts/router-hg255d/hg255d_hu95abe093e5988d14ccd200bc31cd3495_35267_1024x0_resize_q75_box.jpg 1024w"
loading="lazy"
alt="hg255d router">
&lt;/a>
&lt;figcaption>hg255d router&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>Google Domain</title><link>https://tab.deoops.com/posts/google-domain/</link><pubDate>Tue, 17 Jun 2014 14:22:06 +0800</pubDate><guid>https://tab.deoops.com/posts/google-domain/</guid><description>&lt;img src="https://tab.deoops.com/posts/google-domain/google-domain.png" alt="Featured image of post Google Domain" />&lt;p>åˆšåˆšåœ¨google+ä¸Šçœ‹åˆ°google æ¨å‡ºäº†è‡ªå·±çš„åŸŸåæ³¨å†ŒæœåŠ¡ï¼Œæˆªä¸¤å¼ å›¾ï¼Œçºªå¿µä¸‹ã€‚&lt;/p>
&lt;p>googleæ¨å¹¿è‡ªå·±çš„ &lt;strong>&lt;a class="link" href="https://com.google/" target="_blank" rel="noopener"
>com.google åŸŸåæ³¨å†Œæ‰˜ç®¡æœåŠ¡&lt;/a>&lt;/strong>ï¼ŒæŠŠé¦–é¡µå˜æˆäº†é•œåƒæ¨¡å¼
&lt;figure
class="gallery-image"
style="
flex-grow: 195;
flex-basis: 469px"
>
&lt;a href="https://tab.deoops.com/posts/google-domain/google-domain.png" data-size="1100x562">
&lt;img src="https://tab.deoops.com/posts/google-domain/google-domain.png"
width="1100"
height="562"
srcset="https://tab.deoops.com/posts/google-domain/google-domain_hu8addcdeb3c155fbae74eb60aed2e0ca1_53610_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/google-domain/google-domain_hu8addcdeb3c155fbae74eb60aed2e0ca1_53610_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="google domain">
&lt;/a>
&lt;figcaption>google domain&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>æœç´¢æ­£å¸¸ï¼Œä¸è¿‡æœç´¢ç»“æœä¹Ÿä½¿ç”¨äº†é•œåƒæ•ˆæœï¼š
&lt;figure
>
&lt;a href="https://tab.deoops.com/non.png" >
&lt;img src="https://tab.deoops.com/non.png"
loading="lazy"
alt="serach page">
&lt;/a>
&lt;figcaption>serach page&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>æ­ªæ¥¼</title><link>https://tab.deoops.com/posts/wai-lou/</link><pubDate>Mon, 12 May 2014 16:05:52 +0800</pubDate><guid>https://tab.deoops.com/posts/wai-lou/</guid><description>&lt;img src="https://tab.deoops.com/posts/wai-lou/wl.jpeg" alt="Featured image of post æ­ªæ¥¼" />&lt;p>ä»Firefoxçš„æŸ¥çœ‹å…ƒç´ &amp;gt;æŸ¥çœ‹å™¨å…¥æ‰‹ï¼Œå‘ç°æœ‰æå¤´ã€‚ç„¶ååˆè°·æ­ŒæŸ¥é˜…äº†äº›èµ„æ–™ï¼Œå‘ç°æˆ‘æƒ³çš„æ–¹æ³•å¯¹firefoxæµè§ˆå™¨çš„ä¾èµ–æ€§å¤ªå¼ºï¼Œæœ€å¤šä¹Ÿå°±èƒ½åšæˆfirefoxçš„ä¸€ä¸ªæ’ä»¶ã€‚&lt;/p>
&lt;p>ç®€è¦è®°ä¸‹æˆ‘åŸæ¥çš„æ€è·¯ï¼š&lt;/p>
&lt;p>htmlæºæ–‡æ¡£ï¼Œç”¨wordæ‰“å¼€çš„è¯ï¼Œå°±å¯ä»¥è‡ªåŠ¨å»é™¤æ‰€æœ‰çš„&lt;code>&amp;lt;tag&amp;gt;&lt;/code>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨&lt;code>perl&lt;/code>å†™äº›æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥æåˆ°htmlæºæ–‡æ¡£å°±æœ‰æå¤´ã€‚&lt;/p>
&lt;p>ç™¾åº¦æ–‡åº“å•Šï¼Œè±†ä¸å•Šï¼Œåˆ€å®¢88å•Šï¼Œä»€ä¹ˆçš„ï¼Œè¡¨é¢ä¸Šå¥½åƒæŠŠæºæ–‡æ¡£è—çš„å¥½å¥½çš„ï¼Œä½†æ˜¯åªè¦ç”¨firefoxæŸ¥çœ‹ä¸‹å…ƒç´ ï¼Œä»–ä»¬å°±æ€‚äº†ï¼Œç©¿ä»€ä¹ˆè‰²çš„å†…è£¤éƒ½çœ‹çš„ä¸€æ¸…äºŒæ¥šã€‚&lt;/p>
&lt;p>ç„¶åï¼Œæˆä¹Ÿè§ä½•è´¥ä¹Ÿè§ä½•ï¼Œä¸æƒ³å¤ªä¾èµ–firefoxã€‚&lt;/p>
&lt;p>æ‰€ä»¥ï¼Œä½œç½¢ã€‚&lt;/p>
&lt;p>ä¸è¿‡ä¹Ÿæœ‰äº›å°æ”¶è·ï¼Œå¯ä»¥åšäº›å°çš„æ¶ä½œå‰§ã€‚&lt;/p>
&lt;p>æ¯”å¦‚ä¸‹å›¾ä¸€ï¼Œå’Œä¸‹å›¾äºŒçš„æ¶ä½œå‰§ï¼š&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 135;
flex-basis: 324px"
>
&lt;a href="https://tab.deoops.com/posts/wai-lou/quiz.jpeg" data-size="1188x880">
&lt;img src="https://tab.deoops.com/posts/wai-lou/quiz.jpeg"
width="1188"
height="880"
srcset="https://tab.deoops.com/posts/wai-lou/quiz_hu5bbe4659923f69bd65fdecb2cc7ea928_317155_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/wai-lou/quiz_hu5bbe4659923f69bd65fdecb2cc7ea928_317155_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="quiz">
&lt;/a>
&lt;figcaption>quiz&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>ï¼ˆå›¾ä¸€ï¼Œæ¶æçš„æ˜¯ç™¾åº¦æ–‡åº“çš„æ¯ä¸ªè€ƒè¯•è¯•å·æ–‡æ¡£ï¼Œè¿˜ä¸ç®—å¤ªæ­ªï¼‰&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 143;
flex-basis: 345px"
>
&lt;a href="https://tab.deoops.com/posts/wai-lou/weibo.png" data-size="1315x914">
&lt;img src="https://tab.deoops.com/posts/wai-lou/weibo.png"
width="1315"
height="914"
srcset="https://tab.deoops.com/posts/wai-lou/weibo_hu4e5c67c3889d5730d2eb73405719769d_344356_480x0_resize_box_3.png 480w, https://tab.deoops.com/posts/wai-lou/weibo_hu4e5c67c3889d5730d2eb73405719769d_344356_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="weibo">
&lt;/a>
&lt;figcaption>weibo&lt;/figcaption>
&lt;/figure>
ï¼ˆå›¾äºŒï¼Œæ¶æçš„æ˜¯æ–‡ç« ã€‚ã€‚ã€‚~~è¯è¯´äººå®¶åŠˆäººå®¶çš„è…¿ä¸ä½ ä½•å¹²ï¼Ÿ ~~è¯è¯´æˆ‘æ²¡æœ‰èŠ‚æ“åˆä¸ä»–ä»¬åŠˆä¸åŠˆè…¿ä½•å¹²ï¼Ÿï¼‰&lt;/p></description></item><item><title>é›¨å¥½å¤§</title><link>https://tab.deoops.com/posts/da-yu/</link><pubDate>Sat, 10 May 2014 16:21:02 +0800</pubDate><guid>https://tab.deoops.com/posts/da-yu/</guid><description>&lt;img src="https://tab.deoops.com/posts/da-yu/rain.jpeg" alt="Featured image of post é›¨å¥½å¤§" />&lt;p>æ¥è¿ä¸‹äº†ä¸€å‘¨çš„é›¨ï¼Œæ—©ä¸Šé†’æ¥çš„æ—¶å€™æ„Ÿè§‰è¢«å­æœ‰ç‚¹æ½®æ½®çš„ã€‚&lt;/p>
&lt;p>å¬ç€å¤–é¢çš„é›¨å£°ï¼Œæ€ç´¢ç€è¦ä¸è¦èµ·åºŠï¼Œå¿½ç„¶æ„è¯†åˆ°æ˜å¤©è¦ä¸Šç­ï¼Œäºæ˜¯åˆè’™å¤´ç¡è¿‡ã€‚&lt;/p>
&lt;p>åˆè¿‡äº†ä¼šï¼Œé†’äº†ï¼Œèµ·åºŠæ´—æ¼±ï¼Œåˆ·ç‰™çš„æ—¶å€™æˆ‘å–œæ¬¢å¬æ­Œï¼Œæ´—è„¸çš„æ—¶å€™ä¹Ÿå–œæ¬¢å¬æ­Œï¼Œæ´—æ¾¡çš„æ—¶å€™ä¹Ÿæ˜¯ï¼Œè¿˜æœ‰æ´—å¤´çš„æ—¶å€™ã€‚&lt;/p>
&lt;p>æ„Ÿè§‰æ˜¨å¤©æ™šé¤è¿˜æ²¡æœ‰æ¶ˆåŒ–å®Œå…¨ï¼Œæ‰€ä»¥å°±ä¸æ€¥ç€åƒæ—©é¤ã€‚å››å¤„æ™ƒäº†æ™ƒï¼Œä¸‹é›¨æ„Ÿè§‰å¹²ä»€ä¹ˆéƒ½æ²¡åŠ²ï¼Œæ‰“å¼€ç”µè„‘ï¼Œç„¶åæ˜¯google.com.hk&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 258;
flex-basis: 620px"
>
&lt;a href="https://tab.deoops.com/posts/da-yu/google.jpeg" data-size="491x190">
&lt;img src="https://tab.deoops.com/posts/da-yu/google.jpeg"
width="491"
height="190"
srcset="https://tab.deoops.com/posts/da-yu/google_hu2c86cfb65dd94ae6e174cce48badd167_30476_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/da-yu/google_hu2c86cfb65dd94ae6e174cce48badd167_30476_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="google doodles">
&lt;/a>
&lt;figcaption>google doodles&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>å“¦ï¼Œä»Šå¤©æ˜¯æ¯äº²èŠ‚å•Šã€‚
æ€ç»ªä¸€ä¸‹å­è¢«æ‰“å¼€äº†å¥½å¤§ä¸ªç¼ºå£ï¼Œå¥½å¤šæƒ…æ„Ÿå‘æˆ‘è¢­æ¥ï¼Œ&lt;/p>
&lt;p>çœ¼çœ‹æˆ‘å°±è¦è¢«ç§ç§å¹¸ç¦çš„ã€å§”å±ˆçš„ã€äº²åˆ‡çš„ã€ç¾å¥½çš„ã€æ‡Šæ‚”çš„ã€æ‹æ‹ä¸èˆçš„ï¼Œç­‰ç­‰ï¼Œå›å¿†åŒ…å›´ï¼Œ&lt;/p>
&lt;p>æ¯•ä¸šä¸€å¹´å¤šï¼Œæ¼‚æ³Šåœ¨å¤–çš„æˆ‘çªç„¶å‘ç°æˆ‘å¥½æ— åŠ©ï¼Œç„¶åä¸çŸ¥é“ä¸ºå•¥ï¼Œè¿™äº›å›å¿†å°±çªç„¶é—´æ¨¡ç³ŠçƒŸæ¶ˆäº‘æ•£äº†ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 150;
flex-basis: 360px"
>
&lt;a href="https://tab.deoops.com/posts/da-yu/child.jpeg" data-size="510x340">
&lt;img src="https://tab.deoops.com/posts/da-yu/child.jpeg"
width="510"
height="340"
srcset="https://tab.deoops.com/posts/da-yu/child_hu63e49afffa9d0e6c669a2e1b584d896f_16050_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/da-yu/child_hu63e49afffa9d0e6c669a2e1b584d896f_16050_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="child">
&lt;/a>
&lt;figcaption>child&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>æ…¢æ…¢æ¥å§ï¼Œç”Ÿæ´»æ€»ä¼šæ˜¯æƒ³è¦çš„é‚£æ ·çš„ã€‚&lt;/p>
&lt;p>ä¸‹æ¥¼ä¹°æ—©ç‚¹å»äº†ï¼Œè¯è¯´è¿™æŠŠä¼æœ‰ç‚¹å°äº†å§ã€‚&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 133;
flex-basis: 319px"
>
&lt;a href="https://tab.deoops.com/posts/da-yu/umbrella.jpeg" data-size="205x154">
&lt;img src="https://tab.deoops.com/posts/da-yu/umbrella.jpeg"
width="205"
height="154"
srcset="https://tab.deoops.com/posts/da-yu/umbrella_huf7225b652dd15c5d6820a7be494daf60_5347_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/da-yu/umbrella_huf7225b652dd15c5d6820a7be494daf60_5347_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="umbrella">
&lt;/a>
&lt;figcaption>umbrella&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>æ’‘ç€ä¼åœ¨é›¨é‡Œèµ°ç€ï¼Œæƒ³èµ·åˆšæ¥è¿™å·¥ä½œçš„æ—¶å€™ï¼Œå’ŒæŸä¸ªäººä¸€èµ·æ‰“ä¼ï¼Œè¿˜ç»™äº†å¥¹50å—é’±ï¼Œç°åœ¨è¿˜æ²¡è¿˜ç»™æˆ‘ã€‚&lt;/p>
&lt;p>Anyway ï¼ŒHAPPY MOTHER&amp;rsquo;S DAY!
&lt;figure
class="gallery-image"
style="
flex-grow: 150;
flex-basis: 360px"
>
&lt;a href="https://tab.deoops.com/posts/da-yu/mother.jpeg" data-size="1600x1066">
&lt;img src="https://tab.deoops.com/posts/da-yu/mother.jpeg"
width="1600"
height="1066"
srcset="https://tab.deoops.com/posts/da-yu/mother_hu28623d733cda5e9e327544394c637f2c_217058_480x0_resize_q75_box.jpeg 480w, https://tab.deoops.com/posts/da-yu/mother_hu28623d733cda5e9e327544394c637f2c_217058_1024x0_resize_q75_box.jpeg 1024w"
loading="lazy"
alt="mother">
&lt;/a>
&lt;figcaption>mother&lt;/figcaption>
&lt;/figure>&lt;/p></description></item><item><title>è°¢è°¢vpngate</title><link>https://tab.deoops.com/posts/try-vpngate/</link><pubDate>Fri, 09 May 2014 16:39:24 +0800</pubDate><guid>https://tab.deoops.com/posts/try-vpngate/</guid><description>&lt;img src="https://tab.deoops.com/posts/try-vpngate/vpngate.jpeg" alt="Featured image of post è°¢è°¢vpngate" />&lt;p>åœ¨å¤©æœå‘†ä¹…äº†ï¼Œæœ‰ç‚¹è¿«å®³å¦„æƒ³ç—‡ã€‚ç”¨&lt;a class="link" href="https://www.vpngate.net" target="_blank" rel="noopener"
>vpngate&lt;/a>å‡ºæ¥è½¬è½¬çœ‹çœ‹ï¼Œå‘ç°ç¡®å®æ˜¯æˆ‘æƒ³å¤šäº†ã€‚&lt;/p>
&lt;p>anywayï¼Œè°¢è°¢vpngateï¼ŒæŒºä¸é”™çš„vpnã€‚&lt;/p></description></item><item><title>ç¬¬ä¸ƒç« FLOW3dé“¸é€ æ¨¡å…·çƒ­å¾ªç¯åˆ†æ</title><link>https://tab.deoops.com/posts/flow-3d/</link><pubDate>Thu, 08 May 2014 16:34:49 +0800</pubDate><guid>https://tab.deoops.com/posts/flow-3d/</guid><description>&lt;img src="https://tab.deoops.com/posts/flow-3d/software_flow_science.jpeg" alt="Featured image of post ç¬¬ä¸ƒç« FLOW3dé“¸é€ æ¨¡å…·çƒ­å¾ªç¯åˆ†æ" />&lt;p>æ–‡ç« å·²ä¸¢å¤± :(&lt;/p></description></item><item><title>æƒ³å†™ä¸ªcms</title><link>https://tab.deoops.com/posts/rails-cms/</link><pubDate>Mon, 23 Dec 2013 13:28:34 +0800</pubDate><guid>https://tab.deoops.com/posts/rails-cms/</guid><description>&lt;img src="https://tab.deoops.com/posts/rails-cms/ror.jpeg" alt="Featured image of post æƒ³å†™ä¸ªcms" />&lt;p>&lt;code>updated at 2014/2/16 å‘å¤ªå¤§ï¼ŒæŒ‘æˆ˜å¤ªå¤šï¼ŒæŒ‘æˆ˜å¤±è´¥ï¼Œæ”¾å¼ƒå•¦ :)&lt;/code>&lt;/p>
&lt;p>çœ‹å®ŒRuby On Rails tutorialï¼Œæ„Ÿè§‰çƒ­è¡€æ²¸è…¾ã€‚
æ¥å§ï¼Œå°‘å¹´ï¼Œæ¥å†™ä¸ªCMSå§ã€‚&lt;/p>
&lt;h2 id="model">model&lt;/h2>
&lt;p>æ•°æ®åº“è®¾è®¡&lt;/p>
&lt;h3 id="generate">generate&lt;/h3>
&lt;p>ç”Ÿæˆmodel schemaæ•°æ®æ¨¡å‹ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rails g model App &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>title:string icon:binary descript:text &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>get_url:string hits:integer downloaded:integer score:decimal &lt;span class="se">\
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="se">&lt;/span>version:string require_os_version:string author:references
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rails g model Author name:string descript:text website:string
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="populate">populate&lt;/h3>
&lt;p>å¡«å……å‡æ•°æ®ï¼Œä¾¿äºæµ‹è¯•ã€‚
&lt;a class="link" href="https://github.com/stympy/faker" target="_blank" rel="noopener"
>faker gem&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#db/seed.rb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">30&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ne&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">App&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">author&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Lorem&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">paragraph&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">we&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Internet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">url&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">Author&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">create!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">ne&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">descript&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">dt&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">website&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">we&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">users&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Author&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">order&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="ss">:created_at&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">take&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">17&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="mi">50&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">times&lt;/span> &lt;span class="k">do&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">users&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">each&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="o">|&lt;/span>&lt;span class="n">u&lt;/span>&lt;span class="o">|&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">te&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">App&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Hacker&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">say_something_smart&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">gu&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Internet&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">url&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">hs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Number&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Number&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">number&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">se&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">Commerce&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">price&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">vn&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">Faker&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="no">App&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">version&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rn&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;android 1.6+ | ios 6.0+&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">u&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">apps&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">create!&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="ss">icon&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="kp">nil&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">title&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">te&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">descript&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">dt&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">get_url&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">gu&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">hits&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">hs&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">downloaded&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">dd&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">score&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">se&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="ss">version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">vn&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="ss">require_os_version&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">rn&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ•°æ®å½•å…¥">æ•°æ®å½•å…¥&lt;/h3>
&lt;ol>
&lt;li>æ‰‹åŠ¨/äººå·¥å½•å…¥
formè¡¨å•&lt;/li>
&lt;li>æœºå™¨æŠ“å–
&lt;a class="link" href="https://github.com/sparklemotion/nokogiri" target="_blank" rel="noopener"
>nokogiri gem&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="uistatic_pages_controller">UI/static_pages_controller&lt;/h2>
&lt;h3 id="controller">controller&lt;/h3>
&lt;p>æ–°å»ºcontroller&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rails g controller StaticPages index
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rails g controller Apps update destroy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#destroy widget&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rails d controller widgets
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">rails d model Widget
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="scss">scss&lt;/h3>
&lt;p>è°ƒæ•´scss&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-gemfile" data-lang="gemfile"># ä¿®æ”¹gemfile
gem &amp;#39;bootstrap-will_paginate&amp;#39;
gem &amp;#39;will_paginate&amp;#39;
gem &amp;#39;bootstrap-sass&amp;#39;
&lt;/code>&lt;/pre>&lt;p>rename scssæ–‡ä»¶&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mv path/to/application.css path/to/application.scss
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-scss" data-lang="scss">&lt;span class="line">&lt;span class="cl">&lt;span class="k">@import&lt;/span> &lt;span class="s2">&amp;#34;bootstrap-sprockets&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">@import&lt;/span> &lt;span class="s2">&amp;#34;bootstrap&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="cm">/* mixins, variables, etc. */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">$gray-medium-light&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mh">#eaeaea&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">@mixin&lt;/span>&lt;span class="nf"> box_sizing&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">-moz-box-sizing&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="ni">border-box&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">-webkit-box-sizing&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="ni">border-box&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">box-sizing&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="ni">border-box&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* universal */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">html&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">overflow-y&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="ni">scroll&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nt">body&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">padding-top&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">60&lt;/span>&lt;span class="kt">px&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="cm">/* ....... */&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="erb">erb&lt;/h3>
&lt;p>æ·»åŠ titleè‡ªå®šä¹‰æ”¯æŒ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># application.html.erbæ·»åŠ &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="n">title&lt;/span>&lt;span class="o">&amp;gt;&amp;lt;&lt;/span>&lt;span class="s">%= full_title(yield(:title)) %&amp;gt;&amp;lt;/title&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"># static_pages_helper.rbæ·»åŠ 
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">def full_title(page_title =&lt;/span> &lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">base_title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;LOL&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="n">page_title&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">empty?&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">base_title&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">page_title&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> | &lt;/span>&lt;span class="si">#{&lt;/span>&lt;span class="n">base_title&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="action">action&lt;/h3>
&lt;p>ç¼–è¾‘index action&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ruby" data-lang="ruby">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># static_pages_controller.rb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">def&lt;/span> &lt;span class="nf">index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="no">App&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">per_page&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">8&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="vi">@apps&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="no">App&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">paginate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="ss">page&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">params&lt;/span>&lt;span class="o">[&lt;/span>&lt;span class="ss">:page&lt;/span>&lt;span class="o">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="k">end&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># views/static_pages/insex.html.erb&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="sx">% provide(:title, &lt;/span> &lt;span class="s2">&amp;#34;All apps&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="s">%&amp;gt; # é¡µé¢æ ‡é¢˜
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;%= render @apps %&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="s">%= will_paginate @apps %&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"># views/apps/_app.html.erb
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">&amp;lt;span&amp;gt; &amp;lt;%=&lt;/span> &lt;span class="n">app&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">title&lt;/span> &lt;span class="s">%&amp;gt; * * &amp;lt;/span&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>è¿æ¥æ•°æ®åº“</title><link>https://tab.deoops.com/posts/rails-pg/</link><pubDate>Thu, 07 Nov 2013 10:06:54 +0800</pubDate><guid>https://tab.deoops.com/posts/rails-pg/</guid><description>&lt;img src="https://tab.deoops.com/posts/rails-pg/rails-pg.png" alt="Featured image of post è¿æ¥æ•°æ®åº“" />&lt;p>è·Ÿç€rails tutorial å­¦ä¹ railsæ¡†æ¶æ—¶ï¼Œé‡åˆ°äº†dbé“¾æ¥çš„é—®é¢˜&lt;/p>
&lt;h3 id="é—®é¢˜">é—®é¢˜&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">rake db:create failed
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> PG::ConnectionBad: could not connect to server: No such file or directory
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Is the server running locally and accepting
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> connections on Unix domain socket &lt;span class="s2">&amp;#34;/var/pgsql_socket/.s.PGSQL.5432&amp;#34;&lt;/span>?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Googleä¹‹åå‘ç°æ˜¯database.ymlé…ç½®æ–‡ä»¶æ²¡æœ‰åŠ ä¸Š&lt;code>hostï¼šlocalhost&lt;/code>é…ç½®é¡¹ã€‚&lt;/p>
&lt;p>è¿‡ä¸€ä¼šï¼Œå‘ç°PATHæ²¡æœ‰åŒ…å«psqlå‘½ä»¤ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">vi ~/.bash_profile
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">#æ·»åŠ ä¸‹é¢ä¸€è¡Œå†…å®¹&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/Applications/Postgres.app/Contents/Versions/9.4/bin:&lt;/span>&lt;span class="nv">$PATH&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">exit&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">## or&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nb">export&lt;/span> &lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/Applications/Postgres.app/Contents/Versions/9.4/bin:&lt;/span>&lt;span class="nv">$PATH&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.zshrc
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç»ˆäº&lt;code>rake db:migrate&lt;/code> æˆåŠŸã€‚&lt;/p>
&lt;h3 id="é™„å½•">é™„å½•&lt;/h3>
&lt;p>é™„ä¸Šdatabase.ymlï¼ˆproductionç¯å¢ƒä½¿ç”¨herokuç¯å¢ƒå˜é‡)&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="line">&lt;span class="cl">&lt;span class="nt">default&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="cp">&amp;amp;default&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">adapter&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">postgresql&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">encoding&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">unicode&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># For details on connection pooling, see rails configuration guide&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="c"># http://guides.rubyonrails.org/configuring.html#database-pooling&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">pool&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">development&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;lt;&amp;lt;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="cp">*default&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">localhost&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">xxx_development&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">test&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;lt;&amp;lt;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="cp">*default&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">host&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">localhost&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">xxx_test&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w">&lt;/span>&lt;span class="nt">production&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">&amp;lt;&amp;lt;&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="cp">*default&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">database&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">xxx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">username&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">xxx&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="w"> &lt;/span>&lt;span class="nt">password&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;lt;%= ENV[&amp;#39;xxx_xxx_PASSWORD&amp;#39;] %&amp;gt;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>